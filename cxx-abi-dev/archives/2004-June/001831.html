<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [cxx-abi-dev] How to layout the class (with bitfield members) in the inheritance hierarchy on GCC 3.3
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:cxx-abi-dev%40codesourcery.com?Subject=Re%3A%20%5Bcxx-abi-dev%5D%20How%20to%20layout%20the%20class%20%28with%20bitfield%20members%29%0A%20in%20the%20inheritance%20hierarchy%20on%20GCC%203.3&In-Reply-To=%3C40BD2961.6000508%40codesourcery.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001830.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[cxx-abi-dev] How to layout the class (with bitfield members) in the inheritance hierarchy on GCC 3.3</H1>
    <B>Mark Mitchell</B> 
    <A HREF="mailto:cxx-abi-dev%40codesourcery.com?Subject=Re%3A%20%5Bcxx-abi-dev%5D%20How%20to%20layout%20the%20class%20%28with%20bitfield%20members%29%0A%20in%20the%20inheritance%20hierarchy%20on%20GCC%203.3&In-Reply-To=%3C40BD2961.6000508%40codesourcery.com%3E"
       TITLE="[cxx-abi-dev] How to layout the class (with bitfield members) in the inheritance hierarchy on GCC 3.3">mark at codesourcery.com
       </A><BR>
    <I>Wed Jun  2 01:12:01 UTC 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="001830.html">How to layout the class (with bitfield members) in the inheritance hierarchy on GCC 3.3
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1831">[ date ]</a>
              <a href="thread.html#1831">[ thread ]</a>
              <a href="subject.html#1831">[ subject ]</a>
              <a href="author.html#1831">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yan Shi wrote:

&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> According to C++ ABI 2.4 Non-POD Class Types defintion:
</I>&gt;<i> &quot;Allocation of Members Other Than Virtual Bases
</I>&gt;<i> For each data component D (first the primary base of C, if any, then the
</I>&gt;<i> non-primary, non-virtual direct base classes in declaration order, then the
</I>&gt;<i> non-static data members in declaration order), allocate as follows:
</I>&gt;<i> 
</I>&gt;<i> For the following test cases, the bitfield members (b0, b1, b2, b3, b4),
</I>&gt;<i> should all be allocated together in 4 bytes, therefore the total size of
</I>&gt;<i> struct B4 (test2.C) should be 8 bytes and the alignment of struct B4 is 4
</I>&gt;<i> bytes.
</I>&gt;<i> 
</I>&gt;<i> However, I tried both test cases with GCC 3.3 on SLES9 Linux, the size of
</I>&gt;<i> struct B4 (test2.C) is 12 bytes, while the alignment of struct B4 is 4
</I>&gt;<i> bytes on 32-bit mode, which does not agree with the ABI definition.  Could
</I>&gt;<i> some one please explain what the rules/algorithm for such behavior in GCC
</I>&gt;<i> 3.3?
</I>
G++ 3.3 has known bugs in this area of the ABI.  We believe that those 
bugs have been corrected in GCC 3.4.0.  You might also try 
&quot;-fabi-version=0&quot; with G++ 3.3, which eliminates some of the bugs. 
(Some of the bugs were preservedin 3.3 for backwards compatibility with 
earlier versions of G++.)

-- 
Mark Mitchell
CodeSourcery, LLC
<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/cxx-abi-dev">mark at codesourcery.com</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001830.html">How to layout the class (with bitfield members) in the inheritance hierarchy on GCC 3.3
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1831">[ date ]</a>
              <a href="thread.html#1831">[ thread ]</a>
              <a href="subject.html#1831">[ subject ]</a>
              <a href="author.html#1831">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://sourcerytools.com/cgi-bin/mailman/listinfo/cxx-abi-dev">More information about the cxx-abi-dev
mailing list</a><br>
</body></html>

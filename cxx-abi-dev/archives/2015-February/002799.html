<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [cxx-abi-dev] Layout of overaligned empty base classes
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:cxx-abi-dev%40codesourcery.com?Subject=Re%3A%20%5Bcxx-abi-dev%5D%20Layout%20of%20overaligned%20empty%20base%20classes&In-Reply-To=%3CE06C5D25-8C57-4B5D-AE67-26EAE8FD510B%40apple.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="002800.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[cxx-abi-dev] Layout of overaligned empty base classes</H1>
    <B>John McCall</B> 
    <A HREF="mailto:cxx-abi-dev%40codesourcery.com?Subject=Re%3A%20%5Bcxx-abi-dev%5D%20Layout%20of%20overaligned%20empty%20base%20classes&In-Reply-To=%3CE06C5D25-8C57-4B5D-AE67-26EAE8FD510B%40apple.com%3E"
       TITLE="[cxx-abi-dev] Layout of overaligned empty base classes">rjmccall at apple.com
       </A><BR>
    <I>Thu Feb  5 00:11:03 UTC 2015</I>
    <P><UL>
        
        <LI>Next message: <A HREF="002800.html">[cxx-abi-dev] Layout of overaligned empty base classes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2799">[ date ]</a>
              <a href="thread.html#2799">[ thread ]</a>
              <a href="subject.html#2799">[ subject ]</a>
              <a href="author.html#2799">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> On Apr 24, 2014, at 2:52 PM, Richard Smith &lt;<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/cxx-abi-dev">richardsmith at google.com</A>&gt; wrote:
</I>&gt;<i> 2.4/II/3 says:
</I>&gt;<i> 
</I>&gt;<i> &quot;If D is an empty proper base class: [...potentially misalign the D base class...] Note that nvalign(D) is 1, so no update of align(C) is needed.&quot;
</I>&gt;<i> 
</I>&gt;<i> This is not true.
</I>&gt;<i> 
</I>&gt;<i> struct A {};
</I>&gt;<i> struct B : A { char c; };
</I>&gt;<i> struct alignas(4) D : A {};
</I>&gt;<i> struct C : B, D {};
</I>&gt;<i> 
</I>&gt;<i> This puts a D object at offset 1 within C, and gives C nvalign of 1, which is obviously not right. Fortunately, GCC, Clang, and EDG all deviate from the ABI and instead do the natural thing here (put it at offset zero if you can, and otherwise allocate it like any other subobject). Looks like the wording only needs a little massaging here to say the right thing.
</I>
Catching up on my queue, and I found this very old email.  Would you mind proposing an exact wording change?

John.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="002800.html">[cxx-abi-dev] Layout of overaligned empty base classes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2799">[ date ]</a>
              <a href="thread.html#2799">[ thread ]</a>
              <a href="subject.html#2799">[ subject ]</a>
              <a href="author.html#2799">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://sourcerytools.com/cgi-bin/mailman/listinfo/cxx-abi-dev">More information about the cxx-abi-dev
mailing list</a><br>
</body></html>

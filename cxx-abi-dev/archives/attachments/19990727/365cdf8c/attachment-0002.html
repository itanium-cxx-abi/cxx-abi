<tt>
&lt;HTML&gt;<br>
<br>
&lt;HEAD&gt;<br>
&lt;title&gt;C++&nbsp;ABI&nbsp;Closed&nbsp;Issues&lt;/title&gt;<br>
<br>
&lt;link&nbsp;rel=stylesheet&nbsp;href=small-table.css&nbsp;type=&quot;text/css&quot;&gt;<br>
&lt;link&nbsp;rel=stylesheet&nbsp;href=code.css&nbsp;type=&quot;text/css&quot;&gt;<br>
<br>
&lt;hr&gt;<br>
<br>
&lt;font&nbsp;size=6&gt;&lt;i&gt;&lt;b&gt;<br>
&lt;p&gt;<br>
C++&nbsp;ABI&nbsp;Closed&nbsp;Issues<br>
&lt;/b&gt;&lt;/i&gt;&lt;/font&gt;<br>
<br>
&lt;font&nbsp;size=-1&gt;<br>
&lt;p&gt;<br>
&lt;i&gt;Revised&nbsp;27&nbsp;July&nbsp;1999&lt;/i&gt;<br>
<br>
&lt;/center&gt;<br>
<br>
&lt;/HEAD&gt;<br>
<br>
&lt;BODY&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;Issue&nbsp;Status&nbsp;&lt;/h3&gt;<br>
<br>
In&nbsp;the&nbsp;following&nbsp;sections,<br>
the&nbsp;&lt;b&gt;&lt;i&gt;class&lt;/i&gt;&lt;/b&gt;&nbsp;of&nbsp;an&nbsp;issue&nbsp;attempts&nbsp;to&nbsp;classify&nbsp;it&nbsp;on&nbsp;the<br>
basis&nbsp;of&nbsp;what&nbsp;it&nbsp;likely&nbsp;affects.<br>
The&nbsp;identifiers&nbsp;used&nbsp;are:<br>
<br>
&lt;table&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;call&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Function&nbsp;call&nbsp;interface,&nbsp;i.e.&nbsp;call&nbsp;linkage&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;data&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Data&nbsp;layout&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;lib&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Runtime&nbsp;library&nbsp;support&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;lif&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Library&nbsp;interface,&nbsp;i.e.&nbsp;API&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;g&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Potential&nbsp;gABI&nbsp;impact&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;ps&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Potential&nbsp;psABI&nbsp;impact&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;source&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Source&nbsp;code&nbsp;conventions&nbsp;(i.e.&nbsp;API,&nbsp;not&nbsp;ABI)&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;tools&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;May&nbsp;affect&nbsp;how&nbsp;program&nbsp;construction&nbsp;tools&nbsp;interact&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;A.&nbsp;&nbsp;Object&nbsp;Layout&nbsp;Issues&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
&lt;table&nbsp;border=on&nbsp;cellpadding=3&gt;<br>
<br>
&lt;tr&gt;<br>
&lt;th&gt;&nbsp;#&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Issue&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Class&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Status&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Source&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Opened&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Closed&nbsp;&lt;/th&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;A-1&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Vptr&nbsp;location&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;data&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;closed&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;SGI&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990520&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990624&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Summary&lt;/b&gt;:<br>
Where&nbsp;is&nbsp;the&nbsp;Vptr&nbsp;stored&nbsp;in&nbsp;an&nbsp;object&nbsp;(first&nbsp;or&nbsp;last&nbsp;are&nbsp;the&nbsp;usual&nbsp;answers).<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990610&nbsp;All]&lt;/font&gt;<br>
Given&nbsp;the&nbsp;absence&nbsp;of&nbsp;addressing&nbsp;modes&nbsp;with&nbsp;displacements&nbsp;on&nbsp;IA-64,<br>
the&nbsp;consensus&nbsp;is&nbsp;to&nbsp;answer&nbsp;this&nbsp;question&nbsp;with&nbsp;&quot;first.&quot;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990617&nbsp;All]&lt;/font&gt;<br>
Given&nbsp;a&nbsp;Vptr&nbsp;and&nbsp;only&nbsp;non-polymorphic&nbsp;bases,<br>
which&nbsp;(Vptr&nbsp;or&nbsp;base)&nbsp;goes&nbsp;at&nbsp;offset&nbsp;0?<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;HP:&nbsp;Vptr&nbsp;at&nbsp;end,&nbsp;but&nbsp;IA-64&nbsp;is&nbsp;different&nbsp;because&nbsp;no&nbsp;load&nbsp;displacement<br>
&lt;li&gt;&nbsp;Sun:&nbsp;Vptr&nbsp;at&nbsp;0&nbsp;probably&nbsp;preferred<br>
&lt;li&gt;&nbsp;g++:&nbsp;Vptr&nbsp;at&nbsp;end&nbsp;today<br>
&lt;/ul&gt;<br>
&lt;p&gt;<br>
Tentative&nbsp;decision:&nbsp;&nbsp;Vptr&nbsp;always&nbsp;goes&nbsp;at&nbsp;beginning.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990624&nbsp;All]&lt;/font&gt;<br>
Accepted&nbsp;tentative&nbsp;decision.<br>
Rename,&nbsp;close&nbsp;this&nbsp;issue,&nbsp;and&nbsp;open&nbsp;separate&nbsp;issue&nbsp;(B-6)&nbsp;for&nbsp;Vtable&nbsp;layout.<br>
<br>
&lt;p&gt;<br>
&lt;table&nbsp;border=on&nbsp;cellpadding=3&gt;<br>
<br>
&lt;tr&gt;<br>
&lt;th&gt;&nbsp;#&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Issue&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Class&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Status&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Source&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Opened&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Closed&nbsp;&lt;/th&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;A-2&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Virtual&nbsp;base&nbsp;classes&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;data&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;closed&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;SGI&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990520&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990624&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Summary&lt;/b&gt;:<br>
Where&nbsp;are&nbsp;the&nbsp;virtual&nbsp;base&nbsp;subobjects&nbsp;placed&nbsp;in&nbsp;the&nbsp;class&nbsp;layout?<br>
How&nbsp;are&nbsp;data&nbsp;member&nbsp;accesses&nbsp;to&nbsp;them&nbsp;handled?<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990610&nbsp;Matt]&lt;/font&gt;<br>
With&nbsp;regard&nbsp;to&nbsp;how&nbsp;data&nbsp;member&nbsp;accesses&nbsp;are&nbsp;handled,<br>
the&nbsp;choices&nbsp;are&nbsp;to&nbsp;store&nbsp;either&nbsp;a&nbsp;pointer&nbsp;or&nbsp;an&nbsp;offset&nbsp;in&nbsp;the&nbsp;Vtable.<br>
The&nbsp;concensus&nbsp;seems&nbsp;to&nbsp;be&nbsp;to&nbsp;prefer&nbsp;an&nbsp;offset.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990617&nbsp;All]&lt;/font&gt;<br>
Any&nbsp;number&nbsp;of&nbsp;empty&nbsp;virtual&nbsp;base&nbsp;subobjects&nbsp;(rare)&nbsp;will&nbsp;be&nbsp;placed&nbsp;at<br>
offset&nbsp;zero.<br>
If&nbsp;there&nbsp;are&nbsp;no&nbsp;non-virtual&nbsp;polymorphic&nbsp;bases,<br>
the&nbsp;first&nbsp;virtual&nbsp;base&nbsp;subobject&nbsp;with&nbsp;a&nbsp;Vpointer&nbsp;will&nbsp;be&nbsp;placed&nbsp;at<br>
offset&nbsp;zero.<br>
Finally,&nbsp;all&nbsp;other&nbsp;virtual&nbsp;base&nbsp;subobjects&nbsp;will&nbsp;be&nbsp;allocated&nbsp;at&nbsp;the<br>
end&nbsp;of&nbsp;the&nbsp;class,&nbsp;left-to-right,&nbsp;depth-first.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990624&nbsp;All]&lt;/font&gt;<br>
Define&nbsp;an&nbsp;empty&nbsp;object&nbsp;as&nbsp;one&nbsp;with&nbsp;no&nbsp;non-static,&nbsp;non-empty&nbsp;data&nbsp;members,<br>
no&nbsp;virtual&nbsp;functions,<br>
no&nbsp;virtual&nbsp;base&nbsp;classes,<br>
and&nbsp;no&nbsp;non-empty&nbsp;non-virtual&nbsp;base&nbsp;classes.<br>
Define&nbsp;a&nbsp;nearly&nbsp;empty&nbsp;object&nbsp;as&nbsp;one&nbsp;which&nbsp;contains&nbsp;only&nbsp;a&nbsp;Vptr.<br>
The&nbsp;above&nbsp;resolution&nbsp;is&nbsp;accepted,&nbsp;restated&nbsp;as&nbsp;follows:<br>
<br>
&lt;p&gt;<br>
Any&nbsp;number&nbsp;of&nbsp;empty&nbsp;virtual&nbsp;base&nbsp;subobjects<br>
(rare,&nbsp;because&nbsp;they&nbsp;cannot&nbsp;have&nbsp;virtual&nbsp;functions&nbsp;or&nbsp;bases&nbsp;themselves)<br>
will&nbsp;be&nbsp;placed&nbsp;at&nbsp;offset&nbsp;zero,&nbsp;subject&nbsp;to&nbsp;the&nbsp;conflict&nbsp;rules&nbsp;in&nbsp;A-3<br>
(i.e.&nbsp;this&nbsp;cannot&nbsp;result&nbsp;in&nbsp;two&nbsp;objects&nbsp;of&nbsp;the&nbsp;same&nbsp;type&nbsp;at&nbsp;the&nbsp;same<br>
address).<br>
If&nbsp;there&nbsp;are&nbsp;no&nbsp;non-virtual&nbsp;polymorphic&nbsp;base&nbsp;subobjects,<br>
the&nbsp;first&nbsp;nearly&nbsp;empty&nbsp;virtual&nbsp;base&nbsp;subobject&nbsp;will&nbsp;be&nbsp;placed&nbsp;at&nbsp;offset&nbsp;zero.<br>
Any&nbsp;virtual&nbsp;base&nbsp;subobjects&nbsp;not&nbsp;thus&nbsp;placed&nbsp;at&nbsp;offset&nbsp;zero&nbsp;will&nbsp;be<br>
allocated&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;class,<br>
in&nbsp;left-to-right,&nbsp;depth-first&nbsp;declaration&nbsp;order.<br>
<br>
&lt;p&gt;<br>
&lt;table&nbsp;border=on&nbsp;cellpadding=3&gt;<br>
<br>
&lt;tr&gt;<br>
&lt;th&gt;&nbsp;#&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Issue&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Class&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Status&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Source&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Opened&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Closed&nbsp;&lt;/th&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;A-3&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Multiple&nbsp;inheritance&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;data&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;closed&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;SGI&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990520&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990701&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Summary&lt;/b&gt;:<br>
Define&nbsp;the&nbsp;class&nbsp;layout&nbsp;in&nbsp;the&nbsp;presence&nbsp;of&nbsp;multiple&nbsp;base&nbsp;classes.<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990617&nbsp;All]&lt;/font&gt;<br>
At&nbsp;offset&nbsp;zero&nbsp;is&nbsp;the&nbsp;Vptr&nbsp;whenever&nbsp;there&nbsp;is&nbsp;one,<br>
as&nbsp;well&nbsp;as&nbsp;the&nbsp;primary&nbsp;base&nbsp;class&nbsp;if&nbsp;any&nbsp;(see&nbsp;A-7).<br>
Also&nbsp;at&nbsp;offset&nbsp;zero&nbsp;is&nbsp;any&nbsp;number&nbsp;of&nbsp;empty&nbsp;base&nbsp;classes,<br>
as&nbsp;long&nbsp;as&nbsp;that&nbsp;does&nbsp;not&nbsp;place&nbsp;multiple&nbsp;subobjects&nbsp;of&nbsp;the&nbsp;same&nbsp;type&nbsp;at<br>
the&nbsp;same&nbsp;offset.<br>
If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;empty&nbsp;base&nbsp;classes&nbsp;such&nbsp;that&nbsp;placing&nbsp;two&nbsp;of&nbsp;them<br>
at&nbsp;offset&nbsp;zero&nbsp;would&nbsp;violate&nbsp;this&nbsp;constraint,&nbsp;the&nbsp;first&nbsp;is&nbsp;placed&nbsp;there.<br>
(First&nbsp;means&nbsp;in&nbsp;declaration&nbsp;order.)<br>
<br>
&lt;p&gt;<br>
All&nbsp;other&nbsp;non-virtual&nbsp;base&nbsp;classes&nbsp;are&nbsp;laid&nbsp;out&nbsp;in&nbsp;declaration&nbsp;order&nbsp;at<br>
the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;class.<br>
All&nbsp;other&nbsp;virtual&nbsp;base&nbsp;subobjects&nbsp;will&nbsp;be&nbsp;allocated&nbsp;at&nbsp;the<br>
end&nbsp;of&nbsp;the&nbsp;class,&nbsp;left-to-right,&nbsp;depth-first.<br>
<br>
&lt;p&gt;<br>
The&nbsp;above&nbsp;ignores&nbsp;issues&nbsp;of&nbsp;padding&nbsp;for&nbsp;alignment,<br>
and&nbsp;possible&nbsp;reordering&nbsp;of&nbsp;class&nbsp;members&nbsp;to&nbsp;fit&nbsp;in&nbsp;padding&nbsp;areas.<br>
See&nbsp;issue&nbsp;A-9.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990624&nbsp;All]&lt;/font&gt;<br>
There&nbsp;remains&nbsp;an&nbsp;issue&nbsp;concerning&nbsp;the&nbsp;selection&nbsp;of&nbsp;the&nbsp;primary&nbsp;base<br>
class&nbsp;(see&nbsp;A-7),&nbsp;but&nbsp;we&nbsp;are&nbsp;otherwise&nbsp;in&nbsp;agreement.<br>
We&nbsp;will&nbsp;attempt&nbsp;to&nbsp;close&nbsp;this&nbsp;on&nbsp;1&nbsp;July,&nbsp;modulo&nbsp;A-7.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990701&nbsp;All]&lt;/font&gt;<br>
This&nbsp;issue&nbsp;is&nbsp;closed.<br>
A&nbsp;full&nbsp;description&nbsp;of&nbsp;the&nbsp;class&nbsp;layout&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;issue&nbsp;A-9.<br>
(At&nbsp;this&nbsp;time,&nbsp;A-7&nbsp;remains&nbsp;to&nbsp;be&nbsp;closed,<br>
waiting&nbsp;for&nbsp;the&nbsp;Taligent&nbsp;rationale.)<br>
<br>
&lt;p&gt;<br>
&lt;table&nbsp;border=on&nbsp;cellpadding=3&gt;<br>
<br>
&lt;tr&gt;<br>
&lt;th&gt;&nbsp;#&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Issue&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Class&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Status&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Source&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Opened&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Closed&nbsp;&lt;/th&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;A-4&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Empty&nbsp;base&nbsp;classes&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;data&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;closed&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;SGI&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990520&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990624&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Summary&lt;/b&gt;:<br>
Where&nbsp;are&nbsp;empty&nbsp;base&nbsp;classes&nbsp;allocated?<br>
(An&nbsp;empty&nbsp;base&nbsp;class&nbsp;is&nbsp;one&nbsp;with&nbsp;no&nbsp;non-static&nbsp;data&nbsp;members,<br>
no&nbsp;virtual&nbsp;functions,&nbsp;no&nbsp;virtual&nbsp;base&nbsp;classes,<br>
and&nbsp;no&nbsp;non-empty&nbsp;non-virtual&nbsp;base&nbsp;classes.)<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990624&nbsp;All]&lt;/font&gt;<br>
Closed&nbsp;as&nbsp;a&nbsp;duplicate&nbsp;of&nbsp;A-3.<br>
<br>
&lt;p&gt;<br>
&lt;table&nbsp;border=on&nbsp;cellpadding=3&gt;<br>
<br>
&lt;tr&gt;<br>
&lt;th&gt;&nbsp;#&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Issue&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Class&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Status&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Source&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Opened&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Closed&nbsp;&lt;/th&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;A-5&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Empty&nbsp;parameters&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;data&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;closed&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;SGI&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990520&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990701&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Summary&lt;/b&gt;:<br>
When&nbsp;passing&nbsp;a&nbsp;parameter&nbsp;with&nbsp;an&nbsp;empty&nbsp;class&nbsp;type&nbsp;by&nbsp;value,<br>
what&nbsp;is&nbsp;the&nbsp;convention?<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990623&nbsp;SGI]&lt;/font&gt;<br>
We&nbsp;propose&nbsp;that&nbsp;no&nbsp;parameter&nbsp;slot&nbsp;be&nbsp;allocated&nbsp;to&nbsp;such&nbsp;parameters,<br>
i.e.&nbsp;that&nbsp;no&nbsp;register&nbsp;be&nbsp;used,<br>
and&nbsp;that&nbsp;no&nbsp;space&nbsp;in&nbsp;the&nbsp;parameter&nbsp;memory&nbsp;sequence&nbsp;be&nbsp;used.<br>
This&nbsp;implies&nbsp;that&nbsp;the&nbsp;callee&nbsp;must&nbsp;allocate&nbsp;storage&nbsp;at&nbsp;a&nbsp;unique&nbsp;address<br>
if&nbsp;the&nbsp;address&nbsp;is&nbsp;taken&nbsp;(which&nbsp;we&nbsp;expect&nbsp;to&nbsp;be&nbsp;rare).<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990624&nbsp;All]&lt;/font&gt;<br>
In&nbsp;addition&nbsp;to&nbsp;the&nbsp;address-taken&nbsp;case,<br>
care&nbsp;is&nbsp;required&nbsp;if&nbsp;the&nbsp;object&nbsp;has&nbsp;a&nbsp;non-trivial&nbsp;copy&nbsp;constructor.<br>
HP&nbsp;observes&nbsp;that&nbsp;in&nbsp;(some?)&nbsp;such&nbsp;cases,<br>
they&nbsp;perform&nbsp;the&nbsp;construction&nbsp;at&nbsp;the&nbsp;call&nbsp;site&nbsp;and&nbsp;pass&nbsp;the&nbsp;object&nbsp;by<br>
reference.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990625&nbsp;SGI&nbsp;--&nbsp;Jim]&lt;/font&gt;<br>
I&nbsp;understand&nbsp;that&nbsp;the&nbsp;Standard&nbsp;explicitly&nbsp;allows&nbsp;elimination&nbsp;of<br>
even&nbsp;non-trivial&nbsp;copy&nbsp;construction&nbsp;in&nbsp;some&nbsp;cases.<br>
Is&nbsp;this&nbsp;one&nbsp;of&nbsp;them?&nbsp;&nbsp;Where&nbsp;should&nbsp;I&nbsp;look?<br>
Also,&nbsp;of&nbsp;course,&nbsp;varargs&nbsp;processing&nbsp;for&nbsp;elided&nbsp;empty&nbsp;parameters&nbsp;would<br>
need&nbsp;to&nbsp;be&nbsp;careful.<br>
<br>
&lt;p&gt;<br>
I&nbsp;have&nbsp;opened&nbsp;a&nbsp;new&nbsp;issue&nbsp;(C-7)&nbsp;for&nbsp;passing&nbsp;copy-constructed<br>
parameters&nbsp;by&nbsp;reference.<br>
Since&nbsp;doing&nbsp;so&nbsp;would&nbsp;turn&nbsp;an&nbsp;empty&nbsp;value&nbsp;parameter<br>
into&nbsp;a&nbsp;non-empty&nbsp;reference&nbsp;parameter,<br>
this&nbsp;issue&nbsp;can&nbsp;ignore&nbsp;such&nbsp;cases.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990701&nbsp;All]&lt;/font&gt;<br>
An&nbsp;empty&nbsp;parameter&nbsp;will&nbsp;not&nbsp;occupy&nbsp;a&nbsp;slot&nbsp;in&nbsp;the&nbsp;parameter&nbsp;sequence<br>
unless:<br>
&lt;ol&gt;<br>
&lt;li&gt;&nbsp;its&nbsp;type&nbsp;is&nbsp;a&nbsp;class&nbsp;with&nbsp;a&nbsp;non-trivial&nbsp;copy&nbsp;constructor;&nbsp;or<br>
&lt;li&gt;&nbsp;it&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;variable&nbsp;part&nbsp;of&nbsp;a&nbsp;varargs&nbsp;parameter&nbsp;list.<br>
&lt;/ol&gt;<br>
<br>
&lt;p&gt;<br>
Daveed&nbsp;and&nbsp;Matt&nbsp;will&nbsp;pursue&nbsp;the&nbsp;question&nbsp;of&nbsp;when&nbsp;copy&nbsp;constructors&nbsp;may<br>
be&nbsp;ignored&nbsp;for&nbsp;parameters&nbsp;with&nbsp;the&nbsp;Core&nbsp;committee,<br>
and&nbsp;if&nbsp;they&nbsp;identify&nbsp;cases&nbsp;where&nbsp;the&nbsp;constructors&nbsp;may&nbsp;clearly&nbsp;be<br>
omitted,&nbsp;those&nbsp;(empty)&nbsp;parameters&nbsp;will&nbsp;also&nbsp;be&nbsp;elided.<br>
<br>
&lt;p&gt;<br>
&lt;table&nbsp;border=on&nbsp;cellpadding=3&gt;<br>
<br>
&lt;tr&gt;<br>
&lt;th&gt;&nbsp;#&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Issue&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Class&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Status&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Source&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Opened&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Closed&nbsp;&lt;/th&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;A-8&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;(Virtual)&nbsp;base&nbsp;class&nbsp;alignment&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;data&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;closed&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;HP&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990603&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990624&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Summary&lt;/b&gt;:<br>
A&nbsp;(virtual)&nbsp;base&nbsp;class&nbsp;may&nbsp;have&nbsp;a&nbsp;larger&nbsp;alignment&nbsp;constraint&nbsp;than&nbsp;a<br>
derived&nbsp;class.<br>
Do&nbsp;we&nbsp;agree&nbsp;to&nbsp;extend&nbsp;the&nbsp;alignment&nbsp;constraint&nbsp;to&nbsp;the&nbsp;derived&nbsp;class?<br>
(An&nbsp;alternative&nbsp;for&nbsp;virtual&nbsp;bases:<br>
allow&nbsp;the&nbsp;virtual&nbsp;base&nbsp;to&nbsp;move&nbsp;in&nbsp;the&nbsp;complete&nbsp;object.)<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990623&nbsp;SGI]&lt;/font&gt;<br>
We&nbsp;propose&nbsp;that&nbsp;the&nbsp;alignment&nbsp;of&nbsp;a&nbsp;class&nbsp;be&nbsp;the&nbsp;maximum&nbsp;alignment&nbsp;of<br>
its&nbsp;virtual&nbsp;and&nbsp;non-virtual&nbsp;base&nbsp;classes,<br>
non-static&nbsp;data&nbsp;members,&nbsp;and&nbsp;Vptr&nbsp;if&nbsp;any.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990624&nbsp;All]&lt;/font&gt;<br>
Above&nbsp;proposal&nbsp;accepted.<br>
(SGI&nbsp;observation:<br>
the&nbsp;size&nbsp;of&nbsp;the&nbsp;class&nbsp;is&nbsp;rounded&nbsp;up&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;this&nbsp;alignment,<br>
per&nbsp;the&nbsp;underlying&nbsp;psABI&nbsp;rules.)<br>
<br>
&lt;p&gt;<br>
&lt;table&nbsp;border=on&nbsp;cellpadding=3&gt;<br>
<br>
&lt;tr&gt;<br>
&lt;th&gt;&nbsp;#&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Issue&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Class&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Status&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Source&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Opened&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Closed&nbsp;&lt;/th&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;&lt;a&nbsp;name=A9&gt;A-9&lt;/a&gt;&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Sorting&nbsp;fields&nbsp;as&nbsp;allowed&nbsp;by&nbsp;[class.mem]/12&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;data&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;closed&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;HP&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990603&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990624&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Summary&lt;/b&gt;:<br>
The&nbsp;standard&nbsp;constrains&nbsp;ordering&nbsp;of&nbsp;class&nbsp;members&nbsp;in&nbsp;memory&nbsp;only&nbsp;if<br>
they&nbsp;are&nbsp;not&nbsp;separated&nbsp;by&nbsp;an&nbsp;access&nbsp;clause.<br>
Do&nbsp;we&nbsp;use&nbsp;an&nbsp;access&nbsp;clause&nbsp;as&nbsp;an&nbsp;opportunity&nbsp;to&nbsp;fill&nbsp;the&nbsp;gaps&nbsp;left&nbsp;by&nbsp;padding?<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
&lt;b&gt;Resolution&lt;/b&gt;:<br>
See&nbsp;separate&nbsp;writeup&nbsp;of&nbsp;&lt;a&nbsp;href=abi-layout.html&gt;Data&nbsp;Layout&lt;/a&gt;.<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990610&nbsp;all]&lt;/font&gt;<br>
Some&nbsp;participants&nbsp;want&nbsp;to&nbsp;avoid&nbsp;attempts&nbsp;to&nbsp;reorder&nbsp;members&nbsp;differently<br>
than&nbsp;the&nbsp;underlying&nbsp;C&nbsp;struct&nbsp;ABI&nbsp;rules.<br>
Others&nbsp;think&nbsp;there&nbsp;may&nbsp;be&nbsp;benefit&nbsp;in&nbsp;reordering&nbsp;later&nbsp;access&nbsp;sections<br>
to&nbsp;fill&nbsp;holes&nbsp;in&nbsp;earlier&nbsp;ones,&nbsp;or&nbsp;even&nbsp;in&nbsp;base&nbsp;classes.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990617&nbsp;all]&lt;/font&gt;<br>
There&nbsp;are&nbsp;several&nbsp;potential&nbsp;reordering&nbsp;questions,&nbsp;more&nbsp;or&nbsp;less&nbsp;independent:<br>
&lt;ol&gt;<br>
&lt;li&gt;&nbsp;Do&nbsp;we&nbsp;reorder&nbsp;whole&nbsp;access&nbsp;regions&nbsp;relative&nbsp;to&nbsp;one&nbsp;another?<br>
&lt;li&gt;&nbsp;Do&nbsp;we&nbsp;attempt&nbsp;to&nbsp;fill&nbsp;padding&nbsp;in&nbsp;earlier&nbsp;access&nbsp;regions&nbsp;with<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initial&nbsp;members&nbsp;from&nbsp;later&nbsp;regions?<br>
&lt;li&gt;&nbsp;Do&nbsp;we&nbsp;fill&nbsp;the&nbsp;tail&nbsp;padding&nbsp;of&nbsp;non-POD&nbsp;base&nbsp;classes&nbsp;with&nbsp;members&nbsp;from<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;current&nbsp;class?<br>
&lt;li&gt;&nbsp;Do&nbsp;we&nbsp;attempt&nbsp;to&nbsp;fill&nbsp;interior&nbsp;padding&nbsp;of&nbsp;non-POD&nbsp;base&nbsp;classes&nbsp;with&nbsp;later<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;members?<br>
&lt;/ol&gt;<br>
<br>
&lt;p&gt;<br>
There&nbsp;is&nbsp;no&nbsp;apparent&nbsp;support&nbsp;for&nbsp;(1),<br>
since&nbsp;no&nbsp;simple&nbsp;heuristic&nbsp;has&nbsp;been&nbsp;identified&nbsp;with&nbsp;obvious&nbsp;benefits.<br>
There&nbsp;is&nbsp;interest&nbsp;in&nbsp;(2),&nbsp;based&nbsp;on&nbsp;a&nbsp;simple&nbsp;heuristic&nbsp;which&nbsp;might<br>
sometimes&nbsp;help&nbsp;and&nbsp;will&nbsp;never&nbsp;hurt.<br>
However,&nbsp;it&nbsp;is&nbsp;not&nbsp;clear&nbsp;that&nbsp;it&nbsp;will&nbsp;help&nbsp;much,<br>
and&nbsp;Sun&nbsp;objects&nbsp;on&nbsp;grounds&nbsp;that&nbsp;they&nbsp;prefer&nbsp;to&nbsp;match&nbsp;C&nbsp;struct&nbsp;layout.<br>
Unless&nbsp;someone&nbsp;is&nbsp;interested&nbsp;enough&nbsp;to&nbsp;implement&nbsp;and&nbsp;run&nbsp;experiments,<br>
this&nbsp;will&nbsp;be&nbsp;hard&nbsp;to&nbsp;agree&nbsp;upon.<br>
G++&nbsp;has&nbsp;implemented&nbsp;(3)&nbsp;as&nbsp;an&nbsp;option,<br>
based&nbsp;on&nbsp;specific&nbsp;user&nbsp;complaints.<br>
It&nbsp;clearly&nbsp;helps&nbsp;HP's&nbsp;example&nbsp;of&nbsp;a&nbsp;base&nbsp;class&nbsp;containing&nbsp;a&nbsp;word&nbsp;and&nbsp;flag,<br>
with&nbsp;a&nbsp;derived&nbsp;class&nbsp;adding&nbsp;more&nbsp;flags.<br>
Idea&nbsp;(4)&nbsp;has&nbsp;more&nbsp;problems,&nbsp;including&nbsp;some&nbsp;non-intuitive&nbsp;(to&nbsp;users)&nbsp;layouts,<br>
and&nbsp;possibly&nbsp;complicating&nbsp;the&nbsp;selection&nbsp;of&nbsp;bitwise&nbsp;copy&nbsp;in&nbsp;the&nbsp;compiler.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990624&nbsp;all]&lt;/font&gt;<br>
We&nbsp;will&nbsp;not&nbsp;do&nbsp;(1),&nbsp;(2),&nbsp;or&nbsp;(4).&nbsp;&nbsp;We&nbsp;will&nbsp;do&nbsp;(3).<br>
Specifically,&nbsp;allocation&nbsp;will&nbsp;be&nbsp;in&nbsp;modified&nbsp;declaration&nbsp;order&nbsp;as&nbsp;follows:<br>
&lt;ol&gt;<br>
&lt;li&gt;&nbsp;Vptr&nbsp;if&nbsp;any,&nbsp;and&nbsp;the&nbsp;primary&nbsp;base&nbsp;class&nbsp;per&nbsp;A-7.<br>
&lt;li&gt;&nbsp;Any&nbsp;empty&nbsp;base&nbsp;classes&nbsp;allocated&nbsp;at&nbsp;offset&nbsp;zero&nbsp;per&nbsp;A-3.<br>
&lt;li&gt;&nbsp;Any&nbsp;remaining&nbsp;non-virtual&nbsp;base&nbsp;classes.<br>
&lt;li&gt;&nbsp;Any&nbsp;non-static&nbsp;data&nbsp;members.<br>
&lt;li&gt;&nbsp;Any&nbsp;remaining&nbsp;virtual&nbsp;base&nbsp;classes.<br>
&lt;/ol&gt;<br>
Each&nbsp;subobject&nbsp;allocated&nbsp;is&nbsp;placed&nbsp;at&nbsp;the&nbsp;next&nbsp;available&nbsp;position&nbsp;that<br>
satisfies&nbsp;its&nbsp;alignment&nbsp;constraints,&nbsp;as&nbsp;in&nbsp;the&nbsp;underlying&nbsp;psABI.<br>
This&nbsp;is&nbsp;interpreted&nbsp;with&nbsp;the&nbsp;following&nbsp;special&nbsp;cases:<br>
&lt;ol&gt;<br>
&lt;li&gt;&nbsp;The&nbsp;&quot;next&nbsp;available&nbsp;position&quot;&nbsp;after&nbsp;a&nbsp;non-POD&nbsp;class&nbsp;subobject<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(base&nbsp;class&nbsp;or&nbsp;data&nbsp;member)&nbsp;with&nbsp;tail&nbsp;padding&nbsp;is&nbsp;at&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beginning&nbsp;of&nbsp;the&nbsp;tail&nbsp;padding,&nbsp;not&nbsp;after&nbsp;it.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(For&nbsp;POD&nbsp;objects,&nbsp;the&nbsp;tail&nbsp;padding&nbsp;is&nbsp;not&nbsp;&quot;available.&quot;)<br>
&lt;li&gt;&nbsp;Empty&nbsp;classes&nbsp;are&nbsp;considered&nbsp;to&nbsp;have&nbsp;alignment&nbsp;and&nbsp;size&nbsp;1,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;consisting&nbsp;solely&nbsp;of&nbsp;one&nbsp;byte&nbsp;of&nbsp;tail&nbsp;padding.<br>
&lt;li&gt;&nbsp;Placement&nbsp;on&nbsp;top&nbsp;of&nbsp;the&nbsp;tail&nbsp;padding&nbsp;of&nbsp;an&nbsp;empty&nbsp;class&nbsp;must&nbsp;avoid<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;placing&nbsp;multiple&nbsp;subobjects&nbsp;of&nbsp;the&nbsp;same&nbsp;type&nbsp;at&nbsp;the&nbsp;same<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;address.<br>
&lt;/ol&gt;<br>
After&nbsp;allocation&nbsp;is&nbsp;complete,<br>
the&nbsp;size&nbsp;is&nbsp;rounded&nbsp;up&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;alignment&nbsp;(with&nbsp;tail&nbsp;padding).<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990722&nbsp;all]&lt;/font&gt;<br>
The&nbsp;precise&nbsp;placement&nbsp;of&nbsp;empty&nbsp;bases&nbsp;when&nbsp;they&nbsp;don't&nbsp;fit&nbsp;at&nbsp;offset&nbsp;zero<br>
remains&nbsp;imprecise&nbsp;in&nbsp;the&nbsp;above.<br>
Accordingly,&nbsp;a&nbsp;precise&nbsp;layout&nbsp;algorithm&nbsp;is&nbsp;described&nbsp;in<br>
a&nbsp;separate&nbsp;writeup&nbsp;of&nbsp;&lt;a&nbsp;href=abi-layout.html&gt;Data&nbsp;Layout&lt;/a&gt;.<br>
<br>
&lt;p&gt;<br>
&lt;table&nbsp;border=on&nbsp;cellpadding=3&gt;<br>
<br>
&lt;tr&gt;<br>
&lt;th&gt;&nbsp;#&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Issue&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Class&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Status&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Source&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Opened&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Closed&nbsp;&lt;/th&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;A-10&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Class&nbsp;parameters&nbsp;in&nbsp;registers&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;call&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;closed&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;HP&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990603&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990710&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Summary&lt;/b&gt;:<br>
The&nbsp;C&nbsp;ABI&nbsp;specifies&nbsp;that&nbsp;structs&nbsp;are&nbsp;passed&nbsp;in&nbsp;registers.<br>
Does&nbsp;this&nbsp;apply&nbsp;to&nbsp;small&nbsp;non-POD&nbsp;C++&nbsp;objects&nbsp;passed&nbsp;by&nbsp;value?<br>
What&nbsp;about&nbsp;the&nbsp;copy&nbsp;constructor&nbsp;and&nbsp;&lt;code&gt;this&lt;/code&gt;&nbsp;pointer&nbsp;in&nbsp;that&nbsp;case?<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990701&nbsp;all]&lt;/font&gt;<br>
A&nbsp;separate&nbsp;issue&nbsp;(C-7)&nbsp;deals&nbsp;with&nbsp;cases&nbsp;where&nbsp;a&nbsp;non-trivial&nbsp;copy<br>
constructor&nbsp;is&nbsp;required;&nbsp;we&nbsp;ignore&nbsp;those&nbsp;cases&nbsp;here.<br>
Our&nbsp;conclusion&nbsp;is&nbsp;that,&nbsp;without&nbsp;a&nbsp;non-trivial&nbsp;copy&nbsp;constructor,<br>
we&nbsp;need&nbsp;not&nbsp;be&nbsp;concerned&nbsp;about&nbsp;the&nbsp;class&nbsp;object&nbsp;moving&nbsp;in&nbsp;the&nbsp;process<br>
of&nbsp;being&nbsp;passed,&nbsp;and&nbsp;there&nbsp;is&nbsp;no&nbsp;need&nbsp;to&nbsp;use&nbsp;a&nbsp;mechanism&nbsp;different&nbsp;from<br>
the&nbsp;base&nbsp;ABI&nbsp;C&nbsp;struct&nbsp;mechanism.<br>
At&nbsp;the&nbsp;same&nbsp;time,&nbsp;if&nbsp;we&nbsp;do&nbsp;use&nbsp;the&nbsp;underlying&nbsp;C&nbsp;struct&nbsp;mechanism,<br>
the&nbsp;user&nbsp;has&nbsp;complete&nbsp;control&nbsp;of&nbsp;the&nbsp;passing&nbsp;technique,<br>
by&nbsp;choosing&nbsp;whether&nbsp;to&nbsp;pass&nbsp;by&nbsp;value&nbsp;or&nbsp;reference/pointer.<br>
<br>
&lt;p&gt;<br>
Therefore,&nbsp;except&nbsp;in&nbsp;cases&nbsp;identified&nbsp;by&nbsp;issue&nbsp;C-7&nbsp;for&nbsp;different&nbsp;treatment,<br>
class&nbsp;parameters&nbsp;will&nbsp;be&nbsp;passed&nbsp;using&nbsp;the&nbsp;underlying&nbsp;C&nbsp;struct&nbsp;protocol.<br>
<br>
&lt;p&gt;<br>
&lt;table&nbsp;border=on&nbsp;cellpadding=3&gt;<br>
<br>
&lt;tr&gt;<br>
&lt;th&gt;&nbsp;#&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Issue&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Class&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Status&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Source&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Opened&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Closed&nbsp;&lt;/th&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;A-13&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Parameter&nbsp;struct&nbsp;field&nbsp;promotion&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;call&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;closed&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;SGI&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990603&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990701&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Summary&lt;/b&gt;:<br>
It&nbsp;is&nbsp;possible&nbsp;to&nbsp;pass&nbsp;small&nbsp;classes&nbsp;either&nbsp;as&nbsp;memory&nbsp;images,<br>
as&nbsp;is&nbsp;specified&nbsp;by&nbsp;the&nbsp;base&nbsp;ABI&nbsp;for&nbsp;C&nbsp;structs,<br>
or&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;parameters,&nbsp;one&nbsp;for&nbsp;each&nbsp;member.<br>
Which&nbsp;should&nbsp;be&nbsp;done,&nbsp;and&nbsp;if&nbsp;the&nbsp;latter,<br>
what&nbsp;are&nbsp;the&nbsp;rules&nbsp;for&nbsp;identifying&nbsp;&quot;small&quot;&nbsp;classes?<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Resolution&lt;/b&gt;:<br>
No&nbsp;special&nbsp;treatment&nbsp;will&nbsp;be&nbsp;specified&nbsp;by&nbsp;the&nbsp;ABI.<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990701&nbsp;all]&lt;/font&gt;<br>
Define&nbsp;no&nbsp;special&nbsp;treatment&nbsp;for&nbsp;this&nbsp;case&nbsp;in&nbsp;the&nbsp;ABI.<br>
A&nbsp;translator&nbsp;with&nbsp;control&nbsp;over&nbsp;both&nbsp;caller&nbsp;and&nbsp;callee&nbsp;may&nbsp;choose&nbsp;to&nbsp;optimize.<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;B.&nbsp;&nbsp;Virtual&nbsp;Function&nbsp;Handling&nbsp;Issues&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
&lt;table&nbsp;border=on&nbsp;cellpadding=3&gt;<br>
<br>
&lt;tr&gt;<br>
&lt;th&gt;&nbsp;#&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Issue&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Class&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Status&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Source&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Opened&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Closed&nbsp;&lt;/th&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;B-2&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Covariant&nbsp;return&nbsp;types&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;call&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;closed&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;SGI&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990520&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990722&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Summary&lt;/b&gt;:<br>
There&nbsp;are&nbsp;several&nbsp;methods&nbsp;for&nbsp;adjusting&nbsp;the&nbsp;'this'&nbsp;pointer&nbsp;of&nbsp;the<br>
returned&nbsp;value&nbsp;for&nbsp;member&nbsp;functions&nbsp;with&nbsp;covariant&nbsp;return&nbsp;types.<br>
We&nbsp;need&nbsp;to&nbsp;decide&nbsp;how&nbsp;this&nbsp;is&nbsp;done.<br>
Return&nbsp;thunks&nbsp;might&nbsp;be&nbsp;especially&nbsp;costly&nbsp;on&nbsp;IA64,<br>
so&nbsp;a&nbsp;solution&nbsp;based&nbsp;on&nbsp;returning&nbsp;multiple&nbsp;pointers&nbsp;may&nbsp;prove&nbsp;more&nbsp;interesting.<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Resolution&lt;/b&gt;:<br>
Provide&nbsp;a&nbsp;separate&nbsp;Vtable&nbsp;entry&nbsp;for&nbsp;each&nbsp;return&nbsp;type.<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990610&nbsp;Matt]&lt;/font&gt;<br>
One&nbsp;possibility&nbsp;is&nbsp;to&nbsp;have&nbsp;two&nbsp;Vtable&nbsp;entries,<br>
which&nbsp;might&nbsp;point&nbsp;to&nbsp;different&nbsp;functions,&nbsp;different&nbsp;entrypoints,<br>
or&nbsp;a&nbsp;real&nbsp;entrypoint&nbsp;and&nbsp;a&nbsp;thunk.<br>
Another&nbsp;is&nbsp;to&nbsp;return&nbsp;two&nbsp;result&nbsp;pointers&nbsp;(base/derived),<br>
and&nbsp;have&nbsp;the&nbsp;caller&nbsp;select&nbsp;the&nbsp;right&nbsp;one.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990715&nbsp;All]&lt;/font&gt;<br>
Daveed&nbsp;presented&nbsp;his&nbsp;multiple-return-value&nbsp;scheme,<br>
including&nbsp;an&nbsp;example&nbsp;that&nbsp;involved&nbsp;virtual&nbsp;base&nbsp;classes,<br>
return&nbsp;values&nbsp;that&nbsp;are&nbsp;pointers&nbsp;to&nbsp;nonpolymorphic&nbsp;classes,<br>
and&nbsp;other&nbsp;equally&nbsp;horrible&nbsp;things.<br>
<br>
&lt;p&gt;<br>
Consensus:&nbsp;we&nbsp;need&nbsp;to&nbsp;get&nbsp;the&nbsp;horrible&nbsp;cases&nbsp;correct,<br>
but&nbsp;speed&nbsp;only&nbsp;matters&nbsp;in&nbsp;the&nbsp;simple&nbsp;case.<br>
The&nbsp;simple&nbsp;case:&nbsp;class&nbsp;B&nbsp;has&nbsp;a&nbsp;virtual&nbsp;function&nbsp;f&nbsp;returning&nbsp;a&nbsp;B1*<br>
and&nbsp;class&nbsp;D&nbsp;has&nbsp;a&nbsp;virtual&nbsp;function&nbsp;f&nbsp;returning&nbsp;a&nbsp;D1*,<br>
where&nbsp;all&nbsp;four&nbsp;classes&nbsp;are&nbsp;polymorphic,<br>
B&nbsp;is&nbsp;a&nbsp;primary&nbsp;base&nbsp;of&nbsp;D,&nbsp;and&nbsp;B1&nbsp;is&nbsp;a&nbsp;primary&nbsp;base&nbsp;of&nbsp;D1.<br>
(The&nbsp;really&nbsp;important&nbsp;case&nbsp;is&nbsp;where&nbsp;B1&nbsp;is&nbsp;B&nbsp;and&nbsp;D1&nbsp;is&nbsp;D,<br>
but&nbsp;that&nbsp;simplification&nbsp;doesn't&nbsp;make&nbsp;any&nbsp;difference.)<br>
<br>
&lt;p&gt;<br>
Jason:&nbsp;Would&nbsp;the&nbsp;usual&nbsp;multiple-entry-point&nbsp;scheme&nbsp;work&nbsp;just&nbsp;as&nbsp;well?<br>
That&nbsp;is,&nbsp;would&nbsp;it&nbsp;be&nbsp;just&nbsp;as&nbsp;fast&nbsp;as&nbsp;Daveed's&nbsp;scheme&nbsp;in&nbsp;the&nbsp;simple&nbsp;case,<br>
and&nbsp;still&nbsp;preserve&nbsp;enough&nbsp;information&nbsp;for&nbsp;the&nbsp;more&nbsp;complicated&nbsp;cases?<br>
It&nbsp;appears&nbsp;so,&nbsp;but&nbsp;we&nbsp;don't&nbsp;have&nbsp;a&nbsp;proof.<br>
Jason&nbsp;will&nbsp;try&nbsp;to&nbsp;provide&nbsp;one.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990716&nbsp;Cygnus&nbsp;--&nbsp;Jason]&lt;/font&gt;<br>
Proof?<br>
You&nbsp;always&nbsp;know&nbsp;what&nbsp;types&nbsp;a&nbsp;given&nbsp;override&nbsp;must&nbsp;be&nbsp;able&nbsp;to&nbsp;return,<br>
and&nbsp;you&nbsp;know&nbsp;how&nbsp;to&nbsp;convert&nbsp;from&nbsp;the&nbsp;return&nbsp;type&nbsp;to&nbsp;those&nbsp;base&nbsp;types.<br>
You&nbsp;know&nbsp;from&nbsp;the&nbsp;entry&nbsp;point&nbsp;which&nbsp;type&nbsp;is&nbsp;desired.<br>
Seems&nbsp;pretty&nbsp;straightforward&nbsp;to&nbsp;me.<br>
<br>
<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990716&nbsp;Cygnus&nbsp;--&nbsp;Jason]&lt;/font&gt;<br>
The&nbsp;alternative&nbsp;I&nbsp;was&nbsp;talking&nbsp;about&nbsp;yesterday&nbsp;goes&nbsp;something&nbsp;like&nbsp;this:<br>
<br>
&lt;p&gt;<br>
When&nbsp;we&nbsp;have&nbsp;a&nbsp;non-trivial&nbsp;covariant&nbsp;return&nbsp;situation,<br>
we&nbsp;create&nbsp;a&nbsp;new&nbsp;entry&nbsp;in&nbsp;the&nbsp;vtable&nbsp;for&nbsp;the&nbsp;new&nbsp;return&nbsp;type.<br>
The&nbsp;caller&nbsp;chooses&nbsp;which&nbsp;vtable&nbsp;entry&nbsp;to&nbsp;use&nbsp;based&nbsp;on&nbsp;the&nbsp;type&nbsp;they&nbsp;want.<br>
<br>
&lt;p&gt;<br>
This&nbsp;could&nbsp;be&nbsp;implemented&nbsp;several&nbsp;ways,<br>
at&nbsp;the&nbsp;discretion&nbsp;of&nbsp;the&nbsp;vendor:<br>
<br>
&lt;ol&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
Multiple&nbsp;entry&nbsp;points&nbsp;to&nbsp;one&nbsp;function,<br>
with&nbsp;an&nbsp;internal&nbsp;flag&nbsp;indicating&nbsp;which&nbsp;type&nbsp;to&nbsp;return.<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
Thunks&nbsp;which&nbsp;intercept&nbsp;the&nbsp;function's&nbsp;return&nbsp;and&nbsp;modify&nbsp;the&nbsp;return&nbsp;value.<br>
Note&nbsp;that&nbsp;unlike&nbsp;the&nbsp;case&nbsp;of&nbsp;calling&nbsp;virtual&nbsp;functions,<br>
for&nbsp;covariant&nbsp;returns&nbsp;we&nbsp;always&nbsp;know&nbsp;which&nbsp;adjustments&nbsp;will&nbsp;be&nbsp;needed,<br>
so&nbsp;we&nbsp;don't&nbsp;have&nbsp;to&nbsp;pay&nbsp;for&nbsp;a&nbsp;long&nbsp;branch.<br>
We&nbsp;do,&nbsp;however,&nbsp;lose&nbsp;the&nbsp;1-1&nbsp;correspondence&nbsp;between&nbsp;calls&nbsp;and&nbsp;returns,<br>
which&nbsp;apparently&nbsp;affects&nbsp;performance&nbsp;on&nbsp;the&nbsp;Pentium&nbsp;Pro.<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
Function&nbsp;duplication.<br>
&lt;/ol&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;advantage&nbsp;of&nbsp;this&nbsp;approach&nbsp;to&nbsp;the&nbsp;complex&nbsp;case&nbsp;is&nbsp;that&nbsp;we&nbsp;don't&nbsp;have&nbsp;to<br>
do&nbsp;a&nbsp;dynamic_cast&nbsp;when&nbsp;faced&nbsp;with&nbsp;multiple&nbsp;levels&nbsp;of&nbsp;virtual&nbsp;derivation.<br>
It&nbsp;is&nbsp;also&nbsp;strictly&nbsp;simpler;<br>
Daveed's&nbsp;model&nbsp;already&nbsp;requires&nbsp;something&nbsp;like<br>
this&nbsp;in&nbsp;cases&nbsp;of&nbsp;multiple&nbsp;inheritance.<br>
<br>
&lt;p&gt;<br>
Of&nbsp;course,&nbsp;we&nbsp;can&nbsp;always&nbsp;mix&nbsp;and&nbsp;match;<br>
we&nbsp;could&nbsp;choose&nbsp;to&nbsp;only&nbsp;do&nbsp;this&nbsp;in&nbsp;cases&nbsp;of&nbsp;virtual&nbsp;inheritance,<br>
or&nbsp;use&nbsp;Daveed's&nbsp;proposal&nbsp;and&nbsp;do&nbsp;this&nbsp;only&nbsp;in<br>
cases&nbsp;of&nbsp;repeated&nbsp;virtual&nbsp;inheritance.<br>
In&nbsp;that&nbsp;case,&nbsp;the&nbsp;multiple&nbsp;returns<br>
would&nbsp;just&nbsp;be&nbsp;an&nbsp;optimization&nbsp;for&nbsp;the&nbsp;single&nbsp;virtual&nbsp;inheritance&nbsp;case.<br>
<br>
&lt;p&gt;<br>
Since&nbsp;we&nbsp;don't&nbsp;seem&nbsp;to&nbsp;care&nbsp;about&nbsp;the&nbsp;performance&nbsp;of<br>
anything&nbsp;but&nbsp;single&nbsp;nonvirtual&nbsp;inheritance,<br>
it&nbsp;seems&nbsp;simpler&nbsp;not&nbsp;to&nbsp;bother&nbsp;with&nbsp;multiple&nbsp;returns.<br>
<br>
&lt;p&gt;<br>
The&nbsp;remaining&nbsp;question&nbsp;is&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;case&nbsp;of&nbsp;nontrivial<br>
nonvirtual&nbsp;inheritance:<br>
do&nbsp;we&nbsp;use&nbsp;multiple&nbsp;slots&nbsp;or&nbsp;have&nbsp;the&nbsp;caller&nbsp;do&nbsp;the&nbsp;adjustment?<br>
My&nbsp;inclination&nbsp;is&nbsp;to&nbsp;have&nbsp;the&nbsp;caller&nbsp;adjust.<br>
<br>
&lt;p&gt;<br>
WRT&nbsp;patents,<br>
the&nbsp;idea&nbsp;of&nbsp;having&nbsp;the&nbsp;function&nbsp;return&nbsp;the&nbsp;base-most&nbsp;class&nbsp;and&nbsp;having<br>
the&nbsp;caller&nbsp;adjust&nbsp;is&nbsp;parallel&nbsp;to&nbsp;the&nbsp;patented&nbsp;Microsoft&nbsp;scheme&nbsp;whereby<br>
they&nbsp;pass&nbsp;the&nbsp;base-most&nbsp;class&nbsp;as&nbsp;the&nbsp;'this'&nbsp;argument&nbsp;to&nbsp;virtual&nbsp;functions,<br>
but&nbsp;the&nbsp;word&nbsp;'return'&nbsp;does&nbsp;not&nbsp;appear&nbsp;anywhere&nbsp;in&nbsp;the&nbsp;patent,<br>
so&nbsp;it&nbsp;seems&nbsp;safe.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990722&nbsp;All]&lt;/font&gt;<br>
The&nbsp;group&nbsp;was&nbsp;generally&nbsp;agreed&nbsp;that&nbsp;the&nbsp;simplicity&nbsp;of&nbsp;multiple&nbsp;entries<br>
in&nbsp;the&nbsp;vtable&nbsp;outweighed&nbsp;any&nbsp;space/performance&nbsp;advantage&nbsp;of&nbsp;more<br>
complex&nbsp;schemes&nbsp;(e.g.&nbsp;the&nbsp;method&nbsp;Daveed&nbsp;described&nbsp;on&nbsp;15&nbsp;July).<br>
Discussion&nbsp;focussed&nbsp;on&nbsp;whether&nbsp;it&nbsp;is&nbsp;worthwhile&nbsp;to&nbsp;eliminate&nbsp;some&nbsp;of<br>
the&nbsp;entries&nbsp;in&nbsp;cases&nbsp;where&nbsp;they&nbsp;are&nbsp;unnecessary&nbsp;because&nbsp;the&nbsp;caller<br>
knows&nbsp;the&nbsp;required&nbsp;conversion,<br>
namely&nbsp;when&nbsp;the&nbsp;return&nbsp;type&nbsp;has&nbsp;a&nbsp;unique&nbsp;non-virtual&nbsp;subobject&nbsp;of&nbsp;the<br>
original&nbsp;return&nbsp;type.<br>
<br>
&lt;p&gt;<br>
Agreement&nbsp;was&nbsp;reached&nbsp;to&nbsp;avoid&nbsp;the&nbsp;complication&nbsp;of&nbsp;eliminating&nbsp;some&nbsp;of<br>
the&nbsp;Vtable&nbsp;entries.<br>
Thus,&nbsp;the&nbsp;Vtable&nbsp;will&nbsp;have&nbsp;one&nbsp;entry&nbsp;for&nbsp;each&nbsp;accessible&nbsp;return&nbsp;type&nbsp;of<br>
a&nbsp;covariant&nbsp;virtual&nbsp;function.<br>
These&nbsp;may&nbsp;be&nbsp;implemented&nbsp;in&nbsp;a&nbsp;variety&nbsp;of&nbsp;ways,<br>
e.g.&nbsp;duplicated&nbsp;functions,&nbsp;separate&nbsp;entrypoints,&nbsp;or&nbsp;stubs,<br>
and&nbsp;the&nbsp;ABI&nbsp;need&nbsp;not&nbsp;specify&nbsp;the&nbsp;choice.<br>
The&nbsp;location&nbsp;of&nbsp;the&nbsp;Vtable&nbsp;entries&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;separate&nbsp;Vtable<br>
layout&nbsp;issue&nbsp;B-6.<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;C.&nbsp;&nbsp;Object&nbsp;Construction/Destruction&nbsp;Issues&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
&lt;table&nbsp;border=on&nbsp;cellpadding=3&gt;<br>
<br>
&lt;tr&gt;<br>
&lt;th&gt;&nbsp;#&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Issue&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Class&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Status&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Source&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Opened&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Closed&nbsp;&lt;/th&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;C-8&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Returning&nbsp;classes&nbsp;with&nbsp;non-trival&nbsp;copy&nbsp;constructors&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;call&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;closed&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;All&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990625&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990722&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Summary&lt;/b&gt;:<br>
How&nbsp;do&nbsp;we&nbsp;return&nbsp;classes&nbsp;with&nbsp;non-trivial&nbsp;copy&nbsp;constructors?<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Resolution&lt;/b&gt;:<br>
The&nbsp;caller&nbsp;allocates&nbsp;space,<br>
and&nbsp;passes&nbsp;a&nbsp;pointer&nbsp;as&nbsp;an&nbsp;implicit&nbsp;first&nbsp;parameter<br>
(prior&nbsp;to&nbsp;the&nbsp;implicit&nbsp;&lt;i&gt;this&lt;/i&gt;&nbsp;parameter).<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;D.&nbsp;&nbsp;Exception&nbsp;Handling&nbsp;Issues&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;E.&nbsp;&nbsp;Template&nbsp;Instantiation&nbsp;Model&nbsp;Issues&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;F.&nbsp;&nbsp;Name&nbsp;Mangling&nbsp;Issues&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;G.&nbsp;&nbsp;Miscellaneous&nbsp;Issues&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;H.&nbsp;&nbsp;Library&nbsp;Interface&nbsp;Issues&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
&lt;hr&gt;<br>
<br>
&lt;p&gt;<br>
Please&nbsp;send&nbsp;corrections&nbsp;to&nbsp;&lt;a&nbsp;href=mailto:dehnert@sgi.com&gt;Jim&nbsp;Dehnert&lt;/a&gt;.<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>

</tt>

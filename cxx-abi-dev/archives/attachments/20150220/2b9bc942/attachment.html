<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;20&nbsp;February&nbsp;2015&nbsp;at&nbsp;15:51,&nbsp;John&nbsp;McCall&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:rjmccall@apple.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rjmccall@apple.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&gt;&nbsp;On&nbsp;Feb&nbsp;19,&nbsp;2015,&nbsp;at&nbsp;11:44&nbsp;PM,&nbsp;Dennis&nbsp;Handly&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:dhandly@cup.hp.com&quot;&gt;dhandly@cup.hp.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
&gt;&gt;&nbsp;From:&nbsp;David&nbsp;Majnemer&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:david.majnemer@gmail.com&quot;&gt;david.majnemer@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;It&nbsp;seems&nbsp;that&nbsp;the&nbsp;ABI&nbsp;has&nbsp;no&nbsp;means&nbsp;to&nbsp;mangle&nbsp;the&nbsp;contents&nbsp;of&nbsp;string&nbsp;constants.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Why&nbsp;is&nbsp;that&nbsp;needed?&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;current&nbsp;scheme&nbsp;is&nbsp;to&nbsp;just&nbsp;number&nbsp;the&nbsp;constants&nbsp;in&nbsp;order.&lt;br&gt;<br>
&gt;&nbsp;And&nbsp;that&nbsp;handles&nbsp;both&nbsp;strings&nbsp;and&nbsp;wide&nbsp;strings.&lt;br&gt;<br>
&gt;&nbsp;And&nbsp;by&nbsp;the&nbsp;ODR&nbsp;rule&nbsp;the&nbsp;inlines&nbsp;must&nbsp;be&nbsp;the&nbsp;same.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;I&nbsp;think&nbsp;this&nbsp;is&nbsp;what&nbsp;David&nbsp;means&nbsp;by&nbsp;numbering&nbsp;like&nbsp;a&nbsp;reference&nbsp;temporary.&lt;br&gt;<br>
&lt;br&gt;<br>
To&nbsp;the&nbsp;extent&nbsp;that&nbsp;this&nbsp;is&nbsp;needed,&nbsp;I&nbsp;agree&nbsp;with&nbsp;you&nbsp;that&nbsp;that’s&nbsp;the&nbsp;right&nbsp;solution:&nbsp;string&nbsp;literals&nbsp;should&nbsp;be&nbsp;mangled&nbsp;in&nbsp;the&nbsp;same&nbsp;sequence&nbsp;as&nbsp;reference&nbsp;temporaries. &nbsp;(Which&nbsp;already&nbsp;applies&nbsp;to&nbsp;more&nbsp;than&nbsp;just&nbsp;reference&nbsp;temporaries&nbsp;anyway,&nbsp;since&nbsp;the&nbsp;same&nbsp;concept&nbsp;of&nbsp;lifetime&nbsp;extension&nbsp;applies&nbsp;to&nbsp;std::initializer_list&nbsp;temporaries.)&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;have&nbsp;some&nbsp;of&nbsp;the&nbsp;same&nbsp;concerns&nbsp;here&nbsp;as&nbsp;I&nbsp;do&nbsp;with&nbsp;guaranteeing&nbsp;the&nbsp;uniqueness&nbsp;of&nbsp;string&nbsp;literals&nbsp;within&nbsp;inline&nbsp;functions:&nbsp;I&nbsp;want&nbsp;to&nbsp;make&nbsp;sure&nbsp;the&nbsp;language&nbsp;isn’t&nbsp;accidentally&nbsp;promising&nbsp;something&nbsp;that&nbsp;grotesquely&nbsp;affects&nbsp;performance&nbsp;far&nbsp;out&nbsp;of&nbsp;proportion&nbsp;to&nbsp;its&nbsp;utility&nbsp;to&nbsp;the&nbsp;programmer. &nbsp;It&nbsp;would&nbsp;be&nbsp;very&nbsp;unfortunate&nbsp;if&nbsp;we,&nbsp;say,&nbsp;introduced&nbsp;thousands&nbsp;of&nbsp;new&nbsp;global&nbsp;weak&nbsp;symbols&nbsp;just&nbsp;to&nbsp;unique&nbsp;the&nbsp;strings&nbsp;used&nbsp;by&nbsp;assertions. &nbsp;We&nbsp;can&nbsp;take&nbsp;things&nbsp;like&nbsp;this&nbsp;back&nbsp;to&nbsp;the&nbsp;committee&nbsp;if&nbsp;necessary.&lt;br&gt;<br>
&lt;br&gt;<br>
But&nbsp;if&nbsp;we&nbsp;can&nbsp;restrict&nbsp;this&nbsp;guarantee&nbsp;to&nbsp;string&nbsp;literals&nbsp;that&nbsp;appear&nbsp;in&nbsp;reference-temporary-like&nbsp;positions&nbsp;in&nbsp;constexpr&nbsp;initializers,&nbsp;I&nbsp;think&nbsp;it’s&nbsp;reasonable&nbsp;enough.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;We&nbsp;can&#39;t.&nbsp;Consider:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;constexpr&nbsp;const&nbsp;char&nbsp;*f(const&nbsp;char&nbsp;*p)&nbsp;{&nbsp;return&nbsp;p;&nbsp;}&lt;/div&gt;&lt;div&gt;constexpr&nbsp;const&nbsp;char&nbsp;*g()&nbsp;{&nbsp;return&nbsp;&quot;foo&quot;;&nbsp;}&lt;br&gt;&lt;/div&gt;&lt;div&gt;struct&nbsp;X&nbsp;{&lt;/div&gt;&lt;div&gt; &nbsp;constexpr&nbsp;static&nbsp;const&nbsp;char&nbsp;*p&nbsp;=&nbsp;&quot;foo&quot;,&nbsp;//&nbsp;ok&lt;/div&gt;&lt;div&gt; &nbsp;*q&nbsp;=&nbsp;f(&quot;foo&quot;),&nbsp;//&nbsp;not&nbsp;in&nbsp;a&nbsp;&quot;reference-temporary-like&quot;&nbsp;position&lt;/div&gt;&lt;div&gt; &nbsp;*r&nbsp;=&nbsp;g();&nbsp;//&nbsp;string&nbsp;literal&nbsp;is&nbsp;not&nbsp;even&nbsp;lexically&nbsp;within&nbsp;the&nbsp;initializer&lt;/div&gt;&lt;div&gt;};&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>

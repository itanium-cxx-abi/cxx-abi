<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=windows-1252&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&gt;On&nbsp;May&nbsp;7,&nbsp;2014,&nbsp;at&nbsp;12:11&nbsp;AM,&nbsp;Richard&nbsp;Smith&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:richardsmith@google.com&quot;&gt;richardsmith@google.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;6&nbsp;May&nbsp;2014&nbsp;19:57,&nbsp;Jason&nbsp;Merrill&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:jason@redhat.com&quot;&nbsp;target=&quot;_blank&quot;&gt;jason@redhat.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;05/06/2014&nbsp;09:31&nbsp;PM,&nbsp;Richard&nbsp;Smith&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
The&nbsp;core&nbsp;language&nbsp;part&nbsp;of&nbsp;this&nbsp;(core&nbsp;issue&nbsp;1590)&nbsp;is&nbsp;now&nbsp;in&nbsp;'ready'&lt;br&gt;<br>
status.&nbsp;Time&nbsp;to&nbsp;go&nbsp;ahead&nbsp;with&nbsp;the&nbsp;corresponding&nbsp;ABI&nbsp;change?&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
On&nbsp;11/26/2012&nbsp;04:09&nbsp;PM,&nbsp;Richard&nbsp;Smith&nbsp;wrote:&gt;&nbsp;Suggestion&nbsp;for&nbsp;Itanium&nbsp;&gt;&nbsp;Suggestion&nbsp;for&nbsp;Itanium&nbsp;ABI:&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&lt;br&gt;<br>
[parameters&nbsp;and&nbsp;return&nbsp;values&nbsp;are&nbsp;passed&nbsp;by&nbsp;address&nbsp;if]&nbsp;the&nbsp;type&nbsp;has&nbsp;a&nbsp;non-trivial&nbsp;copy&nbsp;constructor,&nbsp;move&nbsp;constructor&nbsp;or&nbsp;destructor,&nbsp;or&nbsp;if&nbsp;neither&nbsp;the&nbsp;copy&nbsp;constructor&nbsp;nor&nbsp;the&nbsp;move&nbsp;constructor&nbsp;is&nbsp;public&nbsp;and&nbsp;non-deleted.&lt;br&gt;<br>
<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
I&nbsp;disagree&nbsp;with&nbsp;the&nbsp;latter&nbsp;part&nbsp;of&nbsp;this;&nbsp;passing&nbsp;by&nbsp;invisible&nbsp;reference&nbsp;should&nbsp;based&nbsp;on&nbsp;triviality,&nbsp;not&nbsp;on&nbsp;callability.&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;think&nbsp;it&nbsp;would&nbsp;be&nbsp;*extremely*&nbsp;surprising&nbsp;if&nbsp;we&nbsp;implicitly&nbsp;added&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;function&nbsp;that&nbsp;is&nbsp;deleted&nbsp;or&nbsp;inaccessible,&nbsp;that&nbsp;the&nbsp;original&nbsp;code&nbsp;didn't&nbsp;call.&nbsp;What&nbsp;alternative&nbsp;do&nbsp;you&nbsp;suggest?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Backstory:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;struct&nbsp;A&nbsp;{&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;A(void*);&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;A(const&nbsp;A&amp;)&nbsp;=&nbsp;delete;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;A(A&amp;&amp;)&nbsp;=&nbsp;default;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;void&nbsp;*p;&lt;/div&gt;&lt;div&gt;};&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;<br>
Here,&nbsp;A&nbsp;should&nbsp;&quot;obviously&quot;&nbsp;be&nbsp;passed&nbsp;by&nbsp;value,&nbsp;not&nbsp;by&nbsp;pointer&nbsp;(you&nbsp;don't&nbsp;want&nbsp;to&nbsp;pass&nbsp;unique_ptr&nbsp;indirectly).&nbsp;And&nbsp;here&nbsp;we&nbsp;have&nbsp;a&nbsp;trivial&nbsp;copy&nbsp;ctor,&nbsp;a&nbsp;trivial&nbsp;deleted&nbsp;move&nbsp;ctor,&nbsp;and&nbsp;a&nbsp;trivial&nbsp;dtor.&nbsp;But&nbsp;if&nbsp;the&nbsp;copy&nbsp;ctor&nbsp;is&nbsp;*also*&nbsp;deleted:&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;struct&nbsp;B&nbsp;{&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;B(void*);&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;B(const&nbsp;B&amp;)&nbsp;=&nbsp;delete;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;B(B&amp;&amp;)&nbsp;=&nbsp;delete;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;void&nbsp;*p;&lt;/div&gt;&lt;div&gt;};&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;...&nbsp;then&nbsp;I&nbsp;think&nbsp;it's&nbsp;equally&nbsp;obvious&nbsp;that&nbsp;this&nbsp;should&nbsp;*not*&nbsp;be&nbsp;passed&nbsp;by&nbsp;value,&nbsp;and&nbsp;must&nbsp;be&nbsp;passed&nbsp;by&nbsp;&quot;invisible&nbsp;reference&quot;.&nbsp;Eg:&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;B::B(void*)&nbsp;:&nbsp;p(this)&nbsp;{}&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;void&nbsp;f(B&nbsp;b)&nbsp;{&nbsp;assert(b.p&nbsp;==&nbsp;&amp;b);&nbsp;}&nbsp;//&nbsp;this&nbsp;assert&nbsp;should&nbsp;hold!&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;int&nbsp;main()&nbsp;{&nbsp;f({0});&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;only&nbsp;difference&nbsp;between&nbsp;these&nbsp;two&nbsp;is&nbsp;whether&nbsp;the&nbsp;copy&nbsp;ctor&nbsp;is&nbsp;deleted&nbsp;(it's&nbsp;trivial&nbsp;either&nbsp;way).&nbsp;So&nbsp;it&nbsp;seems&nbsp;to&nbsp;me&nbsp;that&nbsp;we&nbsp;/must/&nbsp;consider&nbsp;that.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Access&nbsp;checking&nbsp;probably&nbsp;doesn't&nbsp;have&nbsp;as&nbsp;compelling&nbsp;a&nbsp;story,&nbsp;but&nbsp;as&nbsp;with&nbsp;deletedness&nbsp;checking,&nbsp;the&nbsp;fundamental&nbsp;point&nbsp;seems&nbsp;to&nbsp;be&nbsp;that&nbsp;we&nbsp;should&nbsp;not&nbsp;implicitly&nbsp;*add*&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;function&nbsp;that&nbsp;the&nbsp;code&nbsp;in&nbsp;question&nbsp;couldn't&nbsp;originally&nbsp;call.&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;I&nbsp;continue&nbsp;to&nbsp;think&nbsp;that&nbsp;making&nbsp;the&nbsp;ABI&nbsp;dependent&nbsp;on&nbsp;access&nbsp;control&nbsp;is&nbsp;not&nbsp;a&nbsp;good&nbsp;idea.&nbsp;&nbsp;I&nbsp;agree&nbsp;that&nbsp;it’s&nbsp;problematic&nbsp;that&nbsp;this&nbsp;means&nbsp;we&nbsp;might&nbsp;use&nbsp;a&nbsp;private&nbsp;copy&nbsp;constructor,&nbsp;but&nbsp;frankly,&nbsp;I’m&nbsp;a&nbsp;lot&nbsp;less&nbsp;worried&nbsp;about&nbsp;violating&nbsp;the&nbsp;standard&nbsp;in&nbsp;this&nbsp;corner&nbsp;case&nbsp;than&nbsp;I&nbsp;am&nbsp;about&nbsp;making&nbsp;the&nbsp;ABI&nbsp;dependent&nbsp;on&nbsp;access&nbsp;control.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I’d&nbsp;be&nbsp;okay&nbsp;with&nbsp;the&nbsp;rule&nbsp;“if&nbsp;the&nbsp;type&nbsp;has&nbsp;a&nbsp;non-trivial&nbsp;copy&nbsp;constructor,&nbsp;move&nbsp;constructor,&nbsp;or&nbsp;destructor,&nbsp;or&nbsp;if&nbsp;all&nbsp;its&nbsp;copy&nbsp;and&nbsp;move&nbsp;constructors&nbsp;are&nbsp;declared&nbsp;as&nbsp;deleted”.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;John.&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>

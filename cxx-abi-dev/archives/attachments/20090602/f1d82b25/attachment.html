<tt>
&lt;html&gt;&lt;body&gt;<br>
&lt;p&gt;Hey,&nbsp;that&nbsp;sounds&nbsp;exactly&nbsp;like&nbsp;the&nbsp;issue&nbsp;we&nbsp;are&nbsp;having&nbsp;with&nbsp;the&nbsp;boost/python.&nbsp;&nbsp;I&nbsp;hadn't&nbsp;reached&nbsp;the&nbsp;point&nbsp;of&nbsp;isolating&nbsp;the&nbsp;problem&nbsp;to&nbsp;RTLD_LOCAL&nbsp;yet.&nbsp;&nbsp;If&nbsp;you&nbsp;build&nbsp;two&nbsp;libraries&nbsp;with&nbsp;boost/python&nbsp;and&nbsp;load&nbsp;them&nbsp;in&nbsp;a&nbsp;python&nbsp;script&nbsp;and&nbsp;try&nbsp;to&nbsp;throw&nbsp;a&nbsp;predefined&nbsp;exception&nbsp;from&nbsp;one&nbsp;of&nbsp;the&nbsp;two&nbsp;(I&nbsp;forget&nbsp;if&nbsp;it&nbsp;is&nbsp;the&nbsp;first&nbsp;or&nbsp;second),&nbsp;the&nbsp;exception&nbsp;is&nbsp;not&nbsp;caught.&lt;br&gt;<br>
&lt;br&gt;<br>
--&lt;br&gt;<br>
Sean&nbsp;Perry&lt;br&gt;<br>
Compiler&nbsp;Development&lt;br&gt;<br>
IBM&nbsp;Canada&nbsp;Lab&lt;br&gt;<br>
(905)-413-6031&nbsp;(tie&nbsp;313-6031),&nbsp;fax&nbsp;(905)-413-4839&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;img&nbsp;width=&quot;16&quot;&nbsp;height=&quot;16&quot;&nbsp;src=&quot;cid:1__=0ABBFF5ADFE2673D8f9e8a93df938@ca.ibm.com&quot;&nbsp;border=&quot;0&quot;&nbsp;alt=&quot;Inactive&nbsp;hide&nbsp;details&nbsp;for&nbsp;Jason&nbsp;Merrill&nbsp;&lt;jason@redhat.com&gt;&quot;&gt;Jason&nbsp;Merrill&nbsp;&lt;jason@redhat.com&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
<br>
&lt;table&nbsp;width=&quot;100%&quot;&nbsp;border=&quot;0&quot;&nbsp;cellspacing=&quot;0&quot;&nbsp;cellpadding=&quot;0&quot;&gt;<br>
&lt;tr&nbsp;valign=&quot;top&quot;&gt;&lt;td&nbsp;style=&quot;background-image:url(cid:2__=0ABBFF5ADFE2673D8f9e8a93df938@ca.ibm.com);&nbsp;background-repeat:&nbsp;no-repeat;&nbsp;&quot;&nbsp;width=&quot;40%&quot;&gt;<br>
&lt;ul&gt;<br>
&lt;ul&gt;<br>
&lt;ul&gt;<br>
&lt;ul&gt;&lt;b&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;Jason&nbsp;Merrill&nbsp;&lt;jason@redhat.com&gt;&lt;/font&gt;&lt;/b&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;&nbsp;&lt;/font&gt;<br>
&lt;p&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;06/02/2009&nbsp;03:45&nbsp;PM&lt;/font&gt;&lt;/ul&gt;<br>
&lt;/ul&gt;<br>
&lt;/ul&gt;<br>
&lt;/ul&gt;<br>
&lt;/td&gt;&lt;td&nbsp;width=&quot;60%&quot;&gt;<br>
&lt;table&nbsp;width=&quot;100%&quot;&nbsp;border=&quot;0&quot;&nbsp;cellspacing=&quot;0&quot;&nbsp;cellpadding=&quot;0&quot;&gt;<br>
&lt;tr&nbsp;valign=&quot;top&quot;&gt;&lt;td&nbsp;width=&quot;1%&quot;&gt;&lt;img&nbsp;width=&quot;58&quot;&nbsp;height=&quot;1&quot;&nbsp;src=&quot;cid:3__=0ABBFF5ADFE2673D8f9e8a93df938@ca.ibm.com&quot;&nbsp;border=&quot;0&quot;&nbsp;alt=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;div&nbsp;align=&quot;right&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;To&lt;/font&gt;&lt;/div&gt;&lt;/td&gt;&lt;td&nbsp;width=&quot;100%&quot;&gt;&lt;img&nbsp;width=&quot;1&quot;&nbsp;height=&quot;1&quot;&nbsp;src=&quot;cid:3__=0ABBFF5ADFE2673D8f9e8a93df938@ca.ibm.com&quot;&nbsp;border=&quot;0&quot;&nbsp;alt=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;2&quot;&gt;Dennis&nbsp;Handly&nbsp;&lt;dhandly@cup.hp.com&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;<br>
<br>
&lt;tr&nbsp;valign=&quot;top&quot;&gt;&lt;td&nbsp;width=&quot;1%&quot;&gt;&lt;img&nbsp;width=&quot;58&quot;&nbsp;height=&quot;1&quot;&nbsp;src=&quot;cid:3__=0ABBFF5ADFE2673D8f9e8a93df938@ca.ibm.com&quot;&nbsp;border=&quot;0&quot;&nbsp;alt=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;div&nbsp;align=&quot;right&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;cc&lt;/font&gt;&lt;/div&gt;&lt;/td&gt;&lt;td&nbsp;width=&quot;100%&quot;&gt;&lt;img&nbsp;width=&quot;1&quot;&nbsp;height=&quot;1&quot;&nbsp;src=&quot;cid:3__=0ABBFF5ADFE2673D8f9e8a93df938@ca.ibm.com&quot;&nbsp;border=&quot;0&quot;&nbsp;alt=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;2&quot;&gt;mark@codesourcery.com,&nbsp;Sean&nbsp;Perry/Toronto/IBM@IBMCA,&nbsp;cxx-abi-dev@codesourcery.com&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;<br>
<br>
&lt;tr&nbsp;valign=&quot;top&quot;&gt;&lt;td&nbsp;width=&quot;1%&quot;&gt;&lt;img&nbsp;width=&quot;58&quot;&nbsp;height=&quot;1&quot;&nbsp;src=&quot;cid:3__=0ABBFF5ADFE2673D8f9e8a93df938@ca.ibm.com&quot;&nbsp;border=&quot;0&quot;&nbsp;alt=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;div&nbsp;align=&quot;right&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;Subject&lt;/font&gt;&lt;/div&gt;&lt;/td&gt;&lt;td&nbsp;width=&quot;100%&quot;&gt;&lt;img&nbsp;width=&quot;1&quot;&nbsp;height=&quot;1&quot;&nbsp;src=&quot;cid:3__=0ABBFF5ADFE2673D8f9e8a93df938@ca.ibm.com&quot;&nbsp;border=&quot;0&quot;&nbsp;alt=&quot;&quot;&gt;&lt;br&gt;<br>
&lt;font&nbsp;size=&quot;2&quot;&gt;Re:&nbsp;[cxx-abi-dev]&nbsp;Deleted&nbsp;virtual&nbsp;functions&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;<br>
&lt;/table&gt;<br>
<br>
&lt;table&nbsp;border=&quot;0&quot;&nbsp;cellspacing=&quot;0&quot;&nbsp;cellpadding=&quot;0&quot;&gt;<br>
&lt;tr&nbsp;valign=&quot;top&quot;&gt;&lt;td&nbsp;width=&quot;58&quot;&gt;&lt;img&nbsp;width=&quot;1&quot;&nbsp;height=&quot;1&quot;&nbsp;src=&quot;cid:3__=0ABBFF5ADFE2673D8f9e8a93df938@ca.ibm.com&quot;&nbsp;border=&quot;0&quot;&nbsp;alt=&quot;&quot;&gt;&lt;/td&gt;&lt;td&nbsp;width=&quot;336&quot;&gt;&lt;img&nbsp;width=&quot;1&quot;&nbsp;height=&quot;1&quot;&nbsp;src=&quot;cid:3__=0ABBFF5ADFE2673D8f9e8a93df938@ca.ibm.com&quot;&nbsp;border=&quot;0&quot;&nbsp;alt=&quot;&quot;&gt;&lt;/td&gt;&lt;/tr&gt;<br>
&lt;/table&gt;<br>
&lt;/td&gt;&lt;/tr&gt;<br>
&lt;/table&gt;<br>
&lt;br&gt;<br>
&lt;tt&gt;Dennis&nbsp;Handly&nbsp;wrote:&lt;br&gt;<br>
&gt;&gt;&nbsp;From:&nbsp;Mark&nbsp;Mitchell&nbsp;&lt;mark@codesourcery.com&gt;&lt;br&gt;<br>
&gt;&gt;&nbsp;other&nbsp;people&nbsp;don't.&nbsp;&nbsp;For&nbsp;example,&nbsp;when&nbsp;building&nbsp;plugins,&nbsp;you&nbsp;often&nbsp;want&lt;br&gt;<br>
&gt;&gt;&nbsp;each&nbsp;shared&nbsp;library&nbsp;to&nbsp;be&nbsp;completely&nbsp;independent;&nbsp;if&nbsp;my&nbsp;plugin's&nbsp;&quot;class&lt;br&gt;<br>
&gt;&gt;&nbsp;Plugin&quot;&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;your&nbsp;plugin's&nbsp;&quot;class&nbsp;Plugin&quot;,&nbsp;very&nbsp;bad&nbsp;things&nbsp;happen.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;We&nbsp;had&nbsp;to&nbsp;tell&nbsp;another&nbsp;important&nbsp;customer&nbsp;over&nbsp;and&nbsp;over&nbsp;this&nbsp;violated&nbsp;the&lt;br&gt;<br>
&gt;&nbsp;ODR&nbsp;rule.&nbsp;&nbsp;And&nbsp;our&nbsp;above&nbsp;changes&nbsp;making&nbsp;it&nbsp;hard&nbsp;to&nbsp;hide&nbsp;these&nbsp;classes&lt;br&gt;<br>
&gt;&nbsp;caused&nbsp;them&nbsp;issues.&nbsp;&nbsp;They&nbsp;didn't&nbsp;want&nbsp;to&nbsp;use&nbsp;the&nbsp;mangled&nbsp;name&nbsp;for&nbsp;many&lt;br&gt;<br>
&gt;&nbsp;classes.&nbsp;&nbsp;They&nbsp;finally&nbsp;accepted&nbsp;our&nbsp;reasoning,&nbsp;since&nbsp;other&nbsp;vendors&nbsp;had&lt;br&gt;<br>
&gt;&nbsp;to&nbsp;use&nbsp;kludges&nbsp;too.&nbsp;&nbsp;:-)&lt;br&gt;<br>
&lt;br&gt;<br>
Talking&nbsp;about&nbsp;plugins&nbsp;reminds&nbsp;me&nbsp;of&nbsp;a&nbsp;different&nbsp;problem&nbsp;we've&nbsp;run&nbsp;into&nbsp;&lt;br&gt;<br>
on&nbsp;Linux:&nbsp;you&nbsp;have&nbsp;two&nbsp;plugins&nbsp;A&nbsp;and&nbsp;B&nbsp;that&nbsp;both&nbsp;link&nbsp;against&nbsp;the&nbsp;same&nbsp;&lt;br&gt;<br>
shared&nbsp;library&nbsp;C.&nbsp;&nbsp;A&nbsp;and&nbsp;B&nbsp;are&nbsp;loaded&nbsp;with&nbsp;RTLD_LOCAL&nbsp;to&nbsp;avoid&nbsp;symbol&nbsp;&lt;br&gt;<br>
conflicts.&nbsp;&nbsp;If&nbsp;there&nbsp;are&nbsp;symbols&nbsp;defined&nbsp;in&nbsp;all&nbsp;three&nbsp;of&nbsp;A&nbsp;B&nbsp;and&nbsp;C,&nbsp;&lt;br&gt;<br>
references&nbsp;in&nbsp;A&nbsp;and&nbsp;C&nbsp;are&nbsp;bound&nbsp;to&nbsp;the&nbsp;definition&nbsp;in&nbsp;A,&nbsp;while&nbsp;references&nbsp;&lt;br&gt;<br>
in&nbsp;B&nbsp;are&nbsp;bound&nbsp;to&nbsp;the&nbsp;definition&nbsp;in&nbsp;B.&nbsp;&nbsp;If&nbsp;the&nbsp;symbol&nbsp;is&nbsp;a&nbsp;typeid,&nbsp;and&nbsp;B&nbsp;&lt;br&gt;<br>
calls&nbsp;a&nbsp;C&nbsp;function&nbsp;which&nbsp;throws&nbsp;an&nbsp;exception&nbsp;of&nbsp;that&nbsp;type,&nbsp;B&nbsp;can't&nbsp;catch&nbsp;&lt;br&gt;<br>
it&nbsp;because&nbsp;the&nbsp;symbols&nbsp;don't&nbsp;match.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;same&nbsp;issue&nbsp;can&nbsp;come&nbsp;up&nbsp;with&nbsp;static&nbsp;data&nbsp;in&nbsp;inlines&nbsp;or&nbsp;templates,&nbsp;&lt;br&gt;<br>
either&nbsp;data&nbsp;members&nbsp;or&nbsp;function&nbsp;local&nbsp;statics;&nbsp;this&nbsp;case&nbsp;can't&nbsp;be&nbsp;worked&nbsp;&lt;br&gt;<br>
around&nbsp;with&nbsp;string&nbsp;comparison,&nbsp;though&nbsp;it's&nbsp;also&nbsp;less&nbsp;likely&nbsp;to&nbsp;be&nbsp;&lt;br&gt;<br>
encountered.&lt;br&gt;<br>
&lt;br&gt;<br>
I've&nbsp;been&nbsp;talking&nbsp;to&nbsp;Ulrich&nbsp;Drepper&nbsp;about&nbsp;ways&nbsp;to&nbsp;deal&nbsp;with&nbsp;this,&nbsp;and&nbsp;&lt;br&gt;<br>
we've&nbsp;decided&nbsp;to&nbsp;go&nbsp;ahead&nbsp;with&nbsp;a&nbsp;solution&nbsp;that&nbsp;makes&nbsp;affected&nbsp;objects&nbsp;&lt;br&gt;<br>
unique&nbsp;through&nbsp;the&nbsp;whole&nbsp;loaded&nbsp;program&nbsp;regardless&nbsp;of&nbsp;RTLD_LOCAL;&nbsp;we&nbsp;&lt;br&gt;<br>
have&nbsp;namespaces&nbsp;to&nbsp;deal&nbsp;with&nbsp;name&nbsp;collisions.&nbsp;&nbsp;I'm&nbsp;not&nbsp;sure&nbsp;if&nbsp;we&nbsp;&lt;br&gt;<br>
actually&nbsp;want&nbsp;to&nbsp;use&nbsp;this&nbsp;for&nbsp;typeinfos,&nbsp;but&nbsp;I&nbsp;don't&nbsp;see&nbsp;a&nbsp;better&nbsp;&lt;br&gt;<br>
solution&nbsp;for&nbsp;r/w&nbsp;data.&lt;br&gt;<br>
&lt;br&gt;<br>
Sorry&nbsp;I&nbsp;didn't&nbsp;mention&nbsp;this&nbsp;to&nbsp;the&nbsp;list&nbsp;sooner.&lt;br&gt;<br>
&lt;br&gt;<br>
Jason&lt;br&gt;<br>
&lt;/tt&gt;&lt;br&gt;<br>
&lt;/body&gt;&lt;/html&gt;<br>

</tt>

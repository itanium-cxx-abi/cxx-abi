<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;title&gt;Runtime-sized&nbsp;arrays&nbsp;with&nbsp;automatic&nbsp;storage&nbsp;duration&nbsp;(revision&nbsp;4)&lt;/title&gt;<br>
<br>
&lt;style&nbsp;type=&quot;text/css&quot;&gt;<br>
&nbsp;&nbsp;ins&nbsp;{&nbsp;text-decoration:none;&nbsp;font-weight:bold;&nbsp;background-color:#A0FFA0&nbsp;}<br>
&nbsp;&nbsp;del&nbsp;{&nbsp;text-decoration:line-through;&nbsp;background-color:#FFA0A0&nbsp;}<br>
&nbsp;&nbsp;strong&nbsp;{&nbsp;font-weight:&nbsp;inherit;&nbsp;color:&nbsp;#2020ff&nbsp;}<br>
&lt;/style&gt;<br>
<br>
&lt;/head&gt;<br>
<br>
&lt;body&gt;<br>
N3639&lt;br/&gt;<br>
revision&nbsp;of&nbsp;N3467=12-0157&lt;br/&gt;<br>
Jens&nbsp;Maurer&lt;br/&gt;<br>
2013-04-16<br>
<br>
&lt;h1&gt;Runtime-sized&nbsp;arrays&nbsp;with&nbsp;automatic&nbsp;storage&nbsp;duration&nbsp;(revision&nbsp;5)&lt;/h1&gt;<br>
<br>
&lt;h2&gt;Status&lt;/h2&gt;<br>
<br>
The&nbsp;proposal&nbsp;presented&nbsp;in&nbsp;this&nbsp;paper&nbsp;was&nbsp;approved&nbsp;by&nbsp;EWG&nbsp;during&nbsp;the<br>
Portland&nbsp;meeting&nbsp;of&nbsp;WG21&nbsp;and&nbsp;was&nbsp;updated&nbsp;to&nbsp;reflect&nbsp;CWG&nbsp;review.<br>
<br>
&lt;h2&gt;Changes&nbsp;compared&nbsp;to&nbsp;N3366&lt;/h2&gt;<br>
&lt;ul&gt;<br>
&lt;li&gt;discuss&nbsp;array&nbsp;of&nbsp;runtime&nbsp;bound&nbsp;in&nbsp;range-based&nbsp;for&nbsp;statement&lt;/li&gt;<br>
&lt;li&gt;multidimensional&nbsp;arrays&nbsp;with&nbsp;multiple&nbsp;runtime&nbsp;bounds&nbsp;is&nbsp;an&nbsp;open<br>
issue&lt;/li&gt;<br>
&lt;li&gt;adjust&nbsp;grammar&nbsp;in&nbsp;8&nbsp;dcl.decl&lt;/li&gt;<br>
&lt;li&gt;for&nbsp;&quot;bound&nbsp;is&nbsp;0&quot;,&nbsp;range-checking&nbsp;of&nbsp;bound,&nbsp;and&nbsp;&quot;too&nbsp;many<br>
initializers&quot;,&nbsp;behave&nbsp;as-if&nbsp;in&nbsp;array-new&lt;/li&gt;<br>
&lt;/ul&gt;<br>
<br>
&lt;h2&gt;Changes&nbsp;compared&nbsp;to&nbsp;N3412&lt;/h2&gt;<br>
&lt;ul&gt;<br>
&lt;li&gt;removed&nbsp;open&nbsp;issues&nbsp;after&nbsp;EWG&nbsp;discussion:&nbsp;no&nbsp;support&nbsp;for<br>
range-based&nbsp;for,&nbsp;only&nbsp;have&nbsp;the&nbsp;outermost&nbsp;dimension&nbsp;as&nbsp;a<br>
non-constant&lt;/li&gt;<br>
&lt;li&gt;rename&nbsp;exception&nbsp;from&nbsp;std::bad_array_new_length&nbsp;to<br>
std::bad_array_length&lt;/li&gt;<br>
&lt;li&gt;permitted&nbsp;allocation&nbsp;on&nbsp;heap&lt;/li&gt;<br>
&lt;li&gt;change&nbsp;4.2&nbsp;conv.array&nbsp;to&nbsp;accomodate&nbsp;arrays&nbsp;with&nbsp;no&nbsp;elements&lt;/li&gt;<br>
&lt;/ul&gt;<br>
<br>
&lt;h2&gt;Changes&nbsp;compared&nbsp;to&nbsp;N3467&lt;/h2&gt;<br>
&lt;ul&gt;<br>
&lt;li&gt;removed&nbsp;support&nbsp;for&nbsp;zero-sized&nbsp;arrays&nbsp;(CWG&nbsp;consensus&nbsp;to&nbsp;defer&nbsp;that<br>
to&nbsp;a&nbsp;separate&nbsp;proposal&nbsp;that&nbsp;also&nbsp;addresses&nbsp;the&nbsp;questions&nbsp;of&nbsp;zero<br>
object&nbsp;size)&lt;/li&gt;<br>
&lt;li&gt;prohibit&nbsp;taking&nbsp;the&nbsp;address&nbsp;of&nbsp;a&nbsp;runtime-sized&nbsp;array&lt;/li&gt;<br>
&lt;/ul&gt;<br>
<br>
&lt;h2&gt;Changes&nbsp;compared&nbsp;to&nbsp;N3497&lt;/h2&gt;<br>
&lt;ul&gt;<br>
&lt;li&gt;cv-qualification&nbsp;adjustment&nbsp;is&nbsp;also&nbsp;applied&nbsp;for&nbsp;runtime-sized&nbsp;arrays&lt;/li&gt;<br>
&lt;li&gt;range-based&nbsp;&quot;for&quot;&nbsp;loops&nbsp;are&nbsp;supported,&nbsp;also&nbsp;inside&nbsp;lambdas&lt;/li&gt;<br>
&lt;/ul&gt;<br>
<br>
<br>
&lt;h2&gt;Motivation&lt;/h2&gt;<br>
<br>
&lt;p&gt;<br>
Sometimes,&nbsp;a&nbsp;user&nbsp;wishes&nbsp;to&nbsp;allocate&nbsp;a&nbsp;local&nbsp;array&nbsp;whose&nbsp;size&nbsp;is&nbsp;not<br>
known&nbsp;at&nbsp;compile-time,&nbsp;but&nbsp;at&nbsp;runtime&nbsp;only.&nbsp;&nbsp;Nonetheless,&nbsp;the&nbsp;array's<br>
size&nbsp;will&nbsp;remain&nbsp;unchanged&nbsp;during&nbsp;the&nbsp;lifetime&nbsp;of&nbsp;the&nbsp;array.<br>
&lt;/p&gt;<br>
<br>
<br>
&lt;p&gt;<br>
Examples&nbsp;are<br>
&lt;ul&gt;<br>
&lt;li&gt;interfacing&nbsp;with&nbsp;the&nbsp;readv/writev&nbsp;POSIX&nbsp;system&nbsp;calls&lt;/li&gt;<br>
&lt;li&gt;small&nbsp;runtime-sized&nbsp;data&nbsp;structure&nbsp;to&nbsp;apply&nbsp;STL&nbsp;algorithms<br>
calls&lt;/li&gt;<br>
&lt;li&gt;...&lt;/li&gt;<br>
&lt;/ul&gt;<br>
&lt;/p&gt;<br>
<br>
&lt;p&gt;<br>
This&nbsp;paper&nbsp;proposes&nbsp;to&nbsp;add&nbsp;local&nbsp;runtime-sized&nbsp;arrays&nbsp;with&nbsp;automatic<br>
storage&nbsp;duration&nbsp;to&nbsp;C++,&nbsp;for&nbsp;example:&lt;/p&gt;<br>
<br>
&lt;pre&gt;<br>
void&nbsp;f(std::size_t&nbsp;n)<br>
{<br>
&nbsp;&nbsp;&nbsp;int&nbsp;a[n];<br>
&nbsp;&nbsp;&nbsp;for&nbsp;(std::size_t&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;n;&nbsp;++i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a[i]&nbsp;=&nbsp;2*i;<br>
&nbsp;&nbsp;&nbsp;std::sort(a,&nbsp;a+n);<br>
}<br>
&lt;/pre&gt;<br>
&lt;p&gt;<br>
Traditionally,&nbsp;the&nbsp;array&nbsp;bound&nbsp;&quot;n&quot;&nbsp;had&nbsp;to&nbsp;be&nbsp;a&nbsp;constant&nbsp;expression<br>
(see&nbsp;8.3.4&nbsp;dcl.array).&nbsp;&nbsp;For&nbsp;local&nbsp;arrays&nbsp;with&nbsp;automatic&nbsp;storage<br>
duration,&nbsp;this&nbsp;paper&nbsp;proposes&nbsp;to&nbsp;lift&nbsp;that&nbsp;restriction.&nbsp;&nbsp;The&nbsp;syntax&nbsp;is<br>
intended&nbsp;to&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;that&nbsp;used&nbsp;for&nbsp;C99&nbsp;variable&nbsp;length&nbsp;arrays<br>
(VLAs),&nbsp;except&nbsp;that&nbsp;implementation&nbsp;support&nbsp;for&nbsp;VLAs&nbsp;is<br>
optional&nbsp;in&nbsp;C11&nbsp;and&nbsp;aggregate&nbsp;initialization&nbsp;is&nbsp;not&nbsp;supported&nbsp;in<br>
C.<br>
&lt;/p&gt;<br>
<br>
&lt;p&gt;<br>
As&nbsp;a&nbsp;design&nbsp;guideline,&nbsp;the&nbsp;same&nbsp;rules&nbsp;should&nbsp;apply&nbsp;to&nbsp;&quot;&lt;code&gt;new<br>
T[n]&lt;/code&gt;&quot;&nbsp;and&nbsp;a&nbsp;local&nbsp;array&nbsp;&quot;&lt;code&gt;T&nbsp;a[n]&lt;/code&gt;&quot;,&nbsp;except<br>
that&nbsp;arrays&nbsp;of&nbsp;zero&nbsp;size&nbsp;are&nbsp;only&nbsp;supported&nbsp;for&nbsp;&lt;code&gt;new&lt;/code&gt;.<br>
&lt;/p&gt;<br>
<br>
&lt;p&gt;<br>
There&nbsp;is&nbsp;well-established&nbsp;existing&nbsp;practice&nbsp;with&nbsp;gcc,&nbsp;Clang,&nbsp;and&nbsp;Intel<br>
C++&nbsp;all&nbsp;implementing&nbsp;a&nbsp;similar,&nbsp;if&nbsp;not&nbsp;identical&nbsp;feature.&nbsp;&nbsp;In&nbsp;fact,<br>
Douglas&nbsp;Gregor&nbsp;reported&nbsp;in&nbsp;c++std-ext-12553&nbsp;on&nbsp;2012-01-30:<br>
&lt;/p&gt;<br>
&lt;blockquote&gt;<br>
Users&nbsp;really&nbsp;seem&nbsp;to&nbsp;want&nbsp;this&nbsp;feature.&nbsp;It's&nbsp;a&nbsp;fairly&nbsp;common<br>
extension,&nbsp;and&nbsp;when&nbsp;we&nbsp;tried&nbsp;to&nbsp;ban&nbsp;it&nbsp;out&nbsp;of&nbsp;principle&nbsp;(in&nbsp;Clang),<br>
our&nbsp;users&nbsp;reacted&nbsp;*very*&nbsp;strongly.<br>
&lt;/blockquote&gt;<br>
<br>
<br>
&lt;h2&gt;Scope&lt;/h2&gt;<br>
<br>
This&nbsp;paper&nbsp;does&nbsp;not&nbsp;propose&nbsp;to&nbsp;add&nbsp;all&nbsp;features&nbsp;of&nbsp;C99&nbsp;variable<br>
length&nbsp;arrays&nbsp;to&nbsp;C++.&nbsp;&nbsp;In&nbsp;particular,&nbsp;the&nbsp;following&nbsp;features&nbsp;are<br>
explicitly&nbsp;&lt;em&gt;excluded&lt;/em&gt;:<br>
<br>
&lt;ul&gt;<br>
&lt;li&gt;multidimensional&nbsp;arrays,&nbsp;where&nbsp;other&nbsp;than&nbsp;the&nbsp;top&nbsp;level&nbsp;has&nbsp;a&nbsp;runtime&nbsp;bound&nbsp;(in&nbsp;analogy,&nbsp;array-new&nbsp;doesn't&nbsp;support&nbsp;that&nbsp;either)&lt;/li&gt;<br>
&lt;li&gt;modifications&nbsp;to&nbsp;the&nbsp;function&nbsp;declarator&nbsp;syntax&lt;/li&gt;<br>
&lt;li&gt;sizeof(a)&nbsp;being&nbsp;a&nbsp;runtime-evaluated&nbsp;expression&nbsp;returning&nbsp;the&nbsp;size<br>
of&nbsp;a&lt;/li&gt;<br>
&lt;li&gt;&quot;typedef&nbsp;int&nbsp;a[n];&quot;&nbsp;evaluating&nbsp;&quot;n&quot;&nbsp;and&nbsp;passing&nbsp;that&nbsp;through&nbsp;the<br>
typedef&lt;/li&gt;<br>
&lt;/ul&gt;<br>
<br>
Examples:<br>
<br>
&lt;pre&gt;<br>
void&nbsp;f(std::size_t&nbsp;n)<br>
{<br>
&nbsp;&nbsp;int&nbsp;a[n];<br>
&nbsp;&nbsp;unsigned&nbsp;int&nbsp;x&nbsp;=&nbsp;sizeof(a);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ill-formed<br>
&nbsp;&nbsp;const&nbsp;std::type_info&amp;&nbsp;ti&nbsp;=&nbsp;typeid(a);&nbsp;&nbsp;//&nbsp;ill-formed<br>
&nbsp;&nbsp;typedef&nbsp;int&nbsp;t[n];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ill-formed<br>
}<br>
&lt;/pre&gt;<br>
<br>
<br>
&lt;h2&gt;Discussion&lt;/h2&gt;<br>
<br>
&lt;p&gt;<br>
Data&nbsp;structures&nbsp;that&nbsp;allocate&nbsp;from&nbsp;the&nbsp;heap&nbsp;access,&nbsp;by&nbsp;design,&nbsp;a<br>
global&nbsp;resource&nbsp;that&nbsp;is&nbsp;often&nbsp;highly&nbsp;contended&nbsp;in&nbsp;a&nbsp;multi-threaded<br>
program.&nbsp;&nbsp;Therefore,&nbsp;avoiding&nbsp;heap&nbsp;allocations&nbsp;is&nbsp;usually&nbsp;advantageous<br>
for&nbsp;performance.&nbsp;Allocating&nbsp;such&nbsp;data&nbsp;from&nbsp;the&nbsp;stack&nbsp;is&nbsp;much&nbsp;more<br>
efficient,&nbsp;because&nbsp;the&nbsp;stack&nbsp;is&nbsp;local&nbsp;to&nbsp;each&nbsp;thread&nbsp;and&nbsp;bytes&nbsp;on&nbsp;the<br>
stack&nbsp;are&nbsp;often&nbsp;cached&nbsp;locally.&nbsp;&nbsp;(Since&nbsp;each&nbsp;thread&nbsp;has&nbsp;a&nbsp;separate<br>
stack,&nbsp;it&nbsp;is&nbsp;unlikely&nbsp;that&nbsp;another&nbsp;thread&nbsp;on&nbsp;another&nbsp;CPU&nbsp;accesses&nbsp;the<br>
same&nbsp;data,&nbsp;thereby&nbsp;causing&nbsp;more&nbsp;expensive&nbsp;cache&nbsp;invalidations.)<br>
&lt;/p&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;syntax&nbsp;does&nbsp;not&nbsp;require&nbsp;additional&nbsp;keywords.&nbsp;&nbsp;Instead,&nbsp;a<br>
restriction&nbsp;on&nbsp;the&nbsp;existing&nbsp;array&nbsp;declaration&nbsp;syntax&nbsp;is&nbsp;lifted&nbsp;in<br>
certain&nbsp;circumstances.<br>
&lt;/p&gt;<br>
<br>
&lt;p&gt;<br>
There&nbsp;is&nbsp;no&nbsp;reason&nbsp;to&nbsp;limit&nbsp;the&nbsp;feature&nbsp;to&nbsp;PODs&nbsp;as&nbsp;array&nbsp;element<br>
types,&nbsp;thus&nbsp;such&nbsp;a&nbsp;limitation&nbsp;is&nbsp;not&nbsp;proposed.<br>
&lt;/p&gt;<br>
<br>
&lt;p&gt;<br>
Stack&nbsp;overflow&nbsp;becomes&nbsp;more&nbsp;likely,&nbsp;in&nbsp;particular&nbsp;if&nbsp;the&nbsp;size&nbsp;depends&nbsp;on<br>
external&nbsp;input&nbsp;and&nbsp;is&nbsp;not&nbsp;properly&nbsp;checked.&nbsp;&nbsp;Some&nbsp;environments&nbsp;might<br>
therefore&nbsp;prohibit&nbsp;the&nbsp;use&nbsp;of&nbsp;the&nbsp;feature.&nbsp;&nbsp;Such&nbsp;a&nbsp;prohibition&nbsp;can&nbsp;be<br>
easily&nbsp;enforced&nbsp;with&nbsp;a&nbsp;static&nbsp;analysis&nbsp;tool.<br>
&lt;/p&gt;<br>
<br>
&lt;p&gt;<br>
There&nbsp;is&nbsp;no&nbsp;longer&nbsp;an&nbsp;upper&nbsp;bound&nbsp;on&nbsp;the&nbsp;size&nbsp;of&nbsp;a&nbsp;function's&nbsp;stack<br>
frame.&nbsp;&nbsp;This&nbsp;makes&nbsp;static&nbsp;analysis&nbsp;of&nbsp;stack&nbsp;usage&nbsp;harder.<br>
&lt;/p&gt;<br>
<br>
<br>
&lt;h2&gt;Alternatives&lt;/h2&gt;<br>
<br>
The&nbsp;following&nbsp;alternatives&nbsp;were&nbsp;considered:<br>
<br>
&lt;ul&gt;<br>
&lt;li&gt;std::dynarray&lt;T&gt;&nbsp;as&nbsp;presented&nbsp;in&nbsp;N2648&nbsp;&quot;C++&nbsp;Dynamic&nbsp;Arrays&quot;&nbsp;by<br>
Lawrence&nbsp;Crowl&nbsp;and&nbsp;Matt&nbsp;Austern:&nbsp;stack&nbsp;allocation&nbsp;is&nbsp;left&nbsp;as&nbsp;QoI,<br>
requiring&nbsp;&quot;compiler&nbsp;detection&quot;&nbsp;when&nbsp;using&nbsp;dynarray&lt;T&gt;&nbsp;locally;&nbsp;also<br>
usable&nbsp;with&nbsp;static&nbsp;storage&nbsp;duration&lt;/li&gt;<br>
&lt;li&gt;alloca():&nbsp;not&nbsp;type-safe,&nbsp;no&nbsp;support&nbsp;for&nbsp;C++&nbsp;constructors/destructors&lt;/li&gt;<br>
&lt;li&gt;std::vector:&nbsp;allocates&nbsp;from&nbsp;heap,&nbsp;allows&nbsp;space&nbsp;&quot;reservation&quot;,&nbsp;thus<br>
requiring&nbsp;more&nbsp;management&nbsp;data&lt;/li&gt;<br>
&lt;li&gt;std::valarray:&nbsp;allocates&nbsp;from&nbsp;heap;&nbsp;additional&nbsp;unrelated<br>
requirements&nbsp;on&nbsp;contained&nbsp;type&nbsp;(see&nbsp;26.2&nbsp;numeric.requirements)&lt;/li&gt;<br>
&lt;li&gt;&quot;auto_buffer&quot;&nbsp;(fixed-size&nbsp;local&nbsp;buffer&nbsp;plus&nbsp;overflow&nbsp;to&nbsp;the&nbsp;heap):<br>
may&nbsp;waste&nbsp;memory&nbsp;for&nbsp;fixed-size&nbsp;buffer;&nbsp;introduces&nbsp;additional&nbsp;layer&nbsp;of<br>
pointer&nbsp;indirection&lt;/li&gt;<br>
&lt;/ul&gt;<br>
<br>
<br>
&lt;h2&gt;Changes&nbsp;to&nbsp;the&nbsp;Working&nbsp;Draft&lt;/h2&gt;<br>
<br>
Change&nbsp;in&nbsp;3.9&nbsp;basic.types&nbsp;paragraph&nbsp;10:<br>
&lt;blockquote&gt;<br>
A&nbsp;type&nbsp;is&nbsp;a&nbsp;&lt;em&gt;literal&nbsp;type&lt;/em&gt;&nbsp;if&nbsp;it&nbsp;is:<br>
&lt;ul&gt;<br>
&lt;li&gt;...&lt;/li&gt;<br>
&lt;li&gt;an&nbsp;array&nbsp;of&nbsp;literal&nbsp;type&nbsp;&lt;ins&gt;other&nbsp;than&nbsp;an&nbsp;array&nbsp;of&nbsp;runtime<br>
bound&lt;/ins&gt;;&nbsp;or<br>
&lt;li&gt;...&lt;/li&gt;<br>
&lt;/ul&gt;<br>
&lt;/blockquote&gt;<br>
<br>
Change&nbsp;in&nbsp;3.9.2&nbsp;basic.compound&nbsp;paragraph&nbsp;2&nbsp;(the&nbsp;same&nbsp;wording&nbsp;is&nbsp;added<br>
by&nbsp;the&nbsp;proposed&nbsp;resolution&nbsp;of&nbsp;core&nbsp;issue&nbsp;1464):<br>
&lt;blockquote&gt;<br>
These&nbsp;methods&nbsp;of&nbsp;constructing&nbsp;types&nbsp;can&nbsp;be&nbsp;applied&nbsp;recursively;<br>
restrictions&nbsp;are&nbsp;mentioned&nbsp;in&nbsp;8.3.1&nbsp;dcl.ptr,&nbsp;8.3.4&nbsp;dcl.array,&nbsp;8.3.5<br>
dcl.fct,&nbsp;and&nbsp;8.3.2&nbsp;dcl.ref.<br>
&lt;ins&gt;Constructing&nbsp;a&nbsp;type&nbsp;such&nbsp;that&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;its&nbsp;object<br>
representation&nbsp;exceeds&nbsp;the&nbsp;maximum&nbsp;value&nbsp;representable&nbsp;in&nbsp;the&nbsp;type<br>
&lt;code&gt;std::size_t&lt;/code&gt;&nbsp;(18.2&nbsp;support.types)&nbsp;is&nbsp;ill-formed.&lt;/ins&gt;<br>
&lt;/blockquote&gt;<br>
<br>
Change&nbsp;in&nbsp;4.2&nbsp;conv.array&nbsp;paragraph&nbsp;1:<br>
<br>
&lt;blockquote&gt;<br>
An&nbsp;&lt;del&gt;lvalue&nbsp;or&nbsp;rvalue&lt;/del&gt;&nbsp;&lt;ins&gt;expression&lt;/ins&gt;&nbsp;of&nbsp;type&nbsp;&quot;array&nbsp;of<br>
N&nbsp;T&quot;&lt;ins&gt;,&nbsp;&quot;array&nbsp;of&nbsp;runtime&nbsp;bound&nbsp;of&nbsp;T&quot;,&lt;/ins&gt;&nbsp;or&nbsp;&quot;array&nbsp;of&nbsp;unknown<br>
bound&nbsp;of&nbsp;T&quot;&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;a&nbsp;prvalue&nbsp;of&nbsp;type&nbsp;&quot;pointer&nbsp;to&nbsp;T&quot;.&nbsp;The<br>
result&nbsp;is&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;the&nbsp;array.<br>
&lt;/blockquote&gt;<br>
<br>
Change&nbsp;in&nbsp;5.1.2&nbsp;expr.prim.lambda&nbsp;paragraph&nbsp;14:<br>
<br>
&lt;blockquote&gt;<br>
[&nbsp;Note:&nbsp;...&nbsp;]&nbsp;&lt;ins&gt;An&nbsp;array&nbsp;of&nbsp;runtime&nbsp;bound&nbsp;(8.3.4&nbsp;dcl.array)&nbsp;shall<br>
not&nbsp;be&nbsp;captured&nbsp;by&nbsp;copy.&lt;/ins&gt;<br>
&lt;/blockquote&gt;<br>
<br>
Change&nbsp;in&nbsp;5.1.2&nbsp;expr.prim.lambda&nbsp;paragraph&nbsp;15:<br>
<br>
&lt;blockquote&gt;<br>
An&nbsp;entity&nbsp;is&nbsp;&lt;em&gt;captured&nbsp;by&nbsp;reference&lt;/em&gt;&nbsp;if&nbsp;it&nbsp;is&nbsp;implicitly&nbsp;or<br>
explicitly&nbsp;captured&nbsp;but&nbsp;not&nbsp;captured&nbsp;by&nbsp;copy.&nbsp;It&nbsp;is&nbsp;unspecified<br>
whether&nbsp;additional&nbsp;unnamed&nbsp;non-static&nbsp;data&nbsp;members&nbsp;are&nbsp;declared&nbsp;in&nbsp;the<br>
closure&nbsp;type&nbsp;for&nbsp;entities&nbsp;captured&nbsp;by&nbsp;reference.<br>
&lt;ins&gt;[&nbsp;Note:&nbsp;Capturing&nbsp;by&nbsp;reference&nbsp;an&nbsp;array&nbsp;of&nbsp;runtime&nbsp;bound&nbsp;also<br>
implicitly&nbsp;captures&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;bound&nbsp;to&nbsp;support&nbsp;the&nbsp;range-based<br>
for&nbsp;statement&nbsp;(6.5.4&nbsp;stmt.ranged).]&lt;/ins&gt;<br>
&lt;/blockquote&gt;<br>
<br>
Insert&nbsp;a&nbsp;new&nbsp;paragraph&nbsp;before&nbsp;5.2.8&nbsp;expr.typeid&nbsp;paragraph&nbsp;2:<br>
<br>
&lt;blockquote&gt;<br>
&lt;ins&gt;The&nbsp;&lt;code&gt;typeid&lt;/code&gt;&nbsp;operator&nbsp;shall&nbsp;not&nbsp;be&nbsp;applied&nbsp;to&nbsp;an&nbsp;array<br>
of&nbsp;runtime&nbsp;bound.&lt;/ins&gt;<br>
&lt;p&gt;<br>
When&nbsp;&lt;code&gt;typeid&lt;/code&gt;&nbsp;is&nbsp;applied&nbsp;to&nbsp;a&nbsp;glvalue&nbsp;expression&nbsp;...<br>
&lt;/blockquote&gt;<br>
<br>
Change&nbsp;in&nbsp;5.3.1&nbsp;expr.unary.op&nbsp;paragraph&nbsp;3:<br>
<br>
&lt;blockquote&gt;<br>
The&nbsp;result&nbsp;of&nbsp;the&nbsp;unary&nbsp;&amp;&nbsp;operator&nbsp;is&nbsp;a&nbsp;pointer&nbsp;to&nbsp;its<br>
operand.&nbsp;The&nbsp;operand&nbsp;shall&nbsp;be&nbsp;an&nbsp;lvalue&nbsp;&lt;ins&gt;of&nbsp;type&nbsp;other&nbsp;than&nbsp;&quot;array<br>
of&nbsp;runtime&nbsp;bound&quot;&lt;/ins&gt;&nbsp;or&nbsp;a&nbsp;&lt;em&gt;qualified-id&lt;/em&gt;.&nbsp;...<br>
&lt;/blockquote&gt;<br>
<br>
<br>
Change&nbsp;in&nbsp;5.3.3&nbsp;expr.sizeof&nbsp;paragraph&nbsp;1:<br>
<br>
&lt;blockquote&gt;<br>
...&nbsp;The&nbsp;&lt;code&gt;sizeof&lt;/code&gt;<br>
operator&nbsp;shall&nbsp;not&nbsp;be&nbsp;applied&nbsp;to&nbsp;an&nbsp;expression&nbsp;that&nbsp;has&nbsp;function&nbsp;or<br>
incomplete&nbsp;type,&nbsp;to&nbsp;an&nbsp;enumeration&nbsp;type&nbsp;whose&nbsp;underlying&nbsp;type&nbsp;is&nbsp;not<br>
fixed&nbsp;before&nbsp;all&nbsp;its&nbsp;enumerators&nbsp;have&nbsp;been&nbsp;declared,<br>
&lt;ins&gt;to&nbsp;an&nbsp;array&nbsp;of&nbsp;runtime&nbsp;bound,&lt;/ins&gt;<br>
to&nbsp;the&nbsp;parenthesized&nbsp;name&nbsp;of&nbsp;such&nbsp;types,&nbsp;or&nbsp;to&nbsp;an&nbsp;lvalue&nbsp;that<br>
designates&nbsp;a&nbsp;bit-field.&nbsp;...<br>
&lt;/blockquote&gt;<br>
<br>
&lt;p&gt;<br>
&lt;em&gt;Drafting&nbsp;note:&nbsp;5.3.7&nbsp;expr.unary.noexcept&nbsp;does&nbsp;not&nbsp;need&nbsp;to&nbsp;be<br>
changed,&nbsp;because&nbsp;the&nbsp;declaration&nbsp;of&nbsp;an&nbsp;array&nbsp;of&nbsp;runtime&nbsp;bound&nbsp;cannot&nbsp;be<br>
lexically&nbsp;part&nbsp;of&nbsp;the&nbsp;operand&nbsp;of&nbsp;a&nbsp;noexcept;&nbsp;see&nbsp;also&nbsp;5.1.2p2<br>
expr.prim.lambda.&lt;/em&gt;<br>
&lt;/p&gt;<br>
<br>
&lt;em&gt;No&nbsp;change&nbsp;to&nbsp;6.5.4&nbsp;stmt.ranged&nbsp;paragraph&nbsp;1,&nbsp;supporting<br>
runtime-sized&nbsp;arrays&nbsp;implicitly.&lt;/em&gt;<br>
<br>
&lt;p&gt;<br>
<br>
Insert&nbsp;a&nbsp;new&nbsp;paragraph&nbsp;before&nbsp;7.1.3&nbsp;dcl.typedef&nbsp;paragraph&nbsp;3:<br>
<br>
&lt;blockquote&gt;<br>
&lt;ins&gt;A&nbsp;&lt;var&gt;typedef-name&lt;/var&gt;&nbsp;shall&nbsp;not&nbsp;name&nbsp;an&nbsp;array&nbsp;of&nbsp;runtime<br>
bound.&lt;/ins&gt;<br>
&lt;p&gt;<br>
In&nbsp;a&nbsp;given&nbsp;non-class&nbsp;scope,&nbsp;a&nbsp;&lt;code&gt;typedef&lt;/code&gt;&nbsp;specifier&nbsp;can&nbsp;be&nbsp;used&nbsp;to<br>
redefine&nbsp;the&nbsp;name&nbsp;of&nbsp;any&nbsp;type&nbsp;declared&nbsp;in&nbsp;that&nbsp;scope&nbsp;to&nbsp;refer&nbsp;to&nbsp;the<br>
type&nbsp;to&nbsp;which&nbsp;it&nbsp;already&nbsp;refers.&nbsp;[&nbsp;Example:&nbsp;...&nbsp;]<br>
&lt;/blockquote&gt;<br>
<br>
Change&nbsp;in&nbsp;7.1.6.2&nbsp;dcl.type.simple&nbsp;paragraph&nbsp;3:<br>
<br>
&lt;blockquote&gt;<br>
The&nbsp;type&nbsp;denoted&nbsp;by&nbsp;decltype(e)&nbsp;is&nbsp;defined&nbsp;as&nbsp;follows:<br>
&lt;ul&gt;<br>
&lt;li&gt;&lt;ins&gt;if&nbsp;&lt;code&gt;e&lt;/code&gt;&nbsp;has&nbsp;type&nbsp;&quot;array&nbsp;of&nbsp;runtime&nbsp;bound&quot;,&nbsp;the<br>
program&nbsp;is&nbsp;ill-formed;&lt;/ins&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;ins&gt;otherwise,&lt;/ins&gt;&nbsp;if&nbsp;&lt;code&gt;e&lt;/code&gt;&nbsp;is&nbsp;an&nbsp;unparenthesized&nbsp;...&lt;/li&gt;<br>
&lt;/ul&gt;<br>
<br>
&lt;/blockquote&gt;<br>
<br>
Change&nbsp;in&nbsp;8&nbsp;dcl.decl&nbsp;paragraph&nbsp;4:<br>
<br>
&lt;blockquote&gt;<br>
&lt;pre&gt;<br>
&lt;em&gt;noptr-declarator:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;declarator-id&nbsp;attribute-specifier-seq&lt;sub&gt;opt&lt;/sub&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noptr-declarator&nbsp;parameters-and-qualifiers<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noptr-declarator&lt;/em&gt;&nbsp;[&nbsp;&lt;del&gt;&lt;em&gt;constant-expression&lt;/em&gt;&lt;sub&gt;opt&lt;/sub&gt;&lt;/del&gt;&nbsp;&lt;ins&gt;&lt;em&gt;expression&lt;/em&gt;&lt;sub&gt;opt&lt;/sub&gt;&lt;/ins&gt;&nbsp;]&nbsp;&lt;em&gt;attribute-specifier-seq&lt;/em&gt;&lt;sub&gt;opt&lt;/sub&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;&lt;em&gt;ptr-declarator&lt;/em&gt;&nbsp;)<br>
&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
<br>
&lt;p&gt;<br>
&lt;em&gt;Drafting&nbsp;note:&nbsp;Section&nbsp;8.1&nbsp;[dcl.name]&nbsp;defining&nbsp;the&nbsp;grammar&nbsp;term<br>
&lt;em&gt;type-id&lt;/em&gt;&nbsp;is&nbsp;intentionally&nbsp;unchanged.&nbsp;&nbsp;Thus,&nbsp;constructing&nbsp;an<br>
array&nbsp;of&nbsp;runtime&nbsp;bound&nbsp;in&nbsp;a&nbsp;&lt;em&gt;type-id&lt;/em&gt;&nbsp;is&nbsp;ill-formed,&nbsp;because<br>
the&nbsp;grammar&nbsp;continues&nbsp;to&nbsp;require&nbsp;all&nbsp;constant-expressions&nbsp;in&nbsp;array<br>
bounds.&lt;/em&gt;<br>
&lt;/p&gt;<br>
<br>
Change&nbsp;in&nbsp;8.3.1&nbsp;dcl.ptr&nbsp;paragraph&nbsp;1:<br>
<br>
&lt;blockquote&gt;<br>
...&nbsp;Similarly,&nbsp;the&nbsp;optional&nbsp;&lt;var&gt;attribute-specifier-seq&lt;/var&gt;&nbsp;(7.6.1)&nbsp;appertains&nbsp;to<br>
the&nbsp;pointer&nbsp;and&nbsp;not&nbsp;to&nbsp;the&nbsp;object&nbsp;pointed&nbsp;to.&nbsp;&nbsp;&lt;ins&gt;There&nbsp;shall&nbsp;be&nbsp;no<br>
pointers&nbsp;to&nbsp;arrays&nbsp;of&nbsp;runtime&nbsp;bound.&lt;/ins&gt;<br>
&lt;/blockquote&gt;<br>
<br>
Change&nbsp;in&nbsp;8.3.2&nbsp;dcl.ref&nbsp;paragraph&nbsp;5:<br>
<br>
&lt;blockquote&gt;<br>
There&nbsp;shall&nbsp;be&nbsp;no&nbsp;references&nbsp;to&nbsp;references,&nbsp;&lt;ins&gt;no&nbsp;references&nbsp;to<br>
arrays&nbsp;of&nbsp;runtime&nbsp;bound&lt;/ins&gt;,&nbsp;no&nbsp;arrays&nbsp;of&nbsp;references,&nbsp;and&nbsp;no<br>
pointers&nbsp;to&nbsp;references.&nbsp;...<br>
&lt;/blockquote&gt;<br>
<br>
Change&nbsp;in&nbsp;8.3.4&nbsp;dcl.array&nbsp;paragraph&nbsp;1&nbsp;(partly&nbsp;taken&nbsp;from&nbsp;Mike&nbsp;Miller's<br>
drafting&nbsp;for&nbsp;core&nbsp;issue&nbsp;1464):<br>
<br>
&lt;blockquote&gt;<br>
In&nbsp;a&nbsp;declaration&nbsp;T&nbsp;D&nbsp;where&nbsp;D&nbsp;has&nbsp;the&nbsp;form<br>
&lt;pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D1&nbsp;[&nbsp;&lt;del&gt;&lt;var&gt;constant-expression&lt;/var&gt;&lt;sub&gt;opt&lt;/sub&gt;&lt;/del&gt;&nbsp;&lt;ins&gt;&lt;var&gt;expression&lt;/var&gt;&lt;sub&gt;opt&lt;/sub&gt;&lt;/ins&gt;&nbsp;]&nbsp;&lt;var&gt;attribute-specifier-seq&lt;var&gt;&lt;sub&gt;opt&lt;/sub&gt;<br>
&lt;/pre&gt;<br>
and&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;identifier&nbsp;in&nbsp;the&nbsp;declaration&nbsp;T&nbsp;D1&nbsp;is<br>
&quot;&lt;em&gt;derived-declarator-type-list&lt;/em&gt;&nbsp;T&quot;,&nbsp;then&nbsp;the&nbsp;type&nbsp;of&nbsp;the<br>
identifier&nbsp;of&nbsp;D&nbsp;is&nbsp;an&nbsp;array&nbsp;type;&nbsp;if&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;identifier&nbsp;of&nbsp;D<br>
contains&nbsp;the&nbsp;&lt;code&gt;auto&lt;/code&gt;&nbsp;&lt;var&gt;type-specifier&lt;/var&gt;,&nbsp;the&nbsp;program<br>
is&nbsp;ill-formed.<br>
<br>
T&nbsp;is&nbsp;called&nbsp;the&nbsp;array&nbsp;element&nbsp;type;&nbsp;this&nbsp;type&nbsp;shall&nbsp;not&nbsp;be&nbsp;a&nbsp;reference<br>
type,&nbsp;the&nbsp;(possibly&nbsp;cv-qualified)&nbsp;type&nbsp;&lt;code&gt;void&lt;/code&gt;,&nbsp;a&nbsp;function<br>
type,&nbsp;&lt;ins&gt;an&nbsp;array&nbsp;of&nbsp;unknown&nbsp;or&nbsp;runtime&nbsp;bound,&lt;/ins&gt;&nbsp;or&nbsp;an&nbsp;abstract&nbsp;class&nbsp;type.<br>
<br>
&lt;ins&gt;Except&nbsp;as&nbsp;noted&nbsp;below,&nbsp;if&nbsp;the&nbsp;&lt;var&gt;expression&lt;/var&gt;&nbsp;is&nbsp;omitted,<br>
the&nbsp;type&nbsp;of&nbsp;the&nbsp;identifier&nbsp;of&nbsp;D&nbsp;is<br>
&quot;&lt;em&gt;derived-declarator-type-list&lt;/em&gt;&nbsp;array&nbsp;of&nbsp;unknown&nbsp;bound&nbsp;of&nbsp;T&quot;.<br>
If&nbsp;the&nbsp;&lt;em&gt;expression&lt;/em&gt;&nbsp;is&nbsp;present,&nbsp;it&nbsp;is&nbsp;implicitly&nbsp;converted&nbsp;to<br>
&lt;code&gt;std::size_t&lt;/code&gt;.&nbsp;&nbsp;The&nbsp;&lt;em&gt;expression&lt;/em&gt;&nbsp;is&nbsp;erroneous<br>
if:&lt;/ins&gt;<br>
<br>
&lt;ul&gt;<br>
&lt;li&gt;&lt;ins&gt;its&nbsp;value&nbsp;before&nbsp;converting&nbsp;to&nbsp;&lt;code&gt;std::size_t&lt;/code&gt;&nbsp;or,<br>
in&nbsp;the&nbsp;case&nbsp;of<br>
an&nbsp;expression&nbsp;of&nbsp;class&nbsp;type,&nbsp;before&nbsp;application&nbsp;of&nbsp;the&nbsp;second&nbsp;standard<br>
conversion&nbsp;(13.3.3.1.2&nbsp;over.ics.user)&nbsp;is&nbsp;less&nbsp;than&nbsp;or&nbsp;equal<br>
to&nbsp;zero;&lt;/ins&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;ins&gt;its&nbsp;value&nbsp;is&nbsp;such&nbsp;that&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;allocated&nbsp;object<br>
would&nbsp;exceed&nbsp;the&nbsp;implementation-defined&nbsp;limit&nbsp;(annex&nbsp;B<br>
implimits);&lt;/ins&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;ins&gt;the&nbsp;initializer&nbsp;of&nbsp;the&nbsp;object&nbsp;is&nbsp;a<br>
&lt;em&gt;braced-init-list&lt;/em&gt;&nbsp;whose&nbsp;number&nbsp;of&nbsp;(top-level)<br>
&lt;em&gt;initializer-clause&lt;/em&gt;s&nbsp;exceeds&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;to<br>
initialize;&nbsp;or&lt;/ins&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;ins&gt;the&nbsp;object&nbsp;is&nbsp;initialized&nbsp;with&nbsp;a&nbsp;string&nbsp;literal&nbsp;and&nbsp;there<br>
are&nbsp;more&nbsp;initializers&nbsp;than&nbsp;there&nbsp;are&nbsp;array&nbsp;elements.&lt;/ins&gt;&lt;/li&gt;<br>
&lt;/ul&gt;<br>
<br>
&lt;ins&gt;If&nbsp;the&nbsp;&lt;em&gt;expression&lt;/em&gt;,&nbsp;after&nbsp;converting&nbsp;to<br>
&lt;code&gt;std::size_t&lt;/code&gt;,&nbsp;is&nbsp;a&nbsp;core&nbsp;constant&nbsp;expression&nbsp;and&nbsp;the<br>
&lt;em&gt;expression&lt;/em&gt;&nbsp;is&nbsp;erroneous,&nbsp;the&nbsp;program&nbsp;is&nbsp;ill-formed.&lt;/ins&gt;<br>
<br>
&lt;ul&gt;<br>
&lt;li&gt;&lt;ins&gt;If&nbsp;the&nbsp;&lt;em&gt;expression&lt;/em&gt;,&nbsp;after&nbsp;converting&nbsp;to<br>
&lt;code&gt;std::size_t&lt;/code&gt;,&nbsp;is&nbsp;a&nbsp;core&nbsp;constant&nbsp;expression&nbsp;whose<br>
value&nbsp;is&nbsp;&lt;code&gt;N&lt;/code&gt;,&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;identifier&nbsp;of&nbsp;D&nbsp;is<br>
&quot;&lt;em&gt;derived-declarator-type-list&lt;/em&gt;&nbsp;array&nbsp;of&nbsp;N&nbsp;T&quot;.&lt;/ins&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;ins&gt;Otherwise,&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;identifier&nbsp;of&nbsp;D&nbsp;is<br>
&quot;&lt;em&gt;derived-declarator-type-list&lt;/em&gt;&nbsp;array&nbsp;of&nbsp;runtime&nbsp;bound&nbsp;of&nbsp;T&quot;<br>
and&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;&lt;var&gt;expression&lt;/var&gt;&nbsp;designates&nbsp;the&nbsp;number&nbsp;of<br>
elements&nbsp;&lt;code&gt;N&lt;/code&gt;&nbsp;in&nbsp;the&nbsp;array.&nbsp;&nbsp;If&nbsp;the&nbsp;&lt;em&gt;expression&lt;/em&gt;&nbsp;is<br>
erroneous,&nbsp;an&nbsp;exception&nbsp;of&nbsp;a&nbsp;type&nbsp;that&nbsp;would&nbsp;match&nbsp;a&nbsp;handler&nbsp;(15.3<br>
except.handle)&nbsp;of&nbsp;type&nbsp;&lt;code&gt;std::bad_array_length&lt;/code&gt;<br>
(18.6.2.2&nbsp;xxx)&nbsp;is&nbsp;thrown.&lt;/ins&gt;&lt;/li&gt;<br>
&lt;/ul&gt;<br>
<br>
&lt;del&gt;If&nbsp;the&nbsp;&lt;var&gt;constant-expression&nbsp;(5.19&nbsp;expr.const)&lt;/var&gt;&nbsp;is<br>
present,&nbsp;it&nbsp;shall&nbsp;be&nbsp;an&nbsp;integral&nbsp;constant&nbsp;expression&nbsp;and&nbsp;its&nbsp;value<br>
shall&nbsp;be&nbsp;greater&nbsp;than&nbsp;zero.<br>
<br>
The&nbsp;constant&nbsp;expression&nbsp;specifies&nbsp;the&nbsp;bound&nbsp;of&nbsp;(number&nbsp;of&nbsp;elements&nbsp;in)<br>
the&nbsp;array.&nbsp;If&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;constant&nbsp;expression&nbsp;is&nbsp;N,&nbsp;the&nbsp;array&nbsp;has<br>
N&nbsp;elements&nbsp;numbered&nbsp;0&nbsp;to&nbsp;N-1,&nbsp;and&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;identifier&nbsp;of&nbsp;D&nbsp;is<br>
&quot;&lt;em&gt;derived-declarator-type-list&lt;/em&gt;&nbsp;array&nbsp;of&nbsp;N&nbsp;T&quot;.&lt;/del&gt;<br>
<br>
An&nbsp;object&nbsp;of&nbsp;array&nbsp;type&nbsp;contains&nbsp;a&nbsp;contiguously&nbsp;allocated&nbsp;non-empty<br>
set&nbsp;of&nbsp;N&nbsp;subobjects&nbsp;of&nbsp;type&nbsp;T.&nbsp;&lt;del&gt;Except&nbsp;as&nbsp;noted&nbsp;below,&nbsp;if&nbsp;the&nbsp;constant<br>
expression&nbsp;is&nbsp;omitted,&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;identifier&nbsp;of&nbsp;D&nbsp;is<br>
&quot;&lt;em&gt;derived-declarator-type-list&lt;/em&gt;&nbsp;array&nbsp;of&nbsp;unknown&nbsp;bound&nbsp;of&nbsp;T&quot;,<br>
an&nbsp;incomplete&nbsp;object&nbsp;type.&lt;/del&gt;<br>
<br>
The&nbsp;type&nbsp;&quot;&lt;em&gt;derived-declarator-type-list&lt;/em&gt;&nbsp;array&nbsp;of&nbsp;N&nbsp;T&quot;&nbsp;is&nbsp;a<br>
different&nbsp;type&nbsp;from&nbsp;the&nbsp;type&nbsp;&quot;&lt;em&gt;derived-declarator-type-list&lt;/em&gt;<br>
array&nbsp;of&nbsp;unknown&nbsp;bound&nbsp;of&nbsp;T&quot;,&nbsp;see&nbsp;3.9&nbsp;basic.types.&nbsp;&nbsp;Any&nbsp;type&nbsp;of&nbsp;the<br>
form&nbsp;&quot;&lt;em&gt;cv-qualifier-seq&lt;/em&gt;&nbsp;array&nbsp;of&nbsp;N&nbsp;T&quot;&nbsp;is&nbsp;adjusted&nbsp;to&nbsp;&quot;array&nbsp;of<br>
N&nbsp;&lt;em&gt;cv-qualifier-seq&lt;/em&gt;&nbsp;T&quot;,&nbsp;and&nbsp;similarly&nbsp;for&nbsp;&quot;array&nbsp;of&nbsp;unknown<br>
bound&nbsp;of&nbsp;T&quot;&nbsp;&lt;ins&gt;and&nbsp;&quot;array&nbsp;of&nbsp;runtime&nbsp;bound&nbsp;of<br>
T&quot;&lt;/ins&gt;.<br>
<br>
The&nbsp;optional&nbsp;&lt;em&gt;attribute-specifier-seq&lt;/em&gt;&nbsp;appertains&nbsp;to&nbsp;the<br>
array.&nbsp;[&nbsp;Example:&nbsp;<br>
&lt;pre&gt;<br>
&nbsp;&nbsp;typedef&nbsp;int&nbsp;A[5],&nbsp;AA[2][3];<br>
&nbsp;&nbsp;typedef&nbsp;const&nbsp;A&nbsp;CA;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;type&nbsp;is&nbsp;&quot;array&nbsp;of&nbsp;5&nbsp;const&nbsp;int&quot;<br>
&nbsp;&nbsp;typedef&nbsp;const&nbsp;AA&nbsp;CAA;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;type&nbsp;is&nbsp;&quot;array&nbsp;of&nbsp;2&nbsp;array&nbsp;of&nbsp;3&nbsp;const&nbsp;int&quot;<br>
<br>
&lt;ins&gt;&nbsp;&nbsp;void&nbsp;f(unsigned&nbsp;int&nbsp;n)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;a[n];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;type&nbsp;of&nbsp;&quot;a&quot;&nbsp;is&nbsp;&quot;array&nbsp;of&nbsp;runtime&nbsp;bound&nbsp;of&nbsp;int&quot;<br>
&nbsp;&nbsp;}&lt;/ins&gt;<br>
<br>
&lt;/pre&gt;<br>
--&nbsp;end&nbsp;example&nbsp;]&nbsp;[&nbsp;Note:&nbsp;...&nbsp;]<br>
<br>
&lt;/blockquote&gt;<br>
<br>
<br>
Change&nbsp;in&nbsp;8.3.4&nbsp;dcl.array&nbsp;paragraph&nbsp;3:<br>
<br>
&lt;blockquote&gt;<br>
When&nbsp;several&nbsp;&quot;array&nbsp;of&quot;&nbsp;specifications&nbsp;are&nbsp;adjacent,&nbsp;a<br>
multidimensional&nbsp;array&nbsp;is&nbsp;created&lt;del&gt;;&nbsp;only&nbsp;the&nbsp;first&nbsp;of&nbsp;the&nbsp;constant<br>
expressions&nbsp;that&nbsp;specify&nbsp;the&nbsp;bounds&nbsp;of&nbsp;the&nbsp;arrays&nbsp;may&nbsp;be<br>
omitted&lt;/del&gt;.&nbsp;&nbsp;In&nbsp;addition&nbsp;to&nbsp;...<br>
<br>
&lt;/blockquote&gt;<br>
<br>
Add&nbsp;a&nbsp;new&nbsp;paragraph&nbsp;before&nbsp;8.3.4&nbsp;dcl.array&nbsp;paragraph&nbsp;4:<br>
<br>
&lt;blockquote&gt;<br>
&lt;ins&gt;An&nbsp;array&nbsp;of&nbsp;runtime&nbsp;bound&nbsp;shall&nbsp;only&nbsp;be&nbsp;used&nbsp;as&nbsp;the&nbsp;type&nbsp;of&nbsp;a<br>
local&nbsp;object&nbsp;with&nbsp;automatic&nbsp;storage&nbsp;duration.&nbsp;&nbsp;If&nbsp;the&nbsp;size&nbsp;of&nbsp;the<br>
array&nbsp;exceeds&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;memory&nbsp;available&nbsp;for&nbsp;objects&nbsp;with<br>
automatic&nbsp;storage&nbsp;duration,&nbsp;the&nbsp;behavior&nbsp;is&nbsp;undefined&nbsp;[&nbsp;Footnote:<br>
Implementations&nbsp;that&nbsp;detect&nbsp;this&nbsp;case&nbsp;are&nbsp;encouraged&nbsp;to&nbsp;throw&nbsp;an<br>
exception&nbsp;that&nbsp;would&nbsp;match&nbsp;a&nbsp;handler&nbsp;(15.3&nbsp;except.handle)&nbsp;of&nbsp;type<br>
std::bad_array_length&nbsp;(18.6.2.2&nbsp;xxx).&nbsp;]&nbsp;&nbsp;It&nbsp;is&nbsp;unspecified&nbsp;whether&nbsp;a<br>
global&nbsp;allocation&nbsp;function&nbsp;(3.7.4&nbsp;basic.stc.dynamic)&nbsp;is&nbsp;invoked&nbsp;to<br>
obtain&nbsp;storage&nbsp;for&nbsp;the&nbsp;array.&nbsp;&nbsp;If<br>
it&nbsp;is&nbsp;invoked,&nbsp;the&nbsp;corresponding&nbsp;global&nbsp;deallocation&nbsp;function&nbsp;is<br>
invoked&nbsp;to&nbsp;release&nbsp;the&nbsp;storage&nbsp;after&nbsp;the&nbsp;lifetime&nbsp;of&nbsp;the&nbsp;array<br>
ended.&nbsp;&nbsp;[&nbsp;Footnote:&nbsp;Alternatively,&nbsp;an&nbsp;implementation&nbsp;could&nbsp;allocate<br>
such&nbsp;an&nbsp;array&nbsp;on&nbsp;the&nbsp;usual&nbsp;stack&nbsp;or&nbsp;obtain&nbsp;storage&nbsp;via<br>
&lt;code&gt;malloc&lt;/code&gt;&nbsp;(20.6.13&nbsp;c.malloc).&nbsp;]<br>
&lt;/ins&gt;<br>
<br>
&lt;/blockquote&gt;<br>
<br>
Change&nbsp;in&nbsp;8.3.5&nbsp;dcl.fct&nbsp;paragraph&nbsp;8:<br>
<br>
&lt;blockquote&gt;<br>
If&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;parameter&nbsp;includes&nbsp;a&nbsp;type&nbsp;of&nbsp;the&nbsp;form&nbsp;&lt;ins&gt;&quot;array&nbsp;of<br>
runtime&nbsp;bound&nbsp;of&nbsp;T&quot;,&lt;/ins&gt;&nbsp;&quot;pointer&nbsp;to&nbsp;array&nbsp;of&nbsp;unknown&nbsp;bound&nbsp;of<br>
T&quot;&lt;ins&gt;,&lt;/ins&gt;&nbsp;or&nbsp;&quot;reference&nbsp;to&nbsp;array&nbsp;of&nbsp;unknown&nbsp;bound&nbsp;of&nbsp;T,&quot;&nbsp;the<br>
program&nbsp;is&nbsp;ill-formed.&nbsp;[&nbsp;Footnote:&nbsp;...&nbsp;]&nbsp;&nbsp;Functions&nbsp;shall&nbsp;not&nbsp;have&nbsp;a<br>
return&nbsp;type&nbsp;of&nbsp;type&nbsp;array&nbsp;or&nbsp;function,&nbsp;although&nbsp;they&nbsp;may&nbsp;have&nbsp;a&nbsp;return<br>
type&nbsp;of&nbsp;type&nbsp;pointer&nbsp;or&nbsp;reference&nbsp;to&nbsp;such&nbsp;things.<br>
&lt;/blockquote&gt;<br>
<br>
<br>
Change&nbsp;in&nbsp;8.5.1&nbsp;dcl.init.aggr&nbsp;paragraph&nbsp;6:<br>
<br>
&lt;blockquote&gt;<br>
&lt;ins&gt;For&nbsp;types&nbsp;other&nbsp;than&nbsp;arrays&nbsp;of&nbsp;runtime&nbsp;bound&nbsp;(8.3.4&nbsp;dcl.array),<br>
an&lt;/ins&gt;<br>
&lt;del&gt;An&lt;/del&gt;&nbsp;&lt;var&gt;initializer-list&lt;/var&gt;&nbsp;is&nbsp;ill-formed&nbsp;if&nbsp;the&nbsp;number&nbsp;of<br>
&lt;var&gt;initializer-clause&lt;/var&gt;s&nbsp;exceeds&nbsp;the&nbsp;number&nbsp;of&nbsp;members&nbsp;or<br>
elements&nbsp;to&nbsp;initialize.&nbsp;[&nbsp;Example:&nbsp;...&nbsp;]<br>
&lt;/blockquote&gt;<br>
<br>
Change&nbsp;in&nbsp;8.5.2&nbsp;dcl.init.string&nbsp;paragraph&nbsp;2:<br>
<br>
&lt;blockquote&gt;<br>
&lt;ins&gt;[&nbsp;Note:&lt;/ins&gt;&nbsp;There&nbsp;cannot&nbsp;be&nbsp;more&nbsp;initializers&nbsp;than&nbsp;there&nbsp;are<br>
array&nbsp;elements&lt;ins&gt;;&nbsp;see&nbsp;8.3.4&nbsp;dcl.array&lt;/ins&gt;.&nbsp;[&nbsp;Example:<br>
&lt;pre&gt;<br>
&nbsp;char&nbsp;cv[4]&nbsp;=&nbsp;&quot;asdf&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;error<br>
&lt;/pre&gt;<br>
is&nbsp;ill-formed&nbsp;since&nbsp;there&nbsp;is&nbsp;no&nbsp;space&nbsp;for&nbsp;the&nbsp;implied&nbsp;trailing<br>
'\0'.&nbsp;--&nbsp;end&nbsp;example&nbsp;]<br>
&lt;ins&gt;&nbsp;--&nbsp;end&nbsp;note&nbsp;]&lt;/ins&gt;<br>
&lt;/blockquote&gt;<br>
<br>
Change&nbsp;in&nbsp;9.2&nbsp;class.mem&nbsp;paragraph&nbsp;10:<br>
<br>
&lt;blockquote&gt;<br>
&lt;del&gt;Non-static&lt;/del&gt;&nbsp;&lt;ins&gt;A&nbsp;non-static&lt;/ins&gt;&nbsp;(9.4&nbsp;class.static)&nbsp;data<br>
&lt;del&gt;members&lt;/del&gt;&nbsp;&lt;ins&gt;member&lt;/ins&gt;&nbsp;shall&nbsp;not&nbsp;have&nbsp;incomplete<br>
&lt;del&gt;types.&lt;/del&gt;&nbsp;&lt;ins&gt;type&nbsp;or&nbsp;type&nbsp;&quot;array&nbsp;of&nbsp;runtime&nbsp;bound&quot;.&nbsp;[&nbsp;Note:<br>
&lt;/ins&gt;&nbsp;In&nbsp;particular,&nbsp;a&nbsp;class&nbsp;C&nbsp;shall&nbsp;not&nbsp;contain&nbsp;a&nbsp;non-static&nbsp;member<br>
of&nbsp;class&nbsp;C,&nbsp;but&nbsp;it&nbsp;can&nbsp;contain&nbsp;a&nbsp;pointer&nbsp;or&nbsp;reference&nbsp;to&nbsp;an&nbsp;object&nbsp;of<br>
class&nbsp;C.&nbsp;&lt;ins&gt;]&lt;/ins&gt;<br>
<br>
&lt;/blockquote&gt;<br>
<br>
<br>
Change&nbsp;in&nbsp;14.1&nbsp;temp.param&nbsp;paragraph&nbsp;7:<br>
&lt;blockquote&gt;<br>
A&nbsp;non-type&nbsp;&lt;var&gt;template-parameter&lt;/var&gt;&nbsp;shall&nbsp;not&nbsp;be&nbsp;declared&nbsp;to&nbsp;have<br>
floating&nbsp;point,&nbsp;class,&nbsp;&lt;ins&gt;array&nbsp;of&nbsp;runtime&nbsp;bound&lt;/ins&gt;,&nbsp;or&nbsp;void<br>
type.&nbsp;&nbsp;[&nbsp;Example:&nbsp;...&nbsp;]<br>
&lt;/blockquote&gt;<br>
<br>
&lt;p&gt;<br>
&lt;em&gt;Drafting&nbsp;note:&nbsp;It&nbsp;is&nbsp;not&nbsp;necessary&nbsp;to&nbsp;explicitly&nbsp;prevent<br>
template&nbsp;argument&nbsp;deduction&nbsp;for&nbsp;an&nbsp;array&nbsp;of&nbsp;runtime&nbsp;bound,&nbsp;because<br>
14.8.2p8&nbsp;[temp.deduct]&nbsp;says&nbsp;&quot;If&nbsp;a&nbsp;substitution&nbsp;results&nbsp;in&nbsp;an&nbsp;invalid<br>
type&nbsp;or&nbsp;expression,&nbsp;type&nbsp;deduction&nbsp;fails.&nbsp;An&nbsp;invalid&nbsp;type&nbsp;or<br>
expression&nbsp;is&nbsp;one&nbsp;that&nbsp;would&nbsp;be&nbsp;ill-formed&nbsp;if&nbsp;written&nbsp;using&nbsp;the<br>
substituted&nbsp;arguments.&quot;&nbsp;&nbsp;8.3.5p8&nbsp;(and&nbsp;other&nbsp;places)&nbsp;establishing<br>
restrictions&nbsp;on&nbsp;forming&nbsp;types&nbsp;are&nbsp;thus&nbsp;sufficient.&lt;/em&gt;<br>
&lt;/p&gt;<br>
<br>
Change&nbsp;in&nbsp;15.1&nbsp;except.throw&nbsp;paragraph&nbsp;1:<br>
<br>
&lt;blockquote&gt;<br>
...&nbsp;[&nbsp;Note:&nbsp;An&nbsp;exception&nbsp;can&nbsp;be&nbsp;thrown&nbsp;from&nbsp;one&nbsp;of&nbsp;the&nbsp;following<br>
contexts:&nbsp;&lt;em&gt;throw-expression&lt;/em&gt;&nbsp;(see&nbsp;below),&nbsp;allocation&nbsp;functions<br>
(3.7.4.1&nbsp;basic.stc.dynamic.allocation),&nbsp;dynamic_cast&nbsp;(5.2.7<br>
expr.dynamic.cast),&nbsp;typeid&nbsp;(5.2.8&nbsp;expr.typeid),&nbsp;new-expression&nbsp;(5.3.4<br>
expr.new),&nbsp;&lt;ins&gt;array&nbsp;of&nbsp;runtime&nbsp;bound&nbsp;(8.3.4&nbsp;dcl.array),&lt;/ins&gt;&nbsp;and<br>
standard&nbsp;library&nbsp;functions&nbsp;(17.5.1.4&nbsp;structure.specifications).&nbsp;&nbsp;--<br>
end&nbsp;note&nbsp;]&nbsp;...<br>
<br>
&lt;/blockquote&gt;<br>
<br>
Add&nbsp;a&nbsp;new&nbsp;section&nbsp;just&nbsp;before&nbsp;18.6.2.2&nbsp;new.badlength:<br>
<br>
&lt;blockquote&gt;<br>
&lt;h2&gt;Class&nbsp;&lt;code&gt;bad_array_length&lt;/code&gt;&lt;/h2&gt;<br>
&lt;pre&gt;<br>
&nbsp;&nbsp;namespace&nbsp;std&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;bad_array_length&nbsp;:&nbsp;public&nbsp;bad_alloc&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bad_array_length()&nbsp;noexcept;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
&nbsp;&nbsp;}<br>
&lt;/pre&gt;<br>
<br>
The&nbsp;class&nbsp;&lt;code&gt;bad_array_length&lt;/code&gt;&nbsp;defines&nbsp;the&nbsp;type&nbsp;of&nbsp;objects<br>
thrown&nbsp;as&nbsp;exceptions&nbsp;by&nbsp;the&nbsp;implementation<br>
to&nbsp;report&nbsp;an&nbsp;attempt&nbsp;to&nbsp;allocate&nbsp;an&nbsp;array&nbsp;of&nbsp;runtime&nbsp;bound&nbsp;with&nbsp;a&nbsp;size<br>
less&nbsp;than&nbsp;or&nbsp;equal&nbsp;to&nbsp;zero&nbsp;or&nbsp;greater&nbsp;than&nbsp;an<br>
implementation-defined&nbsp;limit&nbsp;(8.3.4&nbsp;dcl.array).<br>
&lt;pre&gt;<br>
bad_array_length()&nbsp;noexcept;<br>
&lt;/pre&gt;<br>
<br>
&lt;em&gt;Effects:&lt;/em&gt;&nbsp;constructs&nbsp;an&nbsp;object&nbsp;of&nbsp;class<br>
&lt;code&gt;bad_array_length&lt;/code&gt;.&lt;br/&gt;<br>
&lt;em&gt;Remarks:&lt;/em&gt;&nbsp;the&nbsp;result&nbsp;of&nbsp;calling&nbsp;&lt;code&gt;what()&lt;/code&gt;&nbsp;on&nbsp;the<br>
newly&nbsp;constructed&nbsp;object&nbsp;is&nbsp;implementation-defined.&lt;br/&gt;<br>
<br>
&lt;/blockquote&gt;<br>
<br>
&lt;/body&gt;<br>
&lt;/html&gt;
</tt>

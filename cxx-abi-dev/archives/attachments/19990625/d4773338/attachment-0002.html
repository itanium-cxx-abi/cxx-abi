<tt>
&lt;HTML&gt;<br>
<br>
&lt;HEAD&gt;<br>
&lt;title&gt;C++&nbsp;ABI&nbsp;Closed&nbsp;Issues&lt;/title&gt;<br>
<br>
&lt;link&nbsp;rel=stylesheet&nbsp;href=small-table.css&nbsp;type=&quot;text/css&quot;&gt;<br>
&lt;link&nbsp;rel=stylesheet&nbsp;href=code.css&nbsp;type=&quot;text/css&quot;&gt;<br>
<br>
&lt;hr&gt;<br>
<br>
&lt;font&nbsp;size=6&gt;&lt;i&gt;&lt;b&gt;<br>
&lt;p&gt;<br>
C++&nbsp;ABI&nbsp;Closed&nbsp;Issues<br>
&lt;/b&gt;&lt;/i&gt;&lt;/font&gt;<br>
<br>
&lt;font&nbsp;size=-1&gt;<br>
&lt;p&gt;<br>
&lt;i&gt;Revised&nbsp;25&nbsp;June&nbsp;1999&lt;/i&gt;<br>
<br>
&lt;/center&gt;<br>
<br>
&lt;/HEAD&gt;<br>
<br>
&lt;BODY&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;Issue&nbsp;Status&nbsp;&lt;/h3&gt;<br>
<br>
In&nbsp;the&nbsp;following&nbsp;sections,<br>
the&nbsp;&lt;b&gt;&lt;i&gt;class&lt;/i&gt;&lt;/b&gt;&nbsp;of&nbsp;an&nbsp;issue&nbsp;attempts&nbsp;to&nbsp;classify&nbsp;it&nbsp;on&nbsp;the<br>
basis&nbsp;of&nbsp;what&nbsp;it&nbsp;likely&nbsp;affects.<br>
The&nbsp;identifiers&nbsp;used&nbsp;are:<br>
<br>
&lt;table&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;call&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Function&nbsp;call&nbsp;interface,&nbsp;i.e.&nbsp;call&nbsp;linkage&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;data&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Data&nbsp;layout&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;lib&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Runtime&nbsp;library&nbsp;support&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;lif&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Library&nbsp;interface,&nbsp;i.e.&nbsp;API&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;g&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Potential&nbsp;gABI&nbsp;impact&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;ps&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Potential&nbsp;psABI&nbsp;impact&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;source&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Source&nbsp;code&nbsp;conventions&nbsp;(i.e.&nbsp;API,&nbsp;not&nbsp;ABI)&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;tools&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;May&nbsp;affect&nbsp;how&nbsp;program&nbsp;construction&nbsp;tools&nbsp;interact&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;A.&nbsp;&nbsp;Object&nbsp;Layout&nbsp;Issues&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
&lt;table&nbsp;border=on&nbsp;cellpadding=3&gt;<br>
<br>
&lt;tr&gt;<br>
&lt;th&gt;&nbsp;#&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Issue&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Class&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Status&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Source&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Opened&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Closed&nbsp;&lt;/th&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;A-1&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Vptr&nbsp;location&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;data&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;closed&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;SGI&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990520&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990624&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Summary&lt;/b&gt;:<br>
Where&nbsp;is&nbsp;the&nbsp;Vptr&nbsp;stored&nbsp;in&nbsp;an&nbsp;object&nbsp;(first&nbsp;or&nbsp;last&nbsp;are&nbsp;the&nbsp;usual&nbsp;answers).<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990610&nbsp;All]&lt;/font&gt;<br>
Given&nbsp;the&nbsp;absence&nbsp;of&nbsp;addressing&nbsp;modes&nbsp;with&nbsp;displacements&nbsp;on&nbsp;IA-64,<br>
the&nbsp;consensus&nbsp;is&nbsp;to&nbsp;answer&nbsp;this&nbsp;question&nbsp;with&nbsp;&quot;first.&quot;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990617&nbsp;All]&lt;/font&gt;<br>
Given&nbsp;a&nbsp;Vptr&nbsp;and&nbsp;only&nbsp;non-polymorphic&nbsp;bases,<br>
which&nbsp;(Vptr&nbsp;or&nbsp;base)&nbsp;goes&nbsp;at&nbsp;offset&nbsp;0?<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;HP:&nbsp;Vptr&nbsp;at&nbsp;end,&nbsp;but&nbsp;IA-64&nbsp;is&nbsp;different&nbsp;because&nbsp;no&nbsp;load&nbsp;displacement<br>
&lt;li&gt;&nbsp;Sun:&nbsp;Vptr&nbsp;at&nbsp;0&nbsp;probably&nbsp;preferred<br>
&lt;li&gt;&nbsp;g++:&nbsp;Vptr&nbsp;at&nbsp;end&nbsp;today<br>
&lt;/ul&gt;<br>
&lt;p&gt;<br>
Tentative&nbsp;decision:&nbsp;&nbsp;Vptr&nbsp;always&nbsp;goes&nbsp;at&nbsp;beginning.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990624&nbsp;All]&lt;/font&gt;<br>
Accepted&nbsp;tentative&nbsp;decision.<br>
Rename,&nbsp;close&nbsp;this&nbsp;issue,&nbsp;and&nbsp;open&nbsp;separate&nbsp;issue&nbsp;(B-6)&nbsp;for&nbsp;Vtable&nbsp;layout.<br>
<br>
&lt;p&gt;<br>
&lt;table&nbsp;border=on&nbsp;cellpadding=3&gt;<br>
<br>
&lt;tr&gt;<br>
&lt;th&gt;&nbsp;#&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Issue&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Class&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Status&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Source&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Opened&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Closed&nbsp;&lt;/th&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;A-2&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Virtual&nbsp;base&nbsp;classes&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;data&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;closed&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;SGI&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990520&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990624&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Summary&lt;/b&gt;:<br>
Where&nbsp;are&nbsp;the&nbsp;virtual&nbsp;base&nbsp;subobjects&nbsp;placed&nbsp;in&nbsp;the&nbsp;class&nbsp;layout?<br>
How&nbsp;are&nbsp;data&nbsp;member&nbsp;accesses&nbsp;to&nbsp;them&nbsp;handled?<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990610&nbsp;Matt]&lt;/font&gt;<br>
With&nbsp;regard&nbsp;to&nbsp;how&nbsp;data&nbsp;member&nbsp;accesses&nbsp;are&nbsp;handled,<br>
the&nbsp;choices&nbsp;are&nbsp;to&nbsp;store&nbsp;either&nbsp;a&nbsp;pointer&nbsp;or&nbsp;an&nbsp;offset&nbsp;in&nbsp;the&nbsp;Vtable.<br>
The&nbsp;concensus&nbsp;seems&nbsp;to&nbsp;be&nbsp;to&nbsp;prefer&nbsp;an&nbsp;offset.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990617&nbsp;All]&lt;/font&gt;<br>
Any&nbsp;number&nbsp;of&nbsp;empty&nbsp;virtual&nbsp;base&nbsp;subobjects&nbsp;(rare)&nbsp;will&nbsp;be&nbsp;placed&nbsp;at<br>
offset&nbsp;zero.<br>
If&nbsp;there&nbsp;are&nbsp;no&nbsp;non-virtual&nbsp;polymorphic&nbsp;bases,<br>
the&nbsp;first&nbsp;virtual&nbsp;base&nbsp;subobject&nbsp;with&nbsp;a&nbsp;Vpointer&nbsp;will&nbsp;be&nbsp;placed&nbsp;at<br>
offset&nbsp;zero.<br>
Finally,&nbsp;all&nbsp;other&nbsp;virtual&nbsp;base&nbsp;subobjects&nbsp;will&nbsp;be&nbsp;allocated&nbsp;at&nbsp;the<br>
end&nbsp;of&nbsp;the&nbsp;class,&nbsp;left-to-right,&nbsp;depth-first.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990624&nbsp;All]&lt;/font&gt;<br>
Define&nbsp;an&nbsp;empty&nbsp;object&nbsp;as&nbsp;one&nbsp;with&nbsp;no&nbsp;non-static,&nbsp;non-empty&nbsp;data&nbsp;members,<br>
no&nbsp;virtual&nbsp;functions,<br>
no&nbsp;virtual&nbsp;base&nbsp;classes,<br>
and&nbsp;no&nbsp;non-empty&nbsp;non-virtual&nbsp;base&nbsp;classes.<br>
Define&nbsp;a&nbsp;nearly&nbsp;empty&nbsp;object&nbsp;as&nbsp;one&nbsp;which&nbsp;contains&nbsp;only&nbsp;a&nbsp;Vptr.<br>
The&nbsp;above&nbsp;resolution&nbsp;is&nbsp;accepted,&nbsp;restated&nbsp;as&nbsp;follows:<br>
<br>
&lt;p&gt;<br>
Any&nbsp;number&nbsp;of&nbsp;empty&nbsp;virtual&nbsp;base&nbsp;subobjects<br>
(rare,&nbsp;because&nbsp;they&nbsp;cannot&nbsp;have&nbsp;virtual&nbsp;functions&nbsp;or&nbsp;bases&nbsp;themselves)<br>
will&nbsp;be&nbsp;placed&nbsp;at&nbsp;offset&nbsp;zero,&nbsp;subject&nbsp;to&nbsp;the&nbsp;conflict&nbsp;rules&nbsp;in&nbsp;A-3<br>
(i.e.&nbsp;this&nbsp;cannot&nbsp;result&nbsp;in&nbsp;two&nbsp;objects&nbsp;of&nbsp;the&nbsp;same&nbsp;type&nbsp;at&nbsp;the&nbsp;same<br>
address).<br>
If&nbsp;there&nbsp;are&nbsp;no&nbsp;non-virtual&nbsp;polymorphic&nbsp;base&nbsp;subobjects,<br>
the&nbsp;first&nbsp;nearly&nbsp;empty&nbsp;virtual&nbsp;base&nbsp;subobject&nbsp;will&nbsp;be&nbsp;placed&nbsp;at&nbsp;offset&nbsp;zero.<br>
Any&nbsp;virtual&nbsp;base&nbsp;subobjects&nbsp;not&nbsp;thus&nbsp;placed&nbsp;at&nbsp;offset&nbsp;zero&nbsp;will&nbsp;be<br>
allocated&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;class,<br>
in&nbsp;left-to-right,&nbsp;depth-first&nbsp;declaration&nbsp;order.<br>
<br>
&lt;p&gt;<br>
&lt;table&nbsp;border=on&nbsp;cellpadding=3&gt;<br>
<br>
&lt;tr&gt;<br>
&lt;th&gt;&nbsp;#&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Issue&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Class&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Status&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Source&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Opened&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Closed&nbsp;&lt;/th&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;A-4&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Empty&nbsp;base&nbsp;classes&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;data&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;closed&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;SGI&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990520&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990624&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Summary&lt;/b&gt;:<br>
Where&nbsp;are&nbsp;empty&nbsp;base&nbsp;classes&nbsp;allocated?<br>
(An&nbsp;empty&nbsp;base&nbsp;class&nbsp;is&nbsp;one&nbsp;with&nbsp;no&nbsp;non-static&nbsp;data&nbsp;members,<br>
no&nbsp;virtual&nbsp;functions,&nbsp;no&nbsp;virtual&nbsp;base&nbsp;classes,<br>
and&nbsp;no&nbsp;non-empty&nbsp;non-virtual&nbsp;base&nbsp;classes.)<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990624&nbsp;All]&lt;/font&gt;<br>
Closed&nbsp;as&nbsp;a&nbsp;duplicate&nbsp;of&nbsp;A-3.<br>
<br>
&lt;tr&gt;<br>
&lt;th&gt;&nbsp;#&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Issue&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Class&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Status&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Source&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Opened&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Closed&nbsp;&lt;/th&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;A-8&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;(Virtual)&nbsp;base&nbsp;class&nbsp;alignment&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;data&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;closed&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;HP&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990603&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990624&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Summary&lt;/b&gt;:<br>
A&nbsp;(virtual)&nbsp;base&nbsp;class&nbsp;may&nbsp;have&nbsp;a&nbsp;larger&nbsp;alignment&nbsp;constraint&nbsp;than&nbsp;a<br>
derived&nbsp;class.<br>
Do&nbsp;we&nbsp;agree&nbsp;to&nbsp;extend&nbsp;the&nbsp;alignment&nbsp;constraint&nbsp;to&nbsp;the&nbsp;derived&nbsp;class?<br>
(An&nbsp;alternative&nbsp;for&nbsp;virtual&nbsp;bases:<br>
allow&nbsp;the&nbsp;virtual&nbsp;base&nbsp;to&nbsp;move&nbsp;in&nbsp;the&nbsp;complete&nbsp;object.)<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990623&nbsp;SGI]&lt;/font&gt;<br>
We&nbsp;propose&nbsp;that&nbsp;the&nbsp;alignment&nbsp;of&nbsp;a&nbsp;class&nbsp;be&nbsp;the&nbsp;maximum&nbsp;alignment&nbsp;of<br>
its&nbsp;virtual&nbsp;and&nbsp;non-virtual&nbsp;base&nbsp;classes,<br>
non-static&nbsp;data&nbsp;members,&nbsp;and&nbsp;Vptr&nbsp;if&nbsp;any.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990624&nbsp;All]&lt;/font&gt;<br>
Above&nbsp;proposal&nbsp;accepted.<br>
(SGI&nbsp;observation:<br>
the&nbsp;size&nbsp;of&nbsp;the&nbsp;class&nbsp;is&nbsp;rounded&nbsp;up&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;this&nbsp;alignment,<br>
per&nbsp;the&nbsp;underlying&nbsp;psABI&nbsp;rules.)<br>
<br>
&lt;p&gt;<br>
&lt;table&nbsp;border=on&nbsp;cellpadding=3&gt;<br>
<br>
&lt;tr&gt;<br>
&lt;th&gt;&nbsp;#&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Issue&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Class&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Status&nbsp;&lt;/th&gt;<br>
&lt;th&gt;&nbsp;Source&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Opened&nbsp;&lt;/th&gt;&nbsp;&lt;th&gt;&nbsp;Closed&nbsp;&lt;/th&gt;<br>
&lt;/tr&gt;<br>
<br>
&lt;tr&gt;&nbsp;&lt;td&gt;&nbsp;A-9&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;Sorting&nbsp;fields&nbsp;as&nbsp;allowed&nbsp;by&nbsp;[class.mem]/12&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;data&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;closed&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;HP&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990603&nbsp;&lt;/td&gt;<br>
&lt;td&gt;&nbsp;990624&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&gt;&nbsp;&lt;td&nbsp;colspan=7&gt;<br>
&lt;b&gt;Summary&lt;/b&gt;:<br>
The&nbsp;standard&nbsp;constrains&nbsp;ordering&nbsp;of&nbsp;class&nbsp;members&nbsp;in&nbsp;memory&nbsp;only&nbsp;if<br>
they&nbsp;are&nbsp;not&nbsp;separated&nbsp;by&nbsp;an&nbsp;access&nbsp;clause.<br>
Do&nbsp;we&nbsp;use&nbsp;an&nbsp;access&nbsp;clause&nbsp;as&nbsp;an&nbsp;opportunity&nbsp;to&nbsp;fill&nbsp;the&nbsp;gaps&nbsp;left&nbsp;by&nbsp;padding?<br>
&lt;/td&gt;&nbsp;&lt;/tr&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990610&nbsp;all]&lt;/font&gt;<br>
Some&nbsp;participants&nbsp;want&nbsp;to&nbsp;avoid&nbsp;attempts&nbsp;to&nbsp;reorder&nbsp;members&nbsp;differently<br>
than&nbsp;the&nbsp;underlying&nbsp;C&nbsp;struct&nbsp;ABI&nbsp;rules.<br>
Others&nbsp;think&nbsp;there&nbsp;may&nbsp;be&nbsp;benefit&nbsp;in&nbsp;reordering&nbsp;later&nbsp;access&nbsp;sections<br>
to&nbsp;fill&nbsp;holes&nbsp;in&nbsp;earlier&nbsp;ones,&nbsp;or&nbsp;even&nbsp;in&nbsp;base&nbsp;classes.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990617&nbsp;all]&lt;/font&gt;<br>
There&nbsp;are&nbsp;several&nbsp;potential&nbsp;reordering&nbsp;questions,&nbsp;more&nbsp;or&nbsp;less&nbsp;independent:<br>
&lt;ol&gt;<br>
&lt;li&gt;&nbsp;Do&nbsp;we&nbsp;reorder&nbsp;whole&nbsp;access&nbsp;regions&nbsp;relative&nbsp;to&nbsp;one&nbsp;another?<br>
&lt;li&gt;&nbsp;Do&nbsp;we&nbsp;attempt&nbsp;to&nbsp;fill&nbsp;padding&nbsp;in&nbsp;earlier&nbsp;access&nbsp;regions&nbsp;with<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initial&nbsp;members&nbsp;from&nbsp;later&nbsp;regions?<br>
&lt;li&gt;&nbsp;Do&nbsp;we&nbsp;fill&nbsp;the&nbsp;tail&nbsp;padding&nbsp;of&nbsp;non-POD&nbsp;base&nbsp;classes&nbsp;with&nbsp;members&nbsp;from<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;current&nbsp;class?<br>
&lt;li&gt;&nbsp;Do&nbsp;we&nbsp;attempt&nbsp;to&nbsp;fill&nbsp;interior&nbsp;padding&nbsp;of&nbsp;non-POD&nbsp;base&nbsp;classes&nbsp;with&nbsp;later<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;members?<br>
&lt;/ol&gt;<br>
<br>
&lt;p&gt;<br>
There&nbsp;is&nbsp;no&nbsp;apparent&nbsp;support&nbsp;for&nbsp;(1),<br>
since&nbsp;no&nbsp;simple&nbsp;heuristic&nbsp;has&nbsp;been&nbsp;identified&nbsp;with&nbsp;obvious&nbsp;benefits.<br>
There&nbsp;is&nbsp;interest&nbsp;in&nbsp;(2),&nbsp;based&nbsp;on&nbsp;a&nbsp;simple&nbsp;heuristic&nbsp;which&nbsp;might<br>
sometimes&nbsp;help&nbsp;and&nbsp;will&nbsp;never&nbsp;hurt.<br>
However,&nbsp;it&nbsp;is&nbsp;not&nbsp;clear&nbsp;that&nbsp;it&nbsp;will&nbsp;help&nbsp;much,<br>
and&nbsp;Sun&nbsp;objects&nbsp;on&nbsp;grounds&nbsp;that&nbsp;they&nbsp;prefer&nbsp;to&nbsp;match&nbsp;C&nbsp;struct&nbsp;layout.<br>
Unless&nbsp;someone&nbsp;is&nbsp;interested&nbsp;enough&nbsp;to&nbsp;implement&nbsp;and&nbsp;run&nbsp;experiments,<br>
this&nbsp;will&nbsp;be&nbsp;hard&nbsp;to&nbsp;agree&nbsp;upon.<br>
G++&nbsp;has&nbsp;implemented&nbsp;(3)&nbsp;as&nbsp;an&nbsp;option,<br>
based&nbsp;on&nbsp;specific&nbsp;user&nbsp;complaints.<br>
It&nbsp;clearly&nbsp;helps&nbsp;HP's&nbsp;example&nbsp;of&nbsp;a&nbsp;base&nbsp;class&nbsp;containing&nbsp;a&nbsp;word&nbsp;and&nbsp;flag,<br>
with&nbsp;a&nbsp;derived&nbsp;class&nbsp;adding&nbsp;more&nbsp;flags.<br>
Idea&nbsp;(4)&nbsp;has&nbsp;more&nbsp;problems,&nbsp;including&nbsp;some&nbsp;non-intuitive&nbsp;(to&nbsp;users)&nbsp;layouts,<br>
and&nbsp;possibly&nbsp;complicating&nbsp;the&nbsp;selection&nbsp;of&nbsp;bitwise&nbsp;copy&nbsp;in&nbsp;the&nbsp;compiler.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990624&nbsp;all]&lt;/font&gt;<br>
We&nbsp;will&nbsp;not&nbsp;do&nbsp;(1),&nbsp;(2),&nbsp;or&nbsp;(4).&nbsp;&nbsp;We&nbsp;will&nbsp;do&nbsp;(3).<br>
Specifically,&nbsp;allocation&nbsp;will&nbsp;be&nbsp;in&nbsp;modified&nbsp;declaration&nbsp;order&nbsp;as&nbsp;follows:<br>
&lt;ol&gt;<br>
&lt;li&gt;&nbsp;Vptr&nbsp;if&nbsp;any,&nbsp;and&nbsp;the&nbsp;primary&nbsp;base&nbsp;class&nbsp;per&nbsp;A-7.<br>
&lt;li&gt;&nbsp;Any&nbsp;empty&nbsp;base&nbsp;classes&nbsp;allocated&nbsp;at&nbsp;offset&nbsp;zero&nbsp;per&nbsp;A-3.<br>
&lt;li&gt;&nbsp;Any&nbsp;remaining&nbsp;non-virtual&nbsp;base&nbsp;classes.<br>
&lt;li&gt;&nbsp;Any&nbsp;non-static&nbsp;data&nbsp;members.<br>
&lt;li&gt;&nbsp;Any&nbsp;remaining&nbsp;virtual&nbsp;base&nbsp;classes.<br>
&lt;/ol&gt;<br>
Each&nbsp;subobject&nbsp;allocated&nbsp;is&nbsp;placed&nbsp;at&nbsp;the&nbsp;next&nbsp;available&nbsp;position&nbsp;that<br>
satisfies&nbsp;its&nbsp;alignment&nbsp;constraints,&nbsp;as&nbsp;in&nbsp;the&nbsp;underlying&nbsp;psABI.<br>
This&nbsp;is&nbsp;interpreted&nbsp;with&nbsp;the&nbsp;following&nbsp;special&nbsp;cases:<br>
&lt;ol&gt;<br>
&lt;li&gt;&nbsp;The&nbsp;&quot;next&nbsp;available&nbsp;position&quot;&nbsp;after&nbsp;a&nbsp;class&nbsp;subobject<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(base&nbsp;class&nbsp;or&nbsp;data&nbsp;member)&nbsp;with&nbsp;tail&nbsp;padding&nbsp;is&nbsp;at&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beginning&nbsp;of&nbsp;the&nbsp;tail&nbsp;padding,&nbsp;not&nbsp;after&nbsp;it.<br>
&lt;li&gt;&nbsp;Empty&nbsp;classes&nbsp;are&nbsp;considered&nbsp;to&nbsp;have&nbsp;alignment&nbsp;and&nbsp;size&nbsp;1,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;consisting&nbsp;solely&nbsp;of&nbsp;one&nbsp;byte&nbsp;of&nbsp;tail&nbsp;padding.<br>
&lt;li&gt;&nbsp;Placement&nbsp;on&nbsp;top&nbsp;of&nbsp;the&nbsp;tail&nbsp;padding&nbsp;of&nbsp;an&nbsp;empty&nbsp;class&nbsp;must&nbsp;avoid<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;placing&nbsp;multiple&nbsp;subobjects&nbsp;of&nbsp;the&nbsp;same&nbsp;type&nbsp;at&nbsp;the&nbsp;same<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;address.<br>
&lt;/ol&gt;<br>
After&nbsp;allocation&nbsp;is&nbsp;complete,<br>
the&nbsp;size&nbsp;is&nbsp;rounded&nbsp;up&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;alignment&nbsp;(with&nbsp;tail&nbsp;padding).<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;B.&nbsp;&nbsp;Virtual&nbsp;Function&nbsp;Handling&nbsp;Issues&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;C.&nbsp;&nbsp;Object&nbsp;Construction/Destruction&nbsp;Issues&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;D.&nbsp;&nbsp;Exception&nbsp;Handling&nbsp;Issues&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;E.&nbsp;&nbsp;Template&nbsp;Instantiation&nbsp;Model&nbsp;Issues&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;F.&nbsp;&nbsp;Name&nbsp;Mangling&nbsp;Issues&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;G.&nbsp;&nbsp;Miscellaneous&nbsp;Issues&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h3&gt;&nbsp;H.&nbsp;&nbsp;Library&nbsp;Interface&nbsp;Issues&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
&lt;hr&gt;<br>
<br>
&lt;p&gt;<br>
Please&nbsp;send&nbsp;corrections&nbsp;to&nbsp;&lt;a&nbsp;href=mailto:dehnert@sgi.com&gt;Jim&nbsp;Dehnert&lt;/a&gt;.<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>

</tt>

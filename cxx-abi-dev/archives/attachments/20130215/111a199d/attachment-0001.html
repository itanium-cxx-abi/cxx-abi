<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;On&nbsp;Fri,&nbsp;Feb&nbsp;15,&nbsp;2013&nbsp;at&nbsp;5:38&nbsp;PM,&nbsp;John&nbsp;McCall&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:rjmccall@apple.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rjmccall@apple.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;Richard&nbsp;Smith&nbsp;has&nbsp;pointed&nbsp;out&nbsp;to&nbsp;me&nbsp;that&nbsp;the&nbsp;ABI&nbsp;document&nbsp;currently&nbsp;states,&nbsp;right&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;section&nbsp;2.5:&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
 &nbsp;A&nbsp;virtual&nbsp;table&nbsp;(vtable)&nbsp;is&nbsp;a&nbsp;table&nbsp;of&nbsp;information&nbsp;used&nbsp;to&nbsp;dispatch&nbsp;virtual&nbsp;functions,&nbsp;to&nbsp;access&nbsp;virtual&nbsp;base&nbsp;class&nbsp;subobjects,&nbsp;and&nbsp;to&nbsp;access&nbsp;information&nbsp;for&nbsp;runtime&nbsp;type&nbsp;identification&nbsp;(RTTI).&nbsp;Each&nbsp;class&nbsp;that&nbsp;has&nbsp;virtual&nbsp;member&nbsp;functions&nbsp;or&nbsp;virtual&nbsp;bases&nbsp;has&nbsp;an&nbsp;associated&nbsp;set&nbsp;of&nbsp;virtual&nbsp;tables.&nbsp;There&nbsp;may&nbsp;be&nbsp;multiple&nbsp;virtual&nbsp;tables&nbsp;for&nbsp;a&nbsp;particular&nbsp;class,&nbsp;if&nbsp;it&nbsp;is&nbsp;used&nbsp;as&nbsp;a&nbsp;base&nbsp;class&nbsp;for&nbsp;other&nbsp;classes.&nbsp;However,&nbsp;the&nbsp;virtual&nbsp;table&nbsp;pointers&nbsp;within&nbsp;all&nbsp;the&nbsp;objects&nbsp;(instances)&nbsp;of&nbsp;a&nbsp;particular&nbsp;most-derived&nbsp;class&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;set&nbsp;of&nbsp;virtual&nbsp;tables.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
This&nbsp;last&nbsp;sentence&nbsp;could&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;strict&nbsp;requirement&nbsp;that&nbsp;all&nbsp;objects&nbsp;of&nbsp;a&nbsp;most-derived&nbsp;class&nbsp;use&nbsp;the&nbsp;same&nbsp;v-table,&nbsp;as&nbsp;opposed&nbsp;to&nbsp;potentially&nbsp;a&nbsp;private&nbsp;copy&nbsp;of&nbsp;that&nbsp;v-table.&lt;br&gt;<br>
&lt;br&gt;<br>
While&nbsp;it&nbsp;is&nbsp;obviously&nbsp;good&nbsp;to&nbsp;avoid&nbsp;redundant&nbsp;copies&nbsp;of&nbsp;a&nbsp;v-table&nbsp;in&nbsp;memory,&nbsp;an&nbsp;unconditional&nbsp;requirement&nbsp;to&nbsp;do&nbsp;so&nbsp;seems&nbsp;excessive.&nbsp; Uniquing&nbsp;a&nbsp;symbol&nbsp;with&nbsp;vague&nbsp;linkage&nbsp;across&nbsp;dynamic-library&nbsp;boundaries&nbsp;may&nbsp;require&nbsp;a&nbsp;significant&nbsp;amount&nbsp;of&nbsp;work,&nbsp;probably&nbsp;at&nbsp;load&nbsp;time&nbsp;but&nbsp;at&nbsp;best&nbsp;at&nbsp;the&nbsp;first&nbsp;use&nbsp;of&nbsp;the&nbsp;symbol&nbsp;(a&nbsp;sort&nbsp;of&nbsp;laziness&nbsp;which&nbsp;would&nbsp;carry&nbsp;its&nbsp;own&nbsp;disadvantages).&nbsp; This&nbsp;work&nbsp;is&nbsp;required&nbsp;for&nbsp;the&nbsp;RTTI&nbsp;symbol&nbsp;name&nbsp;(_ZTS*)&nbsp;in&nbsp;order&nbsp;to&nbsp;make&nbsp;RTTI&nbsp;comparison&nbsp;work,&nbsp;but&nbsp;it&nbsp;is&nbsp;not&nbsp;otherwise&nbsp;mandatory&nbsp;for&nbsp;the&nbsp;RTTI&nbsp;object&nbsp;(_ZTI*)&nbsp;or&nbsp;v-tables&nbsp;(_ZTV*)&nbsp;or&nbsp;VTT&nbsp;(_ZTT*).&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;It&nbsp;is&nbsp;currently&nbsp;mandatory&nbsp;for&nbsp;the&nbsp;_ZTI,&nbsp;per&nbsp;2.9.1:&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&quot;It&nbsp;is&nbsp;intended&nbsp;that&nbsp;two&nbsp;type_info&nbsp;pointers&nbsp;point&nbsp;to&nbsp;equivalent&nbsp;type&nbsp;descriptions&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;the&nbsp;pointers&nbsp;are&nbsp;equal.&nbsp;An&nbsp;implementation&nbsp;must&nbsp;satisfy&nbsp;this&nbsp;constraint,&nbsp;e.g.&nbsp;by&nbsp;using&nbsp;symbol&nbsp;preemption,&nbsp;COMDAT&nbsp;sections,&nbsp;or&nbsp;other&nbsp;mechanisms.&quot;&lt;br&gt;<br>
 &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;<br>
In&nbsp;practice,&nbsp;it&nbsp;is&nbsp;quite&nbsp;common&nbsp;for&nbsp;compilers&nbsp;to&nbsp;implement&nbsp;optimizations&nbsp;that&nbsp;decrease&nbsp;the&nbsp;visibility&nbsp;of&nbsp;symbols&nbsp;when&nbsp;the&nbsp;uses&nbsp;of&nbsp;them&nbsp;are&nbsp;not&nbsp;address-sensitive,&nbsp;or&nbsp;as&nbsp;requested&nbsp;by&nbsp;users.&nbsp; I&nbsp;would&nbsp;hate&nbsp;for&nbsp;this&nbsp;to&nbsp;be&nbsp;a&nbsp;violation&nbsp;of&nbsp;the&nbsp;ABI.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
I&nbsp;propose&nbsp;changing&nbsp;(clarifying?)&nbsp;this&nbsp;paragraph&nbsp;to&nbsp;conclude&nbsp;as&nbsp;follows:&lt;br&gt;<br>
 &nbsp;However,&nbsp;the&nbsp;virtual&nbsp;table&nbsp;pointers&nbsp;within&nbsp;all&nbsp;the&nbsp;objects&nbsp;(instances)&nbsp;of&nbsp;a&nbsp;particular&nbsp;most-derived&nbsp;class&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;**logical**&nbsp;set&nbsp;of&nbsp;virtual&nbsp;tables,&nbsp;**although&nbsp;they&nbsp;need&nbsp;not&nbsp;in&nbsp;fact&nbsp;have&nbsp;pointer-equivalent&nbsp;addresses&nbsp;or&nbsp;contents**.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
I&nbsp;say&nbsp;&quot;contents&quot;&nbsp;because&nbsp;referencing&nbsp;a&nbsp;function&nbsp;in&nbsp;a&nbsp;v-table&nbsp;is&nbsp;not&nbsp;an&nbsp;address-sensitive&nbsp;use&nbsp;of&nbsp;it.&nbsp; In&nbsp;fact,&nbsp;it&nbsp;is&nbsp;impossible&nbsp;to&nbsp;construct&nbsp;an&nbsp;address-sensitive&nbsp;use&nbsp;of&nbsp;a&nbsp;virtual&nbsp;function&nbsp;in&nbsp;standard&nbsp;C++,&nbsp;since&nbsp;pointer-to-members&nbsp;for&nbsp;virtual&nbsp;functions&nbsp;refer&nbsp;to&nbsp;the&nbsp;virtual&nbsp;&quot;slot&quot;,&nbsp;not&nbsp;the&nbsp;concrete&nbsp;implementation.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
John.&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
cxx-abi-dev&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:cxx-abi-dev@codesourcery.com&quot;&gt;cxx-abi-dev@codesourcery.com&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://sourcerytools.com/cgi-bin/mailman/listinfo/cxx-abi-dev&quot;&nbsp;target=&quot;_blank&quot;&gt;http://sourcerytools.com/cgi-bin/mailman/listinfo/cxx-abi-dev&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>

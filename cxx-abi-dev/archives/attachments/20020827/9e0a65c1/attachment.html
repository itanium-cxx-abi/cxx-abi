<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt;<br>
&lt;HTML&gt;<br>
<br>
&lt;HEAD&gt;<br>
&lt;title&gt;C++&nbsp;ABI&nbsp;for&nbsp;Itanium&nbsp;(Draft)&nbsp;&lt;/title&gt;<br>
<br>
&lt;link&nbsp;rel=stylesheet&nbsp;href=small-table.css&nbsp;type=&quot;text/css&quot;&gt;<br>
&lt;link&nbsp;rel=stylesheet&nbsp;href=code.css&nbsp;type=&quot;text/css&quot;&gt;<br>
<br>
&lt;hr&gt;<br>
<br>
&lt;font&nbsp;size=6&gt;&lt;i&gt;&lt;b&gt;<br>
&lt;p&gt;<br>
C++&nbsp;ABI&nbsp;for&nbsp;Itanium&nbsp;(Draft)<br>
&lt;/b&gt;&lt;/i&gt;&lt;/font&gt;<br>
<br>
&lt;font&nbsp;size=-1&gt;<br>
&lt;p&gt;<br>
&lt;i&gt;Revised&nbsp;20&nbsp;March&nbsp;2001&lt;/i&gt;<br>
<br>
&lt;/center&gt;<br>
<br>
&lt;/HEAD&gt;<br>
<br>
&lt;BODY&gt;<br>
<br>
<br>
&lt;!--&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSTRUCTIONS&nbsp;FOR&nbsp;MAKING&nbsp;REVISIONS&nbsp;TO&nbsp;THIS&nbsp;DOCUMENT<br>
<br>
&nbsp;&nbsp;Recent&nbsp;revisions&nbsp;are&nbsp;marked&nbsp;with&nbsp;&lt;div&nbsp;class=&quot;change&quot;&gt;&nbsp;or&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;change&quot;&gt;&nbsp;elements.&nbsp;&nbsp;Deleted&nbsp;text&nbsp;is&nbsp;placed&nbsp;in&nbsp;a<br>
&nbsp;&nbsp;&lt;strike&gt;&nbsp;element.<br>
<br>
&nbsp;&nbsp;&nbsp;1.&nbsp;Find&nbsp;previous&nbsp;recent&nbsp;revisions&nbsp;by&nbsp;searching&nbsp;for&nbsp;class=&quot;change&quot;.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove&nbsp;&lt;div&gt;&nbsp;and&nbsp;&lt;span&gt;&nbsp;tags,&nbsp;and&nbsp;entire&nbsp;&lt;strike&gt;&nbsp;elements.<br>
<br>
&nbsp;&nbsp;&nbsp;2.&nbsp;Merge&nbsp;revisions.&nbsp;&nbsp;Place&nbsp;new&nbsp;text&nbsp;in&nbsp;&lt;div&gt;&nbsp;and&nbsp;&lt;span&gt;&nbsp;elements.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Place&nbsp;deleted&nbsp;text&nbsp;in&nbsp;&lt;strike&gt;&nbsp;elements&nbsp;rather&nbsp;than&nbsp;deleting<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;outright.<br>
<br>
&nbsp;&nbsp;&nbsp;3.&nbsp;Add&nbsp;a&nbsp;summary&nbsp;of&nbsp;the&nbsp;revision&nbsp;to&nbsp;the&nbsp;revision&nbsp;history&nbsp;at&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;of&nbsp;the&nbsp;document.<br>
<br>
-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;--&gt;<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;h2&gt;&nbsp;Contents&nbsp;&lt;/h2&gt;<br>
<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;&lt;a&nbsp;href=#intro&gt;&nbsp;Chapter&nbsp;1:&nbsp;Introduction&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#definitions&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.1&nbsp;Definitions&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#limits&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2&nbsp;Limits&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#namespace&gt;&nbsp;&nbsp;1.3&nbsp;Namespace&nbsp;and&nbsp;Header&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#scope&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.4&nbsp;Scope&nbsp;of&nbsp;This&nbsp;ABI&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#docs&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.5&nbsp;Base&nbsp;Documents&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;/ul&gt;<br>
&lt;li&gt;&nbsp;&lt;a&nbsp;href=#layout&gt;&nbsp;Chapter&nbsp;2:&nbsp;Data&nbsp;Layout&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#general&gt;&nbsp;&nbsp;&nbsp;&nbsp;2.1&nbsp;General&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#pod&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2&nbsp;POD&nbsp;Data&nbsp;Types&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#member-pointers&gt;&nbsp;2.3&nbsp;Member&nbsp;Pointers&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#class-types&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4&nbsp;Non-POD&nbsp;Class&nbsp;Types&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#vtable&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.5&nbsp;Virtual&nbsp;Table&nbsp;Layout&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#vtable-ctor&gt;&nbsp;2.6&nbsp;Virtual&nbsp;Tables&nbsp;During&nbsp;Object&nbsp;Construction&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#array-cookies&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.7&nbsp;Array&nbsp;Operator&nbsp;&lt;code&gt;new&lt;/code&gt;&nbsp;Cookies&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#guards&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.8&nbsp;Initialization&nbsp;Guard&nbsp;Variables&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#rtti&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.9&nbsp;Run-Time&nbsp;Type&nbsp;Information&nbsp;(RTTI)&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;/ul&gt;<br>
&lt;li&gt;&nbsp;&lt;a&nbsp;href=#calls&gt;&nbsp;Chapter&nbsp;3:&nbsp;Function&nbsp;Calling&nbsp;Conventions&nbsp;and&nbsp;APIs&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#normal-call&gt;&nbsp;3.1&nbsp;Non-virtual&nbsp;Function&nbsp;Calling&nbsp;Conventions&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#vcall&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2&nbsp;Virtual&nbsp;Function&nbsp;Calling&nbsp;Conventions&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#obj-ctor&gt;&nbsp;&nbsp;&nbsp;&nbsp;3.3&nbsp;Construction&nbsp;and&nbsp;Destruction&nbsp;APIs&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#demangler&gt;&nbsp;&nbsp;&nbsp;3.4&nbsp;Demangler&nbsp;API&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;/ul&gt;<br>
&lt;li&gt;&nbsp;&lt;a&nbsp;href=abi-eh.html&gt;&nbsp;Chapter&nbsp;4:&nbsp;Exception&nbsp;Handling&nbsp;&lt;/a&gt;<br>
&lt;li&gt;&nbsp;&lt;a&nbsp;href=#linkage&gt;&nbsp;Chapter&nbsp;5:&nbsp;Linkage&nbsp;and&nbsp;Object&nbsp;Files&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#mangling&gt;&nbsp;&nbsp;&nbsp;5.1&nbsp;External&nbsp;Names&nbsp;(a.k.a.&nbsp;Mangling)&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#vague&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.2&nbsp;Vague&nbsp;Linkage&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;a&nbsp;href=#unwind&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.3&nbsp;Unwind&nbsp;Table&nbsp;Location&nbsp;&lt;/a&gt;<br>
&nbsp;&nbsp;&lt;/ul&gt;<br>
&lt;li&gt;&nbsp;&lt;a&nbsp;href=#revisions&gt;&nbsp;Appendix&nbsp;R:&nbsp;Revision&nbsp;History&lt;/a&gt;<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=intro&gt;<br>
&lt;h2&gt;&nbsp;Chapter&nbsp;1:&nbsp;Introduction&nbsp;&lt;/h2&gt;<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
<br>
In&nbsp;this&nbsp;document,&nbsp;we&nbsp;specify&nbsp;the&nbsp;Application&nbsp;Binary&nbsp;Interface&nbsp;for<br>
C++&nbsp;programs,<br>
that&nbsp;is,&nbsp;the&nbsp;object&nbsp;code&nbsp;interfaces&nbsp;between&nbsp;user&nbsp;C++&nbsp;code&nbsp;and&nbsp;the<br>
implementation-provided&nbsp;system&nbsp;and&nbsp;libraries.<br>
This&nbsp;includes&nbsp;the&nbsp;memory&nbsp;layout&nbsp;for&nbsp;C++&nbsp;data&nbsp;objects,<br>
including&nbsp;both&nbsp;predefined&nbsp;and&nbsp;user-defined&nbsp;data&nbsp;types,<br>
as&nbsp;well&nbsp;as&nbsp;internal&nbsp;compiler&nbsp;generated&nbsp;objects&nbsp;such&nbsp;as&nbsp;virtual&nbsp;tables.<br>
It&nbsp;also&nbsp;includes&nbsp;function&nbsp;calling&nbsp;interfaces,<br>
exception&nbsp;handling&nbsp;interfaces,<br>
global&nbsp;naming,<br>
and&nbsp;various&nbsp;object&nbsp;code&nbsp;conventions.<br>
<br>
&lt;p&gt;<br>
In&nbsp;general,&nbsp;this&nbsp;document&nbsp;is&nbsp;written&nbsp;as&nbsp;a&nbsp;generic&nbsp;specification,<br>
to&nbsp;be&nbsp;usable&nbsp;by&nbsp;C++&nbsp;implementations&nbsp;on&nbsp;a&nbsp;variety&nbsp;of&nbsp;architectures.<br>
However,&nbsp;it&nbsp;does&nbsp;contain&nbsp;processor-specific&nbsp;material&nbsp;for&nbsp;the&nbsp;Itanium<br>
64-bit&nbsp;ABI,&nbsp;identified&nbsp;as&nbsp;such.<br>
Where&nbsp;structured&nbsp;data&nbsp;layout&nbsp;is&nbsp;described,<br>
we&nbsp;generally&nbsp;assume&nbsp;Itanium&nbsp;psABI&nbsp;member&nbsp;sizes.<br>
An&nbsp;implementation&nbsp;for&nbsp;a&nbsp;32-bit&nbsp;ABI&nbsp;would&nbsp;typically&nbsp;just&nbsp;change&nbsp;the<br>
sizes&nbsp;of&nbsp;members&nbsp;as&nbsp;appropriate<br>
(i.e.&nbsp;pointers&nbsp;and&nbsp;long&nbsp;ints&nbsp;would&nbsp;become&nbsp;32&nbsp;bits),<br>
but&nbsp;sometimes&nbsp;an&nbsp;order&nbsp;change&nbsp;would&nbsp;be&nbsp;required&nbsp;for&nbsp;compactness,<br>
and&nbsp;we&nbsp;note&nbsp;more&nbsp;substantive&nbsp;changes.<br>
<br>
&lt;p&gt;<br>
This&nbsp;document&nbsp;is&nbsp;a&nbsp;work&nbsp;in&nbsp;progress,<br>
still&nbsp;being&nbsp;changed&nbsp;on&nbsp;a&nbsp;regular&nbsp;basis.<br>
In&nbsp;general,&nbsp;text&nbsp;appearing&nbsp;in&nbsp;this&nbsp;document&nbsp;in&nbsp;color&nbsp;is&nbsp;either<br>
tentative&nbsp;wording&nbsp;of&nbsp;agreements,<br>
or&nbsp;proposals&nbsp;not&nbsp;yet&nbsp;agreed&nbsp;upon,<br>
and&nbsp;should&nbsp;be&nbsp;taken&nbsp;as&nbsp;more&nbsp;subject&nbsp;to&nbsp;change&nbsp;than&nbsp;black&nbsp;material.<br>
Red&nbsp;text&nbsp;will&nbsp;generally&nbsp;remain&nbsp;red&nbsp;until&nbsp;the&nbsp;next&nbsp;group&nbsp;meeting<br>
provides&nbsp;an&nbsp;opportunity&nbsp;to&nbsp;comment.<br>
If&nbsp;problems&nbsp;are&nbsp;noticed,<br>
they&nbsp;should&nbsp;be&nbsp;reported&nbsp;to&nbsp;the<br>
&lt;a&nbsp;href=mailto:cxx-abi@corp.sgi.com&gt;C++&nbsp;ABI&nbsp;Group&lt;/a&gt;<br>
as&nbsp;soon&nbsp;as&nbsp;possible.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;<br>
Note&nbsp;that&nbsp;the&nbsp;body&nbsp;of&nbsp;this&nbsp;document&nbsp;makes&nbsp;free&nbsp;use&nbsp;of&nbsp;a&nbsp;number&nbsp;of&nbsp;terms<br>
which&nbsp;are&nbsp;defined&nbsp;in&nbsp;the&nbsp;&lt;i&gt;&lt;b&gt;Definitions&lt;/b&gt;&lt;/i&gt;&nbsp;section&nbsp;below.<br>
&lt;/font&gt;<br>
<br>
&lt;!--<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;Outstanding&nbsp;Questions&nbsp;&lt;/h4&gt;<br>
&lt;font&nbsp;color=red&gt;<br>
&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;&lt;/ul&gt;<br>
&lt;/font&gt;<br>
--&gt;<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;Recent&nbsp;Revisions&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[001110]&lt;/font&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[001103]&lt;/font&gt;<br>
Fix&nbsp;class&nbsp;layout&nbsp;oversights&nbsp;for&nbsp;data&nbsp;members&nbsp;(2.4).<br>
Update&nbsp;requirements&nbsp;for&nbsp;RTTI&nbsp;layout&nbsp;(2.9.5).<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[001002]&lt;/font&gt;<br>
Updates&nbsp;from&nbsp;28&nbsp;September&nbsp;meeting.<br>
Tighten&nbsp;RTTI&nbsp;specification&nbsp;for&nbsp;portability&nbsp;(2.9.5).<br>
Don't&nbsp;mangle&nbsp;result&nbsp;types&nbsp;for&nbsp;destructors&nbsp;or&nbsp;operator&nbsp;conversions&nbsp;(5.1.5).<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000905]&lt;/font&gt;<br>
Updates&nbsp;from&nbsp;31&nbsp;August&nbsp;meeting,&nbsp;email.<br>
Null&nbsp;parameters&nbsp;to&nbsp;construction/destruction&nbsp;runtimes&nbsp;(3.3.3).<br>
Mangling&nbsp;of&nbsp;numbers&nbsp;cleans&nbsp;up&nbsp;positive/non-negative&nbsp;confusion&nbsp;(5.1.x).<br>
Mangling&nbsp;of&nbsp;names&nbsp;encodes&nbsp;byte&nbsp;count&nbsp;instead&nbsp;of&nbsp;character&nbsp;count&nbsp;(5.1.2).<br>
Mangling&nbsp;of&nbsp;vendor&nbsp;extended&nbsp;operator&nbsp;names&nbsp;encodes&nbsp;operand&nbsp;count&nbsp;(5.1.3).<br>
Remove&nbsp;redundant&nbsp;template-template-arg&nbsp;productions&nbsp;(5.1.5).<br>
Move&nbsp;mangling&nbsp;examples&nbsp;table&nbsp;to&nbsp;examples&nbsp;document&nbsp;(was&nbsp;5.1.8).<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;href=#revisions&gt;Revision&nbsp;History&lt;/a&gt;<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=definitions&gt;<br>
&lt;h3&gt;&nbsp;1.1&nbsp;Definitions&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;descriptions&nbsp;below&nbsp;make&nbsp;use&nbsp;of&nbsp;the&nbsp;following&nbsp;definitions:<br>
<br>
&lt;dl&gt;<br>
<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;i&gt;alignment&lt;/i&gt;&nbsp;of&nbsp;a&nbsp;type&nbsp;T&nbsp;(or&nbsp;object&nbsp;X)&lt;/dt&gt;<br>
&lt;dd&gt;<br>
A&nbsp;value&nbsp;A&nbsp;such&nbsp;that&nbsp;any&nbsp;object&nbsp;X&nbsp;of&nbsp;type&nbsp;T&nbsp;has&nbsp;an&nbsp;address&nbsp;satisfying<br>
the&nbsp;constraint&nbsp;that&nbsp;&amp;X&nbsp;modulo&nbsp;A&nbsp;==&nbsp;0.<br>
<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;i&gt;base&nbsp;class&lt;/i&gt;&nbsp;of&nbsp;a&nbsp;class&nbsp;T&lt;/dt&gt;<br>
&lt;dd&gt;<br>
When&nbsp;this&nbsp;document&nbsp;refers&nbsp;to&nbsp;base&nbsp;classes&nbsp;of&nbsp;a&nbsp;class&nbsp;T,<br>
unless&nbsp;otherwise&nbsp;specified,<br>
it&nbsp;means&nbsp;T&nbsp;itself&nbsp;as&nbsp;well&nbsp;as&nbsp;all&nbsp;of&nbsp;the&nbsp;classes&nbsp;from&nbsp;which&nbsp;it&nbsp;is&nbsp;derived,<br>
directly&nbsp;or&nbsp;indirectly,&nbsp;virtually&nbsp;or&nbsp;non-virtually.<br>
We&nbsp;use&nbsp;the&nbsp;term&nbsp;&nbsp;&lt;i&gt;proper&nbsp;base&nbsp;class&lt;/i&gt;<br>
to&nbsp;exclude&nbsp;T&nbsp;itself&nbsp;from&nbsp;the&nbsp;list.<br>
<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;i&gt;direct&nbsp;base&nbsp;class&nbsp;order&lt;/i&gt;&nbsp;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
When&nbsp;the&nbsp;direct&nbsp;base&nbsp;classes&nbsp;of&nbsp;a&nbsp;class&nbsp;are&nbsp;viewed&nbsp;as&nbsp;an&nbsp;ordered&nbsp;set,<br>
the&nbsp;order&nbsp;assumed&nbsp;is&nbsp;the&nbsp;order&nbsp;declared,&nbsp;left-to-right.<br>
<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;i&gt;diamond-shaped&nbsp;inheritance&lt;/i&gt;&nbsp;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
A&nbsp;class&nbsp;has&nbsp;diamond-shaped&nbsp;inheritance&nbsp;iff&nbsp;it&nbsp;has&nbsp;a&nbsp;virtual&nbsp;base&nbsp;class<br>
that&nbsp;can&nbsp;be&nbsp;reached&nbsp;by&nbsp;distinct&nbsp;inheritance&nbsp;graph&nbsp;paths&nbsp;through<br>
more&nbsp;than&nbsp;one&nbsp;direct&nbsp;base.<br>
<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;i&gt;dynamic&nbsp;class&lt;/i&gt;&nbsp;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
A&nbsp;class&nbsp;requiring&nbsp;a&nbsp;virtual&nbsp;table&nbsp;pointer<br>
(because&nbsp;it&nbsp;or&nbsp;its&nbsp;bases&nbsp;have&nbsp;one&nbsp;or&nbsp;more&nbsp;virtual&nbsp;member&nbsp;functions&nbsp;or<br>
virtual&nbsp;base&nbsp;classes).<br>
<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;i&gt;empty&nbsp;class&lt;/i&gt;&nbsp;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
A&nbsp;class&nbsp;with&nbsp;no&nbsp;non-static&nbsp;data&nbsp;members&nbsp;other&nbsp;than&nbsp;zero-width&nbsp;bitfields,<br>
no&nbsp;virtual&nbsp;functions,&nbsp;no&nbsp;virtual&nbsp;base&nbsp;classes,<br>
and&nbsp;no&nbsp;non-empty&nbsp;non-virtual&nbsp;proper&nbsp;base&nbsp;classes.<br>
<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;i&gt;inheritance&nbsp;graph&lt;/i&gt;&nbsp;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
A&nbsp;graph&nbsp;with&nbsp;nodes&nbsp;representing&nbsp;a&nbsp;class&nbsp;and&nbsp;all&nbsp;of&nbsp;its&nbsp;subobjects,<br>
and&nbsp;arcs&nbsp;connecting&nbsp;each&nbsp;node&nbsp;with&nbsp;its&nbsp;direct&nbsp;bases.<br>
<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;i&gt;inheritance&nbsp;graph&nbsp;order&lt;/i&gt;&nbsp;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
The&nbsp;ordering&nbsp;on&nbsp;a&nbsp;class&nbsp;object&nbsp;and&nbsp;all&nbsp;its&nbsp;subobjects&nbsp;obtained<br>
by&nbsp;a&nbsp;depth-first&nbsp;traversal&nbsp;of&nbsp;its&nbsp;inheritance&nbsp;graph,<br>
from&nbsp;the&nbsp;most-derived&nbsp;class&nbsp;object&nbsp;to&nbsp;base&nbsp;objects,<br>
where:<br>
<br>
&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;No&nbsp;node&nbsp;is&nbsp;visited&nbsp;more&nbsp;than&nbsp;once.<br>
(So,&nbsp;a&nbsp;virtual&nbsp;base&nbsp;subobject,&nbsp;and&nbsp;all&nbsp;of&nbsp;its&nbsp;base&nbsp;subobjects,<br>
will&nbsp;be&nbsp;visited&nbsp;only&nbsp;once.)<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
The&nbsp;subobjects&nbsp;of&nbsp;a&nbsp;node&nbsp;are&nbsp;visited&nbsp;in&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;they<br>
were&nbsp;declared.<br>
(So,&nbsp;given&nbsp;&nbsp;&lt;code&gt;class&nbsp;A&nbsp;:&nbsp;public&nbsp;B,&nbsp;public&nbsp;C&lt;/code&gt;,<br>
A&nbsp;is&nbsp;walked&nbsp;first,<br>
then&nbsp;B&nbsp;and&nbsp;its&nbsp;subobjects,<br>
and&nbsp;then&nbsp;C&nbsp;and&nbsp;its&nbsp;subobjects.)<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
Note&nbsp;that&nbsp;the&nbsp;traversal&nbsp;may&nbsp;be&nbsp;preorder&nbsp;or&nbsp;postorder.<br>
Unless&nbsp;otherwise&nbsp;specified,<br>
preorder&nbsp;(derived&nbsp;classes&nbsp;before&nbsp;their&nbsp;bases)&nbsp;is&nbsp;intended.<br>
<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;i&gt;morally&nbsp;virtual&lt;/i&gt;&nbsp;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
A&nbsp;subobject&nbsp;X&nbsp;is&nbsp;a&nbsp;&lt;i&gt;morally&nbsp;virtual&lt;/i&gt;&nbsp;base&nbsp;of&nbsp;Y&nbsp;if&nbsp;X&nbsp;is&nbsp;either&nbsp;a<br>
virtual&nbsp;base&nbsp;of&nbsp;Y,&nbsp;or&nbsp;the&nbsp;direct&nbsp;or&nbsp;indirect&nbsp;base&nbsp;of&nbsp;a&nbsp;virtual&nbsp;base&nbsp;of<br>
Y.<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=q3&gt;&lt;/a&gt;<br>
&lt;dt&gt;&nbsp;&lt;i&gt;nearly&nbsp;empty&nbsp;class&lt;/i&gt;&nbsp;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
A&nbsp;class&nbsp;that&nbsp;contains&nbsp;no&nbsp;data&nbsp;except&nbsp;its&nbsp;virtual&nbsp;pointer&nbsp;(if&nbsp;any)&nbsp;or<br>
virtual&nbsp;bases.&nbsp;&nbsp;In&nbsp;particular,&nbsp;it:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;has&nbsp;no&nbsp;non-static&nbsp;data&nbsp;members&nbsp;other&nbsp;than&nbsp;zero-width&nbsp;bitfields,<br>
&lt;li&gt;&nbsp;has&nbsp;no&nbsp;direct&nbsp;base&nbsp;classes&nbsp;that&nbsp;are&nbsp;not&nbsp;either&nbsp;empty,&nbsp;nearly&nbsp;empty,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;virtual,<br>
&lt;li&gt;&nbsp;has&nbsp;at&nbsp;most&nbsp;one&nbsp;non-virtual,&nbsp;nearly&nbsp;empty&nbsp;direct&nbsp;base&nbsp;class,&nbsp;and<br>
&lt;li&gt;&nbsp;has&nbsp;no&nbsp;proper&nbsp;base&nbsp;class&nbsp;that&nbsp;is&nbsp;empty,&nbsp;not&nbsp;morally&nbsp;virtual,&nbsp;and<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at&nbsp;an&nbsp;offset&nbsp;other&nbsp;than&nbsp;zero.<br>
&lt;/ul&gt;<br>
Such&nbsp;classes&nbsp;may&nbsp;be&nbsp;primary&nbsp;base&nbsp;classes&nbsp;even&nbsp;if&nbsp;virtual,<br>
sharing&nbsp;a&nbsp;virtual&nbsp;pointer&nbsp;with&nbsp;the&nbsp;derived&nbsp;class.<br>
<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;i&gt;primary&nbsp;base&nbsp;class&lt;/i&gt;&nbsp;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
For&nbsp;a&nbsp;dynamic&nbsp;class,<br>
the&nbsp;unique&nbsp;base&nbsp;class&nbsp;(if&nbsp;any)&nbsp;with&nbsp;which&nbsp;it&nbsp;shares&nbsp;the&nbsp;virtual&nbsp;pointer<br>
at&nbsp;offset&nbsp;0.<br>
<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;i&gt;secondary&nbsp;virtual&nbsp;table&lt;/i&gt;&nbsp;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
The&nbsp;instance&nbsp;of&nbsp;a&nbsp;virtual&nbsp;table&nbsp;for&nbsp;a&nbsp;base&nbsp;class<br>
that&nbsp;is&nbsp;embedded&nbsp;in&nbsp;the&nbsp;virtual&nbsp;table&nbsp;of&nbsp;a&nbsp;class&nbsp;derived&nbsp;from&nbsp;it.<br>
<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;i&gt;thunk&lt;/i&gt;&nbsp;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
A&nbsp;segment&nbsp;of&nbsp;code&nbsp;associated&nbsp;(in&nbsp;this&nbsp;ABI)&nbsp;with&nbsp;a&nbsp;target&nbsp;function,<br>
which&nbsp;is&nbsp;called&nbsp;instead&nbsp;of&nbsp;the&nbsp;target&nbsp;function&nbsp;for&nbsp;the&nbsp;purpose&nbsp;of<br>
modifying&nbsp;parameters&nbsp;(e.g.&nbsp;&lt;code&gt;this&lt;/code&gt;)<br>
or&nbsp;other&nbsp;parts&nbsp;of&nbsp;the&nbsp;environment<br>
before&nbsp;transferring&nbsp;control&nbsp;to&nbsp;the&nbsp;target&nbsp;function,<br>
and&nbsp;possibly&nbsp;making&nbsp;further&nbsp;modifications&nbsp;after&nbsp;its&nbsp;return.<br>
A&nbsp;thunk&nbsp;may&nbsp;contain&nbsp;as&nbsp;little&nbsp;as&nbsp;an&nbsp;instruction&nbsp;to&nbsp;be&nbsp;executed&nbsp;prior&nbsp;to<br>
falling&nbsp;through&nbsp;to&nbsp;an&nbsp;immediately&nbsp;following&nbsp;target&nbsp;function,<br>
or&nbsp;it&nbsp;may&nbsp;be&nbsp;a&nbsp;full&nbsp;function&nbsp;with&nbsp;its&nbsp;own&nbsp;stack&nbsp;frame&nbsp;that&nbsp;does<br>
a&nbsp;full&nbsp;call&nbsp;to&nbsp;the&nbsp;target&nbsp;function.<br>
<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;i&gt;vague&nbsp;linkage&lt;/i&gt;&nbsp;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
The&nbsp;treatment&nbsp;of&nbsp;entities&nbsp;--<br>
e.g.&nbsp;inline&nbsp;functions,&nbsp;templates,&nbsp;virtual&nbsp;tables&nbsp;--<br>
with&nbsp;external&nbsp;linkage&nbsp;that&nbsp;can&nbsp;be<br>
defined&nbsp;in&nbsp;multiple&nbsp;translation&nbsp;units,<br>
while&nbsp;the&nbsp;ODR&nbsp;requires&nbsp;that&nbsp;the&nbsp;program<br>
behave&nbsp;as&nbsp;if&nbsp;there&nbsp;were&nbsp;only&nbsp;a&nbsp;single&nbsp;definition.<br>
<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;i&gt;virtual&nbsp;table&lt;/i&gt;&nbsp;(or&nbsp;&lt;i&gt;vtable&lt;/i&gt;)&nbsp;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
A&nbsp;dynamic&nbsp;class&nbsp;has&nbsp;an&nbsp;associated&nbsp;table<br>
(often&nbsp;several&nbsp;instances,&nbsp;but&nbsp;not&nbsp;one&nbsp;per&nbsp;object)<br>
which&nbsp;contains&nbsp;information&nbsp;about&nbsp;its&nbsp;dynamic&nbsp;attributes,<br>
e.g.&nbsp;virtual&nbsp;function&nbsp;pointers,&nbsp;virtual&nbsp;base&nbsp;class&nbsp;offsets,&nbsp;etc.<br>
<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;i&gt;virtual&nbsp;table&nbsp;group&lt;/i&gt;&nbsp;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
The&nbsp;primary&nbsp;virtual&nbsp;table&nbsp;for&nbsp;a&nbsp;class&nbsp;along&nbsp;with&nbsp;all&nbsp;of&nbsp;the&nbsp;associated<br>
secondary&nbsp;virtual&nbsp;tables&nbsp;for&nbsp;its&nbsp;proper&nbsp;base&nbsp;classes.<br>
<br>
&lt;/dl&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=limits&gt;<br>
&lt;h3&gt;&nbsp;1.2&nbsp;Limits&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
Various&nbsp;representations&nbsp;specified&nbsp;by&nbsp;this&nbsp;ABI&nbsp;impose&nbsp;limitations&nbsp;on<br>
conforming&nbsp;user&nbsp;programs.<br>
These&nbsp;include,&nbsp;for&nbsp;the&nbsp;64-bit&nbsp;Itanium&nbsp;ABI:<br>
<br>
&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
The&nbsp;offset&nbsp;of&nbsp;a&nbsp;non-virtual&nbsp;base&nbsp;subobject&nbsp;in&nbsp;the&nbsp;full&nbsp;object&nbsp;containing<br>
it&nbsp;must&nbsp;be&nbsp;representable&nbsp;by&nbsp;a&nbsp;56-bit&nbsp;signed&nbsp;integer<br>
(due&nbsp;to&nbsp;RTTI&nbsp;implementation).<br>
This&nbsp;implies&nbsp;a&nbsp;practical&nbsp;limit&nbsp;of&nbsp;2**55&nbsp;bytes&nbsp;on&nbsp;the&nbsp;size&nbsp;of&nbsp;a&nbsp;class.<br>
<br>
&lt;/ul&gt;<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=namespace&gt;<br>
&lt;h3&gt;&nbsp;1.3&nbsp;Namespace&nbsp;and&nbsp;Header&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
This&nbsp;ABI&nbsp;specifies&nbsp;a&nbsp;number&nbsp;of&nbsp;type&nbsp;and&nbsp;function&nbsp;APIs&nbsp;supplemental<br>
to&nbsp;those&nbsp;required&nbsp;by&nbsp;the&nbsp;ISO&nbsp;C++&nbsp;Standard.<br>
A&nbsp;header&nbsp;file&nbsp;named&nbsp;&lt;code&gt;cxxabi.h&lt;/code&gt;&nbsp;will&nbsp;be&nbsp;provided&nbsp;by<br>
implementations&nbsp;that&nbsp;declares&nbsp;these&nbsp;APIs.<br>
The&nbsp;reference&nbsp;header&nbsp;file&nbsp;included&nbsp;with&nbsp;this&nbsp;ABI&nbsp;definition<br>
shall&nbsp;be&nbsp;the&nbsp;authoritative&nbsp;definition&nbsp;of&nbsp;the&nbsp;APIs.<br>
<br>
&lt;p&gt;<br>
These&nbsp;APIs&nbsp;will&nbsp;be&nbsp;placed&nbsp;in&nbsp;a&nbsp;namespace&nbsp;&lt;code&gt;__cxxabiv1&lt;/code&gt;.<br>
The&nbsp;header&nbsp;file&nbsp;will&nbsp;also&nbsp;declare&nbsp;a&nbsp;namespace&nbsp;alias&nbsp;&lt;code&gt;abi&lt;/code&gt;<br>
for&nbsp;&lt;code&gt;__cxxabiv1&lt;/code&gt;.<br>
It&nbsp;is&nbsp;expected&nbsp;that&nbsp;users&nbsp;will&nbsp;use&nbsp;the&nbsp;alias,<br>
and&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;ABI&nbsp;specification&nbsp;will&nbsp;use&nbsp;it&nbsp;as&nbsp;well.<br>
<br>
&lt;p&gt;<br>
In&nbsp;general,<br>
API&nbsp;objects&nbsp;defined&nbsp;as&nbsp;part&nbsp;of&nbsp;this&nbsp;ABI&nbsp;are&nbsp;assumed&nbsp;to&nbsp;be&nbsp;extern&nbsp;&quot;C++&quot;.<br>
However,&nbsp;some&nbsp;(many?)&nbsp;are&nbsp;specified&nbsp;to&nbsp;be&nbsp;extern&nbsp;&quot;C&quot;&nbsp;if&nbsp;they:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;are&nbsp;expected&nbsp;to&nbsp;be&nbsp;called&nbsp;by&nbsp;users&nbsp;from&nbsp;C&nbsp;code,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.g.&nbsp;&lt;code&gt;longjmp_unwind&lt;/code&gt;;&nbsp;or<br>
&lt;li&gt;&nbsp;are&nbsp;expected&nbsp;to&nbsp;be&nbsp;called&nbsp;only&nbsp;implicitly&nbsp;by&nbsp;compiled&nbsp;code,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;are&nbsp;likely&nbsp;to&nbsp;be&nbsp;implemented&nbsp;in&nbsp;C.<br>
&lt;/ul&gt;<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=scope&gt;<br>
&lt;h3&gt;&nbsp;1.4&nbsp;Scope&nbsp;of&nbsp;This&nbsp;ABI&nbsp;&lt;/h3&gt;<br>
<br>
&lt;a&nbsp;name=scope-library&gt;<br>
&lt;h3&gt;&nbsp;1.4.1&nbsp;Runtime&nbsp;Libraries&nbsp;&lt;/h3&gt;<br>
<br>
&lt;i&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;objective&nbsp;of&nbsp;a&nbsp;full&nbsp;ABI&nbsp;is&nbsp;to&nbsp;allow&nbsp;arbitrary&nbsp;mixing&nbsp;of&nbsp;object<br>
files&nbsp;produced&nbsp;by&nbsp;conforming&nbsp;implementations,<br>
by&nbsp;fully&nbsp;specifying&nbsp;the&nbsp;&lt;b&gt;binary&nbsp;interface&lt;/b&gt;&nbsp;of&nbsp;application&nbsp;programs.<br>
We&nbsp;do&nbsp;not&nbsp;fully&nbsp;achieve&nbsp;this&nbsp;objective.<br>
<br>
&lt;p&gt;<br>
There&nbsp;are&nbsp;two&nbsp;principal&nbsp;reasons&nbsp;for&nbsp;this:<br>
<br>
&lt;ol&nbsp;type=I&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
We&nbsp;start&nbsp;from&nbsp;the&nbsp;Itanium&nbsp;processor-specific&nbsp;ABI&nbsp;as&nbsp;the&nbsp;standard&nbsp;for&nbsp;the<br>
underlying&nbsp;C&nbsp;interfaces.<br>
At&nbsp;this&nbsp;time,&nbsp;however,<br>
the&nbsp;psABI&nbsp;does&nbsp;not&nbsp;attempt&nbsp;to&nbsp;specify&nbsp;the&nbsp;supported&nbsp;C&nbsp;library&nbsp;interfaces.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
More&nbsp;fundamental&nbsp;is&nbsp;the&nbsp;definition&nbsp;of&nbsp;the&nbsp;Standard&nbsp;C++&nbsp;Library.<br>
As&nbsp;the&nbsp;standard&nbsp;interface&nbsp;makes&nbsp;heavy&nbsp;use&nbsp;of&nbsp;templates,<br>
most&nbsp;user&nbsp;object&nbsp;files&nbsp;will&nbsp;end&nbsp;up&nbsp;with&nbsp;embedded&nbsp;template<br>
instantiations.<br>
Vendors&nbsp;are&nbsp;allowed&nbsp;to&nbsp;use&nbsp;helper&nbsp;functions&nbsp;and&nbsp;data&nbsp;in&nbsp;their<br>
implementations&nbsp;of&nbsp;these&nbsp;templates,<br>
and&nbsp;quite&nbsp;reasonably&nbsp;do&nbsp;so,<br>
with&nbsp;the&nbsp;result&nbsp;that&nbsp;a&nbsp;typical&nbsp;user&nbsp;object&nbsp;file&nbsp;will&nbsp;contain&nbsp;references<br>
to&nbsp;such&nbsp;helper&nbsp;objects&nbsp;specific&nbsp;to&nbsp;the&nbsp;implementation&nbsp;where&nbsp;compiled.<br>
We&nbsp;have&nbsp;not&nbsp;attempted&nbsp;to&nbsp;constrain&nbsp;the&nbsp;interface&nbsp;at&nbsp;this&nbsp;level,<br>
because&nbsp;we&nbsp;do&nbsp;not&nbsp;consider&nbsp;doing&nbsp;so&nbsp;feasible&nbsp;at&nbsp;this&nbsp;time.<br>
&lt;/ol&gt;<br>
<br>
&lt;p&gt;<br>
Notwithstanding&nbsp;these&nbsp;problems,<br>
because&nbsp;this&nbsp;ABI&nbsp;does&nbsp;completely&nbsp;specify&nbsp;the&nbsp;data&nbsp;model<br>
and&nbsp;certain&nbsp;library&nbsp;interfaces&nbsp;that&nbsp;inherently&nbsp;interact&nbsp;between&nbsp;objects<br>
(e.g.&nbsp;construction,&nbsp;destruction,&nbsp;and&nbsp;exceptions),<br>
it&nbsp;is&nbsp;our&nbsp;intent&nbsp;that&nbsp;interoperation&nbsp;of&nbsp;object&nbsp;files&nbsp;produced&nbsp;by<br>
different&nbsp;compilers&nbsp;be&nbsp;possible&nbsp;in&nbsp;the&nbsp;following&nbsp;cases:<br>
<br>
&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
A&nbsp;program&nbsp;which&nbsp;uses&nbsp;only&nbsp;the&nbsp;standalone&nbsp;standard&nbsp;library&nbsp;interfaces<br>
(Chapter&nbsp;18)&nbsp;does&nbsp;not&nbsp;depend&nbsp;on&nbsp;the&nbsp;problematic&nbsp;template&nbsp;features.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
Since&nbsp;the&nbsp;standard&nbsp;library&nbsp;headers&nbsp;for&nbsp;an&nbsp;implementation&nbsp;presumably<br>
match&nbsp;the&nbsp;interfaces&nbsp;of&nbsp;the&nbsp;standard&nbsp;library&nbsp;on&nbsp;that&nbsp;implementation,<br>
a&nbsp;program&nbsp;compiled&nbsp;with&nbsp;the&nbsp;target&nbsp;system's&nbsp;headers,<br>
even&nbsp;if&nbsp;a&nbsp;mixture&nbsp;of&nbsp;compilers&nbsp;is&nbsp;used,<br>
should&nbsp;function&nbsp;properly&nbsp;on&nbsp;that&nbsp;system.<br>
<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
Even&nbsp;these&nbsp;cases&nbsp;can&nbsp;fail&nbsp;if&nbsp;the&nbsp;compiler&nbsp;makes&nbsp;use&nbsp;of<br>
implementation-defined&nbsp;library&nbsp;interfaces&nbsp;to&nbsp;implement&nbsp;runtime<br>
functionality&nbsp;without&nbsp;explicit&nbsp;user&nbsp;reference,<br>
e.g.&nbsp;a&nbsp;software&nbsp;divide&nbsp;function.<br>
We&nbsp;can&nbsp;distinguish&nbsp;between:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;the&nbsp;standard&nbsp;support&nbsp;library,<br>
&nbsp;&nbsp;&nbsp;&nbsp;which&nbsp;provides&nbsp;interfaces&nbsp;required&nbsp;by&nbsp;the&nbsp;C++&nbsp;Standard&nbsp;Library<br>
&nbsp;&nbsp;&nbsp;&nbsp;specification&nbsp;and&nbsp;the&nbsp;vendor&nbsp;header&nbsp;files&nbsp;required&nbsp;for&nbsp;it,<br>
&nbsp;&nbsp;&nbsp;&nbsp;as&nbsp;well&nbsp;as&nbsp;interfaces&nbsp;required&nbsp;by&nbsp;this&nbsp;ABI;&nbsp;and<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;the&nbsp;implicit&nbsp;compiler&nbsp;support&nbsp;library,<br>
&nbsp;&nbsp;&nbsp;&nbsp;which&nbsp;provides&nbsp;other&nbsp;interfaces&nbsp;implicitly&nbsp;assumed&nbsp;by&nbsp;the&nbsp;compiler<br>
&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;used&nbsp;to&nbsp;implement&nbsp;either&nbsp;standard&nbsp;features&nbsp;or&nbsp;extensions.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
An&nbsp;implementation&nbsp;shall&nbsp;place&nbsp;its&nbsp;standard&nbsp;support&nbsp;library&nbsp;in&nbsp;a&nbsp;DSO<br>
named&nbsp;&lt;code&gt;libcxa.so&lt;/code&gt;&nbsp;on&nbsp;Itanium&nbsp;systems,<br>
or&nbsp;in&nbsp;auxiliary&nbsp;DSOs&nbsp;automatically&nbsp;loaded&nbsp;by&nbsp;it.<br>
It&nbsp;shall&nbsp;place&nbsp;implicit&nbsp;compiler&nbsp;support<br>
in&nbsp;a&nbsp;library&nbsp;separate&nbsp;from&nbsp;the&nbsp;standard&nbsp;support&nbsp;library,<br>
with&nbsp;any&nbsp;external&nbsp;names&nbsp;chosen&nbsp;to&nbsp;avoid&nbsp;conflicts&nbsp;between&nbsp;vendors<br>
(e.g.&nbsp;by&nbsp;including&nbsp;a&nbsp;vendor&nbsp;identifier&nbsp;as&nbsp;part&nbsp;of&nbsp;the&nbsp;names).<br>
This&nbsp;allows&nbsp;a&nbsp;program&nbsp;to&nbsp;function&nbsp;properly&nbsp;if&nbsp;linked&nbsp;with&nbsp;the<br>
target's&nbsp;standard&nbsp;support&nbsp;library&nbsp;and&nbsp;the&nbsp;implicit&nbsp;compiler&nbsp;support<br>
libraries&nbsp;from&nbsp;any&nbsp;implementations&nbsp;used&nbsp;to&nbsp;build&nbsp;components.<br>
<br>
<br>
&lt;a&nbsp;name=scope-templates&gt;<br>
&lt;h3&gt;&nbsp;1.4.2&nbsp;Export&nbsp;Templates&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
This&nbsp;ABI&nbsp;does&nbsp;not&nbsp;specify&nbsp;the&nbsp;treatment&nbsp;of&nbsp;export&nbsp;templates,<br>
as&nbsp;there&nbsp;are&nbsp;no&nbsp;working&nbsp;implementations&nbsp;to&nbsp;serve&nbsp;as&nbsp;models&nbsp;at&nbsp;this&nbsp;time.<br>
We&nbsp;hope&nbsp;to&nbsp;address&nbsp;this&nbsp;weakness&nbsp;in&nbsp;the&nbsp;future&nbsp;when&nbsp;implementation<br>
experience&nbsp;is&nbsp;available.<br>
<br>
<br>
&lt;/i&gt;<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=docs&gt;<br>
&lt;h3&gt;&nbsp;1.5&nbsp;Base&nbsp;Documents&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
A&nbsp;number&nbsp;of&nbsp;other&nbsp;documents&nbsp;provide&nbsp;a&nbsp;basis&nbsp;on&nbsp;which&nbsp;this&nbsp;ABI&nbsp;is&nbsp;built,<br>
and&nbsp;are&nbsp;occasionally&nbsp;referenced&nbsp;herein:<br>
<br>
&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;[gABI]<br>
The&nbsp;&lt;b&gt;System&nbsp;V&nbsp;Application&nbsp;Binary&nbsp;Interface&lt;/b&gt;,<br>
otherwise&nbsp;known&nbsp;as&nbsp;the&nbsp;&lt;i&gt;Generic&nbsp;ABI&lt;/i&gt;.<br>
This&nbsp;document&nbsp;describes&nbsp;processor-independent&nbsp;object&nbsp;file&nbsp;formats<br>
and&nbsp;binary&nbsp;software&nbsp;interfaces&nbsp;for&nbsp;C&nbsp;under&nbsp;Unix.<br>
A&nbsp;somewhat&nbsp;out-of-date&nbsp;version&nbsp;is&nbsp;available&nbsp;from&nbsp;the&nbsp;SCO&nbsp;website,<br>
&lt;a&nbsp;href=http://www.sco.com/developer/devspecs/&gt;<br>
http://www.sco.com/developer/devspecs/&lt;/a&gt;.<br>
A&nbsp;newer&nbsp;version,&nbsp;produced&nbsp;in&nbsp;conjunction&nbsp;with&nbsp;the&nbsp;next&nbsp;document,<br>
should&nbsp;be&nbsp;released&nbsp;in&nbsp;the&nbsp;future.<br>
Included&nbsp;by&nbsp;reference&nbsp;in&nbsp;this&nbsp;ABI.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;[psABI]<br>
The&nbsp;Intel&nbsp;&lt;b&gt;Unix&nbsp;System&nbsp;V&nbsp;Application&nbsp;Binary&nbsp;Interface,<br>
Itanium&nbsp;Processor&nbsp;Supplement&lt;/b&gt;.<br>
This&nbsp;document&nbsp;describes&nbsp;Itanium&nbsp;processor-specific&nbsp;object&nbsp;file&nbsp;formats<br>
and&nbsp;binary&nbsp;software&nbsp;interfaces,&nbsp;primarily&nbsp;for&nbsp;C,&nbsp;under&nbsp;Unix.<br>
Available&nbsp;from&nbsp;the&nbsp;Intel&nbsp;Itanium&nbsp;software&nbsp;developer&nbsp;website,<br>
&lt;a&nbsp;href=http://developer.intel.com/design/ia-64/devinfo.htm&gt;<br>
http://developer.intel.com/design/ia-64/devinfo.htm&lt;/a&gt;.<br>
Included&nbsp;by&nbsp;reference&nbsp;in&nbsp;this&nbsp;ABI.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;[SWCONV]<br>
The&nbsp;Intel&nbsp;&lt;b&gt;Itanium&nbsp;Software&nbsp;Conventions&nbsp;and&nbsp;Runtime&nbsp;Architecture&nbsp;Guide&lt;/b&gt;.<br>
This&nbsp;document&nbsp;describes&nbsp;Itanium&nbsp;processor-specific&nbsp;binary&nbsp;software&nbsp;interfaces,<br>
notably&nbsp;including&nbsp;register&nbsp;usage,&nbsp;subprogram&nbsp;calling&nbsp;conventions,&nbsp;and<br>
stack&nbsp;unwind&nbsp;facilities,&nbsp;under&nbsp;all&nbsp;systems.<br>
Available&nbsp;from&nbsp;the&nbsp;Intel&nbsp;Itanium&nbsp;software&nbsp;developer&nbsp;website,<br>
&lt;a&nbsp;href=http://developer.intel.com/design/ia-64/devinfo.htm&gt;<br>
http://developer.intel.com/design/ia-64/devinfo.htm&lt;/a&gt;.<br>
Included&nbsp;by&nbsp;reference&nbsp;in&nbsp;this&nbsp;ABI.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;[ABI-EH]<br>
The&nbsp;&lt;a&nbsp;href=abi-eh.html&gt;&lt;b&gt;C++&nbsp;ABI&nbsp;for&nbsp;Itanium:&nbsp;Exception&nbsp;Handling&lt;/b&gt;&lt;/a&gt;.<br>
Its&nbsp;Level&nbsp;II&nbsp;is&nbsp;considered&nbsp;an&nbsp;integral&nbsp;part&nbsp;of&nbsp;this&nbsp;document&nbsp;(Chapter&nbsp;4).<br>
It&nbsp;also&nbsp;contains&nbsp;the&nbsp;base&nbsp;specification&nbsp;of&nbsp;unwind&nbsp;support&nbsp;for&nbsp;[psABI].<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;[C++FDIS]<br>
The&nbsp;&lt;b&gt;Final&nbsp;Draft&nbsp;International&nbsp;Standard,&nbsp;Programming&nbsp;Language&nbsp;C++&lt;/b&gt;,<br>
ISO/IEC&nbsp;FDIS&nbsp;14882:1998(E).<br>
References&nbsp;herein&nbsp;to&nbsp;the&nbsp;&quot;C++&nbsp;Standard,&quot;&nbsp;or&nbsp;to&nbsp;just&nbsp;the&nbsp;&quot;Standard,&quot;<br>
are&nbsp;to&nbsp;this&nbsp;document.<br>
<br>
&lt;/ul&gt;<br>
<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=layout&gt;<br>
&lt;h2&gt;&nbsp;Chapter&nbsp;2:&nbsp;Data&nbsp;Layout&nbsp;&lt;/h2&gt;<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
<br>
<br>
&lt;a&nbsp;name=general&gt;<br>
&lt;h3&gt;&nbsp;2.1&nbsp;General&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
In&nbsp;what&nbsp;follows,&nbsp;we&nbsp;define&nbsp;the&nbsp;memory&nbsp;layout&nbsp;for&nbsp;C++&nbsp;data&nbsp;objects.<br>
Specifically,&nbsp;for&nbsp;each&nbsp;type,&nbsp;we&nbsp;specify&nbsp;the&nbsp;following&nbsp;information&nbsp;about<br>
an&nbsp;object&nbsp;O&nbsp;of&nbsp;that&nbsp;type:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;the&nbsp;&lt;i&gt;size&lt;/i&gt;&nbsp;of&nbsp;an&nbsp;object,&nbsp;&lt;i&gt;sizeof&lt;/i&gt;(O);<br>
&lt;li&gt;&nbsp;the&nbsp;&lt;i&gt;alignment&lt;/i&gt;&nbsp;of&nbsp;an&nbsp;object,&nbsp;&lt;i&gt;align&lt;/i&gt;(O);&nbsp;and<br>
&lt;li&gt;&nbsp;the&nbsp;&lt;i&gt;offset&lt;/i&gt;&nbsp;within&nbsp;O,&nbsp;&lt;i&gt;offset&lt;/i&gt;(C),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;each&nbsp;data&nbsp;component&nbsp;C,&nbsp;i.e.&nbsp;base&nbsp;or&nbsp;member.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;&nbsp;For&nbsp;purposes&nbsp;internal&nbsp;to&nbsp;the&nbsp;specification,<br>
we&nbsp;also&nbsp;specify:<br>
<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;&lt;i&gt;dsize&lt;/i&gt;(O):<br>
the&nbsp;&lt;i&gt;data&nbsp;size&lt;/i&gt;&nbsp;of&nbsp;an&nbsp;object,&nbsp;which&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;O&nbsp;without&nbsp;tail<br>
padding.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;&lt;i&gt;nvsize&lt;/i&gt;(O):<br>
the&nbsp;&lt;i&gt;non-virtual&nbsp;size&lt;/i&gt;&nbsp;of&nbsp;an&nbsp;object,&nbsp;which&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;O<br>
without&nbsp;virtual&nbsp;bases.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;&lt;i&gt;nvalign&lt;/i&gt;(O):<br>
the&nbsp;&lt;i&gt;non-virtual&nbsp;alignment&lt;/i&gt;&nbsp;of&nbsp;an&nbsp;object,&nbsp;which&nbsp;is&nbsp;the&nbsp;alignment&nbsp;of&nbsp;O<br>
without&nbsp;virtual&nbsp;bases.<br>
<br>
&lt;/ul&gt;<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=pod&gt;<br>
&lt;h3&gt;&nbsp;2.2&nbsp;POD&nbsp;Data&nbsp;Types&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;size&nbsp;and&nbsp;alignment&nbsp;of&nbsp;C&nbsp;POD&nbsp;types&nbsp;is&nbsp;as&nbsp;specified&nbsp;by&nbsp;the&nbsp;base&nbsp;(C)&nbsp;ABI.<br>
Type&nbsp;bool&nbsp;has&nbsp;size&nbsp;and&nbsp;alignment&nbsp;1.<br>
All&nbsp;of&nbsp;these&nbsp;types&nbsp;have&nbsp;data&nbsp;size&nbsp;and&nbsp;non-virtual&nbsp;size&nbsp;equal&nbsp;to&nbsp;their&nbsp;size.<br>
(We&nbsp;ignore&nbsp;tail&nbsp;padding&nbsp;for&nbsp;PODs&nbsp;because&nbsp;the&nbsp;Standard&nbsp;does&nbsp;not&nbsp;allow&nbsp;us<br>
to&nbsp;use&nbsp;it&nbsp;for&nbsp;anything&nbsp;else.)<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=member-pointers&gt;&lt;/a&gt;<br>
&lt;h3&gt;&nbsp;2.3&nbsp;Member&nbsp;Pointers&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
A&nbsp;pointer&nbsp;to&nbsp;data&nbsp;member&nbsp;is&nbsp;an&nbsp;offset&nbsp;from&nbsp;the&nbsp;base<br>
address&nbsp;of&nbsp;the&nbsp;class&nbsp;object&nbsp;containing&nbsp;it,<br>
represented&nbsp;as&nbsp;a&nbsp;&lt;code&gt;ptrdiff_t&lt;/code&gt;.<br>
It&nbsp;has&nbsp;the&nbsp;size&nbsp;and&nbsp;alignment&nbsp;attributes&nbsp;of&nbsp;a&nbsp;&lt;code&gt;ptrdiff_t&lt;/code&gt;.<br>
A&nbsp;NULL&nbsp;pointer&nbsp;is&nbsp;represented&nbsp;as&nbsp;-1.<br>
<br>
&lt;p&gt;<br>
A&nbsp;pointer&nbsp;to&nbsp;member&nbsp;function&nbsp;is&nbsp;a&nbsp;pair&nbsp;&lt;ptr,&nbsp;adj&gt;&nbsp;as&nbsp;follows:<br>
<br>
&lt;dl&gt;<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;code&gt;ptr&lt;/code&gt;:<br>
&lt;dd&gt;&nbsp;For&nbsp;a&nbsp;non-virtual&nbsp;function,&nbsp;this&nbsp;field&nbsp;is&nbsp;a&nbsp;simple&nbsp;function&nbsp;pointer.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Under&nbsp;current&nbsp;base&nbsp;Itanium&nbsp;psABI&nbsp;conventions,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;is&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;GP/function&nbsp;address&nbsp;pair.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;a&nbsp;virtual&nbsp;function,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;is&nbsp;1&nbsp;plus&nbsp;the&nbsp;virtual&nbsp;table&nbsp;offset&nbsp;(in&nbsp;bytes)&nbsp;of&nbsp;the&nbsp;function,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;represented&nbsp;as&nbsp;a&nbsp;&lt;code&gt;ptrdiff_t&lt;/code&gt;.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;value&nbsp;zero&nbsp;represents&nbsp;a&nbsp;NULL&nbsp;pointer,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;independent&nbsp;of&nbsp;the&nbsp;adjustment&nbsp;field&nbsp;value&nbsp;below.<br>
<br>
&lt;p&gt;<br>
&lt;dt&gt;&nbsp;&lt;code&gt;adj&lt;/code&gt;:<br>
&lt;dd&gt;&nbsp;The&nbsp;required&nbsp;adjustment&nbsp;to&nbsp;&lt;i&gt;this&lt;/i&gt;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;represented&nbsp;as&nbsp;a&nbsp;&lt;code&gt;ptrdiff_t&lt;/code&gt;.<br>
&lt;/dl&gt;<br>
<br>
&lt;p&gt;<br>
It&nbsp;has&nbsp;the&nbsp;size,&nbsp;data&nbsp;size,&nbsp;and&nbsp;alignment<br>
of&nbsp;a&nbsp;class&nbsp;containing&nbsp;those&nbsp;two&nbsp;members,&nbsp;in&nbsp;that&nbsp;order.<br>
(For&nbsp;64-bit&nbsp;Itanium,&nbsp;that&nbsp;will&nbsp;be&nbsp;16,&nbsp;16,&nbsp;and&nbsp;8&nbsp;bytes&nbsp;respectively.)<br>
<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=class-types&gt;<br>
&lt;h3&gt;&nbsp;2.4&nbsp;Non-POD&nbsp;Class&nbsp;Types&nbsp;&lt;/h3&gt;<br>
<br>
For&nbsp;non-POD&nbsp;class&nbsp;types&nbsp;C,&nbsp;assume&nbsp;that&nbsp;all&nbsp;component&nbsp;types<br>
(i.e.&nbsp;proper&nbsp;base&nbsp;classes&nbsp;and&nbsp;non-static&nbsp;data&nbsp;member&nbsp;types)<br>
have&nbsp;been&nbsp;laid&nbsp;out,&nbsp;defining&nbsp;size,&nbsp;data&nbsp;size,&nbsp;non-virtual&nbsp;size,<br>
alignment,&nbsp;and&nbsp;non-virtual&nbsp;alignment.<br>
(See&nbsp;the&nbsp;description&nbsp;of&nbsp;these&nbsp;terms&nbsp;in<br>
&lt;a&nbsp;href=#general&gt;&lt;b&gt;General&lt;/b&gt;&lt;/a&gt;&nbsp;above.)<br>
Further,&nbsp;assume&nbsp;for&nbsp;data&nbsp;members&nbsp;that&nbsp;nvsize==size,&nbsp;and&nbsp;nvalign=align.<br>
Layout&nbsp;(of&nbsp;type&nbsp;C)&nbsp;is&nbsp;done&nbsp;using&nbsp;the&nbsp;following&nbsp;procedure.<br>
<br>
&lt;ol&nbsp;type=I&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;&lt;h5&gt;&nbsp;Initialization&nbsp;&lt;/h5&gt;<br>
&nbsp;&nbsp;&lt;ol&nbsp;type=1&gt;<br>
&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;Initialize&nbsp;sizeof(C)&nbsp;to&nbsp;zero,&nbsp;align(C)&nbsp;to&nbsp;one,&nbsp;dsize(C)&nbsp;to&nbsp;zero.<br>
<br>
&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;If&nbsp;C&nbsp;is&nbsp;a&nbsp;dynamic&nbsp;class&nbsp;type:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ol&nbsp;type=a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;Identify&nbsp;all&nbsp;virtual&nbsp;base&nbsp;classes,&nbsp;direct&nbsp;or&nbsp;indirect,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;are&nbsp;primary&nbsp;base&nbsp;classes&nbsp;for&nbsp;some&nbsp;other&nbsp;direct&nbsp;or&nbsp;indirect<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;class.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call&nbsp;these&nbsp;&lt;i&gt;indirect&nbsp;primary&nbsp;base&nbsp;classes&lt;/i&gt;.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;If&nbsp;C&nbsp;has&nbsp;a&nbsp;dynamic&nbsp;base&nbsp;class,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attempt&nbsp;to&nbsp;choose&nbsp;a&nbsp;primary&nbsp;base&nbsp;class&nbsp;B.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;first&nbsp;(in&nbsp;direct&nbsp;base&nbsp;class&nbsp;order)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;non-virtual&nbsp;dynamic&nbsp;base&nbsp;class,&nbsp;if&nbsp;one&nbsp;exists.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Otherwise,&nbsp;it&nbsp;is&nbsp;a&nbsp;nearly&nbsp;empty&nbsp;virtual&nbsp;base&nbsp;class,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;first&nbsp;one&nbsp;in&nbsp;(preorder)&nbsp;inheritance&nbsp;graph&nbsp;order&nbsp;which<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;not&nbsp;an&nbsp;indirect&nbsp;primary&nbsp;base&nbsp;class&nbsp;if&nbsp;any&nbsp;exist,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;just&nbsp;the&nbsp;first&nbsp;one&nbsp;if&nbsp;they&nbsp;are&nbsp;all&nbsp;indirect&nbsp;primaries.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;If&nbsp;C&nbsp;has&nbsp;no&nbsp;primary&nbsp;base&nbsp;class,&nbsp;allocate&nbsp;the&nbsp;virtual&nbsp;table<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointer&nbsp;for&nbsp;C&nbsp;at&nbsp;offset&nbsp;zero,&nbsp;and&nbsp;set&nbsp;sizeof(C),&nbsp;align(C),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;dsize(C)&nbsp;to&nbsp;the&nbsp;appropriate&nbsp;values&nbsp;for&nbsp;a&nbsp;pointer&nbsp;(all&nbsp;8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytes&nbsp;for&nbsp;Itanium&nbsp;64-bit&nbsp;ABI).<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ol&gt;<br>
&nbsp;&nbsp;&lt;/ol&gt;<br>
<br>
&lt;br&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
&lt;span&nbsp;class=&quot;change&quot;&gt;&lt;strike&gt;In&nbsp;case&nbsp;(2b)&nbsp;above,&nbsp;the&lt;/strike&gt;Case&nbsp;(2b)<br>
above&nbsp;is&nbsp;now&nbsp;considered&nbsp;to&nbsp;be&nbsp;a&nbsp;mistake.&nbsp;&nbsp;The&lt;/span&gt;&nbsp;use&nbsp;of&nbsp;the&nbsp;first<br>
indirect&nbsp;primary&nbsp;base&nbsp;class&nbsp;as&nbsp;the&nbsp;derived&nbsp;class'&nbsp;primary&nbsp;base&nbsp;does&nbsp;not&nbsp;save&nbsp;any&nbsp;space&nbsp;in&nbsp;the&nbsp;object,<br>
and&nbsp;will&nbsp;cause&nbsp;some&nbsp;duplication&nbsp;of&nbsp;virtual&nbsp;function&nbsp;pointers&nbsp;in&nbsp;the<br>
additional&nbsp;copy&nbsp;of&nbsp;the&nbsp;base&nbsp;classes&nbsp;virtual&nbsp;table.<br>
<br>
&lt;div&nbsp;class=&quot;change&quot;&gt;<br>
&lt;p&gt;&lt;strike&gt;<br>
The&nbsp;benefit&nbsp;is&nbsp;that&nbsp;using&nbsp;the&nbsp;derived&nbsp;class&nbsp;virtual&nbsp;pointer&nbsp;as&nbsp;the&nbsp;base<br>
class&nbsp;virtual&nbsp;pointer&nbsp;will&nbsp;often&nbsp;save&nbsp;a&nbsp;load,<br>
and&nbsp;no&nbsp;adjustment&nbsp;to&nbsp;the&nbsp;&lt;code&gt;this&lt;/code&gt;&nbsp;pointer&nbsp;will&nbsp;be&nbsp;required&nbsp;for<br>
calls&nbsp;to&nbsp;its&nbsp;virtual&nbsp;functions.<br>
&lt;/strike&gt;<br>
We&nbsp;used&nbsp;to&nbsp;think&nbsp;that&nbsp;this&nbsp;would&nbsp;allow&nbsp;us&nbsp;to&nbsp;avoid&nbsp;adjusting<br>
&lt;code&gt;this&lt;/code&gt;&nbsp;in&nbsp;some&nbsp;cases,&nbsp;but&nbsp;this&nbsp;was&nbsp;incorrect,&nbsp;as&nbsp;the&nbsp;&lt;a<br>
href=#vcall&gt;virtual&nbsp;function&nbsp;call&nbsp;algorithm&lt;/a&gt;&nbsp;requires&nbsp;that&nbsp;we&nbsp;look&nbsp;up<br>
the&nbsp;function&nbsp;through&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;class&nbsp;that&nbsp;defines&nbsp;the&nbsp;function,&nbsp;not<br>
one&nbsp;that&nbsp;just&nbsp;inherits&nbsp;it.&nbsp;&nbsp;Removing&nbsp;that&nbsp;requirement&nbsp;would&nbsp;not&nbsp;be&nbsp;a&nbsp;good<br>
idea,&nbsp;as&nbsp;then&nbsp;we&nbsp;would&nbsp;no&nbsp;longer&nbsp;be&nbsp;able&nbsp;to&nbsp;emit&nbsp;all&nbsp;thunks&nbsp;with&nbsp;the<br>
functions&nbsp;they&nbsp;jump&nbsp;to.&nbsp;&nbsp;For&nbsp;instance,&nbsp;consider&nbsp;this&nbsp;example:<br>
<br>
&lt;code&gt;&lt;pre&gt;<br>
struct&nbsp;A&nbsp;{&nbsp;virtual&nbsp;void&nbsp;f();&nbsp;};<br>
struct&nbsp;B&nbsp;:&nbsp;virtual&nbsp;public&nbsp;A&nbsp;{&nbsp;int&nbsp;i;&nbsp;};<br>
struct&nbsp;C&nbsp;:&nbsp;virtual&nbsp;public&nbsp;A&nbsp;{&nbsp;int&nbsp;j;&nbsp;};<br>
struct&nbsp;D&nbsp;:&nbsp;public&nbsp;B,&nbsp;public&nbsp;C&nbsp;{};<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
When&nbsp;B&nbsp;and&nbsp;C&nbsp;are&nbsp;declared,&nbsp;A&nbsp;is&nbsp;a&nbsp;primary&nbsp;base&nbsp;in&nbsp;each&nbsp;case,&nbsp;so&nbsp;although<br>
vcall&nbsp;offsets&nbsp;are&nbsp;allocated&nbsp;in&nbsp;the&nbsp;A-in-B&nbsp;and&nbsp;A-in-C&nbsp;vtables,&nbsp;no<br>
&lt;code&gt;this&lt;/code&gt;&nbsp;adjustment&nbsp;is&nbsp;required&nbsp;and&nbsp;no&nbsp;thunk&nbsp;is&nbsp;generated.<br>
However,&nbsp;inside&nbsp;D&nbsp;objects,&nbsp;A&nbsp;is&nbsp;no&nbsp;longer&nbsp;a&nbsp;primary&nbsp;base&nbsp;of&nbsp;C,&nbsp;so&nbsp;if&nbsp;we<br>
allowed&nbsp;calls&nbsp;to&nbsp;&lt;code&gt;C::f()&lt;/code&gt;&nbsp;to&nbsp;use&nbsp;the&nbsp;copy&nbsp;of&nbsp;A's&nbsp;vtable&nbsp;in&nbsp;the&nbsp;C<br>
subobject,&nbsp;we&nbsp;would&nbsp;need&nbsp;to&nbsp;adjust&nbsp;&lt;code&gt;this&lt;/code&gt;&nbsp;from&nbsp;&lt;code&gt;C*&lt;/code&gt;<br>
to&nbsp;&lt;code&gt;B::A*&lt;/code&gt;,&nbsp;which&nbsp;would&nbsp;require&nbsp;a&nbsp;third-party&nbsp;thunk.&nbsp;&nbsp;Since&nbsp;we<br>
require&nbsp;that&nbsp;a&nbsp;call&nbsp;to&nbsp;&lt;code&gt;C::f()&lt;/code&gt;&nbsp;first&nbsp;convert&nbsp;to<br>
&lt;code&gt;A*&lt;/code&gt;,&nbsp;C-in-D's&nbsp;copy&nbsp;of&nbsp;A's&nbsp;vtable&nbsp;is&nbsp;never&nbsp;referenced,&nbsp;so&nbsp;this<br>
is&nbsp;not&nbsp;necessary.<br>
&lt;/div&gt;<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;&lt;h5&gt;&nbsp;Allocation&nbsp;of&nbsp;Members&nbsp;Other&nbsp;Than&nbsp;Virtual&nbsp;Bases&nbsp;&lt;/h5&gt;<br>
&lt;p&gt;<br>
For&nbsp;each&nbsp;data&nbsp;component&nbsp;D&nbsp;(first&nbsp;the&nbsp;primary&nbsp;base&nbsp;of&nbsp;C,&nbsp;if&nbsp;any,&nbsp;then<br>
the&nbsp;non-primary,&nbsp;non-virtual&nbsp;direct&nbsp;base&nbsp;classes&nbsp;in&nbsp;declaration&nbsp;order,<br>
then&nbsp;the&nbsp;non-static&nbsp;data&nbsp;members&nbsp;in&nbsp;declaration&nbsp;order),&nbsp;allocate&nbsp;as<br>
follows:<br>
<br>
&nbsp;&nbsp;&lt;ol&nbsp;type=1&gt;<br>
<br>
&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;If&nbsp;D&nbsp;is&nbsp;a&nbsp;bitfield,&nbsp;i.e.&nbsp;declared&nbsp;as&nbsp;&quot;&lt;code&gt;T&nbsp;[b]:&nbsp;n;&quot;&lt;/code&gt;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;some&nbsp;integral&nbsp;POD&nbsp;type&nbsp;T&nbsp;and&nbsp;bit&nbsp;count&nbsp;n,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;are&nbsp;two&nbsp;cases&nbsp;depending&nbsp;on&nbsp;&lt;code&gt;sizeof(T)&lt;/code&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;&lt;code&gt;n&lt;/code&gt;:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ol&nbsp;type=a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;&lt;code&gt;sizeof(T)*8&nbsp;&gt;=&nbsp;n&lt;/code&gt;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;bitfield&nbsp;is&nbsp;allocated&nbsp;as&nbsp;required&nbsp;by&nbsp;the&nbsp;underlying&nbsp;C&nbsp;psABI.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That&nbsp;is,&nbsp;it&nbsp;will&nbsp;be&nbsp;placed&nbsp;in&nbsp;the&nbsp;next&nbsp;available&nbsp;n&nbsp;bits,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subject&nbsp;to&nbsp;the&nbsp;constraint&nbsp;that&nbsp;it&nbsp;does&nbsp;not&nbsp;cross&nbsp;an&nbsp;alignment<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boundary&nbsp;for&nbsp;type&nbsp;&lt;code&gt;T&lt;/code&gt;.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;dsize(C)&nbsp;&gt;&nbsp;0,&nbsp;and&nbsp;the&nbsp;byte&nbsp;at&nbsp;offset&nbsp;dsize(C)&nbsp;-&nbsp;1&nbsp;is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;partially&nbsp;filled&nbsp;by&nbsp;a&nbsp;bitfield,&nbsp;and&nbsp;that&nbsp;bitfield&nbsp;is&nbsp;also&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;member&nbsp;declared&nbsp;in&nbsp;C&nbsp;(but&nbsp;not&nbsp;in&nbsp;one&nbsp;of&nbsp;C's&nbsp;proper&nbsp;base<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;classes),&nbsp;the&nbsp;next&nbsp;available&nbsp;bits&nbsp;are&nbsp;the&nbsp;unfilled&nbsp;bits&nbsp;at<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offset&nbsp;dsize(C)&nbsp;-&nbsp;1.&nbsp;&nbsp;Otherwise,&nbsp;the&nbsp;next&nbsp;available&nbsp;bits&nbsp;at<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offset&nbsp;dsize(C).<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Update&nbsp;align(C)&nbsp;to&nbsp;max&nbsp;(align(C),&nbsp;align(T)).<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;&lt;code&gt;sizeof(T)*8&nbsp;&lt;&nbsp;n&lt;/code&gt;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;T'&nbsp;be&nbsp;the&nbsp;largest&nbsp;integral&nbsp;POD&nbsp;type&nbsp;with<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;code&gt;sizeof(T')*8&nbsp;&lt;=&nbsp;n&lt;/code&gt;.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;bitfield&nbsp;is&nbsp;allocated&nbsp;starting&nbsp;at&nbsp;the&nbsp;next&nbsp;offset&nbsp;aligned<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;appropriately&nbsp;for&nbsp;T',&nbsp;with&nbsp;length&nbsp;n&nbsp;bits.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;first&nbsp;&lt;code&gt;sizeof(T)*8&lt;/code&gt;&nbsp;bits&nbsp;are&nbsp;used&nbsp;to&nbsp;hold&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;of&nbsp;the&nbsp;bitfield,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;followed&nbsp;by&nbsp;&lt;code&gt;n&nbsp;-&nbsp;sizeof(T)*8&lt;/code&gt;&nbsp;bits&nbsp;of&nbsp;padding.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Update&nbsp;align(C)&nbsp;to&nbsp;max&nbsp;(align(C),&nbsp;align(T')).<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ol&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;either&nbsp;case,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;update&nbsp;dsize(C)&nbsp;to&nbsp;include&nbsp;the&nbsp;last&nbsp;byte<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;containing&nbsp;(part&nbsp;of)&nbsp;the&nbsp;bitfield,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;update&nbsp;sizeof(C)&nbsp;to&nbsp;max(sizeof(C),dsize(C)).<br>
<br>
&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;Otherwise,&nbsp;if&nbsp;D&nbsp;is&nbsp;not&nbsp;an&nbsp;empty&nbsp;base&nbsp;class<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(including&nbsp;all&nbsp;data&nbsp;members),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start&nbsp;at&nbsp;offset&nbsp;dsize(C),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incremented&nbsp;if&nbsp;necessary&nbsp;for&nbsp;alignment<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;nvalign(D)&nbsp;for&nbsp;base&nbsp;classes&nbsp;or<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;align(D)&nbsp;for&nbsp;data&nbsp;members.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Place&nbsp;D&nbsp;at&nbsp;this&nbsp;offset&nbsp;unless&nbsp;doing&nbsp;so&nbsp;would&nbsp;result&nbsp;in&nbsp;two<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;components&nbsp;(direct&nbsp;or&nbsp;indirect)&nbsp;of&nbsp;the&nbsp;same&nbsp;type&nbsp;having&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;same&nbsp;offset.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;such&nbsp;a&nbsp;component&nbsp;type&nbsp;conflict&nbsp;occurs,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;increment&nbsp;the&nbsp;candidate&nbsp;offset&nbsp;by&nbsp;nvalign(D)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;base&nbsp;classes&nbsp;or&nbsp;by&nbsp;align(D)&nbsp;for&nbsp;data&nbsp;members<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;try&nbsp;again,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeating&nbsp;until&nbsp;success&nbsp;occurs<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(which&nbsp;will&nbsp;occur&nbsp;no&nbsp;later&nbsp;than&nbsp;sizeof(C)&nbsp;rounded&nbsp;up&nbsp;to&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;required&nbsp;alignment).<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;D&nbsp;is&nbsp;a&nbsp;base&nbsp;class,&nbsp;this&nbsp;step&nbsp;allocates&nbsp;only&nbsp;its&nbsp;non-virtual<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;part,&nbsp;i.e.&nbsp;excluding&nbsp;any&nbsp;direct&nbsp;or&nbsp;indirect&nbsp;virtual&nbsp;bases.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;D&nbsp;is&nbsp;a&nbsp;base&nbsp;class,&nbsp;update&nbsp;sizeof(C)&nbsp;to&nbsp;max&nbsp;(sizeof(C),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offset(D)+nvsize(D)).&nbsp;&nbsp;Otherwise,&nbsp;if&nbsp;D&nbsp;is&nbsp;a&nbsp;data&nbsp;member,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;update&nbsp;sizeof(C)&nbsp;to&nbsp;max&nbsp;(sizeof(C),&nbsp;offset(D)+sizeof(D)).<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;D&nbsp;is&nbsp;a&nbsp;base&nbsp;class&nbsp;(not&nbsp;empty&nbsp;in&nbsp;this&nbsp;case),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;update&nbsp;dsize(C)&nbsp;to&nbsp;offset(D)+nvsize(D),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;align(C)&nbsp;to&nbsp;max&nbsp;(align(C),&nbsp;nvalign(D)).<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;D&nbsp;is&nbsp;a&nbsp;data&nbsp;member,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;update&nbsp;dsize(C)&nbsp;to&nbsp;offset(D)+sizeof(D),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;align(C)&nbsp;to&nbsp;max&nbsp;(align(C),&nbsp;align(D)).<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
<br>
&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;If&nbsp;D&nbsp;is&nbsp;an&nbsp;empty&nbsp;proper&nbsp;base&nbsp;class,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;its&nbsp;allocation&nbsp;is&nbsp;similar&nbsp;to&nbsp;case&nbsp;(2)&nbsp;above,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;that&nbsp;additional&nbsp;candidate&nbsp;offsets&nbsp;are&nbsp;considered&nbsp;before<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;starting&nbsp;at&nbsp;dsize(C).<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;First,&nbsp;attempt&nbsp;to&nbsp;place&nbsp;D&nbsp;at&nbsp;offset&nbsp;zero.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;unsuccessful&nbsp;(due&nbsp;to&nbsp;a&nbsp;component&nbsp;type&nbsp;conflict),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proceed&nbsp;with&nbsp;attempts&nbsp;at&nbsp;dsize(C)&nbsp;as&nbsp;for&nbsp;non-empty&nbsp;bases.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;for&nbsp;that&nbsp;case,&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;type&nbsp;conflict&nbsp;at&nbsp;dsize(C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(with&nbsp;alignment&nbsp;updated&nbsp;as&nbsp;necessary),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;increment&nbsp;the&nbsp;candidate&nbsp;offset&nbsp;by&nbsp;nvalign(D),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;try&nbsp;again,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeating&nbsp;until&nbsp;success&nbsp;occurs.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Once&nbsp;offset(D)&nbsp;has&nbsp;been&nbsp;chosen,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;update&nbsp;sizeof(C)&nbsp;to&nbsp;max&nbsp;(sizeof(C),&nbsp;offset(D)+sizeof(D)).<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;nvalign(D)&nbsp;is&nbsp;1,&nbsp;so&nbsp;no&nbsp;update&nbsp;of&nbsp;align(C)&nbsp;is&nbsp;needed.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Similarly,&nbsp;since&nbsp;D&nbsp;is&nbsp;an&nbsp;empty&nbsp;base&nbsp;class,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no&nbsp;update&nbsp;of&nbsp;dsize(C)&nbsp;is&nbsp;needed.<br>
<br>
&nbsp;&nbsp;&lt;/ol&gt;<br>
<br>
&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;After&nbsp;all&nbsp;such&nbsp;components&nbsp;have&nbsp;been&nbsp;allocated,&nbsp;set&nbsp;nvalign(C)&nbsp;=<br>
&nbsp;&nbsp;align(C)&nbsp;and&nbsp;nvsize(C)&nbsp;=&nbsp;sizeof(C).&nbsp;&nbsp;The&nbsp;values&nbsp;of&nbsp;nvalign(C)&nbsp;and<br>
&nbsp;&nbsp;nvsize(C)&nbsp;will&nbsp;not&nbsp;change&nbsp;during&nbsp;virtual&nbsp;base&nbsp;allocation.&nbsp;&nbsp;Note&nbsp;that<br>
&nbsp;&nbsp;nvsize(C)&nbsp;need&nbsp;not&nbsp;be&nbsp;a&nbsp;multiple&nbsp;of&nbsp;nvalign(C).<br>
<br>
&lt;p&gt;&lt;a&nbsp;name=a17&gt;<br>
&lt;li&gt;&nbsp;&lt;h5&gt;&nbsp;Virtual&nbsp;Base&nbsp;Allocation&nbsp;&lt;/h5&gt;<br>
&lt;p&gt;<br>
<br>
&lt;p&gt;<br>
Finally&nbsp;allocate&nbsp;any&nbsp;direct&nbsp;or&nbsp;indirect&nbsp;virtual&nbsp;base&nbsp;classes<br>
(except&nbsp;the&nbsp;primary&nbsp;base&nbsp;class&nbsp;or&nbsp;any&nbsp;indirect&nbsp;primary&nbsp;base&nbsp;classes)<br>
as&nbsp;we&nbsp;did&nbsp;non-virtual&nbsp;base&nbsp;classes<br>
in&nbsp;step&nbsp;II-2&nbsp;(if&nbsp;empty)&nbsp;or&nbsp;II-3&nbsp;(if&nbsp;non-empty),<br>
in&nbsp;inheritance&nbsp;graph&nbsp;order.<br>
Update&nbsp;sizeof(C)&nbsp;to&nbsp;max&nbsp;(sizeof(C),&nbsp;offset(D)+nvsize(D)).<br>
If&nbsp;non-empty,&nbsp;also&nbsp;update&nbsp;align(C)&nbsp;and&nbsp;dsize(C)&nbsp;as&nbsp;in&nbsp;II-2.<br>
<br>
&lt;p&gt;<br>
The&nbsp;primary&nbsp;base&nbsp;class&nbsp;has&nbsp;already&nbsp;been&nbsp;allocated&nbsp;in&nbsp;I-2b.<br>
Any&nbsp;indirect&nbsp;primary&nbsp;base&nbsp;class&nbsp;E&nbsp;of&nbsp;the&nbsp;current&nbsp;class&nbsp;C,<br>
&lt;span&nbsp;class=&quot;change&quot;&gt;i.e.&nbsp;one&lt;/span&gt;<br>
that&nbsp;has&nbsp;been&nbsp;chosen&nbsp;as&nbsp;the&nbsp;primary&nbsp;base&nbsp;class&nbsp;of&nbsp;some&nbsp;other&nbsp;base&nbsp;class<br>
(direct&nbsp;or&nbsp;indirect,&nbsp;virtual&nbsp;or&nbsp;non-virtual)&nbsp;of&nbsp;C,<br>
will&nbsp;be&nbsp;allocated&nbsp;as&nbsp;part&nbsp;of&nbsp;that&nbsp;other&nbsp;base&nbsp;class,<br>
and&nbsp;is&nbsp;not&nbsp;allocated&nbsp;here.<br>
If&nbsp;E&nbsp;is&nbsp;a&nbsp;primary&nbsp;base&nbsp;class&nbsp;of&nbsp;more&nbsp;than&nbsp;one&nbsp;other&nbsp;base,<br>
the&nbsp;instance&nbsp;used&nbsp;as&nbsp;its&nbsp;allocation&nbsp;in&nbsp;C&nbsp;shall&nbsp;be&nbsp;the&nbsp;first&nbsp;such<br>
in&nbsp;the&nbsp;inheritance&nbsp;graph&nbsp;order.<br>
<br>
&lt;i&gt;<br>
&lt;p&gt;<br>
Consider:<br>
&lt;pre&gt;&lt;code&gt;<br>
&nbsp;&nbsp;struct&nbsp;R&nbsp;{&nbsp;virtual&nbsp;void&nbsp;r&nbsp;();&nbsp;};<br>
&nbsp;&nbsp;struct&nbsp;S&nbsp;{&nbsp;virtual&nbsp;void&nbsp;s&nbsp;();&nbsp;};<br>
&nbsp;&nbsp;struct&nbsp;T&nbsp;:&nbsp;virtual&nbsp;public&nbsp;S&nbsp;{&nbsp;virtual&nbsp;void&nbsp;t&nbsp;();&nbsp;};<br>
&nbsp;&nbsp;struct&nbsp;U&nbsp;:&nbsp;public&nbsp;R,&nbsp;virtual&nbsp;public&nbsp;T&nbsp;{&nbsp;virtual&nbsp;void&nbsp;u&nbsp;();&nbsp;};<br>
<br>
&lt;/code&gt;&lt;/pre&gt;<br>
<br>
R&nbsp;is&nbsp;the&nbsp;primary&nbsp;base&nbsp;class&nbsp;for&nbsp;U&nbsp;since&nbsp;it&nbsp;is&nbsp;the&nbsp;first&nbsp;direct<br>
non-virtual&nbsp;dynamic&nbsp;base.<br>
Then,&nbsp;since&nbsp;an&nbsp;inheritance-order&nbsp;walk&nbsp;of&nbsp;U&nbsp;is&nbsp;{&nbsp;U,&nbsp;R,&nbsp;T,&nbsp;S&nbsp;}<br>
the&nbsp;T&nbsp;base&nbsp;is&nbsp;allocated&nbsp;next.<br>
Since&nbsp;S&nbsp;is&nbsp;a&nbsp;primary&nbsp;base&nbsp;of&nbsp;T,<br>
there&nbsp;is&nbsp;no&nbsp;need&nbsp;to&nbsp;allocate&nbsp;it&nbsp;separately.<br>
However,&nbsp;given:<br>
<br>
&lt;pre&gt;&lt;code&gt;<br>
&nbsp;&nbsp;struct&nbsp;V&nbsp;:&nbsp;public&nbsp;R,&nbsp;virtual&nbsp;public&nbsp;S,&nbsp;virtual&nbsp;public&nbsp;T&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;v&nbsp;();<br>
&nbsp;&nbsp;};<br>
<br>
&lt;/code&gt;&lt;/pre&gt;<br>
<br>
the&nbsp;inheritance-order&nbsp;walk&nbsp;of&nbsp;V&nbsp;is&nbsp;{&nbsp;V,&nbsp;R,&nbsp;S,&nbsp;T&nbsp;}.<br>
Nevertheless,&nbsp;although&nbsp;S&nbsp;is&nbsp;considered&nbsp;for&nbsp;allocation&nbsp;first&nbsp;as&nbsp;a&nbsp;virtual&nbsp;base,<br>
it&nbsp;is&nbsp;not&nbsp;allocated&nbsp;separately&nbsp;because&nbsp;it&nbsp;is&nbsp;a&nbsp;primary&nbsp;base&nbsp;of&nbsp;T,<br>
another&nbsp;base.<br>
Thus&nbsp;sizeof&nbsp;(V)&nbsp;==&nbsp;sizeof&nbsp;(U),<br>
and&nbsp;the&nbsp;full&nbsp;layout&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;C&nbsp;struct:<br>
&lt;/i&gt;<br>
<br>
&lt;pre&gt;&lt;code&gt;<br>
&nbsp;&nbsp;struct&nbsp;X&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;r;<br>
&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;t;<br>
&nbsp;&nbsp;};<br>
<br>
&lt;/code&gt;&lt;/pre&gt;<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;&lt;h5&gt;&nbsp;Finalization&nbsp;&lt;/h5&gt;<br>
&lt;p&gt;<br>
Round&nbsp;sizeof(C)&nbsp;up&nbsp;to&nbsp;a&nbsp;non-zero&nbsp;multiple&nbsp;of&nbsp;align(C).<br>
<br>
&lt;/ol&gt;<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=vtable&gt;<br>
&lt;h3&gt;&nbsp;2.5&nbsp;Virtual&nbsp;Table&nbsp;Layout&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;2.5.1&nbsp;General&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
A&nbsp;&lt;i&gt;virtual&nbsp;table&lt;/i&gt;&nbsp;(&lt;i&gt;vtable&lt;/i&gt;)&nbsp;is&nbsp;a&nbsp;table&nbsp;of&nbsp;information&nbsp;used<br>
to&nbsp;dispatch&nbsp;virtual&nbsp;functions,<br>
to&nbsp;access&nbsp;virtual&nbsp;base&nbsp;class&nbsp;subobjects,<br>
and&nbsp;to&nbsp;access&nbsp;information&nbsp;for&nbsp;runtime&nbsp;type&nbsp;identification&nbsp;(RTTI).<br>
Each&nbsp;class&nbsp;that&nbsp;has&nbsp;virtual&nbsp;member&nbsp;functions&nbsp;or&nbsp;virtual&nbsp;bases<br>
has&nbsp;an&nbsp;associated&nbsp;set&nbsp;of&nbsp;virtual&nbsp;tables.<br>
There&nbsp;may&nbsp;be&nbsp;multiple&nbsp;virtual&nbsp;tables&nbsp;for&nbsp;a&nbsp;particular&nbsp;class,<br>
if&nbsp;it&nbsp;is&nbsp;used&nbsp;as&nbsp;a&nbsp;base&nbsp;class&nbsp;for&nbsp;other&nbsp;classes.<br>
However,&nbsp;the&nbsp;virtual&nbsp;table&nbsp;pointers&nbsp;within&nbsp;all&nbsp;the&nbsp;objects&nbsp;(instances)<br>
of&nbsp;a&nbsp;particular&nbsp;most-derived&nbsp;class&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;set&nbsp;of&nbsp;virtual&nbsp;tables.<br>
<br>
&lt;p&gt;<br>
A&nbsp;virtual&nbsp;table&nbsp;consists&nbsp;of&nbsp;a&nbsp;sequence&nbsp;of&nbsp;offsets,&nbsp;data&nbsp;pointers,<br>
and&nbsp;function&nbsp;pointers,&nbsp;as&nbsp;well&nbsp;as&nbsp;structures&nbsp;composed&nbsp;of&nbsp;such&nbsp;items.<br>
We&nbsp;will&nbsp;describe&nbsp;below&nbsp;the&nbsp;sequence&nbsp;of&nbsp;such&nbsp;items.<br>
Their&nbsp;offsets&nbsp;within&nbsp;the&nbsp;virtual&nbsp;table&nbsp;are&nbsp;determined&nbsp;by&nbsp;that&nbsp;allocation<br>
sequence&nbsp;and&nbsp;the&nbsp;natural&nbsp;ABI&nbsp;size&nbsp;and&nbsp;alignment,<br>
just&nbsp;as&nbsp;a&nbsp;data&nbsp;struct&nbsp;would&nbsp;be.&nbsp;&nbsp;In&nbsp;particular:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;Offsets&nbsp;are&nbsp;of&nbsp;type&nbsp;&lt;code&gt;ptrdiff_t&lt;/code&gt;&nbsp;unless&nbsp;otherwise&nbsp;stated.<br>
&lt;li&gt;&nbsp;Data&nbsp;pointers&nbsp;have&nbsp;normal&nbsp;pointer&nbsp;size&nbsp;and&nbsp;alignment.<br>
&lt;li&gt;&nbsp;Function&nbsp;pointers&nbsp;remain&nbsp;to&nbsp;be&nbsp;defined.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;One&nbsp;possibility&nbsp;is&nbsp;that&nbsp;they&nbsp;will&nbsp;be<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;function&nbsp;address,&nbsp;GP&nbsp;address&gt;&nbsp;pairs,&nbsp;with&nbsp;pointer&nbsp;alignment.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
In&nbsp;general,&nbsp;what&nbsp;we&nbsp;consider&nbsp;the&nbsp;address&nbsp;of&nbsp;a&nbsp;virtual&nbsp;table<br>
(i.e.&nbsp;the&nbsp;address&nbsp;contained&nbsp;in&nbsp;objects&nbsp;pointing&nbsp;to&nbsp;a&nbsp;virtual&nbsp;table)<br>
may&nbsp;not&nbsp;be&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;virtual&nbsp;table.<br>
We&nbsp;call&nbsp;it&nbsp;the&nbsp;&lt;i&gt;address&nbsp;point&lt;/i&gt;&nbsp;of&nbsp;the&nbsp;virtual&nbsp;table.<br>
The&nbsp;virtual&nbsp;table&nbsp;may&nbsp;therefore&nbsp;contain&nbsp;components&nbsp;at&nbsp;either&nbsp;positive&nbsp;or<br>
negative&nbsp;offsets&nbsp;from&nbsp;its&nbsp;address&nbsp;point.<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;2.5.2&nbsp;Virtual&nbsp;Table&nbsp;Components&nbsp;and&nbsp;Order&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
This&nbsp;section&nbsp;describes&nbsp;the&nbsp;usage&nbsp;and&nbsp;relative&nbsp;order&nbsp;of&nbsp;various<br>
components&nbsp;that&nbsp;may&nbsp;appear&nbsp;in&nbsp;virtual&nbsp;tables.<br>
Precisely&nbsp;which&nbsp;components&nbsp;are&nbsp;present&nbsp;in&nbsp;various&nbsp;possible&nbsp;virtual<br>
tables&nbsp;is&nbsp;specified&nbsp;in&nbsp;the&nbsp;next&nbsp;section.<br>
If&nbsp;present,&nbsp;components&nbsp;are&nbsp;present&nbsp;in&nbsp;the&nbsp;order&nbsp;described,<br>
except&nbsp;for&nbsp;the&nbsp;exceptions&nbsp;specified.<br>
<br>
&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
&lt;i&gt;Virtual&nbsp;call&nbsp;(vcall)&nbsp;offsets&lt;/i&gt;&nbsp;are&nbsp;used<br>
to&nbsp;perform&nbsp;pointer&nbsp;adjustment&nbsp;for&nbsp;virtual&nbsp;functions<br>
that&nbsp;are&nbsp;declared&nbsp;in&nbsp;a&nbsp;virtual&nbsp;base&nbsp;class&nbsp;or&nbsp;its&nbsp;subobjects<br>
and&nbsp;overridden&nbsp;in&nbsp;a&nbsp;class&nbsp;derived&nbsp;from&nbsp;it.<br>
These&nbsp;entries&nbsp;are&nbsp;allocated&nbsp;in&nbsp;the&nbsp;virtual&nbsp;table&nbsp;for&nbsp;the&nbsp;virtual&nbsp;base&nbsp;class<br>
that&nbsp;is&nbsp;most&nbsp;immediately&nbsp;derived&nbsp;from&nbsp;the&nbsp;base&nbsp;class&nbsp;containing&nbsp;the<br>
overridden&nbsp;virtual&nbsp;function&nbsp;declaration.<br>
They&nbsp;are&nbsp;used<br>
to&nbsp;find&nbsp;the&nbsp;necessary&nbsp;adjustment&nbsp;from&nbsp;the&nbsp;virtual&nbsp;base&nbsp;to&nbsp;the<br>
derived&nbsp;class&nbsp;containing&nbsp;the&nbsp;overrider,<br>
if&nbsp;any.<br>
When&nbsp;a&nbsp;virtual&nbsp;function&nbsp;is&nbsp;invoked&nbsp;via&nbsp;a&nbsp;virtual&nbsp;base,<br>
but&nbsp;has&nbsp;been&nbsp;overridden&nbsp;in&nbsp;a&nbsp;derived&nbsp;class,<br>
the&nbsp;overriding&nbsp;function&nbsp;first&nbsp;adds&nbsp;a&nbsp;fixed&nbsp;offset&nbsp;to&nbsp;adjust&nbsp;the<br>
&lt;code&gt;this&lt;/code&gt;&nbsp;pointer&nbsp;to&nbsp;the&nbsp;virtual&nbsp;base,<br>
and&nbsp;then&nbsp;adds&nbsp;the&nbsp;value&nbsp;contained&nbsp;at&nbsp;the&nbsp;vcall&nbsp;offset<br>
in&nbsp;the&nbsp;virtual&nbsp;base&nbsp;to&nbsp;its&nbsp;&lt;code&gt;this&lt;/code&gt;&nbsp;pointer<br>
to&nbsp;get&nbsp;the&nbsp;address&nbsp;of&nbsp;the&nbsp;derived&nbsp;object&nbsp;where&nbsp;the&nbsp;function&nbsp;was&nbsp;overridden.<br>
These&nbsp;values&nbsp;may&nbsp;be&nbsp;positive&nbsp;or&nbsp;negative.<br>
These&nbsp;are&nbsp;first&nbsp;in&nbsp;the&nbsp;virtual&nbsp;table&nbsp;if&nbsp;present,<br>
ordered&nbsp;as&nbsp;specified&nbsp;in&nbsp;categories&nbsp;3&nbsp;and&nbsp;4&nbsp;of&nbsp;Section&nbsp;2.5.3&nbsp;below.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
&lt;a&nbsp;name=q1&gt;<br>
&lt;i&gt;Virtual&nbsp;Base&nbsp;(vbase)&nbsp;offsets&lt;/i&gt;&nbsp;are&nbsp;used&nbsp;to&nbsp;access<br>
the&nbsp;virtual&nbsp;bases&nbsp;of&nbsp;an&nbsp;object.<br>
Such&nbsp;an&nbsp;entry&nbsp;is&nbsp;added&nbsp;to&nbsp;the&nbsp;derived&nbsp;class&nbsp;object&nbsp;address<br>
(i.e.&nbsp;the&nbsp;address&nbsp;of&nbsp;its&nbsp;virtual&nbsp;table&nbsp;pointer)<br>
to&nbsp;get&nbsp;the&nbsp;address&nbsp;of&nbsp;a&nbsp;virtual&nbsp;base&nbsp;class&nbsp;subobject.<br>
Such&nbsp;an&nbsp;entry&nbsp;is&nbsp;required&nbsp;for&nbsp;each&nbsp;virtual&nbsp;base&nbsp;class.<br>
The&nbsp;values&nbsp;can&nbsp;be&nbsp;positive&nbsp;or&nbsp;negative.<br>
<br>
&lt;br&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
However,&nbsp;in&nbsp;classes&nbsp;sharing&nbsp;a&nbsp;virtual&nbsp;table&nbsp;with&nbsp;a&nbsp;primary&nbsp;base&nbsp;class,<br>
the&nbsp;vcall&nbsp;and&nbsp;vbase&nbsp;offsets&nbsp;added&nbsp;by&nbsp;the&nbsp;derived&nbsp;class&nbsp;all&nbsp;come&nbsp;before<br>
the&nbsp;vcall&nbsp;and&nbsp;vbase&nbsp;offsets&nbsp;required&nbsp;by&nbsp;the&nbsp;base&nbsp;class,<br>
so&nbsp;that&nbsp;the&nbsp;latter&nbsp;may&nbsp;be&nbsp;laid&nbsp;out&nbsp;as&nbsp;required&nbsp;by&nbsp;the&nbsp;base&nbsp;class<br>
without&nbsp;regard&nbsp;to&nbsp;additions&nbsp;from&nbsp;the&nbsp;derived&nbsp;class(es).<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
The&nbsp;&lt;i&gt;offset&nbsp;to&nbsp;top&lt;/i&gt;&nbsp;holds&nbsp;the&nbsp;displacement&nbsp;to&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;object<br>
from&nbsp;the&nbsp;location&nbsp;within&nbsp;the&nbsp;object&nbsp;of&nbsp;the&nbsp;virtual&nbsp;table&nbsp;pointer<br>
that&nbsp;addresses&nbsp;this&nbsp;virtual&nbsp;table,<br>
as&nbsp;a&nbsp;&nbsp;&lt;code&gt;ptrdiff_t&lt;/code&gt;.<br>
It&nbsp;is&nbsp;always&nbsp;present.<br>
The&nbsp;offset&nbsp;provides&nbsp;a&nbsp;way&nbsp;to&nbsp;find&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;object&nbsp;from&nbsp;any&nbsp;base<br>
subobject&nbsp;with&nbsp;a&nbsp;virtual&nbsp;table&nbsp;pointer.<br>
This&nbsp;is&nbsp;necessary&nbsp;for&nbsp;dynamic_cast&lt;void*&gt;&nbsp;in&nbsp;particular.<br>
<br>
&lt;br&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
In&nbsp;a&nbsp;complete&nbsp;object&nbsp;virtual&nbsp;table,<br>
and&nbsp;therefore&nbsp;in&nbsp;all&nbsp;of&nbsp;its&nbsp;primary&nbsp;base&nbsp;virtual&nbsp;tables,<br>
the&nbsp;value&nbsp;of&nbsp;this&nbsp;offset&nbsp;will&nbsp;be&nbsp;zero.<br>
For&nbsp;the&nbsp;secondary&nbsp;virtual&nbsp;tables&nbsp;of&nbsp;other&nbsp;non-virtual&nbsp;bases,<br>
and&nbsp;of&nbsp;many&nbsp;virtual&nbsp;bases,<br>
it&nbsp;will&nbsp;be&nbsp;negative.<br>
Only&nbsp;in&nbsp;some&nbsp;construction&nbsp;virtual&nbsp;tables&nbsp;will&nbsp;some&nbsp;virtual&nbsp;base&nbsp;virtual<br>
tables&nbsp;have<br>
positive&nbsp;offsets,&nbsp;due&nbsp;to&nbsp;a&nbsp;different&nbsp;ordering&nbsp;of&nbsp;the&nbsp;virtual&nbsp;bases&nbsp;in<br>
the&nbsp;full&nbsp;object&nbsp;than&nbsp;in&nbsp;the&nbsp;subobject's&nbsp;standalone&nbsp;layout.<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
The&nbsp;&lt;i&gt;typeinfo&nbsp;pointer&lt;/i&gt;&nbsp;points&nbsp;to&nbsp;the&nbsp;typeinfo&nbsp;object&nbsp;used&nbsp;for&nbsp;RTTI.<br>
It&nbsp;is&nbsp;always&nbsp;present.<br>
All&nbsp;entries&nbsp;in&nbsp;each&nbsp;of&nbsp;the&nbsp;virtual&nbsp;tables&nbsp;for&nbsp;a&nbsp;given&nbsp;class&nbsp;must&nbsp;point&nbsp;to&nbsp;the<br>
same&nbsp;typeinfo&nbsp;object.<br>
A&nbsp;correct&nbsp;implementation&nbsp;of&nbsp;typeinfo&nbsp;equality&nbsp;is&nbsp;to&nbsp;check&nbsp;pointer&nbsp;equality,<br>
except&nbsp;for&nbsp;pointers&nbsp;(directly&nbsp;or&nbsp;indirectly)&nbsp;to&nbsp;incomplete&nbsp;types.<br>
The&nbsp;typeinfo&nbsp;pointer&nbsp;is&nbsp;a&nbsp;valid&nbsp;pointer&nbsp;for&nbsp;polymorphic&nbsp;classes,<br>
i.e.&nbsp;those&nbsp;with&nbsp;virtual&nbsp;functions,<br>
and&nbsp;is&nbsp;zero&nbsp;for&nbsp;non-polymorphic&nbsp;classes.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
The&nbsp;virtual&nbsp;table&nbsp;address&nbsp;point&nbsp;points&nbsp;here,<br>
i.e.&nbsp;this&nbsp;is&nbsp;the&nbsp;virtual&nbsp;table&nbsp;address<br>
contained&nbsp;in&nbsp;an&nbsp;object's&nbsp;virtual&nbsp;pointer.<br>
This&nbsp;address&nbsp;must&nbsp;have&nbsp;the&nbsp;alignment&nbsp;required&nbsp;for&nbsp;pointers.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
&lt;i&gt;Virtual&nbsp;function&nbsp;pointers&lt;/i&gt;&nbsp;are&nbsp;used&nbsp;for&nbsp;virtual&nbsp;function&nbsp;dispatch.<br>
Each&nbsp;pointer&nbsp;holds&nbsp;either&nbsp;the&nbsp;address&nbsp;of&nbsp;a&nbsp;virtual&nbsp;function&nbsp;of&nbsp;the&nbsp;class,<br>
or&nbsp;the&nbsp;address&nbsp;of&nbsp;a&nbsp;secondary&nbsp;entry&nbsp;point&nbsp;that&nbsp;performs&nbsp;certain<br>
adjustments&nbsp;before&nbsp;transferring&nbsp;control&nbsp;to&nbsp;a&nbsp;virtual&nbsp;function.<br>
<br>
&lt;p&gt;<br>
The&nbsp;form&nbsp;of&nbsp;a&nbsp;virtual&nbsp;function&nbsp;pointer&nbsp;is&nbsp;specified&nbsp;by&nbsp;the<br>
processor-specific&nbsp;C++&nbsp;ABI&nbsp;for&nbsp;the&nbsp;implementation.<br>
In&nbsp;the&nbsp;specific&nbsp;case&nbsp;of&nbsp;64-bit&nbsp;Itanium&nbsp;shared&nbsp;library&nbsp;builds,<br>
a&nbsp;virtual&nbsp;function&nbsp;pointer&nbsp;entry&nbsp;contains&nbsp;a&nbsp;pair&nbsp;of&nbsp;components<br>
(each&nbsp;64&nbsp;bits):<br>
the&nbsp;value&nbsp;of&nbsp;the&nbsp;target&nbsp;GP&nbsp;value&nbsp;and&nbsp;the&nbsp;actual&nbsp;function&nbsp;address.<br>
That&nbsp;is,&nbsp;rather&nbsp;than&nbsp;being&nbsp;a&nbsp;normal&nbsp;function&nbsp;pointer,<br>
which&nbsp;points&nbsp;to&nbsp;such&nbsp;a&nbsp;two-component&nbsp;descriptor,<br>
a&nbsp;virtual&nbsp;function&nbsp;pointer&nbsp;entry&nbsp;is&nbsp;the&nbsp;descriptor.<br>
<br>
&lt;p&gt;<br>
The&nbsp;order&nbsp;of&nbsp;the&nbsp;virtual&nbsp;function&nbsp;pointers&nbsp;in&nbsp;a&nbsp;virtual&nbsp;table&nbsp;is&nbsp;the&nbsp;order<br>
of&nbsp;declaration&nbsp;of&nbsp;the&nbsp;corresponding&nbsp;member&nbsp;functions&nbsp;in&nbsp;the&nbsp;class.<br>
There&nbsp;is&nbsp;an&nbsp;entry&nbsp;for&nbsp;any&nbsp;virtual&nbsp;function&nbsp;declared&nbsp;in&nbsp;a&nbsp;class,<br>
whether&nbsp;it&nbsp;is&nbsp;a&nbsp;new&nbsp;function&nbsp;or&nbsp;overrides&nbsp;a&nbsp;base&nbsp;class&nbsp;function,<br>
unless&nbsp;it&nbsp;overrides&nbsp;a&nbsp;function&nbsp;from&nbsp;the&nbsp;primary&nbsp;base,<br>
and&nbsp;conversion&nbsp;between&nbsp;their&nbsp;return&nbsp;types&nbsp;does&nbsp;not&nbsp;require&nbsp;an&nbsp;adjustment.<br>
(In&nbsp;the&nbsp;case&nbsp;of&nbsp;this&nbsp;exception,<br>
the&nbsp;primary&nbsp;base&nbsp;and&nbsp;the&nbsp;derived&nbsp;class&nbsp;share&nbsp;the&nbsp;virtual&nbsp;table,<br>
and&nbsp;can&nbsp;share&nbsp;the&nbsp;virtual&nbsp;function&nbsp;entry&nbsp;because&nbsp;their&nbsp;'this'&nbsp;and<br>
result&nbsp;type&nbsp;adjustments&nbsp;are&nbsp;the&nbsp;same.)<br>
If&nbsp;a&nbsp;class&nbsp;has&nbsp;an&nbsp;implicitly-defined&nbsp;virtual&nbsp;destructor,<br>
its&nbsp;entries&nbsp;come&nbsp;after&nbsp;the&nbsp;declared&nbsp;virtual&nbsp;function&nbsp;pointers.<br>
<br>
&lt;p&gt;<br>
When&nbsp;a&nbsp;derived&nbsp;class&nbsp;and&nbsp;its&nbsp;primary&nbsp;base&nbsp;share&nbsp;a&nbsp;virtual&nbsp;table,<br>
the&nbsp;virtual&nbsp;function&nbsp;entries&nbsp;introduced&nbsp;by&nbsp;the&nbsp;derived&nbsp;class&nbsp;follow<br>
those&nbsp;for&nbsp;the&nbsp;primary&nbsp;base,<br>
so&nbsp;that&nbsp;the&nbsp;layout&nbsp;of&nbsp;the&nbsp;primary&nbsp;base's&nbsp;embedded&nbsp;virtual&nbsp;table<br>
is&nbsp;the&nbsp;same&nbsp;as&nbsp;that&nbsp;of&nbsp;its&nbsp;standalone&nbsp;virtual&nbsp;table.<br>
In&nbsp;particular,&nbsp;if&nbsp;the&nbsp;derived&nbsp;class&nbsp;overrides&nbsp;a&nbsp;base&nbsp;class&nbsp;virtual<br>
function&nbsp;with&nbsp;a&nbsp;different&nbsp;(covariant)&nbsp;return&nbsp;type,<br>
the&nbsp;entry&nbsp;for&nbsp;the&nbsp;derived&nbsp;class&nbsp;comes&nbsp;after&nbsp;the&nbsp;primary&nbsp;base's<br>
embedded&nbsp;virtual&nbsp;table&nbsp;in&nbsp;declaration&nbsp;order,<br>
and&nbsp;is&nbsp;the&nbsp;entry&nbsp;used&nbsp;for&nbsp;calls&nbsp;from&nbsp;the&nbsp;derived&nbsp;class&nbsp;without&nbsp;adjustment.<br>
The&nbsp;entry&nbsp;in&nbsp;the&nbsp;embedded&nbsp;primary&nbsp;virtual&nbsp;table&nbsp;points&nbsp;to&nbsp;a&nbsp;routine<br>
that&nbsp;adjusts&nbsp;the&nbsp;result&nbsp;pointer&nbsp;before&nbsp;returning.<br>
<br>
&lt;p&gt;<br>
The&nbsp;entries&nbsp;for&nbsp;virtual&nbsp;destructors&nbsp;are&nbsp;actually&nbsp;pairs&nbsp;of&nbsp;entries.<br>
The&nbsp;first&nbsp;destructor,<br>
called&nbsp;the&nbsp;non-deleting&nbsp;in-charge&nbsp;destructor,<br>
performs&nbsp;the&nbsp;destruction&nbsp;without&nbsp;calling&nbsp;delete()&nbsp;on&nbsp;the&nbsp;object.<br>
The&nbsp;second&nbsp;destructor,<br>
called&nbsp;the&nbsp;deleting&nbsp;in-charge&nbsp;destructor,<br>
calls&nbsp;delete()&nbsp;after&nbsp;destroying&nbsp;the&nbsp;object.<br>
Both&nbsp;destroy&nbsp;any&nbsp;virtual&nbsp;bases;<br>
a&nbsp;separate,&nbsp;non-virtual&nbsp;function,<br>
called&nbsp;the&nbsp;not-in-charge&nbsp;destructor,<br>
performs&nbsp;destruction&nbsp;of&nbsp;the&nbsp;object&nbsp;but<br>
not&nbsp;its&nbsp;virtual&nbsp;base&nbsp;subobjects,&nbsp;and&nbsp;does&nbsp;not&nbsp;call&nbsp;delete().<br>
<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
Following&nbsp;the&nbsp;primary&nbsp;virtual&nbsp;table&nbsp;of&nbsp;a&nbsp;derived&nbsp;class&nbsp;are<br>
&lt;i&gt;secondary&nbsp;virtual&nbsp;tables&lt;/i&gt;&nbsp;for&nbsp;each&nbsp;of&nbsp;its&nbsp;proper&nbsp;base&nbsp;classes,<br>
except&nbsp;any&nbsp;primary&nbsp;base(s)&nbsp;with&nbsp;which&nbsp;it&nbsp;shares&nbsp;its&nbsp;primary&nbsp;virtual&nbsp;table.<br>
These&nbsp;are&nbsp;copies&nbsp;of&nbsp;the&nbsp;virtual&nbsp;tables&nbsp;for&nbsp;the&nbsp;respective&nbsp;base&nbsp;classes<br>
(copies&nbsp;in&nbsp;the&nbsp;sense&nbsp;that&nbsp;they&nbsp;have&nbsp;the&nbsp;same&nbsp;layout,<br>
though&nbsp;the&nbsp;fields&nbsp;may&nbsp;have&nbsp;different&nbsp;values).<br>
We&nbsp;call&nbsp;the&nbsp;collection&nbsp;consisting&nbsp;of&nbsp;a&nbsp;primary&nbsp;virtual&nbsp;table&nbsp;along&nbsp;with&nbsp;all&nbsp;of<br>
its&nbsp;secondary&nbsp;virtual&nbsp;tables&nbsp;a&nbsp;&lt;i&gt;virtual&nbsp;table&nbsp;group&lt;/i&gt;.<br>
The&nbsp;order&nbsp;in&nbsp;which&nbsp;they&nbsp;occur&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;the<br>
base&nbsp;class&nbsp;subobjects&nbsp;are&nbsp;considered&nbsp;for&nbsp;allocation&nbsp;in&nbsp;the&nbsp;derived&nbsp;object:<br>
<br>
&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
First&nbsp;are&nbsp;the&nbsp;virtual&nbsp;tables&nbsp;of&nbsp;direct&nbsp;non-primary,&nbsp;non-virtual&nbsp;proper&nbsp;bases,<br>
in&nbsp;the&nbsp;order&nbsp;declared,<br>
including&nbsp;their&nbsp;secondary&nbsp;virtual&nbsp;tables&nbsp;for&nbsp;non-virtual&nbsp;bases&nbsp;in&nbsp;the&nbsp;order<br>
they&nbsp;appear&nbsp;in&nbsp;the&nbsp;standalone&nbsp;virtual&nbsp;table&nbsp;group&nbsp;for&nbsp;the&nbsp;base.<br>
(Thus&nbsp;the&nbsp;effect&nbsp;is&nbsp;that&nbsp;these&nbsp;virtual&nbsp;tables&nbsp;occur&nbsp;in&nbsp;inheritance&nbsp;graph&nbsp;order,<br>
excluding&nbsp;primary&nbsp;bases&nbsp;and&nbsp;virtual&nbsp;bases.)<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
Then&nbsp;come&nbsp;the&nbsp;virtual&nbsp;base&nbsp;virtual&nbsp;tables,<br>
also&nbsp;in&nbsp;inheritance&nbsp;graph&nbsp;order,<br>
and&nbsp;again&nbsp;excluding&nbsp;primary&nbsp;bases<br>
(which&nbsp;share&nbsp;virtual&nbsp;tables&nbsp;with&nbsp;the&nbsp;classes&nbsp;for&nbsp;which&nbsp;they&nbsp;are&nbsp;primary).<br>
&lt;/ul&gt;<br>
<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;2.5.3&nbsp;Virtual&nbsp;Table&nbsp;Construction&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
In&nbsp;this&nbsp;section,&nbsp;we&nbsp;describe&nbsp;how&nbsp;to&nbsp;construct&nbsp;the&nbsp;virtual&nbsp;table&nbsp;for&nbsp;an&nbsp;class,<br>
given&nbsp;virtual&nbsp;tables&nbsp;for&nbsp;all&nbsp;of&nbsp;its&nbsp;proper&nbsp;base&nbsp;classes.<br>
To&nbsp;do&nbsp;so,&nbsp;we&nbsp;divide&nbsp;classes&nbsp;into&nbsp;several&nbsp;categories,<br>
based&nbsp;on&nbsp;their&nbsp;base&nbsp;class&nbsp;structure.<br>
<br>
&lt;p&gt;<br>
&lt;h5&gt;&nbsp;Category&nbsp;0:&nbsp;Trivial&nbsp;&lt;/h5&gt;<br>
<br>
Structure:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;No&nbsp;virtual&nbsp;base&nbsp;classes.<br>
&lt;li&gt;&nbsp;No&nbsp;virtual&nbsp;functions.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
Such&nbsp;a&nbsp;class&nbsp;has&nbsp;no&nbsp;associated&nbsp;virtual&nbsp;table,<br>
and&nbsp;an&nbsp;object&nbsp;of&nbsp;such&nbsp;a&nbsp;class&nbsp;contains&nbsp;no&nbsp;virtual&nbsp;pointer.<br>
<br>
&lt;p&gt;<br>
&lt;h5&gt;&nbsp;Category&nbsp;1:&nbsp;Leaf&nbsp;&lt;/h5&gt;<br>
<br>
Structure:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;No&nbsp;inherited&nbsp;virtual&nbsp;functions.<br>
&lt;li&gt;&nbsp;No&nbsp;virtual&nbsp;base&nbsp;classes.<br>
&lt;li&gt;&nbsp;Declares&nbsp;virtual&nbsp;functions.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;virtual&nbsp;table&nbsp;contains&nbsp;offset-to-top&nbsp;and&nbsp;RTTI&nbsp;fields<br>
followed&nbsp;by&nbsp;virtual&nbsp;function&nbsp;pointers.<br>
There&nbsp;is&nbsp;one&nbsp;function&nbsp;pointer&nbsp;entry&nbsp;for&nbsp;each<br>
virtual&nbsp;function&nbsp;declared&nbsp;in&nbsp;the&nbsp;class,<br>
in&nbsp;declaration&nbsp;order,<br>
with&nbsp;any&nbsp;implicitly-defined&nbsp;virtual&nbsp;destructor&nbsp;pair&nbsp;last.<br>
<br>
&lt;p&gt;<br>
&lt;h5&gt;&nbsp;Category&nbsp;2:&nbsp;Non-Virtual&nbsp;Bases&nbsp;Only&nbsp;&lt;/h5&gt;<br>
<br>
Structure:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;Only&nbsp;non-virtual&nbsp;proper&nbsp;base&nbsp;classes.<br>
&lt;li&gt;&nbsp;Inherits&nbsp;virtual&nbsp;functions.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;class&nbsp;has&nbsp;a&nbsp;virtual&nbsp;table&nbsp;for&nbsp;each&nbsp;proper&nbsp;base&nbsp;class<br>
that&nbsp;has&nbsp;a&nbsp;virtual&nbsp;table.<br>
These&nbsp;secondary&nbsp;virtual&nbsp;tables&nbsp;for&nbsp;the&nbsp;class<br>
are&nbsp;constructed&nbsp;from&nbsp;copies&nbsp;of&nbsp;the&nbsp;base&nbsp;class&nbsp;complete&nbsp;object&nbsp;virtual&nbsp;tables.<br>
The&nbsp;entries&nbsp;are&nbsp;the&nbsp;same,&nbsp;except:<br>
<br>
&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;The&nbsp;offset-to-top&nbsp;and&nbsp;RTTI&nbsp;fields<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;contain&nbsp;information&nbsp;for&nbsp;the&nbsp;class,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rather&nbsp;than&nbsp;for&nbsp;the&nbsp;base&nbsp;class.&nbsp;<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;The&nbsp;function&nbsp;pointer&nbsp;entries&nbsp;for&nbsp;virtual&nbsp;functions&nbsp;inherited&nbsp;from<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;base&nbsp;class&nbsp;and&nbsp;overridden&nbsp;by&nbsp;this&nbsp;class&nbsp;are&nbsp;replaced&nbsp;with&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addresses&nbsp;of&nbsp;the&nbsp;overriding&nbsp;functions<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(or&nbsp;the&nbsp;corresponding&nbsp;adjustor&nbsp;secondary&nbsp;entry&nbsp;points).<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
For&nbsp;a&nbsp;proper&nbsp;base&nbsp;class&nbsp;&lt;code&gt;Base&lt;/code&gt;,<br>
and&nbsp;a&nbsp;derived&nbsp;class&nbsp;&lt;code&gt;Derived&lt;/code&gt;&nbsp;for&nbsp;which&nbsp;we&nbsp;are&nbsp;constructing<br>
this&nbsp;set&nbsp;of&nbsp;virtual&nbsp;tables,<br>
we&nbsp;shall&nbsp;refer&nbsp;to&nbsp;the&nbsp;virtual&nbsp;table&nbsp;for&nbsp;&lt;code&gt;Base&lt;/code&gt;&nbsp;as<br>
&lt;code&gt;Base-in-Derived&lt;/code&gt;.<br>
The&nbsp;virtual&nbsp;pointer&nbsp;of&nbsp;each&nbsp;base&nbsp;subobject&nbsp;of&nbsp;an&nbsp;object&nbsp;of&nbsp;the<br>
derived&nbsp;class&nbsp;will&nbsp;point&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;base&nbsp;virtual&nbsp;table&nbsp;in&nbsp;this&nbsp;set.<br>
<br>
&lt;p&gt;<br>
The&nbsp;virtual&nbsp;table&nbsp;copied&nbsp;from&nbsp;the&nbsp;primary&nbsp;base&nbsp;class&nbsp;is&nbsp;also&nbsp;called&nbsp;the<br>
primary&nbsp;virtual&nbsp;table;<br>
it&nbsp;is&nbsp;addressed&nbsp;by&nbsp;the&nbsp;virtual&nbsp;table&nbsp;pointer&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;object.<br>
The&nbsp;other&nbsp;virtual&nbsp;tables&nbsp;of&nbsp;the&nbsp;class&nbsp;are&nbsp;called&nbsp;secondary&nbsp;virtual&nbsp;tables;<br>
they&nbsp;are&nbsp;addressed&nbsp;by&nbsp;virtual&nbsp;table&nbsp;pointers&nbsp;inside&nbsp;the&nbsp;object.<br>
<br>
&lt;p&gt;<br>
Following&nbsp;the&nbsp;function&nbsp;pointer&nbsp;entries&nbsp;that&nbsp;correspond<br>
to&nbsp;those&nbsp;of&nbsp;the&nbsp;primary&nbsp;base&nbsp;class,<br>
the&nbsp;primary&nbsp;virtual&nbsp;table&nbsp;holds&nbsp;the&nbsp;following&nbsp;additional&nbsp;entries<br>
at&nbsp;its&nbsp;tail:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;Entries&nbsp;for&nbsp;virtual&nbsp;functions&nbsp;introduced&nbsp;by&nbsp;this&nbsp;class,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.e.&nbsp;those&nbsp;not&nbsp;declared&nbsp;by&nbsp;any&nbsp;of&nbsp;its&nbsp;bases.<br>
<br>
&lt;li&gt;&nbsp;Entries&nbsp;for&nbsp;overridden&nbsp;virtual&nbsp;functions&nbsp;not&nbsp;already&nbsp;present<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;the&nbsp;virtual&nbsp;table&nbsp;of&nbsp;the&nbsp;primary&nbsp;base&nbsp;class&nbsp;(if&nbsp;any),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;called&nbsp;replicated&nbsp;entries&nbsp;because&nbsp;they&nbsp;are&nbsp;already<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;the&nbsp;secondary&nbsp;virtual&nbsp;tables&nbsp;of&nbsp;the&nbsp;class.<br>
<br>
&lt;li&gt;&nbsp;Entries&nbsp;for&nbsp;overridden&nbsp;virtual&nbsp;functions&nbsp;from&nbsp;the&nbsp;primary<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;class,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;only&nbsp;if&nbsp;the&nbsp;result&nbsp;types&nbsp;are&nbsp;different&nbsp;(covariant).<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;purposes&nbsp;of&nbsp;this&nbsp;case,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;two&nbsp;types&nbsp;are&nbsp;considered&nbsp;different&nbsp;if&nbsp;one&nbsp;of&nbsp;them&nbsp;is&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;non-primary&nbsp;or&nbsp;virtual&nbsp;base&nbsp;class&nbsp;of&nbsp;the&nbsp;other.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(If&nbsp;the&nbsp;base&nbsp;is&nbsp;primary,&nbsp;no&nbsp;result&nbsp;pointer&nbsp;adjustment&nbsp;is&nbsp;required.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;But&nbsp;if&nbsp;it&nbsp;is&nbsp;virtual,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;may&nbsp;not&nbsp;be&nbsp;primary&nbsp;in&nbsp;a&nbsp;more-derived&nbsp;class&nbsp;hierarchy.)<br>
&lt;/ul&gt;<br>
<br>
The&nbsp;primary&nbsp;virtual&nbsp;table,&nbsp;therefore,<br>
has&nbsp;the&nbsp;base&nbsp;class&nbsp;functions&nbsp;appearing&nbsp;before&nbsp;the&nbsp;derived&nbsp;class&nbsp;functions,<br>
with&nbsp;the&nbsp;derived&nbsp;class&nbsp;functions&nbsp;from&nbsp;all&nbsp;three&nbsp;sets&nbsp;above&nbsp;appearing&nbsp;in<br>
declaration&nbsp;order.<br>
The&nbsp;primary&nbsp;virtual&nbsp;table&nbsp;can&nbsp;be&nbsp;viewed&nbsp;as&nbsp;two&nbsp;virtual&nbsp;tables&nbsp;accessed<br>
from&nbsp;a&nbsp;shared&nbsp;virtual&nbsp;table&nbsp;pointer.&nbsp;<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
A&nbsp;benefit&nbsp;of&nbsp;replicated&nbsp;virtual&nbsp;function&nbsp;entries&nbsp;is&nbsp;that&nbsp;they<br>
reduce&nbsp;the&nbsp;number&nbsp;of&nbsp;this&nbsp;pointer&nbsp;adjustments&nbsp;during&nbsp;virtual&nbsp;calls.<br>
Without&nbsp;replication,<br>
there&nbsp;would&nbsp;be&nbsp;more&nbsp;cases&nbsp;where&nbsp;the&nbsp;this&nbsp;pointer&nbsp;would&nbsp;have&nbsp;to&nbsp;be<br>
adjusted&nbsp;to&nbsp;access&nbsp;a&nbsp;secondary&nbsp;virtual&nbsp;table&nbsp;prior&nbsp;to&nbsp;the&nbsp;call.<br>
These&nbsp;additional&nbsp;cases&nbsp;would&nbsp;be&nbsp;exactly&nbsp;those&nbsp;where&nbsp;the&nbsp;function<br>
is&nbsp;overridden&nbsp;in&nbsp;the&nbsp;derived&nbsp;class,<br>
implying&nbsp;an&nbsp;additional&nbsp;thunk&nbsp;adjustment&nbsp;back&nbsp;to&nbsp;the&nbsp;original&nbsp;pointer.<br>
Replication&nbsp;saves&nbsp;two&nbsp;'this'&nbsp;adjustments&nbsp;for&nbsp;each&nbsp;virtual&nbsp;call&nbsp;to&nbsp;an<br>
overridden&nbsp;function&nbsp;originally&nbsp;introduced&nbsp;by&nbsp;a&nbsp;non-primary&nbsp;proper&nbsp;base&nbsp;class.&nbsp;&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
&lt;h5&gt;&nbsp;Category&nbsp;3:&nbsp;Virtual&nbsp;Bases&nbsp;Only&nbsp;&lt;/h5&gt;<br>
<br>
&lt;p&gt;<br>
Structure:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;Only&nbsp;virtual&nbsp;base&nbsp;classes<br>
(but&nbsp;those&nbsp;may&nbsp;have&nbsp;non-virtual&nbsp;bases).<br>
&lt;li&gt;&nbsp;The&nbsp;virtual<br>
base&nbsp;classes&nbsp;are&nbsp;neither&nbsp;empty&nbsp;nor&nbsp;nearly&nbsp;empty.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;class&nbsp;has&nbsp;a&nbsp;virtual&nbsp;table&nbsp;for&nbsp;each&nbsp;virtual&nbsp;base&nbsp;class<br>
that&nbsp;has&nbsp;a&nbsp;virtual&nbsp;table.<br>
These&nbsp;are&nbsp;all&nbsp;secondary&nbsp;virtual&nbsp;tables,<br>
because&nbsp;there&nbsp;are&nbsp;no&nbsp;empty&nbsp;or&nbsp;nearly&nbsp;empty&nbsp;base&nbsp;classes&nbsp;to&nbsp;be&nbsp;primary,<br>
and&nbsp;they&nbsp;are&nbsp;constructed&nbsp;from&nbsp;copies&nbsp;of&nbsp;the&nbsp;base&nbsp;class<br>
full&nbsp;object&nbsp;virtual&nbsp;tables&nbsp;according&nbsp;to&nbsp;the&nbsp;same&nbsp;rules&nbsp;as&nbsp;in&nbsp;Category&nbsp;2,<br>
except&nbsp;that&nbsp;the&nbsp;virtual&nbsp;table&nbsp;for&nbsp;a&nbsp;virtual&nbsp;base&nbsp;A&nbsp;also&nbsp;includes&nbsp;a&nbsp;vcall<br>
offset&nbsp;entry&nbsp;for&nbsp;each&nbsp;virtual&nbsp;function&nbsp;represented&nbsp;in&nbsp;A's&nbsp;primary<br>
virtual&nbsp;table&nbsp;and&nbsp;the&nbsp;secondary&nbsp;virtual&nbsp;tables&nbsp;from&nbsp;A's&nbsp;non-virtual&nbsp;bases.<br>
<br>
&lt;p&gt;<br>
The&nbsp;vcall&nbsp;offsets&nbsp;in&nbsp;the&nbsp;secondary&nbsp;virtual&nbsp;table&nbsp;for&nbsp;a&nbsp;virtual&nbsp;base&nbsp;A&nbsp;are<br>
ordered&nbsp;as&nbsp;described&nbsp;next.<br>
We&nbsp;describe&nbsp;the&nbsp;ordering&nbsp;from&nbsp;the&nbsp;entry&nbsp;closest&nbsp;to&nbsp;the&nbsp;virtual&nbsp;table&nbsp;address<br>
point&nbsp;to&nbsp;that&nbsp;furthest.<br>
Since&nbsp;the&nbsp;vcall&nbsp;offsets&nbsp;precede&nbsp;the&nbsp;virtual&nbsp;table&nbsp;address&nbsp;point,<br>
this&nbsp;means&nbsp;that&nbsp;the&nbsp;memory&nbsp;address&nbsp;order&nbsp;is&nbsp;the&nbsp;reverse&nbsp;of&nbsp;that<br>
described.<br>
&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
If&nbsp;virtual&nbsp;base&nbsp;A&nbsp;has&nbsp;a&nbsp;primary&nbsp;base&nbsp;class&nbsp;P&nbsp;sharing&nbsp;its&nbsp;virtual&nbsp;table,<br>
P's&nbsp;vcall&nbsp;offsets&nbsp;come&nbsp;first,<br>
in&nbsp;the&nbsp;same&nbsp;order&nbsp;they&nbsp;would&nbsp;appear&nbsp;if&nbsp;P&nbsp;itself&nbsp;were&nbsp;the&nbsp;virtual&nbsp;base.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
Next&nbsp;come&nbsp;vcall&nbsp;offsets&nbsp;for&nbsp;each&nbsp;virtual&nbsp;function&nbsp;declared&nbsp;in&nbsp;A,<br>
in&nbsp;declaration&nbsp;order.<br>
Note&nbsp;that&nbsp;even&nbsp;for&nbsp;an&nbsp;overriding&nbsp;virtual&nbsp;function&nbsp;with&nbsp;covariant&nbsp;return<br>
types,&nbsp;only&nbsp;one&nbsp;vcall&nbsp;offset&nbsp;is&nbsp;present,<br>
as&nbsp;it&nbsp;can&nbsp;be&nbsp;shared&nbsp;by&nbsp;both&nbsp;virtual&nbsp;table&nbsp;entries.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
Finally&nbsp;come&nbsp;vcall&nbsp;offsets&nbsp;for&nbsp;virtual&nbsp;functions&nbsp;declared&nbsp;in<br>
non-virtual&nbsp;bases&nbsp;of&nbsp;A&nbsp;other&nbsp;than&nbsp;P.<br>
These&nbsp;bases&nbsp;are&nbsp;considered&nbsp;in&nbsp;inheritance&nbsp;graph&nbsp;preorder,<br>
and&nbsp;the&nbsp;vcall&nbsp;offsets&nbsp;for&nbsp;multiple&nbsp;functions&nbsp;declared&nbsp;in&nbsp;one&nbsp;of&nbsp;them<br>
are&nbsp;in&nbsp;declaration&nbsp;order.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
If&nbsp;the&nbsp;above&nbsp;listing&nbsp;of&nbsp;vcall&nbsp;offsets&nbsp;includes&nbsp;more&nbsp;than&nbsp;one<br>
for&nbsp;a&nbsp;particular&nbsp;virtual&nbsp;function&nbsp;signature,<br>
only&nbsp;the&nbsp;first&nbsp;one&nbsp;(closest&nbsp;to&nbsp;the&nbsp;virtual&nbsp;table&nbsp;address&nbsp;point)&nbsp;is&nbsp;allocated.<br>
That&nbsp;is,&nbsp;an&nbsp;offset&nbsp;from&nbsp;primary&nbsp;base&nbsp;P&nbsp;(and&nbsp;its&nbsp;non-virtual&nbsp;bases)<br>
eliminates&nbsp;any&nbsp;from&nbsp;A&nbsp;or&nbsp;its&nbsp;other&nbsp;bases,<br>
an&nbsp;offset&nbsp;from&nbsp;A&nbsp;eliminates&nbsp;any&nbsp;from&nbsp;the&nbsp;non-primary&nbsp;bases,<br>
and&nbsp;an&nbsp;offset&nbsp;from&nbsp;a&nbsp;non-primary&nbsp;base&nbsp;B&nbsp;of&nbsp;A&nbsp;eliminates&nbsp;any&nbsp;from&nbsp;the<br>
bases&nbsp;of&nbsp;B.<br>
<br>
&lt;p&gt;<br>
&lt;i&gt;<br>
Note&nbsp;that&nbsp;there&nbsp;are&nbsp;no&nbsp;vcall&nbsp;offsets&nbsp;for&nbsp;virtual&nbsp;functions&nbsp;declared&nbsp;in<br>
a&nbsp;virtual&nbsp;base&nbsp;class&nbsp;V&nbsp;of&nbsp;A&nbsp;and&nbsp;never&nbsp;overridden&nbsp;within&nbsp;A&nbsp;or&nbsp;its<br>
non-virtual&nbsp;bases.<br>
Calls&nbsp;to&nbsp;such&nbsp;functions&nbsp;will&nbsp;use&nbsp;the&nbsp;vcall&nbsp;offset&nbsp;in&nbsp;V's&nbsp;virtual&nbsp;table.<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;class&nbsp;also&nbsp;has&nbsp;a&nbsp;virtual&nbsp;table&nbsp;that&nbsp;is&nbsp;not&nbsp;copied&nbsp;from&nbsp;the&nbsp;virtual&nbsp;base<br>
class&nbsp;virtual&nbsp;tables.<br>
This&nbsp;virtual&nbsp;table&nbsp;is&nbsp;the&nbsp;primary&nbsp;virtual&nbsp;table&nbsp;of&nbsp;the&nbsp;class<br>
and&nbsp;is&nbsp;addressed&nbsp;by&nbsp;the&nbsp;virtual&nbsp;table&nbsp;pointer&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;object,<br>
which&nbsp;is&nbsp;not&nbsp;shared<br>
because&nbsp;there&nbsp;are&nbsp;no&nbsp;nearly&nbsp;empty&nbsp;virtual&nbsp;bases&nbsp;to&nbsp;be&nbsp;primary.<br>
It&nbsp;holds&nbsp;the&nbsp;following&nbsp;function&nbsp;pointer&nbsp;entries,<br>
following&nbsp;those&nbsp;of&nbsp;any&nbsp;primary&nbsp;base's&nbsp;virtual&nbsp;table,<br>
in&nbsp;the&nbsp;virtual&nbsp;functions'&nbsp;declaration&nbsp;order:<br>
<br>
&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;Entries&nbsp;for&nbsp;virtual&nbsp;functions&nbsp;introduced&nbsp;by&nbsp;this&nbsp;class,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.e.&nbsp;those&nbsp;not&nbsp;declared&nbsp;by&nbsp;any&nbsp;of&nbsp;its&nbsp;bases.<br>
<br>
&lt;li&gt;&nbsp;Entries&nbsp;for&nbsp;overridden&nbsp;virtual&nbsp;functions&nbsp;from&nbsp;the&nbsp;base&nbsp;classes,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;called&nbsp;replicated&nbsp;entries&nbsp;because&nbsp;they&nbsp;are&nbsp;already<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;the&nbsp;secondary&nbsp;virtual&nbsp;tables&nbsp;of&nbsp;the&nbsp;class.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;primary&nbsp;virtual&nbsp;table&nbsp;also&nbsp;has&nbsp;virtual&nbsp;base&nbsp;offset&nbsp;entries<br>
to&nbsp;allow&nbsp;finding&nbsp;the&nbsp;virtual&nbsp;base&nbsp;subobjects.<br>
There&nbsp;is&nbsp;one&nbsp;virtual&nbsp;base&nbsp;offset&nbsp;entry&nbsp;for&nbsp;each&nbsp;virtual&nbsp;base&nbsp;class,<br>
direct&nbsp;or&nbsp;indirect.<br>
The&nbsp;entries&nbsp;are&nbsp;in&nbsp;the&nbsp;reverse&nbsp;of&nbsp;the&nbsp;inheritance&nbsp;graph&nbsp;order.<br>
That&nbsp;is,&nbsp;the&nbsp;entry&nbsp;for&nbsp;the&nbsp;leftmost&nbsp;virtual<br>
base&nbsp;is&nbsp;closest&nbsp;to&nbsp;the&nbsp;address&nbsp;point&nbsp;of&nbsp;the&nbsp;virtual&nbsp;table.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;h5&gt;&nbsp;Category&nbsp;4:&nbsp;Complex&nbsp;&lt;/h5&gt;<br>
<br>
&lt;p&gt;<br>
Structure:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;None&nbsp;of&nbsp;the&nbsp;above,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.e.&nbsp;directly&nbsp;or&nbsp;indirectly&nbsp;inherits&nbsp;both&nbsp;virtual&nbsp;and&nbsp;non-virtual<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proper&nbsp;base&nbsp;classes,&nbsp;or&nbsp;at&nbsp;least&nbsp;one&nbsp;nearly&nbsp;empty&nbsp;virtual&nbsp;base&nbsp;class.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;rules&nbsp;for&nbsp;constructing&nbsp;virtual&nbsp;tables&nbsp;of&nbsp;the&nbsp;class&nbsp;are&nbsp;a&nbsp;combination&nbsp;of<br>
the&nbsp;rules&nbsp;from&nbsp;Categories&nbsp;2&nbsp;and&nbsp;3,<br>
and&nbsp;can&nbsp;generally&nbsp;be&nbsp;determined&nbsp;inductively.<br>
The&nbsp;differences&nbsp;are&nbsp;mostly&nbsp;due&nbsp;to&nbsp;the&nbsp;fact&nbsp;that&nbsp;virtual&nbsp;base&nbsp;classes<br>
can&nbsp;now&nbsp;have&nbsp;(nearly&nbsp;empty)&nbsp;primary&nbsp;bases:<br>
<br>
&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;virtual&nbsp;base&nbsp;A&nbsp;has&nbsp;a&nbsp;primary&nbsp;virtual&nbsp;base&nbsp;class&nbsp;P<br>
&nbsp;&nbsp;&nbsp;&nbsp;sharing&nbsp;its&nbsp;virtual&nbsp;table,<br>
&nbsp;&nbsp;&nbsp;&nbsp;P's&nbsp;vbase&nbsp;and&nbsp;vcall&nbsp;offsets&nbsp;come&nbsp;first&nbsp;in&nbsp;the&nbsp;primary&nbsp;virtual&nbsp;table,<br>
&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;the&nbsp;same&nbsp;order&nbsp;they&nbsp;would&nbsp;appear&nbsp;if&nbsp;P&nbsp;itself&nbsp;were&nbsp;the&nbsp;virtual&nbsp;base,<br>
&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;those&nbsp;from&nbsp;A&nbsp;that&nbsp;do&nbsp;not&nbsp;replicate&nbsp;those&nbsp;from&nbsp;P&nbsp;precede&nbsp;them.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;As&nbsp;for&nbsp;the&nbsp;non-virtual&nbsp;base&nbsp;case,<br>
&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;function&nbsp;pointer&nbsp;entries&nbsp;from&nbsp;the&nbsp;derived&nbsp;class<br>
&nbsp;&nbsp;&nbsp;&nbsp;introductions&nbsp;occur&nbsp;only&nbsp;after&nbsp;the&nbsp;entries&nbsp;from&nbsp;the&nbsp;primary&nbsp;base<br>
&nbsp;&nbsp;&nbsp;&nbsp;class.<br>
&nbsp;&nbsp;&nbsp;&nbsp;There&nbsp;are&nbsp;entries&nbsp;for&nbsp;overridden&nbsp;virtual&nbsp;functions&nbsp;from&nbsp;the&nbsp;primary<br>
&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;class&nbsp;only&nbsp;if&nbsp;the&nbsp;result&nbsp;types&nbsp;are&nbsp;different&nbsp;(covariant).<br>
&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;purposes&nbsp;of&nbsp;this&nbsp;case,<br>
&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;two&nbsp;types&nbsp;are&nbsp;considered&nbsp;different&nbsp;if&nbsp;one&nbsp;of&nbsp;them&nbsp;is&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;non-primary&nbsp;or&nbsp;virtual&nbsp;base&nbsp;class&nbsp;of&nbsp;the&nbsp;other.<br>
<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;For&nbsp;an&nbsp;S-as-T&nbsp;virtual&nbsp;table,<br>
the&nbsp;vbase&nbsp;offset&nbsp;entries&nbsp;from&nbsp;the&nbsp;primary&nbsp;virtual&nbsp;table&nbsp;for&nbsp;T<br>
are&nbsp;replaced&nbsp;with&nbsp;appropriate&nbsp;offsets&nbsp;given&nbsp;the&nbsp;completed&nbsp;hierarchy.<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
Consider&nbsp;the&nbsp;following&nbsp;inheritance&nbsp;hierarchy:<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;struct&nbsp;S&nbsp;{&nbsp;virtual&nbsp;void&nbsp;f()&nbsp;};<br>
&nbsp;&nbsp;struct&nbsp;T&nbsp;:&nbsp;virtual&nbsp;public&nbsp;S&nbsp;{};<br>
&nbsp;&nbsp;struct&nbsp;U&nbsp;:&nbsp;virtual&nbsp;public&nbsp;T&nbsp;{};<br>
&nbsp;&nbsp;struct&nbsp;V&nbsp;:&nbsp;public&nbsp;T,&nbsp;virtual&nbsp;public&nbsp;U&nbsp;{};<br>
&lt;/pre&gt;&lt;/code&gt;<br>
&lt;p&gt;<br>
T's&nbsp;virtual&nbsp;table&nbsp;contains&nbsp;a&nbsp;virtual&nbsp;base&nbsp;offset&nbsp;for&nbsp;S.<br>
U's&nbsp;virtual&nbsp;table&nbsp;contains&nbsp;virtual&nbsp;base&nbsp;offsets&nbsp;for&nbsp;S&nbsp;and&nbsp;T.<br>
V's&nbsp;virtual&nbsp;table&nbsp;contains&nbsp;virtual&nbsp;base&nbsp;offsets&nbsp;for&nbsp;S,&nbsp;U,&nbsp;and&nbsp;T<br>
(in&nbsp;reverse&nbsp;inheritance&nbsp;graph&nbsp;preorder),<br>
where&nbsp;the&nbsp;vbase&nbsp;offset&nbsp;for&nbsp;T&nbsp;is&nbsp;for&nbsp;the&nbsp;virtual&nbsp;base&nbsp;of&nbsp;U,<br>
not&nbsp;for&nbsp;the&nbsp;non-virtual&nbsp;direct&nbsp;base&nbsp;of&nbsp;V.<br>
<br>
&lt;p&gt;<br>
Consider&nbsp;in&nbsp;addition:<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;struct&nbsp;W&nbsp;:&nbsp;public&nbsp;T&nbsp;{};<br>
&lt;/pre&gt;&lt;/code&gt;<br>
&lt;p&gt;<br>
T&nbsp;is&nbsp;a&nbsp;primary&nbsp;base&nbsp;class&nbsp;for&nbsp;W.<br>
Therefore,&nbsp;its&nbsp;virtual&nbsp;base&nbsp;offset&nbsp;for&nbsp;S&nbsp;in&nbsp;its&nbsp;embedded&nbsp;T-in-W&nbsp;virtual<br>
table<br>
is&nbsp;the&nbsp;only&nbsp;one&nbsp;present.<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
The&nbsp;above-described&nbsp;virtual&nbsp;table&nbsp;group&nbsp;layout&nbsp;would&nbsp;allow&nbsp;all<br>
non-virtual&nbsp;secondary&nbsp;base&nbsp;class&nbsp;virtual&nbsp;tables&nbsp;in&nbsp;a&nbsp;group&nbsp;to&nbsp;be<br>
accessed&nbsp;from&nbsp;a&nbsp;virtual&nbsp;pointer&nbsp;for&nbsp;one&nbsp;of&nbsp;them,<br>
since&nbsp;the&nbsp;relative&nbsp;offsets&nbsp;would&nbsp;be&nbsp;fixed.<br>
(Since&nbsp;the&nbsp;primary&nbsp;virtual&nbsp;table&nbsp;could&nbsp;end&nbsp;up&nbsp;being&nbsp;embedded,<br>
as&nbsp;the&nbsp;primary&nbsp;base&nbsp;class&nbsp;virtual&nbsp;table,<br>
in&nbsp;another&nbsp;virtual&nbsp;table&nbsp;with&nbsp;additional&nbsp;virtual&nbsp;pointers&nbsp;separating&nbsp;it<br>
from&nbsp;its&nbsp;secondary&nbsp;virtual&nbsp;tables,<br>
this&nbsp;observation&nbsp;is&nbsp;not&nbsp;true&nbsp;of&nbsp;the&nbsp;primary&nbsp;virtual&nbsp;table.)<br>
However,&nbsp;since&nbsp;construction&nbsp;virtual&nbsp;table&nbsp;groups&nbsp;may&nbsp;be&nbsp;organized<br>
differently&nbsp;(see&nbsp;below),<br>
an&nbsp;implementation&nbsp;may&nbsp;not&nbsp;depend&nbsp;on&nbsp;this&nbsp;relationship&nbsp;between<br>
secondary&nbsp;virtual&nbsp;tables.<br>
This&nbsp;tradeoff&nbsp;was&nbsp;made&nbsp;because&nbsp;the&nbsp;space&nbsp;savings&nbsp;resulting&nbsp;from&nbsp;not<br>
requiring&nbsp;construction&nbsp;virtual&nbsp;tables&nbsp;to&nbsp;occur&nbsp;in&nbsp;complete&nbsp;groups<br>
was&nbsp;considered&nbsp;more&nbsp;important&nbsp;than&nbsp;potential&nbsp;sharing&nbsp;of&nbsp;virtual<br>
pointers.<br>
&lt;/i&gt;<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=vtable-ctor&gt;<br>
&lt;h3&gt;&nbsp;2.6&nbsp;Virtual&nbsp;tables&nbsp;During&nbsp;Object&nbsp;Construction&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;2.6.1&nbsp;General&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
In&nbsp;some&nbsp;situations,<br>
a&nbsp;special&nbsp;virtual&nbsp;table&nbsp;called&nbsp;a&nbsp;construction&nbsp;virtual&nbsp;table&nbsp;is&nbsp;used&nbsp;during<br>
the&nbsp;execution&nbsp;of&nbsp;proper&nbsp;base&nbsp;class&nbsp;constructors&nbsp;and&nbsp;destructors.<br>
These&nbsp;virtual&nbsp;tables&nbsp;are&nbsp;for&nbsp;specific&nbsp;cases&nbsp;of&nbsp;virtual&nbsp;inheritance.<br>
<br>
&lt;p&gt;<br>
During&nbsp;the&nbsp;construction&nbsp;of&nbsp;a&nbsp;class&nbsp;object,<br>
the&nbsp;object&nbsp;assumes&nbsp;the&nbsp;type&nbsp;of&nbsp;each&nbsp;of&nbsp;its&nbsp;proper&nbsp;base&nbsp;classes,<br>
as&nbsp;each&nbsp;base&nbsp;class&nbsp;subobject&nbsp;is&nbsp;constructed.<br>
RTTI&nbsp;queries&nbsp;in&nbsp;the&nbsp;base&nbsp;class&nbsp;constructor&nbsp;will&nbsp;return&nbsp;&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;base&nbsp;class,&nbsp;and&nbsp;virtual&nbsp;calls&nbsp;will&nbsp;resolve&nbsp;to&nbsp;member&nbsp;&nbsp;functions&nbsp;of&nbsp;the&nbsp;base&nbsp;class&nbsp;rather&nbsp;than&nbsp;the&nbsp;complete&nbsp;class.&nbsp;&nbsp;&lt;span&nbsp;class=&quot;change&quot;&gt;RTTI&nbsp;queries,<br>
dynamic&nbsp;casts&nbsp;and&nbsp;virtual&nbsp;calls&nbsp;of&nbsp;the&nbsp;object&nbsp;under&nbsp;construction&nbsp;statically<br>
converted&nbsp;to&nbsp;bases&nbsp;of&nbsp;the&nbsp;base&nbsp;under&nbsp;construction&nbsp;will&nbsp;dynamically<br>
resolve&nbsp;to&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;base&nbsp;under&nbsp;construction.&lt;/span&gt;<br>
<br>
Normally,&nbsp;&nbsp;this&nbsp;behavior&nbsp;is&nbsp;accomplished&nbsp;by&nbsp;setting,<br>
in&nbsp;the&nbsp;base&nbsp;class&nbsp;constructor,<br>
the&nbsp;object's&nbsp;virtual&nbsp;table&nbsp;pointers&nbsp;to&nbsp;the&nbsp;addresses&nbsp;of&nbsp;the<br>
virtual&nbsp;tables&nbsp;for&nbsp;the&nbsp;base&nbsp;class.<br>
<br>
&lt;p&gt;<br>
However,&nbsp;if&nbsp;the&nbsp;base&nbsp;class&nbsp;has&nbsp;direct&nbsp;or&nbsp;indirect&nbsp;virtual&nbsp;bases,&nbsp;the&nbsp;&nbsp;virtual&nbsp;table&nbsp;pointers&nbsp;have&nbsp;to&nbsp;be&nbsp;set&nbsp;to&nbsp;the&nbsp;addresses&nbsp;of&nbsp;construction<br>
virtual&nbsp;tables.<br>
This&nbsp;is&nbsp;because&nbsp;the&nbsp;normal&nbsp;proper&nbsp;base&nbsp;class&nbsp;virtual&nbsp;tables&nbsp;may&nbsp;not&nbsp;hold&nbsp;&nbsp;the&nbsp;correct&nbsp;virtual&nbsp;base&nbsp;index&nbsp;values&nbsp;to&nbsp;access&nbsp;the&nbsp;virtual&nbsp;bases&nbsp;of&nbsp;&nbsp;the&nbsp;object&nbsp;under&nbsp;construction,<br>
and&nbsp;adjustment&nbsp;addressed&nbsp;by&nbsp;these&nbsp;virtual&nbsp;tables&nbsp;may&nbsp;hold<br>
the&nbsp;wrong&nbsp;this&nbsp;parameter&nbsp;adjustment&nbsp;if&nbsp;the&nbsp;adjustment&nbsp;is&nbsp;to&nbsp;cast<br>
from&nbsp;a&nbsp;virtual&nbsp;base&nbsp;to&nbsp;another&nbsp;part&nbsp;of&nbsp;the&nbsp;object.&nbsp;The&nbsp;problem&nbsp;is<br>
that&nbsp;a&nbsp;complete&nbsp;object&nbsp;of&nbsp;a&nbsp;proper&nbsp;base&nbsp;class&nbsp;and&nbsp;a&nbsp;complete&nbsp;object&nbsp;of&nbsp;a<br>
derived&nbsp;class&nbsp;do&nbsp;not&nbsp;have&nbsp;virtual&nbsp;bases&nbsp;at&nbsp;the&nbsp;same&nbsp;offsets.<br>
<br>
&lt;p&gt;<br>
A&nbsp;construction&nbsp;virtual&nbsp;table&nbsp;holds&nbsp;the&nbsp;virtual&nbsp;function&nbsp;addresses,<br>
offset-to-top,<br>
and&nbsp;RTTI&nbsp;information&nbsp;associated&nbsp;with&nbsp;the&nbsp;base&nbsp;class,<br>
and&nbsp;virtual&nbsp;base&nbsp;offsets&nbsp;and&nbsp;addresses&nbsp;of&nbsp;adjustor&nbsp;entry&nbsp;points&nbsp;with&nbsp;their<br>
parameter&nbsp;adjustments&nbsp;associated&nbsp;with&nbsp;objects&nbsp;of&nbsp;the&nbsp;complete&nbsp;class.<br>
<br>
&lt;p&gt;<br>
To&nbsp;ensure&nbsp;that&nbsp;the&nbsp;virtual&nbsp;table&nbsp;pointers&nbsp;are&nbsp;set&nbsp;to&nbsp;the&nbsp;appropriate<br>
virtual&nbsp;tables&nbsp;during&nbsp;proper&nbsp;base&nbsp;class&nbsp;construction,<br>
a&nbsp;table&nbsp;of&nbsp;virtual&nbsp;table&nbsp;pointers,&nbsp;&nbsp;called&nbsp;the&nbsp;VTT,&nbsp;which&nbsp;holds&nbsp;the&nbsp;addresses&nbsp;of&nbsp;construction&nbsp;and<br>
non-construction&nbsp;virtual&nbsp;tables&nbsp;is&nbsp;generated&nbsp;for&nbsp;the&nbsp;complete&nbsp;class.&nbsp;The<br>
constructor&nbsp;for&nbsp;the&nbsp;complete&nbsp;class&nbsp;passes&nbsp;to&nbsp;each&nbsp;proper&nbsp;base&nbsp;class<br>
constructor&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;appropriate&nbsp;place&nbsp;in&nbsp;the&nbsp;VTT&nbsp;where&nbsp;the&nbsp;&nbsp;proper&nbsp;base&nbsp;class&nbsp;constructor&nbsp;can&nbsp;find&nbsp;its&nbsp;set&nbsp;of&nbsp;virtual&nbsp;tables.<br>
Construction&nbsp;virtual&nbsp;tables&nbsp;are&nbsp;used&nbsp;in&nbsp;a&nbsp;similar&nbsp;way&nbsp;during&nbsp;the<br>
execution&nbsp;of&nbsp;proper&nbsp;base&nbsp;class&nbsp;destructors.<br>
<br>
&lt;div&nbsp;class=&quot;change&quot;&gt;<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=&quot;warning.gif&quot;&nbsp;alt=&quot;NOTE&quot;&gt;<br>
&lt;i&gt;<br>
When&nbsp;a&nbsp;complete&nbsp;object&nbsp;constructor&nbsp;is&nbsp;constructing&nbsp;a&nbsp;virtual&nbsp;base,&nbsp;it&nbsp;must&nbsp;determine&nbsp;the&nbsp;base's&nbsp;location&nbsp;statically,&nbsp;rather&nbsp;than&nbsp;using&nbsp;vbase&nbsp;offsets<br>
in&nbsp;the&nbsp;virtual&nbsp;table,&nbsp;since&nbsp;the&nbsp;possibly&nbsp;shared&nbsp;virtual&nbsp;pointer&nbsp;may&nbsp;point&nbsp;to&nbsp;a&nbsp;construction&nbsp;virtual&nbsp;table&nbsp;of&nbsp;an&nbsp;unrelated&nbsp;base&nbsp;class.<br>
<br>
For&nbsp;instance,&nbsp;in<br>
&lt;pre&gt;&lt;code&gt;<br>
&nbsp;&nbsp;struct&nbsp;S&nbsp;{};<br>
&nbsp;&nbsp;struct&nbsp;T:&nbsp;virtual&nbsp;S&nbsp;{};<br>
&nbsp;&nbsp;struct&nbsp;U&nbsp;{};<br>
&nbsp;&nbsp;struct&nbsp;V:&nbsp;virtual&nbsp;T,&nbsp;virtual&nbsp;U&nbsp;{};<br>
&lt;/code&gt;&lt;/pre&gt;<br>
the&nbsp;virtual&nbsp;pointers&nbsp;for&nbsp;T&nbsp;and&nbsp;V&nbsp;are&nbsp;in&nbsp;the&nbsp;same&nbsp;place.&nbsp;&nbsp;When&nbsp;V's&nbsp;constructor&nbsp;is&nbsp;about&nbsp;to&nbsp;construct&nbsp;U,&nbsp;that&nbsp;virtual&nbsp;pointer&nbsp;points&nbsp;to<br>
a&nbsp;virtual&nbsp;table&nbsp;for&nbsp;T,&nbsp;and&nbsp;therefore&nbsp;cannot&nbsp;be&nbsp;used&nbsp;to&nbsp;locate&nbsp;U.<br>
&lt;/i&gt;<br>
&lt;/p&gt;<br>
&lt;/div&gt;<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;2.6.2&nbsp;VTT&nbsp;Order&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
An&nbsp;array&nbsp;of&nbsp;virtual&nbsp;table&nbsp;addresses,&nbsp;called&nbsp;the&nbsp;&lt;i&gt;&lt;b&gt;VTT&lt;/b&gt;&lt;/i&gt;,<br>
is&nbsp;declared&nbsp;for&nbsp;each&nbsp;class&nbsp;type&nbsp;that&nbsp;needs&nbsp;a&nbsp;construction&nbsp;virtual&nbsp;table.<br>
A&nbsp;class&nbsp;needs&nbsp;a&nbsp;construction&nbsp;virtual&nbsp;table&nbsp;if&nbsp;it&nbsp;has<br>
indirect&nbsp;or&nbsp;direct&nbsp;virtual&nbsp;base&nbsp;classes.<br>
(Otherwise,<br>
each&nbsp;proper&nbsp;base&nbsp;class&nbsp;may&nbsp;be&nbsp;initialized<br>
using&nbsp;its&nbsp;complete&nbsp;object&nbsp;virtual&nbsp;table&nbsp;group.)<br>
<br>
&lt;p&gt;<br>
The&nbsp;elements&nbsp;of&nbsp;the&nbsp;VTT&nbsp;array&nbsp;for&nbsp;a&nbsp;class&nbsp;D&nbsp;are&nbsp;in&nbsp;this&nbsp;order:<br>
<br>
&lt;ol&nbsp;type=1&gt;<br>
&lt;li&gt;<br>
&lt;i&gt;Primary&nbsp;virtual&nbsp;pointer&lt;/i&gt;:<br>
address&nbsp;of&nbsp;the&nbsp;primary&nbsp;virtual&nbsp;table&nbsp;for&nbsp;the&nbsp;complete&nbsp;object&nbsp;D.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
&lt;i&gt;Secondary&nbsp;VTTs&lt;/i&gt;:<br>
for&nbsp;each&nbsp;direct&nbsp;non-virtual&nbsp;proper&nbsp;base&nbsp;class&nbsp;B&nbsp;of&nbsp;D<br>
that&nbsp;requires&nbsp;a&nbsp;construction&nbsp;virtual&nbsp;table&nbsp;by&nbsp;virtue&nbsp;of&nbsp;having&nbsp;virtual&nbsp;bases,<br>
in&nbsp;declaration&nbsp;order,<br>
a&nbsp;sub-VTT&nbsp;for&nbsp;B-in-D,<br>
structured&nbsp;like&nbsp;the&nbsp;main&nbsp;VTT,<br>
with&nbsp;a&nbsp;primary&nbsp;virtual&nbsp;pointer,&nbsp;secondary&nbsp;VTTs,<br>
and&nbsp;secondary&nbsp;virtual&nbsp;pointers<br>
(but&nbsp;no&nbsp;virtual&nbsp;VTTs).<br>
<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
This&nbsp;construction&nbsp;is&nbsp;applied&nbsp;recursively&nbsp;to&nbsp;embed&nbsp;sub-VTTs&nbsp;for<br>
non-virtual&nbsp;subobjects&nbsp;encountered&nbsp;in&nbsp;each&nbsp;of&nbsp;the&nbsp;base&nbsp;classes.<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
&lt;i&gt;Secondary&nbsp;virtual&nbsp;pointers&lt;/i&gt;:<br>
For&nbsp;each&nbsp;subobject&nbsp;X&nbsp;with&nbsp;either&nbsp;(a)&nbsp;virtual&nbsp;bases<br>
or&nbsp;(b)&nbsp;&lt;span&nbsp;class=&quot;change&quot;&gt;&lt;strike&gt;virtual&nbsp;function&nbsp;declarations&nbsp;overridden&nbsp;along&nbsp;a&nbsp;virtual&nbsp;path&lt;/strike&gt;&nbsp;reachable&nbsp;along&nbsp;a&nbsp;virtual&nbsp;path&nbsp;from&nbsp;D&lt;/span&gt;,<br>
the&nbsp;address&nbsp;of&nbsp;the&nbsp;secondary&nbsp;virtual&nbsp;table&nbsp;for&nbsp;X-in-D.<br>
These&nbsp;include&nbsp;virtual&nbsp;and&nbsp;non-virtual,&nbsp;direct&nbsp;and&nbsp;indirect&nbsp;subobjects,<br>
with&nbsp;the&nbsp;exception&nbsp;of&nbsp;primary&nbsp;non-virtual&nbsp;bases.<br>
The&nbsp;order&nbsp;of&nbsp;the&nbsp;virtual&nbsp;pointers&nbsp;is<br>
inheritance&nbsp;graph&nbsp;preorder.<br>
&lt;i&gt;<br>
Though&nbsp;primary&nbsp;non-virtual&nbsp;bases&nbsp;do&nbsp;not&nbsp;get&nbsp;secondary&nbsp;virtual&nbsp;pointers,<br>
they&nbsp;do&nbsp;not&nbsp;otherwise&nbsp;affect&nbsp;the&nbsp;ordering.<br>
&lt;/i&gt;<br>
<br>
&lt;div&nbsp;class=&quot;change&quot;&gt;<br>
&lt;p&gt;&lt;strike&gt;<br>
When&nbsp;constructing&nbsp;a&nbsp;sub-VTT&nbsp;for&nbsp;a&nbsp;subclass&nbsp;B&nbsp;of&nbsp;D&nbsp;in&nbsp;part&nbsp;2&nbsp;above,<br>
the&nbsp;relevant&nbsp;condition&nbsp;(b)&nbsp;for&nbsp;the&nbsp;inclusion&nbsp;of&nbsp;a&nbsp;secondary&nbsp;virtual<br>
pointer&nbsp;in&nbsp;the&nbsp;sub-VTT&nbsp;for&nbsp;B&nbsp;is&nbsp;the&nbsp;existence&nbsp;of&nbsp;a&nbsp;virtual&nbsp;function<br>
declaration&nbsp;overridden&nbsp;along&nbsp;a&nbsp;virtual&nbsp;path&nbsp;between&nbsp;the&nbsp;declaration&nbsp;and&nbsp;B,<br>
since&nbsp;otherwise&nbsp;the&nbsp;complete&nbsp;object&nbsp;virtual&nbsp;table&nbsp;for&nbsp;B&nbsp;is&nbsp;used<br>
to&nbsp;initialize&nbsp;the&nbsp;B&nbsp;subobject.<br>
&lt;/strike&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
&quot;Along&nbsp;a&nbsp;virtual&nbsp;path&quot;&nbsp;refers&nbsp;to&nbsp;the&nbsp;path&nbsp;in&nbsp;the&nbsp;inheritance&nbsp;graph<br>
&lt;span&nbsp;class=&quot;change&quot;&gt;<br>
&lt;strike&gt;between&nbsp;the&nbsp;class&nbsp;that&nbsp;declares&nbsp;the&nbsp;overridden&nbsp;virtual&nbsp;function<br>
and&nbsp;the&nbsp;class&nbsp;derived&nbsp;from&nbsp;it&nbsp;that&nbsp;declares&nbsp;the&nbsp;overriding&nbsp;virtual<br>
function&lt;/strike&gt;<br>
between&nbsp;X&nbsp;and&nbsp;D.<br>
&lt;/span&gt;<br>
This&nbsp;is&nbsp;considered&nbsp;a&nbsp;virtual&nbsp;path&nbsp;if&nbsp;one&nbsp;of&nbsp;the&nbsp;class&nbsp;derivations&nbsp;it<br>
represents&nbsp;is&nbsp;&lt;span&nbsp;class=&quot;change&quot;&gt;<br>
&lt;strike&gt;from&nbsp;a&nbsp;virtual&nbsp;base.&lt;/strike&gt;<br>
a&nbsp;virtual&nbsp;base&nbsp;of&nbsp;D.<br>
&lt;/span&gt;<br>
&lt;/i&gt;<br>
<br>
&lt;div&nbsp;class=&quot;change&quot;&gt;<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
Primary&nbsp;virtual&nbsp;bases&nbsp;require&nbsp;a&nbsp;secondary&nbsp;virtual&nbsp;pointer&nbsp;in&nbsp;the&nbsp;VTT,<br>
as&nbsp;their&nbsp;placement&nbsp;is&nbsp;determined&nbsp;by&nbsp;the&nbsp;most&nbsp;derived&nbsp;object.&nbsp;If&nbsp;a&nbsp;primary<br>
virtual&nbsp;base&nbsp;is&nbsp;the&nbsp;active&nbsp;instance&nbsp;of&nbsp;that&nbsp;base&nbsp;within&nbsp;the&nbsp;most&nbsp;derived<br>
object,&nbsp;the&nbsp;VTT&nbsp;entry&nbsp;for&nbsp;it&nbsp;will&nbsp;be&nbsp;D-in-most&nbsp;derived's&nbsp;primary&nbsp;virtual<br>
table&nbsp;pointer.&nbsp;Should&nbsp;that&nbsp;primary&nbsp;virtual&nbsp;base&nbsp;not&nbsp;be&nbsp;the&nbsp;active<br>
instance&nbsp;within&nbsp;the&nbsp;most&nbsp;derived&nbsp;object,&nbsp;the&nbsp;secondary&nbsp;virtual&nbsp;pointer<br>
will&nbsp;be&nbsp;different.<br>
&lt;/i&gt;<br>
&lt;/div&gt;<br>
<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
Secondary&nbsp;virtual&nbsp;pointers&nbsp;may&nbsp;be&nbsp;required&nbsp;for&nbsp;base&nbsp;classes<br>
that&nbsp;do&nbsp;not&nbsp;require&nbsp;secondary&nbsp;VTTs.<br>
This&nbsp;may&nbsp;occur&nbsp;if,&nbsp;for&nbsp;D&nbsp;derived&nbsp;from&nbsp;B&nbsp;derived&nbsp;from&nbsp;A,<br>
A&nbsp;does&nbsp;not&nbsp;contain&nbsp;virtual&nbsp;bases,<br>
but&nbsp;does&nbsp;define&nbsp;a&nbsp;virtual&nbsp;function&nbsp;that&nbsp;is&nbsp;not&nbsp;overridden&nbsp;in&nbsp;B,<br>
but&nbsp;is&nbsp;overridden&nbsp;in&nbsp;D&nbsp;(along&nbsp;a&nbsp;virtual&nbsp;path).<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
&lt;i&gt;Virtual&nbsp;VTTs&lt;/i&gt;:<br>
The&nbsp;sub-VTTs&nbsp;for&nbsp;each&nbsp;virtual&nbsp;subobject&nbsp;in<br>
inheritance&nbsp;graph&nbsp;preorder),<br>
i.e.&nbsp;the&nbsp;sub-VTT&nbsp;for&nbsp;virtual&nbsp;base&nbsp;W&nbsp;of&nbsp;virtual&nbsp;base&nbsp;V&nbsp;of&nbsp;D<br>
comes&nbsp;after&nbsp;the&nbsp;sub-VTT&nbsp;for&nbsp;V.<br>
These&nbsp;sub-VTTs&nbsp;are&nbsp;constructed&nbsp;as&nbsp;in&nbsp;(2)&nbsp;above,<br>
including&nbsp;sub-VTTs&nbsp;for&nbsp;any&nbsp;non-virtual&nbsp;bases&nbsp;of&nbsp;the&nbsp;current&nbsp;virtual&nbsp;base.<br>
The&nbsp;virtual&nbsp;VTT&nbsp;addresses&nbsp;come&nbsp;last&nbsp;because&nbsp;they&nbsp;are&nbsp;only&nbsp;passed<br>
to&nbsp;the&nbsp;virtual&nbsp;base&nbsp;class&nbsp;constructors&nbsp;for&nbsp;the&nbsp;complete&nbsp;object.<br>
&lt;/ol&gt;<br>
<br>
&lt;p&gt;<br>
Each&nbsp;virtual&nbsp;table&nbsp;address&nbsp;in&nbsp;the&nbsp;VTT&nbsp;is&nbsp;the&nbsp;address&nbsp;to&nbsp;be&nbsp;assigned&nbsp;to&nbsp;the<br>
respective&nbsp;virtual&nbsp;pointer,<br>
i.e.&nbsp;the&nbsp;address&nbsp;of&nbsp;the&nbsp;first&nbsp;virtual&nbsp;function&nbsp;pointer&nbsp;in&nbsp;the&nbsp;virtual&nbsp;table,<br>
not&nbsp;of&nbsp;the&nbsp;first&nbsp;vcall&nbsp;offset.<br>
<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
It&nbsp;is&nbsp;required&nbsp;that&nbsp;the&nbsp;VTT&nbsp;for&nbsp;a&nbsp;complete&nbsp;class&nbsp;D&nbsp;be&nbsp;identical&nbsp;in<br>
structure&nbsp;to&nbsp;the&nbsp;sub-VTT&nbsp;for&nbsp;the&nbsp;same&nbsp;class&nbsp;D&nbsp;as&nbsp;a&nbsp;subclass&nbsp;of&nbsp;another<br>
class&nbsp;E&nbsp;derived&nbsp;from&nbsp;it,<br>
so&nbsp;that&nbsp;the&nbsp;constructors&nbsp;for&nbsp;D&nbsp;can&nbsp;depend&nbsp;on&nbsp;that&nbsp;structure.<br>
Therefore,&nbsp;the&nbsp;various&nbsp;components&nbsp;of&nbsp;its&nbsp;VTT&nbsp;are&nbsp;present&nbsp;based&nbsp;on&nbsp;the<br>
rules&nbsp;given,&nbsp;even&nbsp;if&nbsp;they&nbsp;point&nbsp;to&nbsp;the<br>
D&nbsp;complete&nbsp;object&nbsp;virtual&nbsp;table&nbsp;or&nbsp;its&nbsp;secondary&nbsp;virtual&nbsp;tables.<br>
That&nbsp;is,&nbsp;secondary&nbsp;VTTs&nbsp;are&nbsp;present&nbsp;for&nbsp;all&nbsp;bases&nbsp;with&nbsp;virtual&nbsp;bases<br>
(including&nbsp;the&nbsp;virtual&nbsp;bases&nbsp;themselves,<br>
which&nbsp;have&nbsp;their&nbsp;secondary&nbsp;VTTs&nbsp;in&nbsp;the&nbsp;virtual&nbsp;VTT&nbsp;section),<br>
and&nbsp;secondary&nbsp;virtual&nbsp;pointers&nbsp;are&nbsp;present&nbsp;for&nbsp;all&nbsp;bases&nbsp;with&nbsp;either<br>
virtual&nbsp;bases&nbsp;or&nbsp;virtual&nbsp;function&nbsp;declarations&nbsp;overridden&nbsp;along&nbsp;a<br>
virtual&nbsp;path.<br>
The&nbsp;only&nbsp;exception&nbsp;is&nbsp;that&nbsp;a&nbsp;primary&nbsp;non-virtual&nbsp;base&nbsp;class&nbsp;does&nbsp;not<br>
require&nbsp;a&nbsp;secondary&nbsp;virtual&nbsp;pointer.<br>
<br>
&lt;p&gt;<br>
Parts&nbsp;(1)&nbsp;and&nbsp;(3)&nbsp;of&nbsp;a&nbsp;primary&nbsp;(not&nbsp;secondary,&nbsp;i.e.&nbsp;nested)&nbsp;VTT,<br>
that&nbsp;is&nbsp;the&nbsp;primary&nbsp;and&nbsp;secondary&nbsp;virtual&nbsp;pointers,<br>
are&nbsp;used&nbsp;for&nbsp;the&nbsp;final&nbsp;initialization&nbsp;of&nbsp;an&nbsp;object's&nbsp;virtual&nbsp;pointers<br>
before&nbsp;the&nbsp;full-object&nbsp;initialization&nbsp;and&nbsp;later&nbsp;use,<br>
and&nbsp;must&nbsp;therefore&nbsp;point&nbsp;to&nbsp;the&nbsp;main&nbsp;virtual&nbsp;table&nbsp;group&nbsp;for&nbsp;the&nbsp;class.<br>
Those&nbsp;bases&nbsp;which&nbsp;do&nbsp;not&nbsp;have&nbsp;secondary&nbsp;virtual&nbsp;pointers&nbsp;in&nbsp;the&nbsp;VTT<br>
have&nbsp;their&nbsp;virtual&nbsp;pointers&nbsp;explicitly&nbsp;initialized&nbsp;to&nbsp;the&nbsp;main&nbsp;virtual<br>
table&nbsp;group&nbsp;by&nbsp;the&nbsp;constructors<br>
(see&nbsp;&lt;a&nbsp;href=#subobj-ctor&gt;Subobject&nbsp;Construction&nbsp;and&nbsp;Destruction&lt;/a&gt;).<br>
<br>
&lt;p&gt;<br>
The&nbsp;virtual&nbsp;pointers&nbsp;in&nbsp;the&nbsp;secondary&nbsp;VTTs&nbsp;and&nbsp;virtual&nbsp;VTTs&nbsp;are&nbsp;used&nbsp;for<br>
subobject&nbsp;construction,<br>
and&nbsp;may&nbsp;always&nbsp;point&nbsp;to&nbsp;special&nbsp;construction&nbsp;virtual&nbsp;tables&nbsp;laid&nbsp;out&nbsp;as<br>
described&nbsp;in&nbsp;the&nbsp;following&nbsp;subsections.<br>
However,&nbsp;it&nbsp;will&nbsp;sometimes&nbsp;be&nbsp;possible&nbsp;to&nbsp;use&nbsp;either&nbsp;the&nbsp;full-object<br>
virtual&nbsp;table&nbsp;for&nbsp;the&nbsp;subclass,<br>
or&nbsp;its&nbsp;secondary&nbsp;virtual&nbsp;table&nbsp;for&nbsp;the&nbsp;full&nbsp;class&nbsp;being&nbsp;constructed.<br>
This&nbsp;ABI&nbsp;does&nbsp;not&nbsp;specify&nbsp;a&nbsp;choice,<br>
nor&nbsp;does&nbsp;it&nbsp;specify&nbsp;names&nbsp;for&nbsp;the&nbsp;construction&nbsp;virtual&nbsp;tables,<br>
so&nbsp;the&nbsp;constructors&nbsp;must&nbsp;use&nbsp;the&nbsp;VTT&nbsp;rather&nbsp;than&nbsp;assuming&nbsp;that&nbsp;a<br>
particular&nbsp;construction&nbsp;virtual&nbsp;table&nbsp;exists.<br>
<br>
&lt;p&gt;<br>
For&nbsp;example,&nbsp;suppose&nbsp;we&nbsp;have&nbsp;the&nbsp;following&nbsp;hierarchy:<br>
&lt;/i&gt;<br>
&lt;div&nbsp;class=&quot;change&quot;&gt;<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;class&nbsp;A1&nbsp;{&nbsp;int&nbsp;i;&nbsp;};<br>
&nbsp;&nbsp;class&nbsp;A2&nbsp;{&nbsp;int&nbsp;i;&nbsp;virtual&nbsp;void&nbsp;f();&nbsp;};<br>
&nbsp;&nbsp;class&nbsp;V1&nbsp;:&nbsp;public&nbsp;A1,&nbsp;public&nbsp;A2&nbsp;{&nbsp;int&nbsp;i;&nbsp;};<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;A2&nbsp;is&nbsp;primary&nbsp;base&nbsp;of&nbsp;V1,&nbsp;A1&nbsp;is&nbsp;non-polymorphic<br>
&nbsp;&nbsp;class&nbsp;B1&nbsp;{&nbsp;int&nbsp;i;&nbsp;};<br>
&nbsp;&nbsp;class&nbsp;B2&nbsp;{&nbsp;int&nbsp;i;&nbsp;};<br>
&nbsp;&nbsp;class&nbsp;V2&nbsp;:&nbsp;public&nbsp;B1,&nbsp;public&nbsp;B2,&nbsp;public&nbsp;virtual&nbsp;V1&nbsp;{&nbsp;int&nbsp;i;&nbsp;};<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;V2&nbsp;has&nbsp;no&nbsp;primary&nbsp;base,&nbsp;V1&nbsp;is&nbsp;secondary&nbsp;base<br>
&nbsp;&nbsp;class&nbsp;V3&nbsp;{virtual&nbsp;void&nbsp;g();&nbsp;};<br>
&nbsp;&nbsp;class&nbsp;C1&nbsp;:&nbsp;public&nbsp;virtual&nbsp;V1&nbsp;{&nbsp;int&nbsp;i;&nbsp;};<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;C1&nbsp;has&nbsp;no&nbsp;primary&nbsp;base,&nbsp;V2&nbsp;is&nbsp;secondary&nbsp;base<br>
&nbsp;&nbsp;class&nbsp;C2&nbsp;:&nbsp;public&nbsp;virtual&nbsp;V3,&nbsp;virtual&nbsp;V2&nbsp;{&nbsp;int&nbsp;i;&nbsp;};<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;C2&nbsp;has&nbsp;V3&nbsp;primary&nbsp;(nearly-empty&nbsp;virtual)&nbsp;base,&nbsp;V2&nbsp;is&nbsp;secondary&nbsp;base<br>
&nbsp;&nbsp;class&nbsp;X1&nbsp;{&nbsp;int&nbsp;i;&nbsp;};<br>
&nbsp;&nbsp;class&nbsp;C3&nbsp;:&nbsp;public&nbsp;X1&nbsp;{&nbsp;int&nbsp;i;&nbsp;};<br>
&nbsp;&nbsp;class&nbsp;D&nbsp;:&nbsp;public&nbsp;C1,&nbsp;public&nbsp;C2,&nbsp;public&nbsp;C3&nbsp;{&nbsp;int&nbsp;i;&nbsp;&nbsp;};<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;C1&nbsp;is&nbsp;primary&nbsp;base,&nbsp;C2&nbsp;is&nbsp;secondary&nbsp;base,&nbsp;C3&nbsp;is&nbsp;non-polymorphic<br>
<br>
&lt;/pre&gt;&lt;/code&gt;<br>
&lt;/div&gt;<br>
<br>
&lt;i&gt;<br>
Then&nbsp;the&nbsp;VTT&nbsp;for&nbsp;D&nbsp;would&nbsp;appear&nbsp;in&nbsp;the&nbsp;following&nbsp;order,<br>
where&nbsp;indenting&nbsp;indicates&nbsp;the&nbsp;sub-VTT&nbsp;structure,<br>
and&nbsp;asterisks&nbsp;(*)&nbsp;indicate&nbsp;that&nbsp;construction&nbsp;virtual&nbsp;tables&nbsp;instead&nbsp;of<br>
complete&nbsp;object&nbsp;virtual&nbsp;tables&nbsp;are&nbsp;required.<br>
&lt;/i&gt;<br>
&lt;div&nbsp;class=&quot;change&quot;&gt;<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;//&nbsp;1.&nbsp;Primary&nbsp;virtual&nbsp;pointer:<br>
&nbsp;&nbsp;[0]&nbsp;D&nbsp;has&nbsp;virtual&nbsp;bases&nbsp;(complete&nbsp;object&nbsp;vptr)<br>
<br>
&nbsp;&nbsp;//&nbsp;2.&nbsp;Secondary&nbsp;VTTs:<br>
&nbsp;&nbsp;[1]&nbsp;&nbsp;C1&nbsp;*&nbsp;(has&nbsp;virtual&nbsp;base)<br>
<br>
&nbsp;&nbsp;[2]&nbsp;&nbsp;C2&nbsp;*&nbsp;(has&nbsp;virtual&nbsp;bases)<br>
&nbsp;&nbsp;[3]&nbsp;&nbsp;&nbsp;&nbsp;V3-in-C2&nbsp;in&nbsp;D&nbsp;(primary&nbsp;vptr)<br>
&nbsp;&nbsp;[4]&nbsp;&nbsp;&nbsp;&nbsp;V2-in-C2&nbsp;in&nbsp;D&nbsp;(secondary&nbsp;vptr)<br>
&nbsp;&nbsp;[5]&nbsp;&nbsp;&nbsp;&nbsp;V1-in-C2&nbsp;in&nbsp;D&nbsp;(secondary&nbsp;vptr)<br>
<br>
&nbsp;&nbsp;//&nbsp;3.&nbsp;Secondary&nbsp;virtual&nbsp;pointers:<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;(no&nbsp;C1-in-D&nbsp;--&nbsp;primary&nbsp;base)<br>
&nbsp;&nbsp;[6]&nbsp;&nbsp;&nbsp;&nbsp;V1-in-D&nbsp;(V1&nbsp;is&nbsp;virtual)<br>
&nbsp;&nbsp;[7]&nbsp;&nbsp;C2-in-D&nbsp;(preorder;&nbsp;has&nbsp;virtual&nbsp;bases)<br>
&nbsp;&nbsp;[8]&nbsp;&nbsp;&nbsp;&nbsp;V3-in-D&nbsp;(V3&nbsp;is&nbsp;virtual)<br>
&nbsp;&nbsp;[9]&nbsp;&nbsp;&nbsp;&nbsp;V2-in-D&nbsp;(V2&nbsp;is&nbsp;virtual)<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;(For&nbsp;complete&nbsp;object&nbsp;D&nbsp;VTT,&nbsp;these&nbsp;all&nbsp;can&nbsp;point&nbsp;to&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;secondary&nbsp;vtables&nbsp;in&nbsp;the&nbsp;D&nbsp;vtable,&nbsp;the&nbsp;V3-in-D&nbsp;entry<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;will&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;C2-in-D&nbsp;entry,&nbsp;as&nbsp;that&nbsp;is&nbsp;the&nbsp;active<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;V3&nbsp;virtual&nbsp;base&nbsp;in&nbsp;the&nbsp;complete&nbsp;object&nbsp;D.&nbsp;&nbsp;In&nbsp;the&nbsp;sub-VTT&nbsp;for<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;D&nbsp;in&nbsp;a&nbsp;class&nbsp;derived&nbsp;from&nbsp;D,&nbsp;some&nbsp;might&nbsp;be&nbsp;construction<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;virtual&nbsp;tables.)<br>
<br>
&nbsp;&nbsp;//&nbsp;4.&nbsp;Virtual&nbsp;VTTs:<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;(V1&nbsp;has&nbsp;no&nbsp;virtual&nbsp;bases).<br>
&nbsp;&nbsp;[10]&nbsp;V2&nbsp;*&nbsp;(V2&nbsp;has&nbsp;virtual&nbsp;bases)<br>
&nbsp;&nbsp;[11]&nbsp;&nbsp;&nbsp;V1-in-V2&nbsp;in&nbsp;D&nbsp;*&nbsp;(secondary&nbsp;vptr,&nbsp;V1&nbsp;is&nbsp;virtual)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(A2&nbsp;is&nbsp;primary&nbsp;base&nbsp;of&nbsp;V1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;(V3&nbsp;has&nbsp;no&nbsp;virtual&nbsp;bases)<br>
<br>
&lt;/pre&gt;&lt;/code&gt;<br>
&lt;/div&gt;<br>
<br>
&lt;p&gt;<br>
&lt;i&gt;<br>
If&nbsp;A2&nbsp;is&nbsp;a&nbsp;virtual&nbsp;base&nbsp;of&nbsp;V1,<br>
the&nbsp;VTT&nbsp;will&nbsp;contain&nbsp;&lt;span&nbsp;class=&quot;change&quot;&gt;&lt;strike&gt;14&lt;/strike&gt;&nbsp;more&lt;/span&gt;<br>
more&nbsp;elements<br>
(exercise&nbsp;left&nbsp;to&nbsp;the&nbsp;astute&nbsp;reader).<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;2.6.3&nbsp;Construction&nbsp;Virtual&nbsp;Table&nbsp;Layout&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;construction&nbsp;virtual&nbsp;tables&nbsp;for&nbsp;a&nbsp;complete&nbsp;object&nbsp;are&nbsp;emitted&nbsp;in&nbsp;the&nbsp;same&nbsp;object&nbsp;file&nbsp;as&nbsp;the&nbsp;virtual&nbsp;table.<br>
&lt;/font&gt;<br>
So&nbsp;the&nbsp;virtual&nbsp;table&nbsp;structures&nbsp;for&nbsp;a&nbsp;complete&nbsp;object&nbsp;of&nbsp;class&nbsp;C&nbsp;include,<br>
in&nbsp;no&nbsp;particular&nbsp;order:<br>
<br>
&lt;ul&gt;<br>
&lt;li&gt;<br>
the&nbsp;main&nbsp;virtual&nbsp;table&nbsp;group&nbsp;for&nbsp;C,<br>
i.e.&nbsp;the&nbsp;virtual&nbsp;table&nbsp;to&nbsp;which&nbsp;the&nbsp;primary&nbsp;virtual&nbsp;pointer<br>
(at&nbsp;offset&nbsp;0)&nbsp;points,<br>
along&nbsp;with&nbsp;its&nbsp;proper&nbsp;base&nbsp;class&nbsp;subobject&nbsp;virtual&nbsp;tables<br>
in&nbsp;order&nbsp;of&nbsp;allocation,<br>
including&nbsp;virtual&nbsp;base&nbsp;class&nbsp;subobject&nbsp;virtual&nbsp;tables;<br>
<br>
&lt;li&gt;<br>
any&nbsp;construction&nbsp;virtual&nbsp;tables&nbsp;required&nbsp;for&nbsp;non-virtual&nbsp;and&nbsp;virtual&nbsp;bases;<br>
and<br>
<br>
&lt;li&gt;<br>
the&nbsp;VTT&nbsp;array&nbsp;for&nbsp;C,&nbsp;providing&nbsp;location&nbsp;information&nbsp;for&nbsp;the&nbsp;above.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;VTT&nbsp;array&nbsp;is&nbsp;referenced&nbsp;via&nbsp;its&nbsp;own&nbsp;mangled&nbsp;external&nbsp;name,<br>
and&nbsp;the&nbsp;construction&nbsp;virtual&nbsp;tables&nbsp;are&nbsp;accessed&nbsp;via&nbsp;the&nbsp;VTT&nbsp;array,<br>
so&nbsp;the&nbsp;latter&nbsp;do&nbsp;not&nbsp;have&nbsp;external&nbsp;names.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;2.6.4&nbsp;Construction&nbsp;Virtual&nbsp;Table&nbsp;entries&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;construction&nbsp;virtual&nbsp;table&nbsp;group&nbsp;for&nbsp;a<br>
proper&nbsp;base&nbsp;class&nbsp;subobject&nbsp;B&nbsp;(of&nbsp;derived&nbsp;class&nbsp;D)<br>
does&nbsp;not&nbsp;have&nbsp;the&nbsp;same&nbsp;entries&nbsp;in&nbsp;the&nbsp;same<br>
order&nbsp;as&nbsp;the&nbsp;main&nbsp;virtual&nbsp;table&nbsp;group&nbsp;for&nbsp;a&nbsp;complete&nbsp;object&nbsp;B,<br>
as&nbsp;described&nbsp;in&nbsp;&lt;a&nbsp;href=#vtable&gt;Virtual&nbsp;Table&nbsp;Layout&lt;/a&gt;&nbsp;above.<br>
Some&nbsp;of&nbsp;the&nbsp;base&nbsp;class&nbsp;subobjects&nbsp;may&nbsp;not&nbsp;need&nbsp;construction&nbsp;virtual&nbsp;tables,<br>
which&nbsp;will&nbsp;therefore&nbsp;not&nbsp;be&nbsp;present&nbsp;in&nbsp;the&nbsp;construction&nbsp;virtual&nbsp;table&nbsp;group,<br>
even&nbsp;though&nbsp;the&nbsp;subobject&nbsp;virtual&nbsp;tables&nbsp;are&nbsp;present&nbsp;in&nbsp;the&nbsp;main&nbsp;virtual<br>
table&nbsp;group<br>
for&nbsp;the&nbsp;complete&nbsp;object.<br>
<br>
&lt;p&gt;<br>
The&nbsp;&lt;i&gt;values&lt;/i&gt;&nbsp;of&nbsp;some&nbsp;construction&nbsp;virtual&nbsp;table&nbsp;entries&nbsp;will&nbsp;differ<br>
from&nbsp;the&nbsp;corresponding&nbsp;entries&nbsp;in&nbsp;either&nbsp;the&nbsp;main&nbsp;virtual&nbsp;table<br>
group&nbsp;for&nbsp;B&nbsp;or&nbsp;the&nbsp;virtual&nbsp;table&nbsp;group&nbsp;for&nbsp;B-in-D,<br>
primarily&nbsp;because&nbsp;the&nbsp;virtual&nbsp;bases&nbsp;of&nbsp;B&nbsp;will&nbsp;be&nbsp;at&nbsp;different&nbsp;relative<br>
offsets&nbsp;in&nbsp;a&nbsp;D&nbsp;object&nbsp;than&nbsp;in&nbsp;a&nbsp;standalone&nbsp;B&nbsp;object,<br>
as&nbsp;follows:<br>
<br>
&lt;ol&gt;<br>
&lt;li&gt;<br>
Virtual&nbsp;base&nbsp;class&nbsp;offsets&nbsp;reflect&nbsp;the&nbsp;positions&nbsp;of&nbsp;the&nbsp;virtual&nbsp;base<br>
classes&nbsp;in&nbsp;the&nbsp;full&nbsp;D&nbsp;object.<br>
<br>
&lt;li&gt;<br>
Similarly,&nbsp;vcall&nbsp;offsets&nbsp;reflect&nbsp;the&nbsp;relative&nbsp;positions&nbsp;of&nbsp;the<br>
overridden&nbsp;and&nbsp;overriding&nbsp;classes&nbsp;within&nbsp;the&nbsp;complete&nbsp;object&nbsp;D.<br>
<br>
&lt;li&gt;<br>
The&nbsp;offset-to-top&nbsp;fields&nbsp;refer&nbsp;to&nbsp;B<br>
(and&nbsp;B's&nbsp;in&nbsp;particular&nbsp;will&nbsp;therefore&nbsp;be&nbsp;zero).<br>
<br>
&lt;li&gt;<br>
The&nbsp;RTTI&nbsp;pointers&nbsp;point&nbsp;to&nbsp;B's&nbsp;RTTI.<br>
<br>
&lt;li&gt;<br>
Only&nbsp;functions&nbsp;in&nbsp;B&nbsp;and&nbsp;its&nbsp;base&nbsp;classes&nbsp;are&nbsp;considered&nbsp;for&nbsp;virtual<br>
function&nbsp;resolution.<br>
&lt;/ol&gt;<br>
<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=array-cookies&gt;<br>
&lt;h3&gt;&nbsp;2.7&nbsp;Array&nbsp;Operator&nbsp;&lt;code&gt;new&lt;/code&gt;&nbsp;Cookies&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
When&nbsp;operator&nbsp;&lt;code&gt;new&lt;/code&gt;&nbsp;is&nbsp;used&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;array,<br>
a&nbsp;cookie&nbsp;is&nbsp;usually&nbsp;stored&nbsp;to&nbsp;remember&nbsp;the&nbsp;allocated&nbsp;length<br>
(number&nbsp;of&nbsp;array&nbsp;elements)<br>
so&nbsp;that&nbsp;it&nbsp;can&nbsp;be&nbsp;deallocated&nbsp;correctly.<br>
<br>
&lt;p&gt;<br>
Specifically:<br>
&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;No&nbsp;cookie&nbsp;is&nbsp;required&nbsp;if&nbsp;the&nbsp;array&nbsp;element&nbsp;type&nbsp;T&nbsp;has&nbsp;a&nbsp;trivial<br>
&nbsp;&nbsp;&nbsp;&nbsp;destructor&nbsp;(12.4&nbsp;[class.dtor])<br>
&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;the&nbsp;usual&nbsp;(array)&nbsp;deallocation&nbsp;function<br>
&nbsp;&nbsp;&nbsp;&nbsp;(3.7.3.2&nbsp;[basic.stc.dynamic.deallocation])<br>
&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;does&nbsp;not&nbsp;take&nbsp;two&nbsp;arguments.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;(Note:&nbsp;if&nbsp;the&nbsp;usual&nbsp;array&nbsp;deallocation&nbsp;function&nbsp;takes&nbsp;two&nbsp;arguments,<br>
&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;it&nbsp;is&nbsp;a&nbsp;member&nbsp;function&nbsp;whose&nbsp;second&nbsp;argument&nbsp;is&nbsp;of&nbsp;type&nbsp;size_t.<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;standard&nbsp;guarantees&nbsp;(12.5&nbsp;[class.free])<br>
&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;this&nbsp;function&nbsp;will&nbsp;be&nbsp;passed&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;bytes&nbsp;allocated&nbsp;with&nbsp;the&nbsp;previous&nbsp;array&nbsp;new&nbsp;expression.)<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;No&nbsp;cookie&nbsp;is&nbsp;required&nbsp;if&nbsp;the&nbsp;&lt;code&gt;new&lt;/code&gt;&nbsp;operator&nbsp;being&nbsp;used<br>
&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;&lt;code&gt;::operator&nbsp;new[](size_t,&nbsp;void*)&lt;/code&gt;.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;Otherwise,&nbsp;this&nbsp;ABI&nbsp;requires&nbsp;a&nbsp;cookie,&nbsp;setup&nbsp;as&nbsp;follows:<br>
&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;The&nbsp;cookie&nbsp;will&nbsp;have&nbsp;size&nbsp;&lt;code&gt;sizeof(size_t)&lt;/code&gt;.<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;Let&nbsp;&lt;code&gt;align&lt;/code&gt;&nbsp;be&nbsp;the&nbsp;maximum&nbsp;alignment&nbsp;of<br>
&nbsp;&nbsp;&lt;code&gt;size_t&lt;/code&gt;&nbsp;and&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;array&nbsp;to&nbsp;be&nbsp;allocated.<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;Let&nbsp;&lt;code&gt;padding&lt;/code&gt;&nbsp;be&nbsp;the&nbsp;maximum&nbsp;of<br>
&nbsp;&nbsp;&lt;code&gt;sizeof(size_t)&lt;/code&gt;&nbsp;and&nbsp;&lt;code&gt;align&lt;/code&gt;&nbsp;bytes.<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;The&nbsp;space&nbsp;allocated&nbsp;for&nbsp;the&nbsp;array&nbsp;will&nbsp;be&nbsp;the&nbsp;space&nbsp;required<br>
&nbsp;&nbsp;by&nbsp;the&nbsp;array&nbsp;itself&nbsp;plus&nbsp;&lt;code&gt;padding&lt;/code&gt;&nbsp;bytes.<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;The&nbsp;alignment&nbsp;of&nbsp;the&nbsp;space&nbsp;allocated&nbsp;for&nbsp;the&nbsp;array&nbsp;will&nbsp;be<br>
&nbsp;&nbsp;&lt;code&gt;align&lt;/code&gt;&nbsp;bytes.<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;The&nbsp;array&nbsp;data&nbsp;will&nbsp;begin&nbsp;at&nbsp;an&nbsp;offset&nbsp;of&nbsp;&lt;code&gt;align&lt;/code&gt;&nbsp;bytes<br>
&nbsp;&nbsp;from&nbsp;the&nbsp;space&nbsp;allocated&nbsp;for&nbsp;the&nbsp;array.<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;The&nbsp;cookie&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;the&nbsp;&lt;code&gt;sizeof(size_t)&lt;/code&gt;&nbsp;bytes<br>
&nbsp;&nbsp;immediately&nbsp;preceding&nbsp;the&nbsp;array&nbsp;data.<br>
&nbsp;&nbsp;&lt;/ul&gt;<br>
<br>
&nbsp;&nbsp;&lt;i&gt;<br>
&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;These&nbsp;rules&nbsp;have&nbsp;the&nbsp;following&nbsp;consequences:<br>
&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;The&nbsp;array&nbsp;elements&nbsp;and&nbsp;the&nbsp;cookie&nbsp;are&nbsp;all&nbsp;aligned&nbsp;naturally.<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;Padding&nbsp;will&nbsp;be&nbsp;required&nbsp;if&nbsp;&lt;code&gt;sizeof(size_t)&lt;/code&gt;<br>
&nbsp;&nbsp;is&nbsp;smaller&nbsp;than&nbsp;the&nbsp;array&nbsp;element&nbsp;alignment,<br>
&nbsp;&nbsp;and&nbsp;if&nbsp;present&nbsp;will&nbsp;precede&nbsp;the&nbsp;cookie.<br>
&nbsp;&nbsp;&lt;/ul&gt;<br>
&nbsp;&nbsp;&lt;/i&gt;<br>
<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
Given&nbsp;the&nbsp;above,&nbsp;the&nbsp;following&nbsp;is&nbsp;pseudocode&nbsp;for&nbsp;processing<br>
&lt;code&gt;new(ARGS)&nbsp;T[n]&lt;/code&gt;:<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;if&nbsp;T&nbsp;has&nbsp;a&nbsp;trivial&nbsp;destructor&nbsp;(C++&nbsp;standard,&nbsp;12.4/3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;padding&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;else&nbsp;if&nbsp;we're&nbsp;using&nbsp;::operator&nbsp;new[](size_t,&nbsp;void*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;padding&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;else<br>
&nbsp;&nbsp;&nbsp;&nbsp;padding&nbsp;=&nbsp;max(sizeof(size_t),&nbsp;alignof(T))<br>
<br>
&nbsp;&nbsp;p&nbsp;=&nbsp;operator&nbsp;new[](n&nbsp;*&nbsp;sizeof(T)&nbsp;+&nbsp;padding,&nbsp;ARGS)<br>
&nbsp;&nbsp;p1&nbsp;=&nbsp;(T*)&nbsp;(&nbsp;(char&nbsp;*)p&nbsp;+&nbsp;padding&nbsp;)<br>
<br>
&nbsp;&nbsp;if&nbsp;padding&nbsp;&gt;&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;*(&nbsp;(unsigned&nbsp;long&nbsp;*)p1&nbsp;-&nbsp;1)&nbsp;=&nbsp;n<br>
<br>
&nbsp;&nbsp;for&nbsp;i&nbsp;=&nbsp;[0,&nbsp;n)<br>
&nbsp;&nbsp;&nbsp;&nbsp;create&nbsp;a&nbsp;T,&nbsp;using&nbsp;the&nbsp;default&nbsp;constructor,&nbsp;at&nbsp;p1[i]<br>
<br>
&nbsp;&nbsp;return&nbsp;p1<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=guards&gt;<br>
&lt;h3&gt;&nbsp;2.8&nbsp;Initialization&nbsp;Guard&nbsp;Variables&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
Associated&nbsp;with&nbsp;each&nbsp;function-scope&nbsp;static&nbsp;variable&nbsp;requiring&nbsp;runtime<br>
construction&nbsp;is&nbsp;a&nbsp;guard&nbsp;variable&nbsp;which&nbsp;is&nbsp;used&nbsp;to&nbsp;guarantee&nbsp;that<br>
construction&nbsp;occurs&nbsp;only&nbsp;once.<br>
Its&nbsp;name&nbsp;is&nbsp;mangled&nbsp;based&nbsp;on&nbsp;the&nbsp;mangling&nbsp;of&nbsp;the&nbsp;guarded&nbsp;object&nbsp;name,<br>
to&nbsp;allow&nbsp;distinct&nbsp;instances&nbsp;of&nbsp;the&nbsp;function<br>
(e.g.&nbsp;due&nbsp;to&nbsp;inlining)&nbsp;to&nbsp;use&nbsp;the&nbsp;same&nbsp;guard.<br>
<br>
&lt;p&gt;<br>
The&nbsp;size&nbsp;of&nbsp;the&nbsp;guard&nbsp;variable&nbsp;is&nbsp;64&nbsp;bits.<br>
The&nbsp;first&nbsp;byte&nbsp;(i.e.&nbsp;the&nbsp;byte&nbsp;at&nbsp;the&nbsp;address&nbsp;of&nbsp;the&nbsp;full&nbsp;variable)<br>
shall&nbsp;contain&nbsp;the&nbsp;value&nbsp;0&nbsp;prior&nbsp;to&nbsp;initialization&nbsp;of<br>
the&nbsp;associated&nbsp;variable,&nbsp;and&nbsp;1&nbsp;after&nbsp;initialization&nbsp;is&nbsp;complete.<br>
Usage&nbsp;of&nbsp;the&nbsp;other&nbsp;bytes&nbsp;of&nbsp;the&nbsp;guard&nbsp;variable&nbsp;is&nbsp;implementation-defined.<br>
<br>
&lt;p&gt;<br>
See&nbsp;&lt;a&nbsp;href=once-ctor&gt;Section&nbsp;3.3.2&lt;/a&gt;<br>
for&nbsp;the&nbsp;API&nbsp;for&nbsp;references&nbsp;to&nbsp;this&nbsp;guard&nbsp;variable.<br>
<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=rtti&gt;<br>
&lt;h3&gt;&nbsp;2.9&nbsp;Run-Time&nbsp;Type&nbsp;Information&nbsp;(RTTI)&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;2.9.1&nbsp;General&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;C++&nbsp;programming&nbsp;language&nbsp;definition&nbsp;implies&nbsp;that&nbsp;information&nbsp;about<br>
types&nbsp;be&nbsp;available&nbsp;at&nbsp;run&nbsp;time&nbsp;for&nbsp;three&nbsp;distinct&nbsp;purposes:<br>
&lt;ol&nbsp;type=a&gt;<br>
&lt;li&gt;&nbsp;to&nbsp;support&nbsp;the&nbsp;typeid&nbsp;operator,<br>
&lt;li&gt;&nbsp;to&nbsp;match&nbsp;an&nbsp;exception&nbsp;handler&nbsp;with&nbsp;a&nbsp;thrown&nbsp;object,&nbsp;and<br>
&lt;li&gt;&nbsp;to&nbsp;implement&nbsp;the&nbsp;dynamic_cast&nbsp;operator.<br>
&lt;/ol&gt;<br>
(c)&nbsp;only&nbsp;requires&nbsp;type&nbsp;information&nbsp;about&nbsp;dynamic&nbsp;class&nbsp;types,<br>
but&nbsp;(a)&nbsp;and&nbsp;(b)&nbsp;may&nbsp;apply&nbsp;to&nbsp;other&nbsp;types&nbsp;as&nbsp;well;<br>
for&nbsp;example,&nbsp;when&nbsp;a&nbsp;pointer&nbsp;to&nbsp;an&nbsp;int&nbsp;is&nbsp;thrown,<br>
it&nbsp;can&nbsp;be&nbsp;caught&nbsp;by&nbsp;a&nbsp;handler&nbsp;that&nbsp;catches&nbsp;&quot;int&nbsp;const*&quot;.<br>
<br>
&lt;p&gt;<br>
It&nbsp;is&nbsp;intended&nbsp;that&nbsp;two&nbsp;type_info&nbsp;pointers&nbsp;point&nbsp;to&nbsp;equivalent&nbsp;type<br>
descriptions&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;the&nbsp;pointers&nbsp;are&nbsp;equal.<br>
An&nbsp;implementation&nbsp;must&nbsp;satisfy&nbsp;this&nbsp;constraint,<br>
e.g.&nbsp;by&nbsp;using&nbsp;symbol&nbsp;preemption,&nbsp;COMDAT&nbsp;sections,&nbsp;or&nbsp;other&nbsp;mechanisms.<br>
<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
Note&nbsp;that&nbsp;the&nbsp;full&nbsp;structure&nbsp;described&nbsp;by&nbsp;an&nbsp;RTTI&nbsp;descriptor&nbsp;may<br>
include&nbsp;incomplete&nbsp;types&nbsp;not&nbsp;required&nbsp;by&nbsp;the&nbsp;Standard&nbsp;to&nbsp;be&nbsp;completed,<br>
although&nbsp;not&nbsp;in&nbsp;contexts&nbsp;where&nbsp;it&nbsp;would&nbsp;cause&nbsp;ambiguity.<br>
Therefore,&nbsp;any&nbsp;cross-references&nbsp;within&nbsp;the&nbsp;RTTI&nbsp;to&nbsp;types&nbsp;not&nbsp;known&nbsp;to<br>
be&nbsp;complete&nbsp;must&nbsp;be&nbsp;weak&nbsp;symbol&nbsp;references.<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;2.9.2&nbsp;Place&nbsp;of&nbsp;Emission&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
It&nbsp;is&nbsp;desirable&nbsp;to&nbsp;minimize&nbsp;the&nbsp;number&nbsp;of&nbsp;places&nbsp;where&nbsp;a<br>
particular&nbsp;bit&nbsp;of&nbsp;RTTI&nbsp;is&nbsp;emitted.<br>
For&nbsp;dynamic&nbsp;class&nbsp;types,<br>
a&nbsp;similar&nbsp;problem&nbsp;occurs&nbsp;for&nbsp;virtual&nbsp;function&nbsp;tables,<br>
and&nbsp;hence&nbsp;the&nbsp;RTTI&nbsp;descriptor&nbsp;should&nbsp;be&nbsp;emitted<br>
with&nbsp;the&nbsp;primary&nbsp;virtual&nbsp;table&nbsp;for&nbsp;that&nbsp;type.<br>
For&nbsp;other&nbsp;types,&nbsp;they&nbsp;must&nbsp;be&nbsp;emitted&nbsp;at&nbsp;the&nbsp;location<br>
where&nbsp;their&nbsp;use&nbsp;is&nbsp;implied:<br>
the&nbsp;object&nbsp;file&nbsp;containing&nbsp;the&nbsp;typeid,&nbsp;throw&nbsp;or&nbsp;catch.<br>
<br>
&lt;p&gt;<br>
Basic&nbsp;type&nbsp;information&nbsp;(e.g.&nbsp;for&nbsp;&quot;int&quot;,&nbsp;&quot;bool&quot;,&nbsp;etc.)<br>
will&nbsp;be&nbsp;kept&nbsp;in&nbsp;the&nbsp;run-time&nbsp;support&nbsp;library.<br>
Specifically,&nbsp;the&nbsp;run-time&nbsp;support&nbsp;library<br>
should&nbsp;contain&nbsp;type_info&nbsp;objects&nbsp;for&nbsp;the&nbsp;types<br>
X,&nbsp;X*&nbsp;and&nbsp;X&nbsp;const*,<br>
for&nbsp;every&nbsp;X&nbsp;in:&nbsp;void,&nbsp;bool,&nbsp;wchar_t,&nbsp;char,&nbsp;unsigned&nbsp;char,&nbsp;signed&nbsp;char,<br>
short,&nbsp;unsigned&nbsp;short,&nbsp;int,&nbsp;unsigned&nbsp;int,&nbsp;long,&nbsp;unsigned&nbsp;long,&nbsp;long&nbsp;long,<br>
unsigned&nbsp;long&nbsp;long,&nbsp;float,&nbsp;double,&nbsp;long&nbsp;double.<br>
(Note&nbsp;that&nbsp;various&nbsp;other&nbsp;type_info&nbsp;objects&nbsp;for&nbsp;class&nbsp;types&nbsp;may&nbsp;reside<br>
in&nbsp;the&nbsp;run-time&nbsp;support&nbsp;library&nbsp;by&nbsp;virtue&nbsp;of&nbsp;the&nbsp;preceding&nbsp;rules,<br>
e.g.&nbsp;that&nbsp;of&nbsp;&lt;code&gt;std::bad_alloc&lt;/code&gt;.)<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=typeid&gt;<br>
&lt;h4&gt;&nbsp;2.9.3&nbsp;The&nbsp;&lt;code&gt;typeid&lt;/code&gt;&nbsp;Operator&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;typeid&nbsp;operator&nbsp;produces&nbsp;a&nbsp;reference&nbsp;to&nbsp;a&nbsp;std::type_info&nbsp;structure<br>
with&nbsp;the&nbsp;following&nbsp;public&nbsp;interface&nbsp;(18.5.1):<br>
<br>
&lt;pre&gt;&lt;code&gt;<br>
&nbsp;&nbsp;namespace&nbsp;std&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;type_info&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;~type_info();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;operator==(const&nbsp;type_info&nbsp;&amp;)&nbsp;const;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;operator!=(const&nbsp;type_info&nbsp;&amp;)&nbsp;const;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bool&nbsp;before(const&nbsp;type_info&nbsp;&amp;)&nbsp;const;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;char*&nbsp;name()&nbsp;const;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type_info&nbsp;(const&nbsp;type_info&amp;&nbsp;rhs);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type_info&amp;&nbsp;operator=&nbsp;(const&nbsp;type_info&amp;&nbsp;rhs);<br>
&nbsp;&nbsp;&nbsp;&nbsp;};<br>
&nbsp;&nbsp;}<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
After&nbsp;linking&nbsp;and&nbsp;loading,<br>
only&nbsp;one&nbsp;std::type_info&nbsp;structure&nbsp;is&nbsp;accessible&nbsp;via&nbsp;the&nbsp;external&nbsp;name<br>
defined&nbsp;by&nbsp;this&nbsp;ABI&nbsp;for&nbsp;any&nbsp;particular&nbsp;complete&nbsp;type&nbsp;symbol<br>
(see&nbsp;&lt;a&nbsp;href=#vague-rtti&gt;Vague&nbsp;Linkage&lt;/a&gt;).<br>
Therefore,<br>
except&nbsp;for&nbsp;direct&nbsp;or&nbsp;indirect&nbsp;pointers&nbsp;to&nbsp;incomplete&nbsp;types,<br>
the&nbsp;equality&nbsp;and&nbsp;inequality&nbsp;operators&nbsp;can&nbsp;be<br>
written&nbsp;as&nbsp;address&nbsp;comparisons<br>
when&nbsp;operating&nbsp;on&nbsp;those&nbsp;type_info&nbsp;objects:<br>
two&nbsp;type_info&nbsp;structures&nbsp;describe&nbsp;the&nbsp;same&nbsp;type<br>
if&nbsp;and&nbsp;only&nbsp;if&nbsp;they&nbsp;are&nbsp;the&nbsp;same&nbsp;structure&nbsp;(at&nbsp;the&nbsp;same&nbsp;address).<br>
However,&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;pointer&nbsp;types,<br>
directly&nbsp;or&nbsp;indirectly&nbsp;pointing&nbsp;to&nbsp;incomplete&nbsp;class&nbsp;types,<br>
a&nbsp;more&nbsp;complex&nbsp;comparison&nbsp;is&nbsp;required,<br>
described&nbsp;below&nbsp;with&nbsp;the&nbsp;RTTI&nbsp;layout&nbsp;of&nbsp;pointer&nbsp;types.<br>
<br>
&lt;p&gt;<br>
The&nbsp;&lt;code&gt;name()&lt;/code&gt;&nbsp;member&nbsp;function&nbsp;returns&nbsp;the&nbsp;address&nbsp;of&nbsp;an&nbsp;NTBS,<br>
unique&nbsp;to&nbsp;the&nbsp;type,<br>
containing&nbsp;the&nbsp;&lt;a&nbsp;href=#mangling-type&gt;mangled&nbsp;name&lt;/a&gt;&nbsp;of&nbsp;the&nbsp;type.<br>
It&nbsp;has&nbsp;a&nbsp;&lt;a&nbsp;href=mangling-special&gt;mangled&nbsp;name&lt;/a&gt;&nbsp;defined&nbsp;by&nbsp;the&nbsp;ABI<br>
to&nbsp;allow&nbsp;consistent&nbsp;reference&nbsp;to&nbsp;it,<br>
and&nbsp;the&nbsp;&lt;a&nbsp;href=#vague-rtti&gt;Vague&nbsp;Linkage&lt;/a&gt;&nbsp;section&nbsp;specifies&nbsp;how&nbsp;to<br>
produce&nbsp;a&nbsp;unique&nbsp;copy.<br>
<br>
&lt;p&gt;<br>
In&nbsp;a&nbsp;flat&nbsp;address&nbsp;space<br>
(such&nbsp;as&nbsp;that&nbsp;of&nbsp;the&nbsp;Itanium&nbsp;architecture),<br>
the&nbsp;&lt;code&gt;operator==&lt;/code&gt;,&nbsp;&lt;code&gt;operator!=&lt;/code&gt;,&nbsp;and&nbsp;&lt;code&gt;before()&lt;/code&gt;<br>
members&nbsp;are&nbsp;easily&nbsp;implemented&nbsp;in&nbsp;terms&nbsp;of<br>
an&nbsp;address&nbsp;comparison&nbsp;of&nbsp;the&nbsp;name&nbsp;NTBS.<br>
<br>
&lt;p&gt;<br>
This&nbsp;implies&nbsp;that&nbsp;the&nbsp;type&nbsp;information&nbsp;must&nbsp;keep&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;public,<br>
unambiguous&nbsp;inheritance&nbsp;relationship&nbsp;of&nbsp;a&nbsp;type,&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;const<br>
and&nbsp;volatile&nbsp;qualifications&nbsp;applied&nbsp;to&nbsp;types.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;2.9.4&nbsp;The&nbsp;&lt;code&gt;dynamic_cast&lt;/code&gt;&nbsp;Operator&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
Although&nbsp;dynamic_cast&nbsp;can&nbsp;work&nbsp;on&nbsp;pointers&nbsp;and&nbsp;references,<br>
from&nbsp;the&nbsp;point&nbsp;of&nbsp;view&nbsp;of&nbsp;representation&nbsp;we&nbsp;need&nbsp;only&nbsp;to&nbsp;worry<br>
about&nbsp;polymorphic&nbsp;class&nbsp;types.<br>
Also,&nbsp;some&nbsp;kinds&nbsp;of&nbsp;dynamic_cast&nbsp;operations&nbsp;are&nbsp;handled&nbsp;at&nbsp;compile&nbsp;time<br>
and&nbsp;do&nbsp;not&nbsp;need&nbsp;any&nbsp;RTTI.<br>
There&nbsp;are&nbsp;then&nbsp;three&nbsp;kinds&nbsp;of&nbsp;truly&nbsp;dynamic&nbsp;cast&nbsp;operations:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;dynamic_cast&lt;void&nbsp;cv*&gt;,&nbsp;which&nbsp;returns&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;complete&nbsp;lvalue,<br>
&lt;li&gt;&nbsp;dynamic_cast&nbsp;operation&nbsp;from&nbsp;a&nbsp;proper&nbsp;base&nbsp;class&nbsp;to&nbsp;a&nbsp;derived&nbsp;class,&nbsp;and<br>
&lt;li&gt;&nbsp;dynamic_cast&nbsp;across&nbsp;the&nbsp;hierarchy&nbsp;which&nbsp;can&nbsp;be&nbsp;seen&nbsp;as&nbsp;a&nbsp;cast&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;complete&nbsp;lvalue&nbsp;and&nbsp;back&nbsp;to&nbsp;a&nbsp;sibling&nbsp;base.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;most&nbsp;common&nbsp;kind&nbsp;of&nbsp;dynamic_cast&nbsp;is&nbsp;base-to-derived&nbsp;in&nbsp;a&nbsp;singly<br>
inherited&nbsp;hierarchy.<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=rtti-layout&gt;<br>
&lt;h4&gt;&nbsp;2.9.5&nbsp;RTTI&nbsp;Layout&nbsp;&lt;/h4&gt;<br>
<br>
&lt;ol&nbsp;type=1&gt;<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
The&nbsp;class&nbsp;definitions&nbsp;below&nbsp;are&nbsp;to&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;implying&nbsp;a&nbsp;memory<br>
layout&nbsp;following&nbsp;the&nbsp;class&nbsp;layout&nbsp;rules&nbsp;for&nbsp;the&nbsp;host&nbsp;ABI.<br>
They&nbsp;specify&nbsp;data&nbsp;members&nbsp;only,<br>
except&nbsp;for&nbsp;the&nbsp;Standard-specified&nbsp;member&nbsp;functions&nbsp;of&nbsp;the<br>
&lt;code&gt;std::type_info&lt;/code&gt;&nbsp;class&nbsp;given&nbsp;below,<br>
and&nbsp;do&nbsp;not&nbsp;imply&nbsp;anything&nbsp;about&nbsp;the&nbsp;member&nbsp;functions&nbsp;of&nbsp;these&nbsp;classes.<br>
Virtual&nbsp;member&nbsp;functions&nbsp;of&nbsp;these&nbsp;classes&nbsp;may&nbsp;only&nbsp;be&nbsp;used&nbsp;within&nbsp;the<br>
target&nbsp;systems'&nbsp;respective&nbsp;runtime&nbsp;libraries.<br>
The&nbsp;data&nbsp;members&nbsp;must&nbsp;be&nbsp;laid&nbsp;out&nbsp;exactly&nbsp;as&nbsp;specified.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
Every&nbsp;virtual&nbsp;table&nbsp;shall&nbsp;contain&nbsp;one&nbsp;entry&nbsp;describing&nbsp;the&nbsp;offset&nbsp;from&nbsp;a<br>
virtual&nbsp;pointer&nbsp;for&nbsp;that&nbsp;virtual&nbsp;table&nbsp;to&nbsp;the&nbsp;origin&nbsp;of&nbsp;the&nbsp;object<br>
containing&nbsp;that&nbsp;virtual&nbsp;pointer<br>
(or&nbsp;equivalently:&nbsp;to&nbsp;the&nbsp;virtual&nbsp;pointer&nbsp;for&nbsp;the&nbsp;primary&nbsp;virtual&nbsp;table).<br>
This&nbsp;entry&nbsp;is&nbsp;directly&nbsp;useful&nbsp;to&nbsp;implement&nbsp;dynamic_cast&lt;void&nbsp;cv*&gt;,<br>
but&nbsp;is&nbsp;also&nbsp;needed&nbsp;for&nbsp;the&nbsp;other&nbsp;truly&nbsp;dynamic&nbsp;casts.<br>
This&nbsp;entry&nbsp;is&nbsp;located&nbsp;two&nbsp;words&nbsp;ahead&nbsp;of&nbsp;the&nbsp;location<br>
pointed&nbsp;to&nbsp;by&nbsp;the&nbsp;virtual&nbsp;pointer&nbsp;(i.e.,&nbsp;entry&nbsp;&quot;-2&quot;).<br>
This&nbsp;entry&nbsp;is&nbsp;present&nbsp;in&nbsp;all&nbsp;virtual&nbsp;tables,<br>
even&nbsp;for&nbsp;classes&nbsp;having&nbsp;virtual&nbsp;bases&nbsp;but&nbsp;no&nbsp;virtual&nbsp;functions.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
Every&nbsp;virtual&nbsp;table&nbsp;shall&nbsp;contain&nbsp;one&nbsp;entry&nbsp;that&nbsp;is&nbsp;a&nbsp;pointer&nbsp;to&nbsp;an&nbsp;object<br>
derived&nbsp;from&nbsp;&lt;code&gt;std::type_info&lt;/code&gt;.<br>
This&nbsp;entry&nbsp;is&nbsp;located&nbsp;at&nbsp;the&nbsp;word&nbsp;preceding&nbsp;the&nbsp;location<br>
pointed&nbsp;to&nbsp;by&nbsp;the&nbsp;virtual&nbsp;pointer&nbsp;(i.e.,&nbsp;entry&nbsp;&quot;-1&quot;).<br>
The&nbsp;entry&nbsp;is&nbsp;allocated&nbsp;in&nbsp;all&nbsp;virtual&nbsp;tables;<br>
for&nbsp;classes&nbsp;having&nbsp;virtual&nbsp;bases&nbsp;but&nbsp;no&nbsp;virtual&nbsp;functions,<br>
the&nbsp;entry&nbsp;is&nbsp;zero.<br>
<br>
&lt;p&gt;<br>
We&nbsp;add&nbsp;one&nbsp;pointer&nbsp;to&nbsp;the<br>
&lt;code&gt;std::type_info&lt;/code&gt;&nbsp;class&nbsp;in&nbsp;addition&nbsp;to&nbsp;the&nbsp;virtual&nbsp;table<br>
pointer&nbsp;implied&nbsp;by&nbsp;its&nbsp;virtual&nbsp;destructor:<br>
&lt;pre&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;type_info&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;//&nbsp;See&nbsp;&lt;a&nbsp;href=#typeid&gt;section&nbsp;2.9.3&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;char&nbsp;*__type_name;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
<br>
&lt;/pre&gt;&lt;/code&gt;<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;The&nbsp;class&nbsp;will&nbsp;contain&nbsp;a&nbsp;virtual&nbsp;pointer&nbsp;before&nbsp;the&nbsp;explicit&nbsp;members.<br>
&lt;li&gt;&nbsp;&lt;code&gt;__type_name&lt;/code&gt;&nbsp;is&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;NTBS<br>
&nbsp;&nbsp;&nbsp;&nbsp;representing&nbsp;the&nbsp;mangled&nbsp;name&nbsp;of&nbsp;the&nbsp;type.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;possible&nbsp;derived&nbsp;types&nbsp;are:<br>
&lt;ul&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;code&gt;abi::__fundamental_type_info&lt;/code&gt;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;code&gt;abi::__array_type_info&lt;/code&gt;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;code&gt;abi::__function_type_info&lt;/code&gt;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;code&gt;abi::__enum_type_info&lt;/code&gt;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;code&gt;abi::__class_type_info&lt;/code&gt;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;code&gt;abi::__si_class_type_info&lt;/code&gt;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;code&gt;abi::__vmi_class_type_info&lt;/code&gt;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;code&gt;abi::__pbase_type_info&lt;/code&gt;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;code&gt;abi::__pointer_type_info&lt;/code&gt;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;code&gt;abi::__pointer_to_member_type_info&lt;/code&gt;&nbsp;&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
&lt;code&gt;abi::__fundamental_type_info&lt;/code&gt;&nbsp;adds&nbsp;no&nbsp;data&nbsp;members<br>
to&nbsp;&lt;code&gt;std::type_info&lt;/code&gt;;<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
&lt;code&gt;abi::__array_type_info&lt;/code&gt;&nbsp;and<br>
&lt;code&gt;abi::__function_type_info&lt;/code&gt;&nbsp;do&nbsp;not&nbsp;add&nbsp;data<br>
members&nbsp;to&nbsp;&lt;code&gt;std::type_info&lt;/code&gt;<br>
(these&nbsp;types&nbsp;are&nbsp;only&nbsp;produced&nbsp;by&nbsp;the&nbsp;typeid&nbsp;operator;<br>
they&nbsp;decay&nbsp;in&nbsp;other&nbsp;contexts).&nbsp;&nbsp;<br>
&lt;code&gt;abi::__enum_type_info&lt;/code&gt;&nbsp;does&nbsp;not&nbsp;add&nbsp;data&nbsp;members&nbsp;either.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
Three&nbsp;different&nbsp;types&nbsp;are&nbsp;used&nbsp;to&nbsp;represent&nbsp;user&nbsp;type&nbsp;information:<br>
<br>
&lt;ol&nbsp;type=a&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
&lt;code&gt;abi::__class_type_info&lt;/code&gt;&nbsp;is&nbsp;used&nbsp;for&nbsp;class&nbsp;types&nbsp;having&nbsp;no&nbsp;bases,<br>
and&nbsp;is&nbsp;also&nbsp;a&nbsp;base&nbsp;type&nbsp;for&nbsp;the&nbsp;other&nbsp;two&nbsp;class&nbsp;type&nbsp;representations.<br>
&lt;pre&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;__class_type_info&nbsp;:&nbsp;public&nbsp;std::type_info&nbsp;{}<br>
<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
This&nbsp;RTTI&nbsp;class&nbsp;may<br>
also&nbsp;be&nbsp;used&nbsp;for&nbsp;incomplete&nbsp;class&nbsp;types&nbsp;when&nbsp;referenced&nbsp;by&nbsp;a&nbsp;pointer&nbsp;RTTI,<br>
in&nbsp;which&nbsp;case&nbsp;it&nbsp;must&nbsp;be&nbsp;prevented&nbsp;from&nbsp;preempting<br>
the&nbsp;RTTI&nbsp;for&nbsp;the&nbsp;complete&nbsp;class&nbsp;type,<br>
for&nbsp;instance&nbsp;by&nbsp;emitting&nbsp;it&nbsp;as&nbsp;a&nbsp;static&nbsp;object&nbsp;(without&nbsp;external&nbsp;linkage).<br>
<br>
&lt;p&gt;<br>
Two&nbsp;&lt;code&gt;abi::__class_type_info&lt;/code&gt;&nbsp;objects&nbsp;can&nbsp;always&nbsp;be&nbsp;compared,<br>
for&nbsp;equality&nbsp;(i.e.&nbsp;of&nbsp;the&nbsp;types&nbsp;represented)&nbsp;or&nbsp;ordering,<br>
by&nbsp;comparison&nbsp;of&nbsp;their&nbsp;name&nbsp;NTBS&nbsp;addresses.<br>
In&nbsp;addition,&nbsp;complete&nbsp;class&nbsp;RTTI&nbsp;objects<br>
may&nbsp;also&nbsp;be&nbsp;compared&nbsp;for&nbsp;equality<br>
by&nbsp;comparison&nbsp;of&nbsp;their&nbsp;type_info&nbsp;addresses.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
For&nbsp;classes&nbsp;containing&nbsp;only&nbsp;a&nbsp;single,&nbsp;public,&nbsp;non-virtual&nbsp;base<br>
at&nbsp;offset&nbsp;zero&nbsp;(i.e.&nbsp;the&nbsp;derived&nbsp;class&nbsp;is&nbsp;dynamic&nbsp;iff&nbsp;the&nbsp;base&nbsp;is),<br>
class&nbsp;&lt;code&gt;abi::__si_class_type_info&lt;/code&gt;&nbsp;is&nbsp;used.<br>
It&nbsp;adds&nbsp;to&nbsp;&lt;code&gt;abi::__class_type_info&lt;/code&gt;&nbsp;a&nbsp;single&nbsp;member&nbsp;pointing&nbsp;to&nbsp;the&nbsp;type_info&nbsp;structure&nbsp;for&nbsp;the&nbsp;base&nbsp;type,<br>
declared&nbsp;&quot;&lt;code&gt;__class_type_info&nbsp;const&nbsp;*type&lt;/code&gt;&quot;.<br>
&lt;pre&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;__si_class_type_info&nbsp;:&nbsp;public&nbsp;__class_type_info&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;__class_type_info&nbsp;*__base_type;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
&lt;a&nbsp;name=vmi&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
For&nbsp;classes&nbsp;with&nbsp;bases&nbsp;that&nbsp;do&nbsp;not&nbsp;satisfy&nbsp;the<br>
&lt;code&gt;__si_class_type_info&lt;/code&gt;&nbsp;constraints,<br>
&lt;code&gt;abi::__vmi_class_type_info&lt;/code&gt;&nbsp;is&nbsp;used.<br>
It&nbsp;is&nbsp;derived&nbsp;from&nbsp;&lt;code&gt;abi::__class_type_info&lt;/code&gt;:<br>
&lt;pre&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;__vmi_class_type_info&nbsp;:&nbsp;public&nbsp;__class_type_info&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;__flags;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;__base_count;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__base_class_type_info&nbsp;__base_info[1];<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enum&nbsp;__flags_masks&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__non_diamond_repeat_mask&nbsp;=&nbsp;0x1,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__diamond_shaped_mask&nbsp;=&nbsp;0x2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
<br>
&lt;/pre&gt;&lt;/code&gt;<br>
&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;code&gt;__flags&lt;/code&gt;&nbsp;is&nbsp;a&nbsp;word&nbsp;with&nbsp;flags&nbsp;describing&nbsp;details<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;about&nbsp;the&nbsp;class&nbsp;structure,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which&nbsp;may&nbsp;be&nbsp;referenced&nbsp;by&nbsp;using&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;code&gt;__flags_masks&lt;/code&gt;&nbsp;enumeration.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;0x01:&nbsp;class&nbsp;has&nbsp;non-diamond&nbsp;repeated&nbsp;inheritance<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;0x02:&nbsp;class&nbsp;is&nbsp;diamond&nbsp;shaped<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;These&nbsp;flags&nbsp;refer&nbsp;to&nbsp;both&nbsp;direct&nbsp;and&nbsp;indirect&nbsp;bases.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;type&nbsp;of&nbsp;the&nbsp;&lt;code&gt;__flags&lt;/code&gt;&nbsp;field&nbsp;is&nbsp;defined&nbsp;by&nbsp;each&nbsp;psABI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;but&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;16&nbsp;bits.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;the&nbsp;64-bit&nbsp;Itanium&nbsp;ABI,&nbsp;it&nbsp;will&nbsp;be&nbsp;unsigned&nbsp;int&nbsp;(32&nbsp;bits).<br>
<br>
&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;code&gt;__base_count&lt;/code&gt;&nbsp;is&nbsp;a&nbsp;word&nbsp;with&nbsp;the&nbsp;number&nbsp;of<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;direct&nbsp;proper&nbsp;base&nbsp;class&nbsp;descriptions&nbsp;that&nbsp;follow.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;type&nbsp;of&nbsp;the&nbsp;&lt;code&gt;__base_count&lt;/code&gt;&nbsp;field&nbsp;is&nbsp;defined&nbsp;by&nbsp;each&nbsp;psABI.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;the&nbsp;64-bit&nbsp;Itanium&nbsp;ABI,&nbsp;it&nbsp;will&nbsp;be&nbsp;unsigned&nbsp;int&nbsp;(32&nbsp;bits).<br>
<br>
&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;code&gt;__base_info[]&lt;/code&gt;&nbsp;is&nbsp;an&nbsp;array&nbsp;of&nbsp;base&nbsp;class&nbsp;descriptions&nbsp;--<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;one&nbsp;for&nbsp;every&nbsp;direct&nbsp;proper&nbsp;base.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Each&nbsp;description&nbsp;is&nbsp;of&nbsp;the&nbsp;type:<br>
&lt;pre&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;abi::__base_class_type_info&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;__class_type_info&nbsp;*__base_type;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;__offset_flags;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enum&nbsp;__offset_flags_masks&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__virtual_mask&nbsp;=&nbsp;0x1,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__public_mask&nbsp;=&nbsp;0x2,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__offset_shift&nbsp;=&nbsp;8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;&lt;code&gt;__base_type&lt;/code&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;member&nbsp;points&nbsp;to&nbsp;the&nbsp;RTTI&nbsp;for&nbsp;the&nbsp;base&nbsp;type.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;upper&nbsp;56&nbsp;bits&nbsp;of&nbsp;&lt;code&gt;__offset_flags&lt;/code&gt;&nbsp;are&nbsp;a&nbsp;signed&nbsp;offset.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;a&nbsp;non-virtual&nbsp;base,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this&nbsp;is&nbsp;the&nbsp;offset&nbsp;in&nbsp;the&nbsp;object&nbsp;of&nbsp;the&nbsp;base&nbsp;subobject.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;a&nbsp;virtual&nbsp;base,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this&nbsp;is&nbsp;the&nbsp;offset&nbsp;in&nbsp;the&nbsp;virtual&nbsp;table&nbsp;of&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;base&nbsp;offset&nbsp;for&nbsp;the&nbsp;virtual&nbsp;base&nbsp;referenced<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(negative).<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;low-order&nbsp;byte&nbsp;of&nbsp;&lt;code&gt;__offset_flags&lt;/code&gt;&nbsp;contains&nbsp;flags,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;as&nbsp;given&nbsp;by&nbsp;the&nbsp;masks&nbsp;from&nbsp;the&nbsp;enumeration<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;code&gt;__offset_flags_masks&lt;/code&gt;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;0x1:&nbsp;Base&nbsp;class&nbsp;is&nbsp;virtual<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&nbsp;0x2:&nbsp;Base&nbsp;class&nbsp;is&nbsp;public<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;an&nbsp;ABI&nbsp;for&nbsp;a&nbsp;machine&nbsp;with&nbsp;32-bit&nbsp;addresses,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;offset&nbsp;becomes&nbsp;a&nbsp;32-bit&nbsp;field,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;the&nbsp;flags&nbsp;are&nbsp;in&nbsp;the&nbsp;low-order&nbsp;byte&nbsp;of&nbsp;a&nbsp;second&nbsp;32-bit&nbsp;field.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/i&gt;<br>
<br>
&nbsp;&nbsp;&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
Note&nbsp;that&nbsp;the&nbsp;resulting&nbsp;structure&nbsp;is&nbsp;variable-length,<br>
with&nbsp;the&nbsp;actual&nbsp;size&nbsp;depending&nbsp;on&nbsp;the&nbsp;number&nbsp;of&nbsp;trailing&nbsp;base&nbsp;class<br>
descriptions.<br>
<br>
&lt;/ol&gt;<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
&lt;code&gt;abi::__pbase_type_info&lt;/code&gt;&nbsp;is&nbsp;a&nbsp;base&nbsp;for&nbsp;both&nbsp;pointer&nbsp;types&nbsp;and<br>
pointer-to-member&nbsp;types.<br>
It&nbsp;adds&nbsp;two&nbsp;data&nbsp;members:<br>
&lt;pre&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;__pbase_type_info&nbsp;:&nbsp;public&nbsp;std::type_info&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;__flags;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;std::type_info&nbsp;*__pointee;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enum&nbsp;__masks&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__const_mask&nbsp;=&nbsp;0x1,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__volatile_mask&nbsp;=&nbsp;0x2,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__restrict_mask&nbsp;=&nbsp;0x4,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__incomplete_mask&nbsp;=&nbsp;0x8,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__incomplete_class_mask&nbsp;=&nbsp;0x10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
<br>
&lt;ul&gt;<br>
&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;code&gt;__flags&lt;/code&gt;&nbsp;is&nbsp;a&nbsp;flag&nbsp;word&nbsp;describing&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cv-qualification&nbsp;and&nbsp;other&nbsp;attributes&nbsp;of&nbsp;the&nbsp;type&nbsp;pointed&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(e.g.,&nbsp;&quot;int&nbsp;volatile*&quot;&nbsp;should&nbsp;have&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;volatile&quot;&nbsp;bit&nbsp;set&nbsp;in&nbsp;that&nbsp;word);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and<br>
&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&lt;li&gt;&nbsp;&lt;code&gt;__pointee&lt;/code&gt;&nbsp;is&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;code&gt;std::type_info&lt;/code&gt;&nbsp;derivation&nbsp;for&nbsp;the&nbsp;unqualified&nbsp;type<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;being&nbsp;pointed&nbsp;to.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
Note&nbsp;that&nbsp;the&nbsp;&lt;code&gt;__flags&lt;/code&gt;<br>
bits&nbsp;should&nbsp;not&nbsp;be&nbsp;folded<br>
into&nbsp;the&nbsp;pointer&nbsp;to&nbsp;allow&nbsp;future&nbsp;definition&nbsp;of&nbsp;additional&nbsp;flags.<br>
It&nbsp;contains&nbsp;the&nbsp;following&nbsp;bits,<br>
and&nbsp;may&nbsp;be&nbsp;referenced&nbsp;using&nbsp;the&nbsp;flags&nbsp;defined&nbsp;in&nbsp;the<br>
&lt;code&gt;__masks&lt;/code&gt;&nbsp;enum:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;0x1:&nbsp;&lt;code&gt;__pointee&lt;/code&gt;&nbsp;type&nbsp;has&nbsp;const&nbsp;qualifier<br>
&lt;li&gt;&nbsp;0x2:&nbsp;&lt;code&gt;__pointee&lt;/code&gt;&nbsp;type&nbsp;has&nbsp;volatile&nbsp;qualifier<br>
&lt;li&gt;&nbsp;0x4:&nbsp;&lt;code&gt;__pointee&lt;/code&gt;&nbsp;type&nbsp;has&nbsp;restrict&nbsp;qualifier<br>
&lt;li&gt;&nbsp;0x8:&nbsp;&lt;code&gt;__pointee&lt;/code&gt;&nbsp;type&nbsp;is&nbsp;incomplete<br>
&lt;li&gt;&nbsp;0x10:&nbsp;class&nbsp;containing&nbsp;&lt;code&gt;__pointee&lt;/code&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;incomplete&nbsp;(in&nbsp;pointer&nbsp;to&nbsp;member)<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
When&nbsp;the&nbsp;&lt;code&gt;abi::__pbase_type_info&lt;/code&gt;&nbsp;is&nbsp;for&nbsp;a&nbsp;direct<br>
or&nbsp;indirect&nbsp;pointer&nbsp;to&nbsp;an&nbsp;incomplete&nbsp;class&nbsp;type,<br>
the&nbsp;incomplete&nbsp;target&nbsp;type&nbsp;flag&nbsp;is&nbsp;set.<br>
When&nbsp;it&nbsp;is&nbsp;for&nbsp;a&nbsp;direct&nbsp;or&nbsp;indirect&nbsp;pointer&nbsp;to&nbsp;a&nbsp;member&nbsp;of<br>
an&nbsp;incomplete&nbsp;class&nbsp;type,<br>
the&nbsp;incomplete&nbsp;class&nbsp;type&nbsp;flag&nbsp;is&nbsp;set.<br>
In&nbsp;addition,&nbsp;it&nbsp;and&nbsp;all&nbsp;of&nbsp;the&nbsp;intermediate<br>
&lt;code&gt;abi::__pointer_type_info&lt;/code&gt;&nbsp;structs&nbsp;in&nbsp;the&nbsp;chain<br>
down&nbsp;to&nbsp;the&nbsp;&lt;code&gt;abi::__class_type_info&lt;/code&gt;&nbsp;for&nbsp;the<br>
incomplete&nbsp;class&nbsp;type&nbsp;must&nbsp;be&nbsp;prevented&nbsp;from&nbsp;resolving&nbsp;to&nbsp;the<br>
corresponding&nbsp;type_info&nbsp;structs&nbsp;for&nbsp;the&nbsp;complete&nbsp;class&nbsp;type,<br>
possibly&nbsp;by&nbsp;making&nbsp;them&nbsp;local&nbsp;static&nbsp;objects.<br>
Finally,&nbsp;a&nbsp;dummy&nbsp;class&nbsp;RTTI&nbsp;is&nbsp;generated&nbsp;for&nbsp;the&nbsp;incomplete&nbsp;type<br>
that&nbsp;will&nbsp;not&nbsp;resolve&nbsp;to&nbsp;the&nbsp;final&nbsp;complete&nbsp;class&nbsp;RTTI<br>
(because&nbsp;the&nbsp;latter&nbsp;need&nbsp;not&nbsp;exist),<br>
possibly&nbsp;by&nbsp;making&nbsp;it&nbsp;a&nbsp;local&nbsp;static&nbsp;object.<br>
<br>
&lt;p&gt;<br>
Two&nbsp;&lt;code&gt;abi::__pbase_type_info&lt;/code&gt;&nbsp;objects&nbsp;can&nbsp;always&nbsp;be&nbsp;compared<br>
for&nbsp;equality&nbsp;(i.e.&nbsp;of&nbsp;the&nbsp;types&nbsp;represented)&nbsp;or&nbsp;ordering<br>
by&nbsp;comparison&nbsp;of&nbsp;their&nbsp;name&nbsp;NTBS&nbsp;addresses.<br>
In&nbsp;addition,<br>
unless&nbsp;either&nbsp;or&nbsp;both&nbsp;have&nbsp;either&nbsp;of&nbsp;the&nbsp;incomplete&nbsp;flags&nbsp;set,<br>
equality&nbsp;can&nbsp;be&nbsp;tested&nbsp;by&nbsp;comparing&nbsp;the&nbsp;type_info&nbsp;addresses.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
&lt;code&gt;abi::__pointer_type_info&lt;/code&gt;&nbsp;is&nbsp;derived&nbsp;from<br>
&lt;code&gt;abi::__pbase_type_info&lt;/code&gt;&nbsp;with&nbsp;no&nbsp;additional&nbsp;data&nbsp;members.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
The&nbsp;&lt;code&gt;abi::__pointer_to_member_type_info&lt;/code&gt;&nbsp;type&nbsp;adds&nbsp;one&nbsp;field<br>
to&nbsp;&lt;code&gt;abi::__pbase_type_info&lt;/code&gt;:<br>
&lt;pre&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;__pointer_to_member_type_info&nbsp;:&nbsp;public&nbsp;__pbase_type_info&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;abi::__class_type_info&nbsp;*__context;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
<br>
&lt;/pre&gt;&lt;/code&gt;<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;&lt;code&gt;__context&lt;/code&gt;&nbsp;is&nbsp;a&nbsp;pointer&nbsp;to&nbsp;an<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;code&gt;abi::__class_type_info&lt;/code&gt;&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;class&nbsp;type<br>
&nbsp;&nbsp;&nbsp;&nbsp;containing&nbsp;the&nbsp;member&nbsp;pointed&nbsp;to&nbsp;(e.g.,&nbsp;the&nbsp;&quot;A&quot;&nbsp;in&nbsp;&quot;int&nbsp;A::*&quot;)<br>
&lt;/ul&gt;<br>
<br>
&lt;/ol&gt;<br>
<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
Note&nbsp;that&nbsp;this&nbsp;ABI&nbsp;requires&nbsp;elsewhere&nbsp;that&nbsp;a&nbsp;virtual&nbsp;table&nbsp;be&nbsp;emitted&nbsp;for&nbsp;a<br>
dynamic&nbsp;type&nbsp;in&nbsp;the&nbsp;object&nbsp;where&nbsp;the&nbsp;first&nbsp;non-inline&nbsp;virtual&nbsp;function<br>
member&nbsp;is&nbsp;defined,&nbsp;if&nbsp;any,&nbsp;or&nbsp;everywhere&nbsp;referenced&nbsp;if&nbsp;none.<br>
Therefore,&nbsp;an&nbsp;implementation&nbsp;should&nbsp;include&nbsp;at&nbsp;least&nbsp;one<br>
non-inline&nbsp;virtual&nbsp;function&nbsp;member&nbsp;and&nbsp;define&nbsp;it&nbsp;in&nbsp;the&nbsp;library,<br>
to&nbsp;avoid&nbsp;having&nbsp;user&nbsp;code&nbsp;inadvertently&nbsp;preempt&nbsp;the&nbsp;virtual&nbsp;table.<br>
Since&nbsp;the&nbsp;Standard&nbsp;requires&nbsp;a&nbsp;virtual&nbsp;destructor,<br>
and&nbsp;it&nbsp;will&nbsp;rarely&nbsp;be&nbsp;called,<br>
it&nbsp;is&nbsp;a&nbsp;good&nbsp;candidate&nbsp;for&nbsp;this&nbsp;role.<br>
&lt;/i&gt;<br>
<br>
<br>
&lt;h4&gt;&nbsp;2.9.6&nbsp;&lt;code&gt;std::type_info::name()&lt;/code&gt;&nbsp;&lt;/h4&gt;<br>
&lt;p&gt;<br>
The&nbsp;null-terminated&nbsp;byte&nbsp;string&nbsp;returned&nbsp;by&nbsp;this&nbsp;routine&nbsp;is<br>
the&nbsp;&lt;a&nbsp;href=#mangling&gt;mangled&nbsp;name&lt;/a&gt;&nbsp;of&nbsp;the&nbsp;type.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;2.9.7&nbsp;The&nbsp;&lt;code&gt;dynamic_cast&lt;/code&gt;&nbsp;Algorithm&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
Dynamic&nbsp;casts&nbsp;to&nbsp;&quot;void&nbsp;cv*&quot;&nbsp;are&nbsp;inserted&nbsp;inline&nbsp;at&nbsp;compile&nbsp;time.<br>
So&nbsp;are&nbsp;dynamic&nbsp;casts&nbsp;of&nbsp;null&nbsp;pointers&nbsp;and&nbsp;dynamic&nbsp;casts&nbsp;that&nbsp;are&nbsp;really<br>
static.<br>
<br>
&lt;p&gt;<br>
This&nbsp;leaves&nbsp;the&nbsp;following&nbsp;test&nbsp;to&nbsp;be&nbsp;implemented&nbsp;in&nbsp;the&nbsp;run-time<br>
library&nbsp;for&nbsp;truly&nbsp;dynamic&nbsp;casts&nbsp;of&nbsp;the&nbsp;form&nbsp;&quot;dynamic_cast&lt;T&gt;(v)&quot;:<br>
(see&nbsp;[expr.dynamic_cast]&nbsp;5.2.7/8)<br>
<br>
&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
If,&nbsp;in&nbsp;the&nbsp;most&nbsp;derived&nbsp;object&nbsp;pointed&nbsp;(referred)&nbsp;to&nbsp;by&nbsp;v,&nbsp;v&nbsp;points<br>
(refers)&nbsp;to&nbsp;a&nbsp;public&nbsp;base&nbsp;class&nbsp;sub-object&nbsp;of&nbsp;a&nbsp;T&nbsp;object<br>
[note:&nbsp;this&nbsp;can&nbsp;be&nbsp;checked&nbsp;at&nbsp;compile&nbsp;time],<br>
and&nbsp;if&nbsp;only&nbsp;one&nbsp;object&nbsp;of&nbsp;type&nbsp;T&nbsp;is&nbsp;derived<br>
from&nbsp;the&nbsp;sub-object&nbsp;pointed&nbsp;(referred)&nbsp;to&nbsp;by&nbsp;v,<br>
the&nbsp;result&nbsp;is&nbsp;a&nbsp;pointer&nbsp;(an&nbsp;lvalue&nbsp;referring)&nbsp;to&nbsp;that&nbsp;T&nbsp;object.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
Otherwise,&nbsp;if&nbsp;v&nbsp;points&nbsp;(refers)&nbsp;to&nbsp;a&nbsp;public&nbsp;base&nbsp;class&nbsp;sub-object<br>
of&nbsp;the&nbsp;most&nbsp;derived&nbsp;object,<br>
and&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;most&nbsp;derived&nbsp;object&nbsp;has&nbsp;an<br>
unambiguous&nbsp;public&nbsp;base&nbsp;class&nbsp;of&nbsp;type&nbsp;T,<br>
the&nbsp;result&nbsp;is&nbsp;a&nbsp;pointer<br>
(an&nbsp;lvalue&nbsp;referring)<br>
to&nbsp;the&nbsp;T&nbsp;sub-object&nbsp;of&nbsp;the&nbsp;most&nbsp;derived&nbsp;object.&nbsp;<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
Otherwise,&nbsp;the&nbsp;run-time&nbsp;check&nbsp;fails.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;first&nbsp;check&nbsp;corresponds&nbsp;to&nbsp;a&nbsp;&quot;base-to-derived&nbsp;cast&quot;&nbsp;and&nbsp;the&nbsp;second<br>
to&nbsp;a&nbsp;&quot;cross&nbsp;cast&quot;.<br>
These&nbsp;tests&nbsp;are&nbsp;implemented&nbsp;by&nbsp;abi::__dynamic_cast:<br>
<br>
&lt;pre&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&nbsp;extern&nbsp;&quot;C&quot;&nbsp;&nbsp;&nbsp;&nbsp;void*&nbsp;__dynamic_cast&nbsp;(&nbsp;const&nbsp;void&nbsp;*sub,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;abi::__class_type_info&nbsp;*src,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;abi::__class_type_info&nbsp;*dst,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::ptrdiff_t&nbsp;src2dst_offset);<br>
&nbsp;&nbsp;&nbsp;/*&nbsp;sub:&nbsp;source&nbsp;address&nbsp;to&nbsp;be&nbsp;adjusted;&nbsp;nonnull,&nbsp;and&nbsp;since&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;object&nbsp;is&nbsp;polymorphic,&nbsp;*(void**)sub&nbsp;is&nbsp;a&nbsp;virtual<br>
&nbsp;&nbsp;&nbsp;&nbsp;pointer.<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;src:&nbsp;static&nbsp;type&nbsp;of&nbsp;the&nbsp;source&nbsp;object.<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;dst:&nbsp;destination&nbsp;type&nbsp;(the&nbsp;&quot;T&quot;&nbsp;in&nbsp;&quot;dynamic_cast&lt;T&gt;(v)&quot;).<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;src2dst_offset:&nbsp;a&nbsp;static&nbsp;hint&nbsp;about&nbsp;the&nbsp;location&nbsp;of&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;subobject&nbsp;with&nbsp;respect&nbsp;to&nbsp;the&nbsp;complete&nbsp;object;<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;special&nbsp;negative&nbsp;values&nbsp;are:<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1:&nbsp;no&nbsp;hint<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2:&nbsp;src&nbsp;is&nbsp;not&nbsp;a&nbsp;public&nbsp;base&nbsp;of&nbsp;dst<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-3:&nbsp;src&nbsp;is&nbsp;a&nbsp;multiple&nbsp;public&nbsp;base&nbsp;type&nbsp;but&nbsp;never&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;base&nbsp;type<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;otherwise,&nbsp;the&nbsp;src&nbsp;type&nbsp;is&nbsp;a&nbsp;unique&nbsp;public&nbsp;nonvirtual<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;type&nbsp;of&nbsp;dst&nbsp;at&nbsp;offset&nbsp;src2dst_offset&nbsp;from&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;origin&nbsp;of&nbsp;dst.<br>
&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
Rationale:&nbsp;&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;A&nbsp;simple&nbsp;dynamic_cast&nbsp;algorithm&nbsp;that&nbsp;is&nbsp;efficient&nbsp;in&nbsp;the&nbsp;common<br>
&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;of&nbsp;base-to-most-derived&nbsp;cast&nbsp;case&nbsp;is&nbsp;preferable&nbsp;to&nbsp;more<br>
&nbsp;&nbsp;&nbsp;&nbsp;sophisticated&nbsp;ideas&nbsp;that&nbsp;handle&nbsp;deep-base-to-in-between-derived<br>
&nbsp;&nbsp;&nbsp;&nbsp;casts&nbsp;more&nbsp;efficiently&nbsp;at&nbsp;a&nbsp;slight&nbsp;cost&nbsp;to&nbsp;the&nbsp;common&nbsp;case.<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hence,&nbsp;an&nbsp;earlier&nbsp;scheme&nbsp;of&nbsp;providing&nbsp;a&nbsp;hash-table&nbsp;into&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;list&nbsp;of&nbsp;base&nbsp;classes<br>
&nbsp;&nbsp;&nbsp;&nbsp;(as&nbsp;is&nbsp;done&nbsp;e.g.&nbsp;in&nbsp;the&nbsp;HP&nbsp;aC++&nbsp;compiler)<br>
&nbsp;&nbsp;&nbsp;&nbsp;was&nbsp;dropped.<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;For&nbsp;similar&nbsp;reasons,<br>
&nbsp;&nbsp;&nbsp;&nbsp;we&nbsp;only&nbsp;keep&nbsp;direct&nbsp;base&nbsp;information&nbsp;about&nbsp;a&nbsp;class&nbsp;type.<br>
&nbsp;&nbsp;&nbsp;&nbsp;Indirect&nbsp;base&nbsp;information&nbsp;can&nbsp;be&nbsp;found&nbsp;by&nbsp;chasing&nbsp;type_info&nbsp;pointers<br>
&nbsp;&nbsp;&nbsp;&nbsp;(and&nbsp;care&nbsp;should&nbsp;be&nbsp;taken&nbsp;to&nbsp;determine&nbsp;ambiguous&nbsp;base&nbsp;class&nbsp;types).<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;The&nbsp;GNU&nbsp;egcs&nbsp;development&nbsp;team&nbsp;has&nbsp;implemented&nbsp;an&nbsp;idea&nbsp;of&nbsp;this&nbsp;ABI<br>
&nbsp;&nbsp;&nbsp;&nbsp;group&nbsp;to&nbsp;accelerate&nbsp;dynamic_cast&nbsp;operations&nbsp;by&nbsp;a-posteriori<br>
&nbsp;&nbsp;&nbsp;&nbsp;checking&nbsp;a&nbsp;&quot;likely&nbsp;outcome&quot;.<br>
&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;is&nbsp;the&nbsp;purpose&nbsp;of&nbsp;the&nbsp;src2dst_offset&nbsp;hint.<br>
&nbsp;&nbsp;&nbsp;&nbsp;An&nbsp;implementation&nbsp;is&nbsp;free&nbsp;to&nbsp;always&nbsp;pass&nbsp;-1&nbsp;(no&nbsp;hint),<br>
&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;to&nbsp;always&nbsp;ignore&nbsp;the&nbsp;hint&nbsp;in&nbsp;__dynamic_cast.<br>
&lt;/ul&gt;<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;2.9.8&nbsp;The&nbsp;Exception&nbsp;Handler&nbsp;Matching&nbsp;Algorithm&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
Since&nbsp;the&nbsp;RTTI&nbsp;related&nbsp;exception&nbsp;handling&nbsp;routines&nbsp;are&nbsp;&quot;personality&nbsp;specific&quot;,<br>
no&nbsp;interfaces&nbsp;need&nbsp;to&nbsp;be&nbsp;specified&nbsp;in&nbsp;this&nbsp;document<br>
(beyond&nbsp;the&nbsp;layout&nbsp;of&nbsp;the&nbsp;RTTI&nbsp;data).<br>
<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=calls&gt;<br>
&lt;h2&gt;&nbsp;Chapter&nbsp;3:&nbsp;Function&nbsp;Calling&nbsp;Conventions&nbsp;and&nbsp;APIs&nbsp;&lt;/h2&gt;<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
<br>
&lt;p&gt;<br>
In&nbsp;general,&nbsp;the&nbsp;calling&nbsp;conventions&nbsp;for&nbsp;C++&nbsp;in&nbsp;this&nbsp;ABI<br>
follow&nbsp;those&nbsp;specified&nbsp;by&nbsp;the&nbsp;underlying&nbsp;processor-specific&nbsp;ABI&nbsp;for&nbsp;C,<br>
whenever&nbsp;there&nbsp;is&nbsp;an&nbsp;analogous&nbsp;construct&nbsp;in&nbsp;C.<br>
This&nbsp;chapter&nbsp;specifies&nbsp;exceptions&nbsp;required&nbsp;by&nbsp;C++-specific&nbsp;semantics,<br>
or&nbsp;by&nbsp;features&nbsp;without&nbsp;analogues&nbsp;in&nbsp;C.<br>
It&nbsp;also&nbsp;specifies&nbsp;the&nbsp;APIs&nbsp;of&nbsp;a&nbsp;variety&nbsp;of&nbsp;runtime&nbsp;utility&nbsp;routines<br>
required&nbsp;to&nbsp;be&nbsp;part&nbsp;of&nbsp;the&nbsp;support&nbsp;library&nbsp;of&nbsp;an&nbsp;ABI-conforming<br>
implementation&nbsp;for&nbsp;use&nbsp;by&nbsp;compiled&nbsp;code.<br>
In&nbsp;addition,&nbsp;reference&nbsp;is&nbsp;made&nbsp;to&nbsp;the&nbsp;separate&nbsp;description&nbsp;of<br>
&lt;a&nbsp;href=abi-eh.html&gt;exception&nbsp;handling&lt;/a&gt;&nbsp;in&nbsp;this&nbsp;ABI,<br>
which&nbsp;defines&nbsp;a&nbsp;large&nbsp;number&nbsp;of&nbsp;runtime&nbsp;utility&nbsp;routine&nbsp;APIs.<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=normal-call&gt;<br>
&lt;h3&gt;&nbsp;3.1&nbsp;Non-Virtual&nbsp;Function&nbsp;Calling&nbsp;Conventions&nbsp;&lt;/h3&gt;<br>
&lt;/a&gt;<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;3.1.1&nbsp;Value&nbsp;Parameters&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
In&nbsp;general,&nbsp;C++&nbsp;value&nbsp;parameters&nbsp;are&nbsp;handled&nbsp;just&nbsp;like&nbsp;C&nbsp;parameters.<br>
This&nbsp;includes&nbsp;class&nbsp;type&nbsp;parameters&nbsp;passed&nbsp;wholly&nbsp;or&nbsp;partially&nbsp;in&nbsp;registers.<br>
However,&nbsp;in&nbsp;the&nbsp;special&nbsp;case&nbsp;where&nbsp;the&nbsp;parameter&nbsp;type&nbsp;has&nbsp;a&nbsp;non-trivial<br>
copy&nbsp;constructor&nbsp;or&nbsp;destructor,<br>
the&nbsp;caller&nbsp;must&nbsp;allocate&nbsp;space&nbsp;for&nbsp;a&nbsp;temporary&nbsp;copy,<br>
and&nbsp;pass&nbsp;the&nbsp;resulting&nbsp;copy&nbsp;by&nbsp;reference&nbsp;(below).<br>
Specifically,<br>
<br>
&lt;ul&gt;<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
Space&nbsp;is&nbsp;allocated&nbsp;by&nbsp;the&nbsp;caller&nbsp;for&nbsp;the&nbsp;temporary.<br>
If&nbsp;there&nbsp;is&nbsp;no&nbsp;non-trivial&nbsp;copy&nbsp;constructor<br>
or&nbsp;destructor,<br>
it&nbsp;is&nbsp;in&nbsp;the&nbsp;normal&nbsp;parameter-passing&nbsp;space,<br>
i.e.&nbsp;in&nbsp;the&nbsp;parameter&nbsp;registers&nbsp;or&nbsp;on&nbsp;the&nbsp;stack,<br>
and&nbsp;the&nbsp;constructor&nbsp;is&nbsp;called&nbsp;if&nbsp;necessary.<br>
Otherwise,&nbsp;it&nbsp;is&nbsp;allocated&nbsp;on&nbsp;the&nbsp;stack&nbsp;or&nbsp;heap.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
The&nbsp;caller&nbsp;constructs&nbsp;the&nbsp;parameter&nbsp;in&nbsp;the&nbsp;space&nbsp;allocated,<br>
using&nbsp;a&nbsp;simple&nbsp;copy&nbsp;to&nbsp;the&nbsp;parameter&nbsp;space<br>
(parameter&nbsp;registers&nbsp;or&nbsp;stack)<br>
if&nbsp;there&nbsp;is&nbsp;no&nbsp;non-trivial&nbsp;copy&nbsp;constructor<br>
or&nbsp;destructor.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
The&nbsp;function&nbsp;is&nbsp;called,<br>
passing&nbsp;the&nbsp;parameter&nbsp;value<br>
(if&nbsp;there&nbsp;is&nbsp;no&nbsp;non-trivial<br>
copy&nbsp;constructor&nbsp;or&nbsp;destructor),<br>
or&nbsp;its&nbsp;address&nbsp;(if&nbsp;there&nbsp;is&nbsp;one).<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
The&nbsp;caller&nbsp;calls&nbsp;any&nbsp;non-trivial&nbsp;destructor<br>
for&nbsp;the&nbsp;parameter&nbsp;after&nbsp;returning<br>
(at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;containing&nbsp;expression).<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
If&nbsp;necessary&nbsp;(e.g.&nbsp;if&nbsp;the&nbsp;parameter&nbsp;was&nbsp;allocated&nbsp;on&nbsp;the&nbsp;heap),<br>
the&nbsp;caller&nbsp;deallocates&nbsp;space&nbsp;after&nbsp;return&nbsp;and&nbsp;destruction.<br>
<br>
&lt;/ul&gt;<br>
<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;3.1.2&nbsp;Reference&nbsp;Parameters&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
Reference&nbsp;parameters&nbsp;are&nbsp;handled&nbsp;by&nbsp;passing&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;actual<br>
parameter.<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;3.1.3&nbsp;Empty&nbsp;Parameters&nbsp;&lt;/h4&gt;<br>
<br>
&lt;div&nbsp;class=&quot;change&quot;&gt;<br>
&lt;p&gt;<br>
&lt;strike&gt;<br>
A&nbsp;parameter&nbsp;of&nbsp;an&nbsp;empty&nbsp;class&nbsp;type&nbsp;will&nbsp;normally&nbsp;occupy&nbsp;a&nbsp;position<br>
in&nbsp;the&nbsp;parameter&nbsp;sequence&nbsp;as&nbsp;though&nbsp;it&nbsp;were&nbsp;a&nbsp;single-byte&nbsp;integer.<br>
There&nbsp;is&nbsp;one&nbsp;exception:<br>
&lt;/p&gt;<br>
&lt;ul&gt;<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
If&nbsp;the&nbsp;type&nbsp;has&nbsp;a&nbsp;non-trivial&nbsp;copy&nbsp;constructor,<br>
it&nbsp;must&nbsp;be&nbsp;passed&nbsp;by&nbsp;reference&nbsp;as&nbsp;described&nbsp;in&nbsp;Section&nbsp;3.1.1&nbsp;above.<br>
<br>
&lt;/ul&gt;<br>
&lt;/strike&gt;<br>
<br>
&lt;p&gt;<br>
Empty&nbsp;classes&nbsp;will&nbsp;be&nbsp;passed&nbsp;no&nbsp;differently&nbsp;from&nbsp;ordinary&nbsp;classes.&nbsp;&nbsp;If<br>
passed&nbsp;in&nbsp;registers&nbsp;the&nbsp;NaT&nbsp;bit&nbsp;must&nbsp;not&nbsp;be&nbsp;set&nbsp;on&nbsp;all&nbsp;registers&nbsp;that<br>
make&nbsp;up&nbsp;the&nbsp;class.<br>
&lt;/p&gt;<br>
&lt;/div&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;contents&nbsp;of&nbsp;the&nbsp;single&nbsp;byte&nbsp;parameter&nbsp;slot&nbsp;are&nbsp;unspecified,<br>
and&nbsp;the&nbsp;callee&nbsp;may&nbsp;not&nbsp;depend&nbsp;on&nbsp;any&nbsp;particular&nbsp;value.<br>
On&nbsp;Itanium,&nbsp;the&nbsp;associated&nbsp;NaT&nbsp;bit&nbsp;must&nbsp;not&nbsp;be&nbsp;set<br>
if&nbsp;the&nbsp;parameter&nbsp;slot&nbsp;is&nbsp;associated&nbsp;with&nbsp;a&nbsp;register.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;3.1.4&nbsp;Return&nbsp;Values&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
In&nbsp;general,&nbsp;C++&nbsp;return&nbsp;values&nbsp;are&nbsp;handled&nbsp;just&nbsp;like&nbsp;C&nbsp;return&nbsp;values.<br>
This&nbsp;includes&nbsp;class&nbsp;type&nbsp;results&nbsp;returned&nbsp;in&nbsp;registers.<br>
However,&nbsp;if&nbsp;the&nbsp;return&nbsp;value&nbsp;type&nbsp;has&nbsp;a&nbsp;non-trivial&nbsp;copy&nbsp;constructor<br>
or&nbsp;destructor,<br>
the&nbsp;caller&nbsp;allocates&nbsp;space&nbsp;for&nbsp;a&nbsp;temporary,<br>
and&nbsp;passes&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;temporary&nbsp;as&nbsp;an&nbsp;implicit<br>
first&nbsp;parameter<br>
preceding&nbsp;both&nbsp;the&nbsp;&lt;code&gt;this&lt;/code&gt;&nbsp;parameter&nbsp;and&nbsp;user&nbsp;parameters.<br>
The&nbsp;callee&nbsp;constructs&nbsp;the&nbsp;return&nbsp;value&nbsp;into&nbsp;this&nbsp;temporary.<br>
On&nbsp;Itanium,&nbsp;the&nbsp;pointer&nbsp;is&nbsp;passed&nbsp;in&nbsp;&lt;code&gt;out0&lt;/code&gt;,<br>
different&nbsp;from&nbsp;other&nbsp;large&nbsp;class&nbsp;result&nbsp;buffer&nbsp;pointers,<br>
passed&nbsp;in&nbsp;&lt;code&gt;r8&lt;/code&gt;.<br>
<br>
&lt;p&gt;<br>
A&nbsp;result&nbsp;of&nbsp;an&nbsp;empty&nbsp;class&nbsp;type&nbsp;will&nbsp;be&nbsp;returned&nbsp;as&nbsp;though&nbsp;it&nbsp;were<br>
a&nbsp;struct&nbsp;containing&nbsp;a&nbsp;single&nbsp;char,<br>
i.e.&nbsp;&lt;code&gt;struct&nbsp;S&nbsp;{&nbsp;char&nbsp;c;&nbsp;};&lt;/code&gt;.<br>
The&nbsp;actual&nbsp;content&nbsp;of&nbsp;the&nbsp;return&nbsp;register&nbsp;is&nbsp;unspecified.<br>
On&nbsp;Itanium,&nbsp;the&nbsp;associated&nbsp;NaT&nbsp;bit&nbsp;must&nbsp;not&nbsp;be&nbsp;set.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;3.1.5&nbsp;Constructor&nbsp;Return&nbsp;Values&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
Constructors&nbsp;return&nbsp;&lt;code&gt;void&lt;/code&gt;&nbsp;results.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=vcall&gt;<br>
&lt;h3&gt;&nbsp;3.2&nbsp;Virtual&nbsp;Function&nbsp;Calling&nbsp;Conventions&nbsp;&lt;/h3&gt;<br>
&lt;/a&gt;<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;3.2.1&nbsp;Foundation&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
This&nbsp;section&nbsp;sketches&nbsp;the&nbsp;calling&nbsp;convention&nbsp;for&nbsp;virtual&nbsp;functions,<br>
based&nbsp;on&nbsp;the&nbsp;above&nbsp;virtual&nbsp;table&nbsp;layout.<br>
&lt;i&gt;See&nbsp;also&nbsp;the&nbsp;&lt;a&nbsp;href=abi-examples.html#vcall&gt;ABI&nbsp;examples&lt;/a&gt;<br>
document&nbsp;for&nbsp;motivating&nbsp;examples&nbsp;and&nbsp;potential&nbsp;implementations.&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
We&nbsp;explain,&nbsp;at&nbsp;a&nbsp;high&nbsp;level,<br>
what&nbsp;information&nbsp;must&nbsp;be&nbsp;present&nbsp;in&nbsp;the&nbsp;virtual&nbsp;table&nbsp;for&nbsp;a&nbsp;class&nbsp;A<br>
which&nbsp;declares&nbsp;a&nbsp;virtual&nbsp;function&nbsp;f&nbsp;in&nbsp;order&nbsp;that,<br>
given&nbsp;an&nbsp;pointer&nbsp;of&nbsp;type&nbsp;A*,<br>
the&nbsp;caller&nbsp;can&nbsp;call&nbsp;the&nbsp;virtual&nbsp;function&nbsp;f.<br>
This&nbsp;section&nbsp;does&nbsp;not&nbsp;specify&nbsp;exactly&nbsp;where&nbsp;that&nbsp;information&nbsp;is&nbsp;located<br>
(see&nbsp;above),<br>
nor&nbsp;does&nbsp;it&nbsp;specify&nbsp;how&nbsp;to&nbsp;convert&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;class<br>
derived&nbsp;from&nbsp;A&nbsp;to&nbsp;an&nbsp;A*,<br>
if&nbsp;that&nbsp;is&nbsp;required.<br>
<br>
&lt;p&gt;<br>
When&nbsp;this&nbsp;section&nbsp;uses&nbsp;the&nbsp;term&nbsp;&lt;i&gt;function&nbsp;pointer&lt;/i&gt;&nbsp;it&nbsp;is&nbsp;understood<br>
that&nbsp;this&nbsp;term&nbsp;may&nbsp;refer&nbsp;either&nbsp;to&nbsp;a&nbsp;traditional&nbsp;function&nbsp;pointer<br>
(i.e.,&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;GP/address&nbsp;pair)&nbsp;or&nbsp;a&nbsp;GP/address&nbsp;pair&nbsp;itself.<br>
Which&nbsp;of&nbsp;these&nbsp;alternatives&nbsp;is&nbsp;actually&nbsp;used<br>
is&nbsp;specified&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;ABI,<br>
but&nbsp;is&nbsp;independent&nbsp;of&nbsp;the&nbsp;description&nbsp;in&nbsp;this&nbsp;section.<br>
<br>
&lt;p&gt;<br>
Throughout&nbsp;this&nbsp;section,<br>
we&nbsp;assume&nbsp;that&nbsp;A&nbsp;is&nbsp;the&nbsp;class&nbsp;for&nbsp;which&nbsp;we&nbsp;are&nbsp;creating&nbsp;a&nbsp;virtual&nbsp;table,<br>
B&nbsp;is&nbsp;the&nbsp;most&nbsp;derived&nbsp;class&nbsp;in&nbsp;the&nbsp;hierarchy,<br>
and&nbsp;C&nbsp;is&nbsp;the&nbsp;class&nbsp;that&nbsp;contains&nbsp;C::f,<br>
the&nbsp;unique&nbsp;final&nbsp;overrider&nbsp;for&nbsp;A::f.<br>
This&nbsp;section&nbsp;specifies&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;f&nbsp;entry&nbsp;in&nbsp;the&nbsp;A-in-B&nbsp;virtual<br>
table.<br>
(If&nbsp;A&nbsp;is&nbsp;primary&nbsp;base&nbsp;in&nbsp;the&nbsp;hierarchy,<br>
then&nbsp;the&nbsp;A-in-B&nbsp;virtual&nbsp;table&nbsp;will&nbsp;be&nbsp;shared<br>
with&nbsp;the&nbsp;derived&nbsp;class&nbsp;virtual&nbsp;table&nbsp;--<br>
but&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;A&nbsp;portion&nbsp;of&nbsp;that&nbsp;virtual&nbsp;table<br>
will&nbsp;still&nbsp;be&nbsp;as&nbsp;specified&nbsp;here.)<br>
<br>
&lt;p&gt;<br>
In&nbsp;all&nbsp;cases,&nbsp;the&nbsp;&lt;i&gt;non-adjusting&nbsp;entry&nbsp;point&lt;/i&gt;&nbsp;for&nbsp;a&nbsp;virtual<br>
function&nbsp;expects&nbsp;the&nbsp;`this'&nbsp;pointer&nbsp;to&nbsp;point&nbsp;to&nbsp;an&nbsp;instance&nbsp;of&nbsp;the<br>
class&nbsp;in&nbsp;which&nbsp;the&nbsp;virtual&nbsp;function&nbsp;is&nbsp;defined.<br>
In&nbsp;other&nbsp;words,&nbsp;the&nbsp;non-adjusting&nbsp;entry&nbsp;point&nbsp;for&nbsp;C::f&nbsp;will&nbsp;expect<br>
that&nbsp;its&nbsp;`this'&nbsp;pointer&nbsp;points&nbsp;to&nbsp;a&nbsp;C&nbsp;object.<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;3.2.2&nbsp;Virtual&nbsp;Table&nbsp;Components&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
For&nbsp;each&nbsp;virtual&nbsp;function&nbsp;declared&nbsp;in&nbsp;a&nbsp;class&nbsp;C,<br>
we&nbsp;add&nbsp;an&nbsp;entry&nbsp;to&nbsp;its&nbsp;virtual&nbsp;table&nbsp;if&nbsp;one&nbsp;is&nbsp;not&nbsp;already&nbsp;there<br>
(i.e.&nbsp;if&nbsp;it&nbsp;is&nbsp;not&nbsp;overriding&nbsp;a&nbsp;function&nbsp;in&nbsp;its&nbsp;primary&nbsp;base).<br>
In&nbsp;particular,&nbsp;a&nbsp;declaration&nbsp;which&nbsp;overrides&nbsp;a&nbsp;function&nbsp;inherited&nbsp;from<br>
a&nbsp;secondary&nbsp;base&nbsp;gets&nbsp;a&nbsp;new&nbsp;slot&nbsp;in&nbsp;the&nbsp;primary&nbsp;virtual&nbsp;table.<br>
We&nbsp;do&nbsp;this&nbsp;to&nbsp;avoid&nbsp;useless&nbsp;adjustments&nbsp;when&nbsp;calling&nbsp;a&nbsp;virtual<br>
function&nbsp;through&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;most&nbsp;derived&nbsp;class.<br>
<br>
&lt;p&gt;<br>
The&nbsp;content&nbsp;of&nbsp;this&nbsp;entry&nbsp;for&nbsp;class&nbsp;A&nbsp;is&nbsp;a&nbsp;function&nbsp;pointer,<br>
as&nbsp;determined&nbsp;by&nbsp;one&nbsp;of&nbsp;the&nbsp;following&nbsp;cases.<br>
Recall&nbsp;that&nbsp;we&nbsp;are&nbsp;dealing&nbsp;with&nbsp;a&nbsp;hierarchy&nbsp;where&nbsp;B&nbsp;is&nbsp;most&nbsp;derived,<br>
A&nbsp;is&nbsp;a&nbsp;direct&nbsp;(or&nbsp;indirect)&nbsp;base&nbsp;of&nbsp;B&nbsp;defining&nbsp;f,<br>
and&nbsp;C&nbsp;contains&nbsp;the&nbsp;unique&nbsp;final&nbsp;overrider&nbsp;C::f&nbsp;of&nbsp;A::f.<br>
<br>
&lt;ol&nbsp;type=1&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;A&nbsp;=&nbsp;C<br>
&lt;p&gt;<br>
(In&nbsp;this&nbsp;case,&nbsp;we&nbsp;are&nbsp;creating&nbsp;either&nbsp;the&nbsp;primary&nbsp;virtual&nbsp;table&nbsp;for&nbsp;A,<br>
or&nbsp;the&nbsp;A-in-B&nbsp;secondary&nbsp;virtual&nbsp;table.)<br>
&lt;p&gt;<br>
The&nbsp;virtual&nbsp;table&nbsp;contains&nbsp;a&nbsp;function&nbsp;pointer&nbsp;pointing&nbsp;to&nbsp;the<br>
non-adjusting&nbsp;entry&nbsp;point&nbsp;for&nbsp;A::f.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;A&nbsp;!=&nbsp;C<br>
&lt;p&gt;<br>
In&nbsp;this&nbsp;case,&nbsp;we&nbsp;are&nbsp;creating&nbsp;the&nbsp;A-in-B&nbsp;secondary&nbsp;virtual&nbsp;table.<br>
&lt;p&gt;<br>
The&nbsp;virtual&nbsp;table&nbsp;contains&nbsp;a&nbsp;pointer&nbsp;to&nbsp;an&nbsp;entry&nbsp;point&nbsp;that&nbsp;performs&nbsp;the<br>
adjustment&nbsp;from&nbsp;an&nbsp;A*&nbsp;to&nbsp;a&nbsp;C*,<br>
and&nbsp;then&nbsp;transfers&nbsp;control&nbsp;to&nbsp;the&nbsp;non-adjusting&nbsp;entry&nbsp;point&nbsp;for&nbsp;C::f.<br>
&lt;/ol&gt;<br>
<br>
&lt;p&gt;<br>
When&nbsp;a&nbsp;class&nbsp;is&nbsp;used&nbsp;as&nbsp;a&nbsp;virtual&nbsp;base,<br>
we&nbsp;add&nbsp;a&nbsp;vcall&nbsp;offset&nbsp;slot&nbsp;to&nbsp;the&nbsp;beginning&nbsp;of&nbsp;its&nbsp;virtual&nbsp;table&nbsp;for&nbsp;each&nbsp;of<br>
the&nbsp;virtual&nbsp;functions&nbsp;it&nbsp;provides,<br>
whether&nbsp;in&nbsp;its&nbsp;primary&nbsp;or&nbsp;secondary&nbsp;virtual&nbsp;tables.<br>
Derived&nbsp;classes&nbsp;which&nbsp;override&nbsp;these&nbsp;functions&nbsp;may&nbsp;use&nbsp;the&nbsp;slots&nbsp;to<br>
determine&nbsp;the&nbsp;adjustment&nbsp;necessary.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;3.2.3&nbsp;Callee&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
For&nbsp;each&nbsp;direct&nbsp;or&nbsp;indirect&nbsp;base&nbsp;A&nbsp;of&nbsp;C&nbsp;that&nbsp;is&nbsp;not&nbsp;a&nbsp;morally&nbsp;virtual<br>
base&nbsp;of&nbsp;C,<br>
the&nbsp;compiler&nbsp;must&nbsp;emit,&nbsp;in&nbsp;the&nbsp;same&nbsp;object&nbsp;file&nbsp;as&nbsp;the&nbsp;code&nbsp;for&nbsp;C::f,<br>
an&nbsp;&lt;i&gt;A-adjusting&nbsp;entry&nbsp;point&lt;/i&gt;&nbsp;for&nbsp;C::f.<br>
This&nbsp;entry&nbsp;point&nbsp;will&nbsp;expect&nbsp;that&nbsp;its&nbsp;&lt;code&gt;this&lt;/code&gt;&nbsp;pointer<br>
points&nbsp;to&nbsp;an&nbsp;A*,<br>
and&nbsp;will&nbsp;convert&nbsp;it&nbsp;to&nbsp;a&nbsp;C*<br>
(which&nbsp;merely&nbsp;requires&nbsp;adding&nbsp;a&nbsp;constant&nbsp;offset)<br>
before&nbsp;transferring&nbsp;control&nbsp;to&nbsp;the&nbsp;non-adjusting&nbsp;entry&nbsp;point&nbsp;for&nbsp;C::f.<br>
<br>
&lt;p&gt;<br>
For&nbsp;each&nbsp;direct&nbsp;or&nbsp;indirect&nbsp;virtual&nbsp;base&nbsp;V&nbsp;of&nbsp;C&nbsp;such&nbsp;that&nbsp;either&nbsp;V&nbsp;declares&nbsp;f,<br>
or&nbsp;is&nbsp;derived&nbsp;from&nbsp;a&nbsp;class&nbsp;that&nbsp;declares&nbsp;f,<br>
the&nbsp;compiler&nbsp;must&nbsp;emit,&nbsp;in&nbsp;the&nbsp;same&nbsp;object&nbsp;file&nbsp;as&nbsp;the&nbsp;code&nbsp;for&nbsp;C::f,<br>
a&nbsp;&lt;i&gt;V-adjusting&nbsp;entry&nbsp;point&lt;/i&gt;&nbsp;for&nbsp;C::f.<br>
This&nbsp;entry&nbsp;point&nbsp;will&nbsp;expect&nbsp;that&nbsp;its&nbsp;&lt;code&gt;this&lt;/code&gt;&nbsp;pointer<br>
points&nbsp;to&nbsp;the&nbsp;unique&nbsp;virtual&nbsp;V&nbsp;subobject&nbsp;of&nbsp;C.<br>
(Note&nbsp;that&nbsp;there&nbsp;may&nbsp;in&nbsp;general&nbsp;be&nbsp;multiple&nbsp;V&nbsp;subobjects&nbsp;of&nbsp;C,<br>
but&nbsp;that&nbsp;only&nbsp;one&nbsp;of&nbsp;them&nbsp;will&nbsp;be&nbsp;virtual.)<br>
This&nbsp;entry&nbsp;point&nbsp;must&nbsp;load&nbsp;the&nbsp;vcall&nbsp;offset&nbsp;corresponding&nbsp;to&nbsp;f&nbsp;located<br>
in&nbsp;the&nbsp;virtual&nbsp;table&nbsp;for&nbsp;V&nbsp;obtained&nbsp;via&nbsp;its&nbsp;&lt;code&gt;this&lt;/code&gt;&nbsp;pointer,<br>
extract&nbsp;the&nbsp;vcall&nbsp;offset&nbsp;corresponding&nbsp;to&nbsp;f&nbsp;located&nbsp;in&nbsp;that&nbsp;virtual&nbsp;table,<br>
and&nbsp;add&nbsp;this&nbsp;offset&nbsp;to&nbsp;the&nbsp;&lt;code&gt;this&lt;/code&gt;&nbsp;pointer.<br>
(Note&nbsp;that,&nbsp;as&nbsp;specified&nbsp;in&nbsp;the&nbsp;data&nbsp;layout&nbsp;document,<br>
when&nbsp;V&nbsp;is&nbsp;used&nbsp;as&nbsp;a&nbsp;virtual&nbsp;base,<br>
its&nbsp;virtual&nbsp;table&nbsp;contains&nbsp;vcall&nbsp;offsets&nbsp;for&nbsp;every&nbsp;virtual&nbsp;function<br>
declared&nbsp;in&nbsp;V&nbsp;or&nbsp;any&nbsp;of&nbsp;its&nbsp;bases.)<br>
Then,<br>
this&nbsp;entry&nbsp;point&nbsp;must&nbsp;transfer&nbsp;control&nbsp;to&nbsp;the&nbsp;non-adjusting&nbsp;entry&nbsp;point.<br>
<br>
&lt;a&nbsp;name=morally-virtual&gt;<br>
&lt;p&gt;<br>
For&nbsp;each&nbsp;morally&nbsp;virtual&nbsp;base&nbsp;M&nbsp;of&nbsp;C<br>
such&nbsp;that&nbsp;M&nbsp;is&nbsp;&lt;i&gt;&lt;b&gt;not&lt;/b&gt;&lt;/i&gt;&nbsp;a&nbsp;virtual&nbsp;base<br>
(and&nbsp;therefore&nbsp;must&nbsp;be&nbsp;a&nbsp;subobject&nbsp;of&nbsp;a&nbsp;virtual&nbsp;base&nbsp;V),<br>
and&nbsp;such&nbsp;that&nbsp;M&nbsp;declares&nbsp;f,<br>
the&nbsp;compiler&nbsp;must&nbsp;emit,<br>
in&nbsp;the&nbsp;same&nbsp;object&nbsp;file&nbsp;as&nbsp;the&nbsp;code&nbsp;for&nbsp;C::f,<br>
an&nbsp;&lt;i&gt;M-adjusting&nbsp;entry&nbsp;point&lt;/i&gt;&nbsp;for&nbsp;C::f.<br>
This&nbsp;entry&nbsp;point&nbsp;will&nbsp;expect&nbsp;that&nbsp;its&nbsp;&lt;code&gt;this&lt;/code&gt;&nbsp;pointer<br>
points&nbsp;to&nbsp;an&nbsp;M*,<br>
and&nbsp;will&nbsp;convert&nbsp;it&nbsp;to&nbsp;a&nbsp;V*&nbsp;(a&nbsp;fixed&nbsp;offset),<br>
where&nbsp;V&nbsp;is&nbsp;the&nbsp;nearest&nbsp;virtual&nbsp;base&nbsp;to&nbsp;M<br>
along&nbsp;the&nbsp;inheritance&nbsp;path&nbsp;from&nbsp;C&nbsp;to&nbsp;M.<br>
Then,&nbsp;it&nbsp;will&nbsp;convert&nbsp;the&nbsp;V*&nbsp;to&nbsp;a&nbsp;C*&nbsp;by&nbsp;using&nbsp;the&nbsp;vcall&nbsp;offset<br>
stored&nbsp;in&nbsp;the&nbsp;V's&nbsp;virtual&nbsp;table.<br>
(Note&nbsp;that&nbsp;one&nbsp;implementation&nbsp;of&nbsp;the&nbsp;M-adjusting&nbsp;entry&nbsp;point<br>
is&nbsp;to&nbsp;convert&nbsp;from&nbsp;M*&nbsp;to&nbsp;V*<br>
and&nbsp;then&nbsp;transfer&nbsp;control&nbsp;to&nbsp;the&nbsp;V-adjusting&nbsp;entry&nbsp;point.)<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;3.2.4&nbsp;Caller&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
When&nbsp;calling&nbsp;a&nbsp;virtual&nbsp;function&nbsp;f,<br>
through&nbsp;a&nbsp;pointer&nbsp;of&nbsp;static&nbsp;type&nbsp;B*,<br>
the&nbsp;caller<br>
<br>
&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;Selects&nbsp;a&nbsp;(possibly&nbsp;improper)&nbsp;subobject&nbsp;A&nbsp;of&nbsp;B<br>
&nbsp;&nbsp;&nbsp;&nbsp;such&nbsp;that&nbsp;A&nbsp;declares&nbsp;f.<br>
&nbsp;&nbsp;&nbsp;&nbsp;(In&nbsp;general,&nbsp;A&nbsp;may&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;B.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;(Note&nbsp;that&nbsp;A&nbsp;need&nbsp;not&nbsp;define&nbsp;f;<br>
&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;may&nbsp;contain&nbsp;either&nbsp;a&nbsp;definition&nbsp;of&nbsp;f,<br>
&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;a&nbsp;declaration&nbsp;of&nbsp;f&nbsp;as&nbsp;a&nbsp;pure&nbsp;virtual&nbsp;function.)<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;Converts&nbsp;the&nbsp;B*&nbsp;to&nbsp;point&nbsp;to&nbsp;this&nbsp;subobject.<br>
&nbsp;&nbsp;&nbsp;&nbsp;(Call&nbsp;the&nbsp;resulting&nbsp;pointer&nbsp;`a'.)<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;Uses&nbsp;the&nbsp;virtual&nbsp;table&nbsp;pointer&nbsp;contained&nbsp;in&nbsp;the&nbsp;A&nbsp;subobject&nbsp;to&nbsp;locate<br>
&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;function&nbsp;pointer&nbsp;through&nbsp;which&nbsp;to&nbsp;perform&nbsp;the&nbsp;call.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;Calls&nbsp;through&nbsp;this&nbsp;function&nbsp;pointer,<br>
&nbsp;&nbsp;&nbsp;&nbsp;passing&nbsp;`a'&nbsp;as&nbsp;the&nbsp;&lt;code&gt;this&lt;/code&gt;&nbsp;pointer.<br>
&lt;/ul&gt;<br>
<br>
&lt;i&gt;<br>
&lt;p&gt;<br>
(Note&nbsp;that&nbsp;in&nbsp;general&nbsp;it&nbsp;will&nbsp;be&nbsp;optimal&nbsp;to&nbsp;select&nbsp;the&nbsp;class&nbsp;which<br>
contained&nbsp;the&nbsp;final&nbsp;overrider&nbsp;(i.e.,&nbsp;C)<br>
as&nbsp;the&nbsp;class&nbsp;to&nbsp;which&nbsp;the&nbsp;B*&nbsp;should&nbsp;be&nbsp;converted.<br>
This&nbsp;class&nbsp;is&nbsp;always&nbsp;a&nbsp;satisfactory&nbsp;choice,<br>
since&nbsp;it&nbsp;is&nbsp;known&nbsp;to&nbsp;contain&nbsp;a&nbsp;definition&nbsp;of&nbsp;f.<br>
In&nbsp;addition,&nbsp;if&nbsp;the&nbsp;dynamic&nbsp;type&nbsp;of&nbsp;the&nbsp;object&nbsp;is&nbsp;B,<br>
then&nbsp;C::f&nbsp;will&nbsp;be&nbsp;the&nbsp;function&nbsp;ultimately&nbsp;selected&nbsp;by&nbsp;the&nbsp;call,<br>
which&nbsp;means&nbsp;that&nbsp;C's&nbsp;virtual&nbsp;table&nbsp;will<br>
contain&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;non-adjusting&nbsp;entry&nbsp;point,<br>
meaning&nbsp;that&nbsp;no&nbsp;additional&nbsp;adjustments&nbsp;to&nbsp;the&nbsp;&lt;code&gt;this&lt;/code&gt;<br>
pointer&nbsp;will&nbsp;be&nbsp;required.<br>
<br>
&lt;p&gt;<br>
However,&nbsp;there&nbsp;may&nbsp;be&nbsp;cases&nbsp;in&nbsp;which&nbsp;choosing&nbsp;a&nbsp;different&nbsp;base<br>
subobject&nbsp;could&nbsp;be&nbsp;superior.<br>
For&nbsp;example,&nbsp;if&nbsp;there&nbsp;is&nbsp;an&nbsp;alternate&nbsp;base&nbsp;D&nbsp;which&nbsp;also&nbsp;declares&nbsp;f,<br>
and&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;D&nbsp;subobject&nbsp;is&nbsp;already&nbsp;available,<br>
then&nbsp;it&nbsp;may&nbsp;be&nbsp;better&nbsp;to&nbsp;use&nbsp;the&nbsp;D&nbsp;subobject&nbsp;rather<br>
than&nbsp;converting&nbsp;the&nbsp;B*&nbsp;to&nbsp;a&nbsp;C*,<br>
in&nbsp;order&nbsp;to&nbsp;avoid&nbsp;the&nbsp;cost&nbsp;of&nbsp;the&nbsp;conversion.)<br>
&lt;/i&gt;<br>
<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;3.2.5&nbsp;Implementation&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
Note&nbsp;that&nbsp;the&nbsp;ABI&nbsp;only&nbsp;specifies&nbsp;the&nbsp;multiple&nbsp;entry&nbsp;points<br>
for&nbsp;a&nbsp;virtual&nbsp;function&nbsp;and&nbsp;its&nbsp;associated&nbsp;thunks;<br>
how&nbsp;those&nbsp;entry&nbsp;points&nbsp;are&nbsp;provided&nbsp;is&nbsp;unspecified.<br>
An&nbsp;existing&nbsp;compiler&nbsp;which&nbsp;uses&nbsp;thunks&nbsp;with&nbsp;a&nbsp;different&nbsp;means&nbsp;of<br>
adjusting&nbsp;the&nbsp;virtual&nbsp;table&nbsp;pointers<br>
can&nbsp;be&nbsp;made&nbsp;compliant&nbsp;with&nbsp;this&nbsp;ABI&nbsp;by&nbsp;only&nbsp;adding&nbsp;the&nbsp;vcall&nbsp;offsets&nbsp;--<br>
the&nbsp;thunks&nbsp;need&nbsp;not&nbsp;use&nbsp;them.<br>
A&nbsp;more&nbsp;efficient&nbsp;implementation&nbsp;would&nbsp;be&nbsp;to&nbsp;emit&nbsp;all&nbsp;of&nbsp;the&nbsp;thunks<br>
immediately&nbsp;before&nbsp;the&nbsp;non-adjusting&nbsp;entry&nbsp;point&nbsp;to&nbsp;the&nbsp;function.<br>
Another&nbsp;might&nbsp;emit&nbsp;a&nbsp;new&nbsp;copy&nbsp;of&nbsp;the&nbsp;function&nbsp;for&nbsp;each&nbsp;entry&nbsp;point;<br>
this&nbsp;is&nbsp;a&nbsp;quality&nbsp;of&nbsp;implementation&nbsp;issue.<br>
&lt;i&gt;See&nbsp;further&nbsp;discussion&nbsp;of&nbsp;implementation&nbsp;in&nbsp;the<br>
&lt;a&nbsp;href=abi-examples.html#vcall-impl&gt;ABI&nbsp;examples&lt;/a&gt;&nbsp;document.&lt;/i&gt;<br>
&lt;/ul&gt;<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=pure-virtual&gt;<br>
&lt;h4&gt;&nbsp;3.2.6&nbsp;Pure&nbsp;Virtual&nbsp;Function&nbsp;API&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
An&nbsp;implementation&nbsp;shall&nbsp;provide&nbsp;a&nbsp;standard&nbsp;entry&nbsp;point&nbsp;that&nbsp;a&nbsp;compiler<br>
may&nbsp;reference&nbsp;in&nbsp;virtual&nbsp;tables&nbsp;to&nbsp;indicate&nbsp;a&nbsp;pure&nbsp;virtual&nbsp;function.<br>
Its&nbsp;interface&nbsp;is:<br>
<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;extern&nbsp;&quot;C&quot;&nbsp;void&nbsp;__cxa_pure_virtual&nbsp;();<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
This&nbsp;routine&nbsp;will&nbsp;only&nbsp;be&nbsp;called&nbsp;if&nbsp;the&nbsp;user&nbsp;calls&nbsp;a&nbsp;non-overridden<br>
pure&nbsp;virtual&nbsp;function,&nbsp;which&nbsp;has&nbsp;undefined&nbsp;behavior&nbsp;according&nbsp;to&nbsp;the<br>
C++&nbsp;Standard.<br>
Therefore,&nbsp;this&nbsp;ABI&nbsp;does&nbsp;not&nbsp;specify&nbsp;its&nbsp;behavior,<br>
but&nbsp;it&nbsp;is&nbsp;expected&nbsp;that&nbsp;it&nbsp;will&nbsp;terminate&nbsp;the&nbsp;program,<br>
possibly&nbsp;with&nbsp;an&nbsp;error&nbsp;message.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=obj-ctor&gt;<br>
&lt;h3&gt;&nbsp;3.3&nbsp;Construction&nbsp;and&nbsp;Destruction&nbsp;APIs&nbsp;&lt;/h3&gt;<br>
&lt;/a&gt;<br>
<br>
&lt;p&gt;<br>
This&nbsp;section&nbsp;describes&nbsp;APIs&nbsp;to&nbsp;be&nbsp;used&nbsp;for&nbsp;the&nbsp;construction&nbsp;and<br>
destruction&nbsp;of&nbsp;objects.<br>
This&nbsp;includes:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;&lt;a&nbsp;href=#subobj-ctor&gt;&nbsp;3.3.1&nbsp;Subobject&nbsp;Construction&nbsp;and&nbsp;Destruction&lt;/a&gt;<br>
&lt;li&gt;&nbsp;&lt;a&nbsp;href=#once-ctor&gt;&nbsp;&nbsp;&nbsp;3.3.2&nbsp;One-time&nbsp;Construction&nbsp;API&nbsp;&lt;/a&gt;<br>
&lt;li&gt;&nbsp;&lt;a&nbsp;href=#array-ctor&gt;&nbsp;&nbsp;3.3.3&nbsp;Array&nbsp;Construction&nbsp;and&nbsp;Destruction&nbsp;API&nbsp;&lt;/a&gt;<br>
&lt;li&gt;&nbsp;&lt;a&nbsp;href=#ctor-order&gt;&nbsp;&nbsp;3.3.4&nbsp;Controlling&nbsp;Object&nbsp;Construction&nbsp;Order&nbsp;&lt;/a&gt;<br>
&lt;li&gt;&nbsp;&lt;a&nbsp;href=#dso-dtor&gt;&nbsp;&nbsp;&nbsp;&nbsp;3.3.5&nbsp;DSO&nbsp;Object&nbsp;Destruction&nbsp;API&nbsp;&lt;/a&gt;<br>
&lt;/ul&gt;<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=subobj-ctor&gt;<br>
&lt;h4&gt;&nbsp;3.3.1&nbsp;Subobject&nbsp;Construction&nbsp;and&nbsp;Destruction&nbsp;&lt;/h4&gt;<br>
&lt;/a&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;complete&nbsp;object&nbsp;(in-charge)&nbsp;constructors&nbsp;and&nbsp;destructors&nbsp;find&nbsp;the&nbsp;VTT,<br>
described&nbsp;in&nbsp;Section&nbsp;2.6,&nbsp;Virtual&nbsp;Tables&nbsp;During&nbsp;Object&nbsp;Construction,<br>
via&nbsp;its&nbsp;mangled&nbsp;name.<br>
They&nbsp;pass&nbsp;the&nbsp;address&nbsp;of&nbsp;the&nbsp;subobject's&nbsp;sub-VTT<br>
entry&nbsp;in&nbsp;the&nbsp;VTT&nbsp;as&nbsp;a&nbsp;second&nbsp;parameter&nbsp;when&nbsp;calling<br>
the&nbsp;subobject&nbsp;(not-in-charge)&nbsp;constructors&nbsp;and&nbsp;destructors.<br>
The&nbsp;subobject&nbsp;ctor/dtors&nbsp;use&nbsp;the&nbsp;addresses&nbsp;passed&nbsp;to&nbsp;initialize<br>
the&nbsp;primary&nbsp;virtual&nbsp;pointer&nbsp;and&nbsp;virtual&nbsp;pointers&nbsp;that&nbsp;point&nbsp;to&nbsp;the<br>
classes&nbsp;which&nbsp;either&nbsp;have&nbsp;virtual&nbsp;bases&nbsp;or&nbsp;override&nbsp;virtual&nbsp;functions<br>
with&nbsp;a&nbsp;virtual&nbsp;step<br>
(have&nbsp;vcall&nbsp;offsets&nbsp;needing&nbsp;adjustment).<br>
<br>
&lt;p&gt;<br>
If&nbsp;a&nbsp;constructor&nbsp;calls&nbsp;constructors&nbsp;for&nbsp;base&nbsp;class<br>
subobjects&nbsp;that&nbsp;do&nbsp;not&nbsp;need&nbsp;construction&nbsp;virtual&nbsp;tables,<br>
e.g.&nbsp;because&nbsp;they&nbsp;have&nbsp;no&nbsp;virtual&nbsp;bases,<br>
the&nbsp;construction&nbsp;virtual&nbsp;table&nbsp;parameter&nbsp;is&nbsp;not&nbsp;passed&nbsp;to&nbsp;the&nbsp;base&nbsp;class<br>
subobject&nbsp;constructor,<br>
and&nbsp;the&nbsp;base&nbsp;class&nbsp;subobject&nbsp;constructors&nbsp;use<br>
their&nbsp;complete&nbsp;object&nbsp;virtual&nbsp;tables&nbsp;for&nbsp;initialization.<br>
<br>
&lt;p&gt;<br>
&lt;i&gt;<br>
Suppose&nbsp;we&nbsp;have&nbsp;a&nbsp;subobject&nbsp;class&nbsp;D&nbsp;that&nbsp;needs&nbsp;a&nbsp;construction&nbsp;virtual&nbsp;table,<br>
derived&nbsp;from&nbsp;a&nbsp;base&nbsp;B&nbsp;that&nbsp;needs&nbsp;a&nbsp;construction&nbsp;virtual&nbsp;table&nbsp;as&nbsp;part&nbsp;of&nbsp;D,<br>
and&nbsp;possibly&nbsp;from&nbsp;others&nbsp;that&nbsp;do&nbsp;not&nbsp;need&nbsp;construction&nbsp;virtual&nbsp;tables.<br>
Then&nbsp;the&nbsp;sub-VTT&nbsp;and&nbsp;constructor&nbsp;code&nbsp;for&nbsp;D&nbsp;would&nbsp;look&nbsp;like&nbsp;the&nbsp;following:<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Sub-VTT&nbsp;for&nbsp;D&nbsp;(embedded&nbsp;in&nbsp;VTT&nbsp;for&nbsp;its&nbsp;derived&nbsp;class&nbsp;X):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;vtable&nbsp;*__VTT__1D&nbsp;[1+n+m]&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;D&nbsp;primary&nbsp;vtable,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;The&nbsp;sub-VTT&nbsp;for&nbsp;B-in-D&nbsp;in&nbsp;X&nbsp;may&nbsp;have&nbsp;further&nbsp;structure:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B-in-D&nbsp;sub-VTT&nbsp;(n&nbsp;elements),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;The&nbsp;secondary&nbsp;virtual&nbsp;pointers&nbsp;for&nbsp;D's&nbsp;bases&nbsp;have&nbsp;elements<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;corresponding&nbsp;to&nbsp;those&nbsp;in&nbsp;the&nbsp;B-in-D&nbsp;sub-VTT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;and&nbsp;possibly&nbsp;others&nbsp;for&nbsp;virtual&nbsp;bases&nbsp;of&nbsp;D:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;secondary&nbsp;virtual&nbsp;pointer&nbsp;for&nbsp;B&nbsp;and&nbsp;bases&nbsp;(m&nbsp;elements)&nbsp;};&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;(&nbsp;D&nbsp;*this,&nbsp;vtable&nbsp;**ctorvtbls&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;(The&nbsp;following&nbsp;will&nbsp;be&nbsp;unwound,&nbsp;not&nbsp;a&nbsp;real&nbsp;loop):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;each&nbsp;base&nbsp;A&nbsp;of&nbsp;D&nbsp;)&nbsp;{<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;A&nbsp;&quot;boring&quot;&nbsp;base&nbsp;is&nbsp;one&nbsp;that&nbsp;does&nbsp;not&nbsp;need&nbsp;a&nbsp;ctorvtbl:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;!&nbsp;boring(A)&nbsp;)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Call&nbsp;subobject&nbsp;constructors&nbsp;with&nbsp;sub-VTT&nbsp;index<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;the&nbsp;base&nbsp;needs&nbsp;it&nbsp;--&nbsp;only&nbsp;B&nbsp;in&nbsp;our&nbsp;example:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;(&nbsp;(A*)this,&nbsp;ctorvtbls&nbsp;+&nbsp;sub-VTT-index(A)&nbsp;);&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Otherwise,&nbsp;just&nbsp;invoke&nbsp;the&nbsp;complete-object&nbsp;constructor:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;(&nbsp;(A*)this&nbsp;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Initialize&nbsp;virtual&nbsp;pointer&nbsp;with&nbsp;primary&nbsp;ctorvtbls&nbsp;address<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;(first&nbsp;element):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;vptr&nbsp;=&nbsp;ctorvtbls+0;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;primary&nbsp;virtual&nbsp;pointer<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;(The&nbsp;following&nbsp;will&nbsp;be&nbsp;unwound,&nbsp;not&nbsp;a&nbsp;real&nbsp;loop):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;each&nbsp;subobject&nbsp;A&nbsp;of&nbsp;D&nbsp;)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Initialize&nbsp;virtual&nbsp;pointers&nbsp;of&nbsp;subobjects&nbsp;with&nbsp;ctorvtbls<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;addresses&nbsp;for&nbsp;the&nbsp;bases&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;!&nbsp;boring(A)&nbsp;)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((A*)this)-&gt;vptr&nbsp;=&nbsp;ctorvtbls&nbsp;+&nbsp;1+n&nbsp;+&nbsp;secondary-vptr-index(A);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;where&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;in&nbsp;the&nbsp;sub-VTTs<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Otherwise,&nbsp;just&nbsp;use&nbsp;the&nbsp;complete-object&nbsp;vtable:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((A&nbsp;*)this)-&gt;vptr&nbsp;=&nbsp;&amp;(A-in-D&nbsp;vtable);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Code&nbsp;for&nbsp;D&nbsp;constructor.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
&lt;/table&gt;<br>
<br>
&lt;p&gt;<br>
A&nbsp;test&nbsp;program&nbsp;for&nbsp;this&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the<br>
&lt;a&nbsp;href=abi-examples.html#vtable-ctor&gt;ABI&nbsp;Examples&lt;/a&gt;&nbsp;document.<br>
<br>
<br>
&lt;/dl&gt;<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=once-ctor&gt;&lt;/a&gt;<br>
&lt;h4&gt;&nbsp;3.3.2&nbsp;One-time&nbsp;Construction&nbsp;API&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
As&nbsp;described&nbsp;in&nbsp;&lt;a&nbsp;href=#guards&gt;Section&nbsp;2.8&lt;/a&gt;,<br>
function-scope&nbsp;static&nbsp;objects&nbsp;have&nbsp;associated&nbsp;guard&nbsp;variables&nbsp;used<br>
to&nbsp;support&nbsp;the&nbsp;requirement&nbsp;that&nbsp;they&nbsp;be&nbsp;initialized&nbsp;exactly&nbsp;once,<br>
the&nbsp;first&nbsp;time&nbsp;the&nbsp;scope&nbsp;declaring&nbsp;them&nbsp;is&nbsp;entered.<br>
An&nbsp;implementation&nbsp;that&nbsp;does&nbsp;not&nbsp;anticipate&nbsp;supporting&nbsp;multi-threading<br>
may&nbsp;simply&nbsp;check&nbsp;the&nbsp;low-order&nbsp;byte&nbsp;of&nbsp;that&nbsp;guard&nbsp;variable,<br>
initializing&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;its&nbsp;value&nbsp;is&nbsp;zero,<br>
and&nbsp;then&nbsp;setting&nbsp;it&nbsp;to&nbsp;a&nbsp;non-zero&nbsp;value.<br>
<br>
&lt;p&gt;<br>
However,&nbsp;an&nbsp;implementation&nbsp;intending&nbsp;to&nbsp;support<br>
automatically&nbsp;thread-safe,&nbsp;one-time&nbsp;initialization<br>
(as&nbsp;opposed&nbsp;to&nbsp;requiring&nbsp;explicit&nbsp;user&nbsp;control&nbsp;for&nbsp;thread&nbsp;safety)<br>
requires&nbsp;more&nbsp;control,<br>
and&nbsp;should&nbsp;use&nbsp;the&nbsp;following&nbsp;API&nbsp;to&nbsp;achieve&nbsp;interoperability&nbsp;with&nbsp;other<br>
such&nbsp;implementations.<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;&lt;i&gt;obj_guard.first_byte&lt;/i&gt;&nbsp;==&nbsp;false&nbsp;)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;__cxa_guard_acquire&nbsp;(&lt;i&gt;obj_guard&lt;/i&gt;)&nbsp;)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&gt;...&nbsp;initialize&nbsp;the&nbsp;object&nbsp;...&lt;/i&gt;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&gt;...&nbsp;queue&nbsp;object&nbsp;destructor&nbsp;with&nbsp;__cxa_atexit()&nbsp;...&lt;/i&gt;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__cxa_guard_release&nbsp;(&lt;i&gt;obj_guard&lt;/i&gt;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;two&nbsp;functions&nbsp;in&nbsp;the&nbsp;above&nbsp;sequence&nbsp;are&nbsp;defined&nbsp;as&nbsp;follows:<br>
<br>
&lt;dl&gt;<br>
<br>
&lt;dt&gt;&lt;code&gt;&lt;pre&gt;<br>
extern&nbsp;&quot;C&quot;&nbsp;int&nbsp;__cxa_guard_acquire&nbsp;(&nbsp;__int64_t&nbsp;*guard_object&nbsp;);<br>
&lt;/pre&gt;&lt;/code&gt;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
The&nbsp;&lt;code&gt;guard_object&lt;/code&gt;&nbsp;argument&nbsp;is&nbsp;the&nbsp;guard&nbsp;variable<br>
(see&nbsp;&lt;a&nbsp;href=#guards&gt;Section&nbsp;2.8&lt;/a&gt;)<br>
associated&nbsp;with&nbsp;the&nbsp;object&nbsp;to&nbsp;be&nbsp;initialized.<br>
If&nbsp;it&nbsp;indicates&nbsp;that&nbsp;the&nbsp;object&nbsp;has&nbsp;been&nbsp;initialized&nbsp;already,<br>
return&nbsp;&lt;code&gt;false&lt;/code&gt;&nbsp;(0)&nbsp;immediately.<br>
Otherwise,&nbsp;acquire&nbsp;a&nbsp;lock&nbsp;associated&nbsp;with&nbsp;the&nbsp;guard&nbsp;variable<br>
(possibly&nbsp;part&nbsp;of&nbsp;it,&nbsp;but&nbsp;unspecified&nbsp;by&nbsp;this&nbsp;ABI).<br>
If&nbsp;the&nbsp;object&nbsp;has&nbsp;now&nbsp;been&nbsp;initialized,<br>
release&nbsp;the&nbsp;lock&nbsp;and&nbsp;return&nbsp;&lt;code&gt;false&lt;/code&gt;&nbsp;(0).<br>
If&nbsp;not,&nbsp;return&nbsp;&lt;code&gt;true&lt;/code&gt;&nbsp;(1)&nbsp;without&nbsp;releasing&nbsp;the&nbsp;lock.<br>
&lt;/dd&gt;<br>
<br>
<br>
&lt;dt&gt;&lt;code&gt;&lt;pre&gt;<br>
extern&nbsp;&quot;C&quot;&nbsp;void&nbsp;__cxa_guard_release&nbsp;(&nbsp;__int64_t&nbsp;*guard_object&nbsp;);<br>
&lt;/pre&gt;&lt;/code&gt;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
The&nbsp;&lt;code&gt;guard_object&lt;/code&gt;&nbsp;argument&nbsp;is&nbsp;the&nbsp;guard&nbsp;variable<br>
(see&nbsp;&lt;a&nbsp;href=#guards&gt;Section&nbsp;2.8&lt;/a&gt;)<br>
associated&nbsp;with&nbsp;the&nbsp;object&nbsp;being&nbsp;initialized.<br>
Set&nbsp;it&nbsp;to&nbsp;indicate&nbsp;that&nbsp;initialization&nbsp;is&nbsp;complete,<br>
release&nbsp;the&nbsp;associated&nbsp;lock&nbsp;(in&nbsp;that&nbsp;order),<br>
and&nbsp;return.<br>
&lt;/dd&gt;<br>
<br>
<br>
&lt;dt&gt;&lt;code&gt;&lt;pre&gt;<br>
extern&nbsp;&quot;C&quot;&nbsp;void&nbsp;__cxa_guard_abort&nbsp;(&nbsp;__int64_t&nbsp;*guard_object&nbsp;);<br>
&lt;/pre&gt;&lt;/code&gt;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
The&nbsp;&lt;code&gt;guard_object&lt;/code&gt;&nbsp;argument&nbsp;is&nbsp;the&nbsp;guard&nbsp;variable<br>
(see&nbsp;&lt;a&nbsp;href=#guards&gt;Section&nbsp;2.8&lt;/a&gt;)<br>
associated&nbsp;with&nbsp;an&nbsp;object&nbsp;being&nbsp;initialized.<br>
Set&nbsp;it&nbsp;to&nbsp;indicate&nbsp;that&nbsp;initialization&nbsp;is&nbsp;not&nbsp;complete,<br>
release&nbsp;the&nbsp;associated&nbsp;lock&nbsp;(in&nbsp;that&nbsp;order),<br>
and&nbsp;return.<br>
This&nbsp;routine&nbsp;is&nbsp;intended&nbsp;for&nbsp;use&nbsp;when&nbsp;the&nbsp;initialization&nbsp;raises&nbsp;an<br>
exception,&nbsp;which&nbsp;requires&nbsp;that&nbsp;initialization&nbsp;be&nbsp;attempted&nbsp;again&nbsp;by&nbsp;the<br>
next&nbsp;pass&nbsp;through&nbsp;the&nbsp;object's&nbsp;scope.<br>
&lt;/dd&gt;<br>
<br>
&lt;/dl&gt;<br>
<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
An&nbsp;implementation&nbsp;need&nbsp;not&nbsp;include&nbsp;the&nbsp;simple&nbsp;inline&nbsp;test&nbsp;of&nbsp;the<br>
initialization&nbsp;flag&nbsp;in&nbsp;the&nbsp;guard&nbsp;variable&nbsp;around&nbsp;the&nbsp;above&nbsp;sequence.<br>
If&nbsp;it&nbsp;does&nbsp;so,<br>
the&nbsp;cost&nbsp;of&nbsp;this&nbsp;scheme,<br>
when&nbsp;run&nbsp;single-threaded&nbsp;with&nbsp;minimal&nbsp;versions&nbsp;of&nbsp;the&nbsp;above&nbsp;functions,<br>
will&nbsp;be&nbsp;two&nbsp;extra&nbsp;function&nbsp;calls,<br>
each&nbsp;of&nbsp;them&nbsp;accessing&nbsp;the&nbsp;guard&nbsp;variable,<br>
the&nbsp;first&nbsp;time&nbsp;the&nbsp;scope&nbsp;is&nbsp;entered.<br>
<br>
&lt;p&gt;<br>
An&nbsp;implementation&nbsp;supporting&nbsp;thread-safety&nbsp;on&nbsp;multiprocessor&nbsp;systems<br>
must&nbsp;also&nbsp;guarantee&nbsp;that&nbsp;references&nbsp;to&nbsp;the&nbsp;initialized&nbsp;object&nbsp;do&nbsp;not<br>
occur&nbsp;before&nbsp;the&nbsp;load&nbsp;of&nbsp;the&nbsp;initialization&nbsp;flag.<br>
On&nbsp;Itanium,&nbsp;this&nbsp;can&nbsp;be&nbsp;done&nbsp;by&nbsp;using&nbsp;a&nbsp;&lt;code&gt;ld1.acq&lt;/code&gt;&nbsp;operation&nbsp;to<br>
load&nbsp;the&nbsp;flag.<br>
<br>
&lt;p&gt;<br>
The&nbsp;intent&nbsp;of&nbsp;specifying&nbsp;an&nbsp;8-byte&nbsp;structure&nbsp;for&nbsp;the&nbsp;guard&nbsp;variable,<br>
but&nbsp;only&nbsp;describing&nbsp;one&nbsp;byte&nbsp;of&nbsp;its&nbsp;contents,<br>
is&nbsp;to&nbsp;allow&nbsp;flexibility&nbsp;in&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;API&nbsp;above.<br>
On&nbsp;systems&nbsp;with&nbsp;good&nbsp;small&nbsp;lock&nbsp;support,<br>
the&nbsp;second&nbsp;word&nbsp;might&nbsp;be&nbsp;used&nbsp;for&nbsp;a&nbsp;mutex&nbsp;lock.<br>
On&nbsp;others,&nbsp;it&nbsp;might&nbsp;identify&nbsp;(as&nbsp;a&nbsp;pointer&nbsp;or&nbsp;index)<br>
a&nbsp;more&nbsp;complex&nbsp;lock&nbsp;structure&nbsp;to&nbsp;use.<br>
&lt;/i&gt;<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=array-ctor&gt;&lt;/a&gt;<br>
&lt;h4&gt;&nbsp;3.3.3&nbsp;Array&nbsp;Construction&nbsp;and&nbsp;Destruction&nbsp;API&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
An&nbsp;ABI-compliant&nbsp;system&nbsp;shall&nbsp;provide&nbsp;several&nbsp;runtime&nbsp;routines&nbsp;for&nbsp;use<br>
in&nbsp;array&nbsp;construction&nbsp;and&nbsp;destruction.<br>
They&nbsp;may&nbsp;be&nbsp;used&nbsp;by&nbsp;compilers,&nbsp;but&nbsp;their&nbsp;use&nbsp;is&nbsp;not&nbsp;required.<br>
The&nbsp;required&nbsp;APIs&nbsp;are:<br>
<br>
&lt;dl&gt;<br>
<br>
&lt;dt&gt;&lt;code&gt;&lt;pre&gt;<br>
extern&nbsp;&quot;C&quot;&nbsp;void&nbsp;*&nbsp;__cxa_vec_new&nbsp;(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_count,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_size,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;padding_size,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*constructor)&nbsp;(&nbsp;void&nbsp;*this&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*destructor)&nbsp;(&nbsp;void&nbsp;*this&nbsp;)&nbsp;);<br>
&lt;/pre&gt;&lt;/code&gt;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
Given&nbsp;the&nbsp;number&nbsp;and&nbsp;size&nbsp;of&nbsp;elements&nbsp;for&nbsp;an&nbsp;array,<br>
and&nbsp;the&nbsp;non-negative&nbsp;size&nbsp;of&nbsp;prefix&nbsp;padding&nbsp;for&nbsp;a&nbsp;cookie,<br>
allocate&nbsp;space&nbsp;for&nbsp;the&nbsp;array&nbsp;preceded&nbsp;by&nbsp;the&nbsp;specified&nbsp;padding,<br>
initialize&nbsp;the&nbsp;cookie&nbsp;if&nbsp;the&nbsp;padding&nbsp;is&nbsp;non-zero,<br>
and&nbsp;call&nbsp;the&nbsp;given&nbsp;constructor&nbsp;on&nbsp;each&nbsp;element.<br>
Return&nbsp;the&nbsp;address&nbsp;of&nbsp;the&nbsp;array&nbsp;proper,<br>
after&nbsp;the&nbsp;padding.<br>
If&nbsp;allocation&nbsp;throws,&nbsp;rethrow.<br>
If&nbsp;the&nbsp;constructor&nbsp;throws&nbsp;an&nbsp;exception,<br>
call&nbsp;the&nbsp;given&nbsp;destructor&nbsp;for&nbsp;any&nbsp;already-constructed&nbsp;elements,<br>
delete&nbsp;the&nbsp;space,<br>
and&nbsp;rethrow&nbsp;the&nbsp;exception.<br>
If&nbsp;the&nbsp;destructor&nbsp;throws&nbsp;an&nbsp;exception,<br>
call&nbsp;&lt;code&gt;terminate()&lt;/code&gt;.<br>
The&nbsp;constructor&nbsp;may&nbsp;be&nbsp;NULL.<br>
The&nbsp;destructor&nbsp;may&nbsp;be&nbsp;NULL&nbsp;only&nbsp;if&nbsp;the&nbsp;padding&nbsp;size&nbsp;is&nbsp;zero.<br>
If&nbsp;either&nbsp;is&nbsp;NULL,&nbsp;no&nbsp;action&nbsp;is&nbsp;taken&nbsp;when&nbsp;it&nbsp;would&nbsp;have&nbsp;been&nbsp;called.<br>
&lt;/dd&gt;<br>
<br>
&lt;dt&gt;&lt;code&gt;&lt;pre&gt;<br>
extern&nbsp;&quot;C&quot;&nbsp;void&nbsp;*&nbsp;__cxa_vec_new2&nbsp;(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_count,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_size,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;padding_size,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*constructor)&nbsp;(&nbsp;void&nbsp;*this&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*destructor)&nbsp;(&nbsp;void&nbsp;*this&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void*&nbsp;(*alloc)&nbsp;(&nbsp;size_t&nbsp;size&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*dealloc)&nbsp;(&nbsp;void&nbsp;*obj&nbsp;)&nbsp;);<br>
&lt;/pre&gt;&lt;/code&gt;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
Same&nbsp;as&nbsp;&lt;code&gt;__cxa_vec_new&lt;/code&gt;,<br>
except&nbsp;that&nbsp;the&nbsp;given&nbsp;functions&nbsp;are&nbsp;used&nbsp;for&nbsp;allocation/deallocation<br>
instead&nbsp;of&nbsp;the&nbsp;default&nbsp;new/delete&nbsp;functions.<br>
If&nbsp;&lt;code&gt;dealloc&lt;/code&gt;&nbsp;throws&nbsp;an&nbsp;exception,<br>
the&nbsp;result&nbsp;is&nbsp;undefined.<br>
The&nbsp;&lt;code&gt;alloc&lt;/code&gt;&nbsp;and&nbsp;&lt;code&gt;dealloc&lt;/code&gt;&nbsp;pointers&nbsp;may&nbsp;not&nbsp;be<br>
NULL.<br>
&lt;/dd&gt;<br>
<br>
&lt;dt&gt;&lt;code&gt;&lt;pre&gt;<br>
extern&nbsp;&quot;C&quot;&nbsp;void&nbsp;*&nbsp;__cxa_vec_new3&nbsp;(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_count,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_size,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;padding_size,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*constructor)&nbsp;(&nbsp;void&nbsp;*this&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*destructor)&nbsp;(&nbsp;void&nbsp;*this&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void*&nbsp;(*alloc)&nbsp;(&nbsp;size_t&nbsp;size&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*dealloc)&nbsp;(&nbsp;void&nbsp;*obj,&nbsp;size_t&nbsp;size&nbsp;)&nbsp;);<br>
&lt;/pre&gt;&lt;/code&gt;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
Same&nbsp;as&nbsp;&lt;code&gt;__cxa_vec_new&lt;/code&gt;,<br>
except&nbsp;that&nbsp;the&nbsp;given&nbsp;functions&nbsp;are&nbsp;used&nbsp;for&nbsp;allocation/deallocation<br>
instead&nbsp;of&nbsp;the&nbsp;default&nbsp;new/delete&nbsp;functions.<br>
The&nbsp;deallocation&nbsp;function&nbsp;takes&nbsp;both&nbsp;the&nbsp;object&nbsp;address&nbsp;and&nbsp;its&nbsp;size.<br>
If&nbsp;&lt;code&gt;dealloc&lt;/code&gt;&nbsp;throws&nbsp;an&nbsp;exception,<br>
the&nbsp;result&nbsp;is&nbsp;undefined.<br>
The&nbsp;&lt;code&gt;alloc&lt;/code&gt;&nbsp;and&nbsp;&lt;code&gt;dealloc&lt;/code&gt;&nbsp;pointers&nbsp;may&nbsp;not&nbsp;be<br>
NULL.<br>
&lt;/dd&gt;<br>
<br>
&lt;dt&gt;&lt;code&gt;&lt;pre&gt;<br>
extern&nbsp;&quot;C&quot;&nbsp;void&nbsp;__cxa_vec_ctor&nbsp;(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;*array_address,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_count,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_size,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*constructor)&nbsp;(&nbsp;void&nbsp;*this&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*destructor)&nbsp;(&nbsp;void&nbsp;*this&nbsp;)&nbsp;);<br>
&lt;/pre&gt;&lt;/code&gt;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
Given&nbsp;the&nbsp;(data)&nbsp;address&nbsp;of&nbsp;an&nbsp;array,<br>
not&nbsp;including&nbsp;any&nbsp;cookie&nbsp;padding,<br>
and&nbsp;the&nbsp;number&nbsp;and&nbsp;size&nbsp;of&nbsp;its&nbsp;elements,<br>
call&nbsp;the&nbsp;given&nbsp;constructor&nbsp;on&nbsp;each&nbsp;element.<br>
If&nbsp;the&nbsp;constructor&nbsp;throws&nbsp;an&nbsp;exception,<br>
call&nbsp;the&nbsp;given&nbsp;destructor&nbsp;for&nbsp;any&nbsp;already-constructed&nbsp;elements,<br>
and&nbsp;rethrow&nbsp;the&nbsp;exception.<br>
If&nbsp;the&nbsp;destructor&nbsp;throws&nbsp;an&nbsp;exception,<br>
call&nbsp;&lt;code&gt;terminate()&lt;/code&gt;.<br>
The&nbsp;constructor&nbsp;and/or&nbsp;destructor&nbsp;pointers&nbsp;may&nbsp;be&nbsp;NULL.<br>
If&nbsp;either&nbsp;is&nbsp;NULL,&nbsp;no&nbsp;action&nbsp;is&nbsp;taken&nbsp;when&nbsp;it&nbsp;would&nbsp;have&nbsp;been&nbsp;called.<br>
&lt;/dd&gt;<br>
<br>
&lt;dt&gt;&lt;code&gt;&lt;pre&gt;<br>
extern&nbsp;&quot;C&quot;&nbsp;void&nbsp;__cxa_vec_dtor&nbsp;(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;*array_address,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_count,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_size,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*destructor)&nbsp;(&nbsp;void&nbsp;*this&nbsp;)&nbsp;);<br>
&lt;/pre&gt;&lt;/code&gt;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
Given&nbsp;the&nbsp;(data)&nbsp;address&nbsp;of&nbsp;an&nbsp;array,<br>
the&nbsp;number&nbsp;of&nbsp;elements,<br>
and&nbsp;the&nbsp;size&nbsp;of&nbsp;its&nbsp;elements,<br>
call&nbsp;the&nbsp;given&nbsp;destructor&nbsp;on&nbsp;each&nbsp;element.<br>
If&nbsp;the&nbsp;destructor&nbsp;throws&nbsp;an&nbsp;exception,<br>
rethrow&nbsp;after&nbsp;destroying&nbsp;the&nbsp;remaining&nbsp;elements&nbsp;if&nbsp;possible.<br>
If&nbsp;the&nbsp;destructor&nbsp;throws&nbsp;a&nbsp;second&nbsp;exception,&nbsp;call&nbsp;terminate.<br>
The&nbsp;destructor&nbsp;pointer&nbsp;may&nbsp;be&nbsp;NULL,<br>
in&nbsp;which&nbsp;case&nbsp;this&nbsp;routine&nbsp;does&nbsp;nothing.<br>
&lt;/dd&gt;<br>
<br>
&lt;div&nbsp;class=&quot;change&quot;&gt;<br>
&lt;dt&gt;&lt;code&gt;&lt;pre&gt;<br>
extern&nbsp;&quot;C&quot;&nbsp;void&nbsp;__cxa_vec_cleanup&nbsp;(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;*array_address,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_count,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_size,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*destructor)&nbsp;(&nbsp;void&nbsp;*this&nbsp;)&nbsp;);<br>
&lt;/pre&gt;&lt;/code&gt;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
Given&nbsp;the&nbsp;(data)&nbsp;address&nbsp;of&nbsp;an&nbsp;array,<br>
the&nbsp;number&nbsp;of&nbsp;elements,<br>
and&nbsp;the&nbsp;size&nbsp;of&nbsp;its&nbsp;elements,<br>
call&nbsp;the&nbsp;given&nbsp;destructor&nbsp;on&nbsp;each&nbsp;element.<br>
If&nbsp;the&nbsp;destructor&nbsp;throws&nbsp;an&nbsp;exception,&nbsp;call&nbsp;terminate.<br>
The&nbsp;destructor&nbsp;pointer&nbsp;may&nbsp;be&nbsp;NULL,<br>
in&nbsp;which&nbsp;case&nbsp;this&nbsp;routine&nbsp;does&nbsp;nothing.<br>
&lt;/dd&gt;<br>
&lt;/div&gt;<br>
<br>
&lt;dt&gt;&lt;code&gt;&lt;pre&gt;<br>
extern&nbsp;&quot;C&quot;&nbsp;void&nbsp;__cxa_vec_delete&nbsp;(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;*array_address,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_size,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;padding_size,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*destructor)&nbsp;(&nbsp;void&nbsp;*this&nbsp;)&nbsp;);<br>
&lt;/pre&gt;&lt;/code&gt;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
Given&nbsp;the&nbsp;(data)&nbsp;address&nbsp;of&nbsp;an&nbsp;array,<br>
the&nbsp;non-negative&nbsp;size&nbsp;of&nbsp;prefix&nbsp;padding&nbsp;for&nbsp;the&nbsp;cookie,<br>
and&nbsp;the&nbsp;size&nbsp;of&nbsp;its&nbsp;elements,<br>
call&nbsp;the&nbsp;given&nbsp;destructor&nbsp;on&nbsp;each&nbsp;element,<br>
using&nbsp;the&nbsp;cookie&nbsp;to&nbsp;determine&nbsp;the&nbsp;number&nbsp;of&nbsp;elements,<br>
and&nbsp;then&nbsp;delete&nbsp;the&nbsp;space.<br>
If&nbsp;the&nbsp;destructor&nbsp;throws&nbsp;an&nbsp;exception,<br>
rethrow&nbsp;after&nbsp;destroying&nbsp;the&nbsp;remaining&nbsp;elements&nbsp;if&nbsp;possible.<br>
If&nbsp;the&nbsp;destructor&nbsp;throws&nbsp;a&nbsp;second&nbsp;exception,&nbsp;call&nbsp;terminate.<br>
If&nbsp;padding_size&nbsp;is&nbsp;0,&nbsp;the&nbsp;destructor&nbsp;pointer&nbsp;must&nbsp;be&nbsp;NULL.<br>
If&nbsp;the&nbsp;destructor&nbsp;pointer&nbsp;is&nbsp;NULL,<br>
no&nbsp;destructor&nbsp;call&nbsp;is&nbsp;to&nbsp;be&nbsp;made.<br>
&lt;/dd&gt;<br>
<br>
&lt;dt&gt;&lt;code&gt;&lt;pre&gt;<br>
extern&nbsp;&quot;C&quot;&nbsp;void&nbsp;__cxa_vec_delete2&nbsp;(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;*array_address,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_size,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;padding_size,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*destructor)&nbsp;(&nbsp;void&nbsp;*this&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*dealloc)&nbsp;(&nbsp;void&nbsp;*obj&nbsp;)&nbsp;);<br>
&lt;/pre&gt;&lt;/code&gt;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
Same&nbsp;as&nbsp;&lt;code&gt;__cxa_vec_delete&lt;/code&gt;,<br>
except&nbsp;that&nbsp;the&nbsp;given&nbsp;function&nbsp;is&nbsp;used&nbsp;for&nbsp;deallocation<br>
instead&nbsp;of&nbsp;the&nbsp;default&nbsp;delete&nbsp;function.<br>
If&nbsp;&lt;code&gt;dealloc&lt;/code&gt;&nbsp;throws&nbsp;an&nbsp;exception,<br>
the&nbsp;result&nbsp;is&nbsp;undefined.<br>
The&nbsp;&lt;code&gt;dealloc&lt;/code&gt;&nbsp;pointer&nbsp;may&nbsp;not&nbsp;be&nbsp;NULL.<br>
&lt;/dd&gt;<br>
<br>
&lt;dt&gt;&lt;code&gt;&lt;pre&gt;<br>
extern&nbsp;&quot;C&quot;&nbsp;void&nbsp;__cxa_vec_delete3&nbsp;(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;*array_address,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_size,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;padding_size,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*destructor)&nbsp;(&nbsp;void&nbsp;*this&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*dealloc)&nbsp;(&nbsp;void&nbsp;*obj,&nbsp;size_t&nbsp;size&nbsp;)&nbsp;);<br>
&lt;/pre&gt;&lt;/code&gt;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
Same&nbsp;as&nbsp;&lt;code&gt;__cxa_vec_delete&lt;/code&gt;,<br>
except&nbsp;that&nbsp;the&nbsp;given&nbsp;function&nbsp;is&nbsp;used&nbsp;for&nbsp;deallocation<br>
instead&nbsp;of&nbsp;the&nbsp;default&nbsp;delete&nbsp;function.<br>
The&nbsp;deallocation&nbsp;function&nbsp;takes&nbsp;both&nbsp;the&nbsp;object&nbsp;address&nbsp;and&nbsp;its&nbsp;size.<br>
If&nbsp;&lt;code&gt;dealloc&lt;/code&gt;&nbsp;throws&nbsp;an&nbsp;exception,<br>
the&nbsp;result&nbsp;is&nbsp;undefined.<br>
The&nbsp;&lt;code&gt;dealloc&lt;/code&gt;&nbsp;pointer&nbsp;may&nbsp;not&nbsp;be&nbsp;NULL.<br>
&lt;/dd&gt;<br>
<br>
&lt;a&nbsp;name=array-copy-ctor&gt;&lt;/a&gt;<br>
&lt;dt&gt;&lt;code&gt;&lt;pre&gt;<br>
extern&nbsp;&quot;C&quot;&nbsp;void&nbsp;__cxa_vec_cctor&nbsp;(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;*dest_array,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;*src_array,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_count,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;element_size,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*constructor)&nbsp;(void&nbsp;*,&nbsp;void&nbsp;*),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;(*destructor)&nbsp;(void&nbsp;*))<br>
&lt;/pre&gt;&lt;/code&gt;&lt;/dt&gt;<br>
&lt;dd&gt;<br>
Given&nbsp;the&nbsp;(data)&nbsp;addresses&nbsp;of&nbsp;a&nbsp;destination&nbsp;and&nbsp;a&nbsp;source&nbsp;array,<br>
an&nbsp;element&nbsp;count&nbsp;and&nbsp;an&nbsp;element&nbsp;size,<br>
call&nbsp;the&nbsp;given&nbsp;copy&nbsp;constructor&nbsp;to&nbsp;copy&nbsp;each&nbsp;element&nbsp;from&nbsp;the<br>
source&nbsp;array&nbsp;to&nbsp;the&nbsp;destination&nbsp;array.<br>
If&nbsp;an&nbsp;exception&nbsp;occurs,<br>
call&nbsp;the&nbsp;given&nbsp;destructor&nbsp;on&nbsp;each&nbsp;(if&nbsp;non-NULL)&nbsp;and&nbsp;rethrow.<br>
If&nbsp;the&nbsp;destructor&nbsp;throws&nbsp;an&nbsp;exception,&nbsp;call&nbsp;&lt;code&gt;terminate()&lt;/code&gt;.<br>
The&nbsp;constructor&nbsp;and&nbsp;or&nbsp;destructor&nbsp;pointers&nbsp;may&nbsp;be&nbsp;NULL.<br>
If&nbsp;either&nbsp;is&nbsp;NULL,&nbsp;no&nbsp;action&nbsp;is&nbsp;taken&nbsp;when&nbsp;it&nbsp;would&nbsp;have&nbsp;been&nbsp;called.<br>
&lt;/dd&gt;<br>
<br>
&lt;/dl&gt;<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=ctor-order&gt;<br>
&lt;h4&gt;&nbsp;3.3.4&nbsp;Controlling&nbsp;Object&nbsp;Construction&nbsp;Order&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
&lt;h5&gt;&nbsp;3.3.4.1&nbsp;Motivation&nbsp;&lt;/h5&gt;<br>
<br>
&lt;p&gt;<br>
&lt;i&gt;<br>
The&nbsp;only&nbsp;requirement&nbsp;of&nbsp;the&nbsp;C++&nbsp;Standard&nbsp;with&nbsp;respect&nbsp;to&nbsp;file&nbsp;scope<br>
object&nbsp;construction&nbsp;order&nbsp;is&nbsp;that&nbsp;file&nbsp;scope&nbsp;objects<br>
in&nbsp;a&nbsp;single&nbsp;object&nbsp;file&nbsp;are&nbsp;constructed&nbsp;in&nbsp;declaration&nbsp;order.<br>
However,&nbsp;building&nbsp;large&nbsp;programs&nbsp;sometimes&nbsp;requires&nbsp;careful&nbsp;attention<br>
to&nbsp;construction&nbsp;ordering&nbsp;for&nbsp;objects&nbsp;in&nbsp;different&nbsp;object&nbsp;files,<br>
and&nbsp;a&nbsp;number&nbsp;of&nbsp;vendors&nbsp;have&nbsp;provided&nbsp;extra-lingual&nbsp;facilities&nbsp;to<br>
control&nbsp;it.<br>
This&nbsp;ABI&nbsp;does&nbsp;not&nbsp;require&nbsp;an&nbsp;implementation&nbsp;to&nbsp;support&nbsp;this&nbsp;capability,<br>
but&nbsp;it&nbsp;specifies&nbsp;such&nbsp;a&nbsp;facility&nbsp;for&nbsp;those&nbsp;implementations&nbsp;that&nbsp;do.<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
This&nbsp;facility&nbsp;only&nbsp;controls&nbsp;construction&nbsp;order&nbsp;within&nbsp;a&nbsp;singled&nbsp;linked<br>
object&nbsp;(executable&nbsp;or&nbsp;DSO).<br>
Construction&nbsp;order&nbsp;between&nbsp;linked&nbsp;objects&nbsp;is&nbsp;determined&nbsp;by&nbsp;the<br>
initialization&nbsp;ordering&nbsp;specified&nbsp;in&nbsp;the&nbsp;base&nbsp;ABI.<br>
<br>
&lt;p&gt;<br>
&lt;h5&gt;&nbsp;3.3.4.2&nbsp;Source&nbsp;Code&nbsp;API&nbsp;&lt;/h5&gt;<br>
<br>
&lt;p&gt;<br>
A&nbsp;user&nbsp;may&nbsp;specify&nbsp;the&nbsp;construction&nbsp;priority&nbsp;with&nbsp;the&nbsp;pragma:<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;#pragma&nbsp;priority&nbsp;(&nbsp;&lt;priority&gt;&nbsp;)<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
The&nbsp;&lt;priority&gt;&nbsp;parameter&nbsp;specifies&nbsp;a&nbsp;32-bit&nbsp;signed&nbsp;initialization<br>
priority,&nbsp;with&nbsp;lower&nbsp;numbers&nbsp;meaning&nbsp;earlier&nbsp;initialization.<br>
The&nbsp;range&nbsp;of&nbsp;priorities&nbsp;[MIN_INT&nbsp;..&nbsp;MIN_INT+1023]&nbsp;is&nbsp;reserved<br>
to&nbsp;the&nbsp;implementation.<br>
The&nbsp;pragma&nbsp;applies&nbsp;to&nbsp;all&nbsp;file&nbsp;scope&nbsp;variables&nbsp;in&nbsp;the&nbsp;file&nbsp;where&nbsp;it<br>
appears,&nbsp;from&nbsp;the&nbsp;point&nbsp;of&nbsp;appearance&nbsp;to&nbsp;the&nbsp;next&nbsp;priority&nbsp;pragma&nbsp;or<br>
the&nbsp;end&nbsp;of&nbsp;the&nbsp;file.<br>
Objects&nbsp;defined&nbsp;before&nbsp;any&nbsp;priority&nbsp;pragmas&nbsp;have&nbsp;a&nbsp;default&nbsp;priority&nbsp;of&nbsp;zero,<br>
as&nbsp;do&nbsp;initialization&nbsp;actions&nbsp;specified&nbsp;by&nbsp;other&nbsp;means,<br>
e.g.&nbsp;&lt;code&gt;DT_INIT_ARRAY&lt;/code&gt;&nbsp;entries.<br>
For&nbsp;consistency&nbsp;with&nbsp;the&nbsp;C++&nbsp;Standard&nbsp;requirements&nbsp;on&nbsp;initialization&nbsp;order,<br>
behavior&nbsp;is&nbsp;undefined&nbsp;unless&nbsp;the&nbsp;priorities&nbsp;appearing&nbsp;in&nbsp;a&nbsp;single&nbsp;file,<br>
including&nbsp;any&nbsp;default&nbsp;zero&nbsp;priorities,<br>
are&nbsp;in&nbsp;non-decreasing&nbsp;numeric&nbsp;(non-increasing&nbsp;priority)&nbsp;order.<br>
<br>
&lt;p&gt;<br>
Initialization&nbsp;entries&nbsp;with&nbsp;the&nbsp;same&nbsp;priority&nbsp;from&nbsp;different&nbsp;files<br>
(or&nbsp;from&nbsp;other&nbsp;sources&nbsp;such&nbsp;as&nbsp;link&nbsp;command&nbsp;options)<br>
will&nbsp;be&nbsp;executed&nbsp;in&nbsp;an&nbsp;unspecified&nbsp;order.<br>
<br>
&lt;p&gt;<br>
&lt;h5&gt;&nbsp;3.3.4.3&nbsp;Object&nbsp;File&nbsp;Representation&nbsp;&lt;/h5&gt;<br>
<br>
&lt;p&gt;<br>
Initialization&nbsp;priority&nbsp;is&nbsp;represented&nbsp;in&nbsp;the&nbsp;object&nbsp;file&nbsp;by&nbsp;elements<br>
of&nbsp;a&nbsp;target-specific&nbsp;section&nbsp;type,<br>
&lt;code&gt;&lt;b&gt;SHT_IA_64_PRIORITY_INIT&lt;/b&gt;&lt;/code&gt;,<br>
with&nbsp;section&nbsp;ID&nbsp;&lt;code&gt;0x79000000&lt;/code&gt;&nbsp;on&nbsp;Itanium,<br>
and&nbsp;section&nbsp;name&nbsp;&lt;code&gt;.priority_init&lt;/code&gt;,<br>
and&nbsp;attributes&nbsp;allowing&nbsp;writing&nbsp;but&nbsp;not&nbsp;execution.<br>
The&nbsp;elements&nbsp;are&nbsp;structs:<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;typedef&nbsp;struct&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ElfXX_Word&nbsp;&nbsp;&nbsp;&nbsp;pi_pri;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ElfXX_Addr&nbsp;&nbsp;&nbsp;&nbsp;pi_addr;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;ElfXX_Priority_Init;<br>
&lt;/pre&gt;&lt;/code&gt;<br>
The&nbsp;field&nbsp;&lt;code&gt;pi_addr&lt;/code&gt;&nbsp;is&nbsp;a&nbsp;function&nbsp;pointer,<br>
as&nbsp;defined&nbsp;by&nbsp;the&nbsp;base&nbsp;ABI<br>
(a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;function&nbsp;descriptor&nbsp;on&nbsp;Itanium).<br>
The&nbsp;function&nbsp;takes&nbsp;a&nbsp;single&nbsp;&lt;code&gt;unsigned&nbsp;int&lt;/code&gt;&nbsp;priority&nbsp;parameter,<br>
which&nbsp;performs&nbsp;some&nbsp;initialization&nbsp;at&nbsp;priority&nbsp;&lt;code&gt;pi_pri&lt;/code&gt;.<br>
The&nbsp;priority&nbsp;value&nbsp;is&nbsp;obtained&nbsp;from&nbsp;the&nbsp;signed&nbsp;int&nbsp;in&nbsp;the&nbsp;source&nbsp;pragma<br>
by&nbsp;subtracting&nbsp;MIN_INT,&nbsp;so&nbsp;the&nbsp;default&nbsp;priority&nbsp;is&nbsp;-MIN_INT.<br>
The&nbsp;section&nbsp;header&nbsp;field&nbsp;&lt;code&gt;sh_entsize&lt;/code&gt;&nbsp;is&nbsp;8&nbsp;for&nbsp;ELF-32,<br>
or&nbsp;16&nbsp;for&nbsp;ELF-64.<br>
<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
An&nbsp;implementation&nbsp;may&nbsp;initialize&nbsp;as&nbsp;many&nbsp;(or&nbsp;as&nbsp;few)&nbsp;objects&nbsp;of&nbsp;the<br>
same&nbsp;prioriry&nbsp;as&nbsp;it&nbsp;chooses&nbsp;in&nbsp;a&nbsp;single&nbsp;such&nbsp;initialization&nbsp;function,<br>
as&nbsp;long&nbsp;as&nbsp;the&nbsp;sequence&nbsp;of&nbsp;such&nbsp;initialization&nbsp;entries&nbsp;for&nbsp;a&nbsp;given&nbsp;file<br>
preserves&nbsp;the&nbsp;source&nbsp;code&nbsp;order&nbsp;of&nbsp;objects&nbsp;to&nbsp;be&nbsp;initialized.<br>
&lt;/i&gt;<br>
<br>
<br>
&lt;p&gt;<br>
&lt;h5&gt;&nbsp;3.3.4.4&nbsp;Runtime&nbsp;Library&nbsp;Support&nbsp;&lt;/h5&gt;<br>
<br>
&lt;p&gt;<br>
Each&nbsp;implementation&nbsp;supporting&nbsp;priority&nbsp;initialization&nbsp;shall&nbsp;provide<br>
a&nbsp;runtime&nbsp;library&nbsp;function&nbsp;with&nbsp;prototype:<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;__cxa_priority_init&nbsp;(&nbsp;ElfXX_Priority_Init&nbsp;*pi,&nbsp;int&nbsp;cnt&nbsp;);<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
It&nbsp;will&nbsp;be&nbsp;called&nbsp;with&nbsp;the&nbsp;address&nbsp;of&nbsp;a&nbsp;&lt;code&gt;cnt&lt;/code&gt;-element<br>
(sub-)vector&nbsp;of&nbsp;the&nbsp;priority&nbsp;initialization&nbsp;entries,<br>
and&nbsp;must&nbsp;call&nbsp;each&nbsp;of&nbsp;them&nbsp;in&nbsp;order.<br>
It&nbsp;will&nbsp;be&nbsp;called&nbsp;with&nbsp;the&nbsp;GP&nbsp;of&nbsp;the&nbsp;initialization&nbsp;entries.<br>
<br>
&lt;p&gt;<br>
&lt;h5&gt;&nbsp;3.3.4.5&nbsp;Linker&nbsp;Processing&nbsp;&lt;/h5&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;only&nbsp;required&nbsp;static&nbsp;linker&nbsp;processing&nbsp;is&nbsp;to&nbsp;concatenate&nbsp;the<br>
&lt;code&gt;SHT_IA_64_PRIORITY_INIT&lt;/code&gt;&nbsp;sections&nbsp;in&nbsp;link&nbsp;order,<br>
which,&nbsp;given&nbsp;equal&nbsp;section&nbsp;IDs,&nbsp;section&nbsp;names,&nbsp;and&nbsp;section&nbsp;attributes<br>
as&nbsp;specified&nbsp;above,&nbsp;is&nbsp;the&nbsp;default&nbsp;behavior&nbsp;specified&nbsp;by&nbsp;the&nbsp;generic<br>
ABI&nbsp;for&nbsp;unknown&nbsp;section&nbsp;types.<br>
<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
Given&nbsp;minimum&nbsp;static&nbsp;linker&nbsp;processing,<br>
an&nbsp;implementation&nbsp;supporting&nbsp;priority&nbsp;initialization&nbsp;would&nbsp;need&nbsp;to<br>
include&nbsp;bracketing&nbsp;files&nbsp;in&nbsp;the&nbsp;link&nbsp;command&nbsp;that<br>
(1)&nbsp;label&nbsp;the&nbsp;ends&nbsp;of&nbsp;the&nbsp;&lt;code&gt;SHT_IA_64_PRIORITY_INIT&lt;/code&gt;&nbsp;section,<br>
and&nbsp;(2)&nbsp;provide&nbsp;initial&nbsp;and&nbsp;final&nbsp;&lt;code&gt;DT_INIT_ARRAY&lt;/code&gt;&nbsp;entries.<br>
The&nbsp;initial&nbsp;&lt;code&gt;DT_INIT_ARRAY&lt;/code&gt;&nbsp;entry&nbsp;would&nbsp;need&nbsp;to&nbsp;sort&nbsp;the<br>
&lt;code&gt;SHT_IA_64_PRIORITY_INIT&lt;/code&gt;&nbsp;section&nbsp;and&nbsp;call<br>
&lt;code&gt;__cxa_priority_init&lt;/code&gt;&nbsp;to&nbsp;run&nbsp;the&nbsp;constructors&nbsp;with&nbsp;negative<br>
priority&nbsp;(in&nbsp;the&nbsp;source).<br>
The&nbsp;final&nbsp;&lt;code&gt;DT_INIT_ARRAY&lt;/code&gt;&nbsp;entry&nbsp;would&nbsp;need&nbsp;to&nbsp;call<br>
&lt;code&gt;__cxa_priority_init&lt;/code&gt;&nbsp;to&nbsp;run&nbsp;the&nbsp;constructors&nbsp;with<br>
non-negative&nbsp;priority.<br>
Other&nbsp;&lt;code&gt;DT_INIT_ARRAY&lt;/code&gt;&nbsp;entries&nbsp;would&nbsp;thus&nbsp;run&nbsp;at&nbsp;the&nbsp;proper<br>
point&nbsp;in&nbsp;the&nbsp;priority&nbsp;sequence.<br>
<br>
&lt;p&gt;<br>
A&nbsp;more&nbsp;ambitious&nbsp;linker&nbsp;implementation&nbsp;could&nbsp;sort&nbsp;the<br>
&lt;code&gt;SHT_IA_64_PRIORITY_INIT&lt;/code&gt;&nbsp;section&nbsp;at&nbsp;link&nbsp;time&nbsp;and&nbsp;fabricate<br>
the&nbsp;code&nbsp;to&nbsp;call&nbsp;&lt;code&gt;__cxa_priority_init&lt;/code&gt;&nbsp;at&nbsp;the&nbsp;beginning&nbsp;and<br>
end.<br>
At&nbsp;the&nbsp;extreme,&nbsp;it&nbsp;could&nbsp;even&nbsp;include&nbsp;other&nbsp;&lt;code&gt;DT_INIT_ARRAY&lt;/code&gt;<br>
entries&nbsp;in&nbsp;the&nbsp;&lt;code&gt;SHT_IA_64_PRIORITY_INIT&lt;/code&gt;&nbsp;sequence&nbsp;at&nbsp;the<br>
appropriate&nbsp;places&nbsp;and&nbsp;emit&nbsp;exactly&nbsp;one&nbsp;call&nbsp;to<br>
&lt;code&gt;__cxa_priority_init&lt;/code&gt;,<br>
with&nbsp;no&nbsp;other&nbsp;entries&nbsp;in&nbsp;the&nbsp;&lt;code&gt;DT_INIT_ARRAY&lt;/code&gt;&nbsp;section.<br>
<br>
&lt;/i&gt;<br>
<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=dso-dtor&gt;<br>
&lt;h4&gt;&nbsp;3.3.5&nbsp;DSO&nbsp;Object&nbsp;Destruction&nbsp;API&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
&lt;h5&gt;&nbsp;3.3.5.1&nbsp;Motivation&nbsp;&lt;/h5&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;C++&nbsp;Standard&nbsp;requires&nbsp;that&nbsp;destructors&nbsp;be&nbsp;called&nbsp;for&nbsp;global&nbsp;objects<br>
when&nbsp;a&nbsp;program&nbsp;exits&nbsp;in&nbsp;the&nbsp;opposite&nbsp;order&nbsp;of&nbsp;construction.<br>
Most&nbsp;implementations&nbsp;have&nbsp;handled&nbsp;this&nbsp;by&nbsp;calling&nbsp;the&nbsp;C&nbsp;library<br>
&lt;code&gt;atexit&lt;/code&gt;&nbsp;routine&nbsp;to&nbsp;register&nbsp;the&nbsp;destructors.<br>
This&nbsp;is&nbsp;problematic&nbsp;because&nbsp;the&nbsp;1999&nbsp;C&nbsp;Standard&nbsp;only&nbsp;requires&nbsp;that&nbsp;the<br>
implementation&nbsp;support&nbsp;32&nbsp;registered&nbsp;functions,<br>
although&nbsp;most&nbsp;implementations&nbsp;support&nbsp;many&nbsp;more.<br>
More&nbsp;important,<br>
it&nbsp;does&nbsp;not&nbsp;deal&nbsp;at&nbsp;all&nbsp;with&nbsp;the&nbsp;ability&nbsp;in&nbsp;most&nbsp;implementations&nbsp;to<br>
remove&nbsp;DSOs&nbsp;from&nbsp;a&nbsp;running&nbsp;program&nbsp;image&nbsp;by&nbsp;calling<br>
&lt;code&gt;dlclose&lt;/code&gt;&nbsp;prior&nbsp;to&nbsp;program&nbsp;termination.<br>
<br>
&lt;p&gt;<br>
The&nbsp;API&nbsp;specified&nbsp;below&nbsp;is&nbsp;intended&nbsp;to&nbsp;provide<br>
standard-conforming&nbsp;treatment&nbsp;during&nbsp;normal&nbsp;program&nbsp;exit,<br>
which&nbsp;includes&nbsp;executing&nbsp;&lt;code&gt;atexit&lt;/code&gt;-registered&nbsp;functions<br>
in&nbsp;the&nbsp;correct&nbsp;sequence&nbsp;relative&nbsp;to&nbsp;constructor-registered&nbsp;destructors,<br>
and&nbsp;reasonable&nbsp;treatment&nbsp;during&nbsp;early&nbsp;DSO&nbsp;unload&nbsp;(e.g.&nbsp;dlclose).<br>
<br>
&lt;p&gt;<br>
&lt;h5&gt;&nbsp;3.3.5.2&nbsp;Runtime&nbsp;Data&nbsp;Structure&nbsp;&lt;/h5&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;runtime&nbsp;library&nbsp;shall&nbsp;maintain&nbsp;a&nbsp;list&nbsp;of&nbsp;termination&nbsp;functions<br>
with&nbsp;the&nbsp;following&nbsp;information&nbsp;about&nbsp;each:<br>
<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;A&nbsp;function&nbsp;pointer&nbsp;(a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;function&nbsp;descriptor&nbsp;on&nbsp;Itanium).<br>
&lt;li&gt;&nbsp;A&nbsp;void*&nbsp;operand&nbsp;to&nbsp;be&nbsp;passed&nbsp;to&nbsp;the&nbsp;function.<br>
&lt;li&gt;&nbsp;A&nbsp;void*&nbsp;handle&nbsp;for&nbsp;the&nbsp;&lt;i&gt;home&nbsp;DSO&lt;/i&gt;&nbsp;of&nbsp;the&nbsp;entry&nbsp;(below).<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;representation&nbsp;of&nbsp;this&nbsp;structure&nbsp;is&nbsp;implementation&nbsp;defined.<br>
All&nbsp;references&nbsp;are&nbsp;via&nbsp;the&nbsp;API&nbsp;described&nbsp;below.<br>
<br>
&lt;p&gt;<br>
&lt;h5&gt;&nbsp;3.3.5.3&nbsp;Runtime&nbsp;API&nbsp;&lt;/h5&gt;<br>
<br>
&lt;ol&nbsp;type=A&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;Object&nbsp;construction:<br>
&lt;p&gt;<br>
After&nbsp;construcing&nbsp;a&nbsp;global&nbsp;(or&nbsp;local&nbsp;static)&nbsp;object,<br>
that&nbsp;will&nbsp;require&nbsp;destruction&nbsp;on&nbsp;exit,<br>
a&nbsp;termination&nbsp;function&nbsp;is&nbsp;&lt;i&gt;registered&lt;/i&gt;&nbsp;as&nbsp;follows:<br>
&lt;center&gt;&lt;code&gt;<br>
extern&nbsp;&quot;C&quot;&nbsp;int&nbsp;__cxa_atexit&nbsp;(&nbsp;void&nbsp;(*f)(void&nbsp;*),&nbsp;void&nbsp;*p,&nbsp;dso_handle&nbsp;d&nbsp;);<br>
&lt;/code&gt;&lt;/center&gt;<br>
This&nbsp;registration,&nbsp;e.g.&nbsp;&lt;code&gt;__cxa_atexit(f,p,d)&lt;/code&gt;,<br>
is&nbsp;intended&nbsp;to&nbsp;cause&nbsp;the&nbsp;call&nbsp;&lt;code&gt;f(p)&lt;/code&gt;&nbsp;when&nbsp;DSO&nbsp;d&nbsp;is&nbsp;unloaded,<br>
before&nbsp;all&nbsp;such&nbsp;termination&nbsp;calls&nbsp;registered&nbsp;before&nbsp;this&nbsp;one.<br>
It&nbsp;returns&nbsp;zero&nbsp;if&nbsp;registration&nbsp;is&nbsp;successful,&nbsp;nonzero&nbsp;on&nbsp;failure.<br>
<br>
&lt;p&gt;<br>
The&nbsp;registration&nbsp;function&nbsp;is&nbsp;not&nbsp;called&nbsp;from&nbsp;within&nbsp;the&nbsp;constructor.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;User&nbsp;atexit&nbsp;calls:<br>
&lt;p&gt;<br>
When&nbsp;the&nbsp;user&nbsp;registers&nbsp;exit&nbsp;functions&nbsp;with&nbsp;&lt;code&gt;atexit&lt;/code&gt;,<br>
they&nbsp;should&nbsp;be&nbsp;registered&nbsp;with&nbsp;NULL&nbsp;parameter&nbsp;and&nbsp;DSO&nbsp;handle,&nbsp;i.e.<br>
&lt;center&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;__cxa_atexit&nbsp;(&nbsp;f,&nbsp;NULL,&nbsp;NULL&nbsp;);<br>
&lt;/code&gt;&lt;/center&gt;<br>
It&nbsp;is&nbsp;expected&nbsp;that&nbsp;implementations&nbsp;supporting&nbsp;both&nbsp;C&nbsp;and&nbsp;C++&nbsp;will<br>
integrate&nbsp;this&nbsp;capability&nbsp;into&nbsp;the&nbsp;libc&nbsp;&lt;code&gt;atexit&lt;/code&gt;<br>
implementation,&nbsp;so&nbsp;that&nbsp;C-only&nbsp;DSOs&nbsp;will&nbsp;nevertheless&nbsp;interact&nbsp;with&nbsp;C++<br>
programs&nbsp;in&nbsp;a&nbsp;C++-standard-conforming&nbsp;manner.<br>
No&nbsp;user&nbsp;interface&nbsp;to&nbsp;&lt;code&gt;__cxa_atexit&lt;/code&gt;&nbsp;is&nbsp;supported,<br>
so&nbsp;the&nbsp;user&nbsp;is&nbsp;not&nbsp;able&nbsp;to&nbsp;register&nbsp;an&nbsp;&lt;code&gt;atexit&lt;/code&gt;&nbsp;function<br>
with&nbsp;a&nbsp;parameter&nbsp;or&nbsp;a&nbsp;home&nbsp;DSO.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;Termination:<br>
&lt;p&gt;<br>
When&nbsp;linking&nbsp;any&nbsp;DSO&nbsp;containing&nbsp;a&nbsp;call&nbsp;to&nbsp;&lt;code&gt;__cxa_atexit&lt;/code&gt;,<br>
the&nbsp;linker&nbsp;should&nbsp;define&nbsp;a&nbsp;hidden&nbsp;symbol&nbsp;&lt;code&gt;__dso_handle&lt;/code&gt;,<br>
with&nbsp;a&nbsp;value&nbsp;which&nbsp;is&nbsp;an&nbsp;address&nbsp;in&nbsp;one&nbsp;of&nbsp;the&nbsp;object's&nbsp;segments.<br>
(It&nbsp;does&nbsp;not&nbsp;matter&nbsp;what&nbsp;address,<br>
as&nbsp;long&nbsp;as&nbsp;they&nbsp;are&nbsp;different&nbsp;in&nbsp;different&nbsp;DSOs.)<br>
It&nbsp;should&nbsp;also&nbsp;include&nbsp;a&nbsp;call&nbsp;to&nbsp;the&nbsp;following&nbsp;function&nbsp;in&nbsp;the&nbsp;FINI<br>
list&nbsp;(to&nbsp;be&nbsp;executed&nbsp;first):<br>
&lt;center&gt;&lt;code&gt;<br>
extern&nbsp;&quot;C&quot;&nbsp;void&nbsp;__cxa_finalize&nbsp;(&nbsp;dso_handle&nbsp;d&nbsp;);<br>
&lt;/code&gt;&lt;/center&gt;<br>
The&nbsp;parameter&nbsp;passed&nbsp;should&nbsp;be&nbsp;&lt;code&gt;&amp;__dso_handle&lt;/code&gt;.<br>
<br>
&lt;p&gt;<br>
Note&nbsp;that&nbsp;the&nbsp;above&nbsp;can&nbsp;be&nbsp;accomplished&nbsp;either&nbsp;by&nbsp;explicitly&nbsp;providing<br>
the&nbsp;symbol&nbsp;and&nbsp;call&nbsp;in&nbsp;the&nbsp;linker,&nbsp;or&nbsp;by&nbsp;implicitly&nbsp;including&nbsp;a<br>
relocatable&nbsp;object&nbsp;in&nbsp;the&nbsp;link&nbsp;with&nbsp;the&nbsp;necessary&nbsp;definitions,<br>
using&nbsp;a&nbsp;.fini_array&nbsp;section&nbsp;for&nbsp;the&nbsp;FINI&nbsp;call.<br>
Also,&nbsp;note&nbsp;that&nbsp;these&nbsp;can&nbsp;be&nbsp;omitted&nbsp;for&nbsp;an&nbsp;object&nbsp;with&nbsp;no&nbsp;calls&nbsp;to<br>
&lt;code&gt;__cxa_atexit&lt;/code&gt;,&nbsp;but&nbsp;they&nbsp;can&nbsp;be&nbsp;safely&nbsp;included&nbsp;in&nbsp;all&nbsp;objects.<br>
<br>
&lt;p&gt;<br>
When&nbsp;&lt;code&gt;__cxa_finalize(d)&lt;/code&gt;&nbsp;is&nbsp;called,<br>
it&nbsp;should&nbsp;walk&nbsp;the&nbsp;termination&nbsp;function&nbsp;list,<br>
calling&nbsp;each&nbsp;in&nbsp;turn&nbsp;if&nbsp;&lt;code&gt;d&lt;/code&gt;&nbsp;matches<br>
&lt;code&gt;__dso_handle&lt;/code&gt;&nbsp;for&nbsp;the&nbsp;termination&nbsp;function&nbsp;entry.<br>
If&nbsp;&lt;code&gt;d&nbsp;==&nbsp;NULL&lt;/code&gt;,&nbsp;it&nbsp;should&nbsp;call&nbsp;all&nbsp;of&nbsp;them.<br>
Multiple&nbsp;calls&nbsp;to&nbsp;&lt;code&gt;__cxa_finalize&lt;/code&gt;&nbsp;shall&nbsp;not&nbsp;result&nbsp;in<br>
calling&nbsp;termination&nbsp;function&nbsp;entries&nbsp;multiple&nbsp;times;<br>
the&nbsp;implementation&nbsp;may&nbsp;either&nbsp;remove&nbsp;entries&nbsp;or&nbsp;mark&nbsp;them&nbsp;finished.<br>
<br>
&lt;p&gt;<br>
When&nbsp;the&nbsp;main&nbsp;program&nbsp;calls&nbsp;&lt;code&gt;exit&lt;/code&gt;,<br>
it&nbsp;must&nbsp;call&nbsp;any&nbsp;remaining&nbsp;&lt;code&gt;__cxa_atexit&lt;/code&gt;-registered&nbsp;functions,<br>
either&nbsp;by&nbsp;calling&nbsp;&lt;code&gt;__cxa_finalize(NULL)&lt;/code&gt;,<br>
or&nbsp;by&nbsp;walking&nbsp;the&nbsp;registration&nbsp;list&nbsp;itself.<br>
<br>
&lt;p&gt;<br>
Note&nbsp;that&nbsp;the&nbsp;destructors&nbsp;must&nbsp;be&nbsp;called&nbsp;by&nbsp;&lt;code&gt;__cxa_finalize()&lt;/code&gt;<br>
in&nbsp;the&nbsp;opposite&nbsp;of&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;they&nbsp;were&nbsp;enqueued&nbsp;by<br>
&lt;code&gt;__cxa_atexit&lt;/code&gt;.<br>
<br>
&lt;/ol&gt;<br>
<br>
&lt;p&gt;<br>
Since&nbsp;&lt;code&gt;__cxa_atexit&lt;/code&gt;&nbsp;and&nbsp;&lt;code&gt;__cxa_finalize&lt;/code&gt;<br>
must&nbsp;both&nbsp;manipulate&nbsp;the&nbsp;same&nbsp;termination&nbsp;function&nbsp;list,<br>
they&nbsp;must&nbsp;be&nbsp;defined&nbsp;in&nbsp;the&nbsp;implementation's&nbsp;runtime&nbsp;library,<br>
rather&nbsp;than&nbsp;in&nbsp;the&nbsp;individual&nbsp;linked&nbsp;objects.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=demangler&gt;<br>
&lt;h3&gt;&nbsp;3.4&nbsp;Demangler&nbsp;API&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
&lt;b&gt;Synopsis&lt;/b&gt;:<br>
&lt;code&gt;&lt;pre&gt;<br>
namespace&nbsp;abi&nbsp;{<br>
&nbsp;&nbsp;extern&nbsp;&quot;C&quot;&nbsp;char*&nbsp;__cxa_demangle&nbsp;(const&nbsp;char*&nbsp;mangled_name,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char*&nbsp;buf,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size_t*&nbsp;n,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int*&nbsp;status);<br>
}<br>
<br>
&lt;/code&gt;&lt;/pre&gt;<br>
<br>
&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
&lt;code&gt;mangled-name&lt;/code&gt;<br>
is&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;null-terminated&nbsp;array&nbsp;of&nbsp;characters.<br>
It&nbsp;may&nbsp;be&nbsp;either&nbsp;an&nbsp;external&nbsp;name,&nbsp;i.e.&nbsp;with&nbsp;a&nbsp;&quot;_Z&quot;&nbsp;prefix,<br>
or&nbsp;an&nbsp;internal&nbsp;NTBS&nbsp;mangling,&nbsp;e.g.&nbsp;of&nbsp;a&nbsp;type&nbsp;for&nbsp;type_info.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
&lt;code&gt;buf&lt;/code&gt;&nbsp;may&nbsp;be&nbsp;null.<br>
If&nbsp;it&nbsp;is&nbsp;non-null,&nbsp;then&nbsp;&lt;code&gt;n&lt;/code&gt;&nbsp;must&nbsp;also&nbsp;be&nbsp;nonnull,<br>
and&nbsp;buf&nbsp;is&nbsp;a&nbsp;pointer&nbsp;to&nbsp;an&nbsp;array,&nbsp;of&nbsp;at&nbsp;least&nbsp;*n&nbsp;characters,<br>
that&nbsp;was&nbsp;allocated&nbsp;using&nbsp;malloc.<br>
<br>
&lt;p&gt;<br>
&lt;li&gt;<br>
&lt;code&gt;status&lt;/code&gt;&nbsp;points&nbsp;to&nbsp;an&nbsp;int&nbsp;that's&nbsp;used&nbsp;as&nbsp;an&nbsp;error&nbsp;indicator.<br>
It&nbsp;is&nbsp;permitted&nbsp;to&nbsp;be&nbsp;null,<br>
in&nbsp;which&nbsp;case&nbsp;the&nbsp;user&nbsp;just&nbsp;doesn't&nbsp;get&nbsp;any&nbsp;detailed&nbsp;error&nbsp;information.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
&lt;b&gt;Behavior&lt;/b&gt;:<br>
The&nbsp;return&nbsp;value&nbsp;is&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;null-terminated&nbsp;array&nbsp;of&nbsp;characters,&nbsp;the&nbsp;demangled&nbsp;name.<br>
Ambiguities&nbsp;are&nbsp;possible&nbsp;between&nbsp;extern&nbsp;&quot;C&quot;&nbsp;object&nbsp;names&nbsp;and&nbsp;internal<br>
built-in&nbsp;type&nbsp;names,<br>
e.g.&nbsp;&quot;i&quot;&nbsp;may&nbsp;be&nbsp;either&nbsp;an&nbsp;object&nbsp;named&nbsp;&quot;i&quot;&nbsp;or&nbsp;the&nbsp;built-in&nbsp;&quot;int&quot;&nbsp;type.<br>
Such&nbsp;ambiguities&nbsp;should&nbsp;be&nbsp;resolved&nbsp;to&nbsp;user&nbsp;names&nbsp;over&nbsp;built-in&nbsp;names.<br>
<br>
&lt;p&gt;<br>
If&nbsp;there&nbsp;is&nbsp;an&nbsp;error&nbsp;in&nbsp;demangling,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;a&nbsp;null&nbsp;pointer.<br>
The&nbsp;user&nbsp;can&nbsp;examine&nbsp;*status&nbsp;to&nbsp;find&nbsp;out&nbsp;what&nbsp;kind&nbsp;of&nbsp;error&nbsp;occurred.<br>
Meaning&nbsp;of&nbsp;error&nbsp;indications:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;0:&nbsp;&nbsp;success<br>
&lt;li&gt;&nbsp;-1:&nbsp;memory&nbsp;allocation&nbsp;failure<br>
&lt;li&gt;&nbsp;-2:&nbsp;invalid&nbsp;mangled&nbsp;name<br>
&lt;li&gt;&nbsp;-3:&nbsp;invalid&nbsp;arguments&nbsp;(e.g.&nbsp;buf&nbsp;nonnull&nbsp;and&nbsp;n&nbsp;null)<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
&lt;b&gt;Memory&nbsp;management&lt;/b&gt;:&nbsp;&lt;ul&gt;<br>
&lt;li&gt;&nbsp;If&nbsp;buf&nbsp;is&nbsp;a&nbsp;null&nbsp;pointer,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;code&gt;__cxa_demangle&lt;/code&gt;&nbsp;allocates&nbsp;a&nbsp;new&nbsp;buffer&nbsp;with&nbsp;malloc.<br>
&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;stores&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;buffer&nbsp;in&nbsp;*n,&nbsp;if&nbsp;n&nbsp;is&nbsp;nonnull.<br>
&lt;li&gt;&nbsp;If&nbsp;buf&nbsp;is&nbsp;not&nbsp;a&nbsp;null&nbsp;pointer,<br>
&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;must&nbsp;have&nbsp;been&nbsp;allocated&nbsp;with&nbsp;malloc.<br>
&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;the&nbsp;array&nbsp;turns&nbsp;out&nbsp;to&nbsp;be&nbsp;too&nbsp;small,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;code&gt;__cxa_demangle&lt;/code&gt;&nbsp;may&nbsp;use&nbsp;realloc&nbsp;to&nbsp;increase&nbsp;its&nbsp;size.<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;new&nbsp;size&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;*n.<br>
&lt;/ul&gt;<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=layout&gt;<br>
&lt;h2&gt;&nbsp;Chapter&nbsp;4:&nbsp;Exception&nbsp;Handling&nbsp;&lt;/h2&gt;<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
See&nbsp;&lt;a&nbsp;href=abi-eh.html&gt;Exception&nbsp;Handling&lt;/a&gt;&nbsp;document,<br>
currently&nbsp;just&nbsp;the&nbsp;base&nbsp;psABI-level&nbsp;material,<br>
and&nbsp;the<br>
HP&nbsp;&lt;a&nbsp;href=exceptions.pdf&gt;exception&nbsp;handling&lt;/a&gt;&nbsp;working&nbsp;paper,<br>
8&nbsp;December&nbsp;1999.<br>
<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=layout&gt;<br>
&lt;h2&gt;&nbsp;Chapter&nbsp;5:&nbsp;Linkage&nbsp;and&nbsp;Object&nbsp;Files&nbsp;&lt;/h2&gt;<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
<br>
<br>
&lt;a&nbsp;name=mangling&gt;<br>
&lt;h3&gt;&nbsp;5.1&nbsp;External&nbsp;Names&nbsp;(a.k.a.&nbsp;Mangling)&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;5.1.1&nbsp;General&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
This&nbsp;section&nbsp;specifies&nbsp;the&nbsp;&lt;i&gt;mangling&lt;/i&gt;,&nbsp;i.e.&nbsp;encoding,<br>
of&nbsp;external&nbsp;names<br>
(external&nbsp;in&nbsp;the&nbsp;sense&nbsp;of&nbsp;being&nbsp;visible&nbsp;outside&nbsp;the&nbsp;object&nbsp;file&nbsp;where<br>
they&nbsp;occur).<br>
The&nbsp;encoding&nbsp;is&nbsp;formalized&nbsp;as&nbsp;a&nbsp;derivation&nbsp;grammar&nbsp;along&nbsp;with&nbsp;the<br>
explanatory&nbsp;text,<br>
in&nbsp;a&nbsp;modified&nbsp;BNF&nbsp;with&nbsp;the&nbsp;following&nbsp;conventions:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;Non-terminals&nbsp;are&nbsp;delimited&nbsp;by&nbsp;diamond&nbsp;braces:&nbsp;&quot;&lt;&gt;&quot;.<br>
&lt;li&gt;&nbsp;Italics&nbsp;in&nbsp;non-terminals&nbsp;are&nbsp;modifiers&nbsp;to&nbsp;be&nbsp;ignored,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.g.&nbsp;&lt;&lt;i&gt;function&lt;/i&gt;&nbsp;name&gt;&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;&lt;name&gt;.<br>
&lt;li&gt;&nbsp;Spaces&nbsp;are&nbsp;to&nbsp;be&nbsp;ignored.<br>
&lt;li&gt;&nbsp;Text&nbsp;beginning&nbsp;with&nbsp;'#'&nbsp;is&nbsp;comments,&nbsp;to&nbsp;be&nbsp;ignored.<br>
&lt;li&gt;&nbsp;Tokens&nbsp;in&nbsp;square&nbsp;brackets&nbsp;&quot;[]&quot;&nbsp;are&nbsp;optional.<br>
&lt;li&gt;&nbsp;Tokens&nbsp;are&nbsp;placed&nbsp;in&nbsp;parentheses&nbsp;&quot;()&quot;&nbsp;for&nbsp;grouping&nbsp;purposes.<br>
&lt;li&gt;&nbsp;'*'&nbsp;repeats&nbsp;the&nbsp;preceding&nbsp;item&nbsp;0&nbsp;or&nbsp;more&nbsp;times.<br>
&lt;li&gt;&nbsp;'+'&nbsp;repeats&nbsp;the&nbsp;preceding&nbsp;item&nbsp;1&nbsp;or&nbsp;more&nbsp;times.<br>
&lt;li&gt;&nbsp;All&nbsp;other&nbsp;characters&nbsp;are&nbsp;terminals,&nbsp;representing&nbsp;themselves.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
See&nbsp;the&nbsp;separate&nbsp;&lt;a&nbsp;href=abi-mangling.html&gt;table&lt;/a&gt;<br>
summarizing&nbsp;the&nbsp;encoding&nbsp;characters&nbsp;used&nbsp;as&nbsp;terminals.<br>
Also&nbsp;see&nbsp;additional&nbsp;&lt;a&nbsp;href=abi-examples.html#mangling&gt;mangling&nbsp;examples&lt;/a&gt;<br>
in&nbsp;the&nbsp;separate&nbsp;ABI&nbsp;examples&nbsp;document.<br>
<br>
&lt;p&gt;<br>
In&nbsp;the&nbsp;various&nbsp;explanatory&nbsp;examples,<br>
we&nbsp;use&nbsp;&lt;code&gt;Ret?&lt;/code&gt;&nbsp;for&nbsp;an&nbsp;unknown&nbsp;function&nbsp;return&nbsp;type<br>
(i.e.&nbsp;that&nbsp;is&nbsp;not&nbsp;given&nbsp;by&nbsp;the&nbsp;mangling),<br>
or&nbsp;&lt;code&gt;Type?&lt;/code&gt;&nbsp;for&nbsp;an&nbsp;unknown&nbsp;data&nbsp;type.<br>
<br>
&lt;p&gt;<br>
&lt;h4&gt;&nbsp;5.1.2&nbsp;General&nbsp;Structure&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
Entities&nbsp;with&nbsp;C&nbsp;linkage&nbsp;and&nbsp;global&nbsp;namespace&nbsp;variables&nbsp;are&nbsp;not&nbsp;mangled.<br>
Mangled&nbsp;names&nbsp;have&nbsp;the&nbsp;general&nbsp;structure:<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;mangled-name&gt;&nbsp;::=&nbsp;_Z&nbsp;&lt;encoding&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;encoding&gt;&nbsp;::=&nbsp;&lt;&lt;i&gt;function&lt;/i&gt;&nbsp;name&gt;&nbsp;&lt;bare-function-type&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;&lt;i&gt;data&lt;/i&gt;&nbsp;name&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;special-name&gt;<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
Thus,&nbsp;a&nbsp;name&nbsp;is&nbsp;mangled&nbsp;by&nbsp;prefixing&nbsp;&quot;_Z&quot;&nbsp;to&nbsp;an&nbsp;encoding&nbsp;of&nbsp;its&nbsp;name,<br>
and&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;functions&nbsp;its&nbsp;type&nbsp;(to&nbsp;support&nbsp;overloading).<br>
At&nbsp;this&nbsp;top&nbsp;level,<br>
function&nbsp;types&nbsp;do&nbsp;not&nbsp;have&nbsp;the&nbsp;special&nbsp;delimiter&nbsp;characters&nbsp;required<br>
when&nbsp;nested&nbsp;(see&nbsp;below).<br>
The&nbsp;type&nbsp;is&nbsp;omitted&nbsp;for&nbsp;variables&nbsp;and&nbsp;static&nbsp;data&nbsp;members.<br>
<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;name&gt;&nbsp;::=&nbsp;&lt;nested-name&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;unscoped-name&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;unscoped-template-name&gt;&nbsp;&lt;template-args&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;local-name&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;See&nbsp;&lt;a&nbsp;href=#mangling-scope&gt;Scope&nbsp;Encoding&lt;/a&gt;&nbsp;below<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;unscoped-name&gt;&nbsp;::=&nbsp;&lt;unqualified-name&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;St&nbsp;&lt;unqualified-name&gt;&nbsp;&nbsp;&nbsp;#&nbsp;::std::<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;unscoped-template-name&gt;&nbsp;::=&nbsp;&lt;unscoped-name&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;substitution&gt;<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
Names&nbsp;of&nbsp;objects&nbsp;nested&nbsp;in&nbsp;namespaces&nbsp;or&nbsp;classes&nbsp;are&nbsp;identified&nbsp;as&nbsp;a<br>
delimited&nbsp;sequence&nbsp;of&nbsp;names&nbsp;identifying&nbsp;the&nbsp;enclosing&nbsp;scopes.<br>
In&nbsp;addition,&nbsp;when&nbsp;naming&nbsp;a&nbsp;class&nbsp;member&nbsp;function,<br>
CV-qualifiers&nbsp;may&nbsp;be&nbsp;prefixed&nbsp;to&nbsp;the&nbsp;compound&nbsp;name,<br>
encoding&nbsp;the&nbsp;&lt;code&gt;this&lt;/code&gt;&nbsp;attributes.<br>
Note&nbsp;that&nbsp;if&nbsp;member&nbsp;function&nbsp;CV-qualifiers&nbsp;are&nbsp;required,<br>
the&nbsp;delimited&nbsp;form&nbsp;must&nbsp;be&nbsp;used&nbsp;even&nbsp;if&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;name&nbsp;is<br>
a&nbsp;single&nbsp;substitution.<br>
<br>
&lt;pre&gt;&lt;code&gt;&lt;font&nbsp;color=blue&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;nested-name&gt;&nbsp;::=&nbsp;N&nbsp;[&lt;CV-qualifiers&gt;]&nbsp;&lt;prefix&gt;&nbsp;&lt;unqualified-name&gt;&nbsp;E<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;N&nbsp;[&lt;CV-qualifiers&gt;]&nbsp;&lt;template-prefix&gt;&nbsp;&lt;template-args&gt;&nbsp;E<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;prefix&gt;&nbsp;::=&nbsp;&lt;prefix&gt;&nbsp;&lt;unqualified-name&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;template-prefix&gt;&nbsp;&lt;template-args&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;#&nbsp;empty<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;substitution&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;template-prefix&gt;&nbsp;::=&nbsp;&lt;prefix&gt;&nbsp;&lt;&lt;i&gt;template&lt;/i&gt;&nbsp;unqualified-name&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;substitution&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;unqualified-name&gt;&nbsp;::=&nbsp;&lt;operator-name&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;ctor-dtor-name&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;source-name&gt;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;source-name&gt;&nbsp;::=&nbsp;&lt;&lt;i&gt;positive&nbsp;length&lt;/i&gt;&nbsp;number&gt;&nbsp;&lt;identifier&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;number&gt;&nbsp;::=&nbsp;[n]&nbsp;&lt;&lt;i&gt;non-negative&nbsp;decimal&nbsp;integer&lt;/i&gt;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;identifier&gt;&nbsp;::=&nbsp;&lt;&lt;i&gt;unqualified&nbsp;source&nbsp;code&nbsp;identifier&lt;/i&gt;&gt;<br>
<br>
&lt;/pre&gt;&lt;/code&gt;&lt;/font&gt;<br>
<br>
&lt;p&gt;<br>
&lt;number&gt;&nbsp;is&nbsp;a&nbsp;pseudo-terminal&nbsp;representing&nbsp;a&nbsp;decimal&nbsp;integer,<br>
with&nbsp;a&nbsp;leading&nbsp;'n'&nbsp;for&nbsp;negative&nbsp;integers.<br>
It&nbsp;is&nbsp;used&nbsp;in&nbsp;&lt;source-name&gt;&nbsp;to&nbsp;provide&nbsp;the&nbsp;byte<br>
length&nbsp;of&nbsp;the&nbsp;following&nbsp;identifier.<br>
&lt;number&gt;s&nbsp;appearing&nbsp;in&nbsp;mangled&nbsp;names&nbsp;never&nbsp;have&nbsp;leading&nbsp;zeroes,<br>
except&nbsp;for&nbsp;the&nbsp;value&nbsp;zero,&nbsp;represented&nbsp;as&nbsp;'0'.<br>
&lt;identifier&gt;&nbsp;is&nbsp;a&nbsp;pseudo-terminal&nbsp;representing&nbsp;the&nbsp;unqualified<br>
identifier&nbsp;for&nbsp;the&nbsp;entity&nbsp;in&nbsp;the&nbsp;source&nbsp;code.<br>
<br>
&lt;p&gt;<br>
Note&nbsp;that&nbsp;&lt;source-name&gt;&nbsp;in&nbsp;the&nbsp;productions&nbsp;for&nbsp;&lt;unqualified-name&gt;<br>
may&nbsp;be&nbsp;either&nbsp;a&nbsp;function&nbsp;or&nbsp;data&nbsp;object&nbsp;name&nbsp;when&nbsp;derived&nbsp;from&nbsp;&lt;name&gt;,<br>
or&nbsp;a&nbsp;class&nbsp;or&nbsp;enum&nbsp;name&nbsp;when&nbsp;derived&nbsp;from&nbsp;&lt;type&gt;.<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=mangling-operator&gt;<br>
&lt;h4&gt;&nbsp;5.1.3&nbsp;Operator&nbsp;Encodings&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
Operators&nbsp;appear&nbsp;as&nbsp;function&nbsp;names,<br>
and&nbsp;in&nbsp;nontype&nbsp;template&nbsp;argument&nbsp;expressions.<br>
Unlike&nbsp;Cfront,<br>
unary&nbsp;and&nbsp;binary&nbsp;operators&nbsp;using&nbsp;the&nbsp;same&nbsp;symbol&nbsp;have&nbsp;different&nbsp;encodings.<br>
All&nbsp;operators&nbsp;are&nbsp;encoded&nbsp;using&nbsp;exactly&nbsp;two&nbsp;letters,<br>
the&nbsp;first&nbsp;of&nbsp;which&nbsp;is&nbsp;lowercase.<br>
<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&lt;operator-name&gt;&nbsp;::=&nbsp;nw&nbsp;&nbsp;#&nbsp;new&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;na&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;new[]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;dl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;delete&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;da&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;delete[]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;ng&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;-&nbsp;(unary)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;ad&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&amp;&nbsp;(unary)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;de&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;*&nbsp;(unary)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;co&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;~&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;pl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;mi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;ml&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;dv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;rm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;an&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;or&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;eo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;^&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;aS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;pL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;+=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;mI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;-=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;mL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;*=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;dV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;/=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;rM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;%=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;aN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&amp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;oR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;|=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;eO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;^=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;ls&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&lt;&lt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;rs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;lS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&lt;&lt;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;rS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&gt;&gt;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;eq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;==&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;ne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;!=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;lt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&lt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;gt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;le&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&lt;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;ge&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&gt;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;nt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;!&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;aa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&amp;&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;oo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;||&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;pp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;++&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;mm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;cm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;pm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;-&gt;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;pt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;-&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;cl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;ix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;[]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;qu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;sz&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;sizeof&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;sr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;scope&nbsp;resolution&nbsp;(::),&nbsp;see&nbsp;below&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;cv&nbsp;&lt;type&gt;&nbsp;&nbsp;&nbsp;#&nbsp;(cast)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;v&nbsp;&lt;digit&gt;&nbsp;&lt;source-name&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;vendor&nbsp;extended&nbsp;operator<br>
<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;scope&nbsp;resolution&nbsp;operator&nbsp;is&nbsp;discussed&nbsp;with&nbsp;expressions&nbsp;below.<br>
Vendors&nbsp;who&nbsp;define&nbsp;builtin&nbsp;extended&nbsp;operators&nbsp;(e.g.&nbsp;__alignof)<br>
shall&nbsp;encode&nbsp;them&nbsp;as&nbsp;a&nbsp;'v'&nbsp;prefix&nbsp;followed&nbsp;by<br>
the&nbsp;operand&nbsp;count&nbsp;as&nbsp;a&nbsp;single&nbsp;decimal&nbsp;digit,&nbsp;and<br>
the&nbsp;name&nbsp;in&nbsp;&lt;length,ID&gt;&nbsp;form.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=mangling-special&gt;<br>
&lt;h4&gt;&nbsp;5.1.4&nbsp;Other&nbsp;Special&nbsp;Functions&nbsp;and&nbsp;Entities&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
Associated&nbsp;with&nbsp;a&nbsp;virtual&nbsp;table&nbsp;are&nbsp;several&nbsp;entities&nbsp;with&nbsp;mangled<br>
external&nbsp;names:&nbsp;the&nbsp;virtual&nbsp;table&nbsp;itself,&nbsp;the&nbsp;VTT&nbsp;for&nbsp;construction,<br>
the&nbsp;typeinfo&nbsp;structure,&nbsp;and&nbsp;the&nbsp;name&nbsp;it&nbsp;references.<br>
Each&nbsp;has&nbsp;a&nbsp;&lt;special-name&gt;&nbsp;encoding&nbsp;that&nbsp;is&nbsp;a&nbsp;simple&nbsp;two-character&nbsp;code,<br>
prefixed&nbsp;to&nbsp;the&nbsp;type&nbsp;encoding&nbsp;for&nbsp;the&nbsp;class&nbsp;to&nbsp;which&nbsp;it&nbsp;applies.<br>
<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&lt;special-name&gt;&nbsp;::=&nbsp;TV&nbsp;&lt;type&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;virtual&nbsp;table<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;TT&nbsp;&lt;type&gt;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;VTT&nbsp;structure&nbsp;(construction&nbsp;vtable&nbsp;index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;TI&nbsp;&lt;type&gt;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;typeinfo&nbsp;structure<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;TS&nbsp;&lt;type&gt;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;typeinfo&nbsp;name&nbsp;(null-terminated&nbsp;byte&nbsp;string)<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
Initialization&nbsp;of&nbsp;function-scope&nbsp;static&nbsp;objects&nbsp;requires<br>
a&nbsp;guard&nbsp;variable&nbsp;to&nbsp;prevent&nbsp;multiple&nbsp;initialization.<br>
These&nbsp;are&nbsp;mangled&nbsp;as&nbsp;a&nbsp;'GV'&nbsp;prefix&nbsp;with&nbsp;the&nbsp;mangled&nbsp;name&nbsp;of&nbsp;the&nbsp;object<br>
being&nbsp;guarded.<br>
<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&lt;special-name&gt;&nbsp;::=&nbsp;GV&nbsp;&lt;&lt;i&gt;object&lt;/i&gt;&nbsp;name&gt;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Guard&nbsp;variable&nbsp;for&nbsp;one-time&nbsp;initialization<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;No&nbsp;&lt;type&gt;<br>
<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
Virtual&nbsp;function&nbsp;override&nbsp;thunks&nbsp;come&nbsp;in&nbsp;two&nbsp;forms.<br>
Those&nbsp;overriding&nbsp;from&nbsp;a&nbsp;non-virtual&nbsp;base,<br>
with&nbsp;fixed&nbsp;&lt;code&gt;this&lt;/code&gt;&nbsp;adjustments,<br>
use&nbsp;a&nbsp;&quot;Th&quot;&nbsp;prefix&nbsp;and&nbsp;encode&nbsp;the&nbsp;required&nbsp;adjustment&nbsp;offset,<br>
probably&nbsp;negative,&nbsp;indicated&nbsp;by&nbsp;a&nbsp;'n'&nbsp;prefix,<br>
and&nbsp;the&nbsp;encoding&nbsp;of&nbsp;the&nbsp;target&nbsp;function.<br>
Those&nbsp;overriding&nbsp;from&nbsp;a&nbsp;virtual&nbsp;base&nbsp;must&nbsp;encode&nbsp;two&nbsp;offsets<br>
after&nbsp;a&nbsp;&quot;Tv&quot;&nbsp;prefix.<br>
The&nbsp;first&nbsp;is&nbsp;the&nbsp;constant&nbsp;adjustment&nbsp;to&nbsp;the&nbsp;nearest&nbsp;virtual&nbsp;base<br>
(of&nbsp;the&nbsp;full&nbsp;object),<br>
of&nbsp;which&nbsp;the&nbsp;defining&nbsp;object&nbsp;is&nbsp;a&nbsp;non-virtual&nbsp;base.<br>
It&nbsp;is&nbsp;coded&nbsp;like&nbsp;the&nbsp;non-virtual&nbsp;case,<br>
with&nbsp;a&nbsp;'n'&nbsp;prefix&nbsp;if&nbsp;negative.<br>
The&nbsp;second&nbsp;offset&nbsp;identifies&nbsp;the&nbsp;vcall&nbsp;offset&nbsp;in&nbsp;the&nbsp;nearest&nbsp;virtual&nbsp;base,<br>
which&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;finish&nbsp;adjusting&nbsp;&lt;code&gt;this&lt;/code&gt;&nbsp;to&nbsp;the&nbsp;full&nbsp;object.<br>
After&nbsp;these&nbsp;two&nbsp;offsets&nbsp;comes&nbsp;the&nbsp;encoding&nbsp;of&nbsp;the&nbsp;target&nbsp;function.<br>
The&nbsp;target&nbsp;function&nbsp;encodings&nbsp;of&nbsp;both&nbsp;thunks&nbsp;incorporate&nbsp;the&nbsp;function&nbsp;type;<br>
no&nbsp;additional&nbsp;type&nbsp;is&nbsp;encoded&nbsp;for&nbsp;the&nbsp;thunk&nbsp;itself.<br>
<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&lt;special-name&gt;&nbsp;::=&nbsp;T&nbsp;&lt;call-offset&gt;&nbsp;&lt;&lt;i&gt;base&lt;/i&gt;&nbsp;encoding&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&lt;i&gt;base&lt;/i&gt;&nbsp;is&nbsp;the&nbsp;nominal&nbsp;target&nbsp;function&nbsp;of&nbsp;thunk<br>
&nbsp;&nbsp;&lt;call-offset&gt;&nbsp;::=&nbsp;h&nbsp;&lt;nv-offset&gt;&nbsp;_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;v&nbsp;&lt;v-offset&gt;&nbsp;_<br>
&nbsp;&nbsp;&lt;nv-offset&gt;&nbsp;::=&nbsp;&lt;&lt;i&gt;offset&lt;/i&gt;&nbsp;number&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;non-virtual&nbsp;base&nbsp;override<br>
&nbsp;&nbsp;&lt;v-offset&gt;&nbsp;&nbsp;::=&nbsp;&lt;&lt;i&gt;offset&lt;/i&gt;&nbsp;number&gt;&nbsp;_&nbsp;&lt;&lt;i&gt;virtual&nbsp;offset&lt;/i&gt;&nbsp;number&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;virtual&nbsp;base&nbsp;override,&nbsp;with&nbsp;vcall&nbsp;offset<br>
<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
Virtual&nbsp;function&nbsp;override&nbsp;thunks&nbsp;with&nbsp;covariant&nbsp;returns&nbsp;are&nbsp;twice&nbsp;as&nbsp;complex.&nbsp;&nbsp;Just&nbsp;as&nbsp;normal&nbsp;virtual&nbsp;function&nbsp;override&nbsp;thunks&nbsp;must&nbsp;adjust&nbsp;the&nbsp;&lt;i&gt;this&lt;/i&gt;<br>
pointer&nbsp;before&nbsp;calling&nbsp;the&nbsp;base&nbsp;function,<br>
those&nbsp;with&nbsp;covariant&nbsp;returns&nbsp;must&nbsp;adjust&nbsp;the&nbsp;return&nbsp;pointer&nbsp;after&nbsp;they<br>
return&nbsp;from&nbsp;the&nbsp;base&nbsp;function.<br>
So&nbsp;the&nbsp;mangling&nbsp;must&nbsp;also&nbsp;encode&nbsp;a&nbsp;fixed&nbsp;offset&nbsp;to&nbsp;a&nbsp;non-virtual&nbsp;base,<br>
and&nbsp;possibly&nbsp;an&nbsp;offset&nbsp;to&nbsp;a&nbsp;vbase&nbsp;offset&nbsp;in&nbsp;the&nbsp;vtable&nbsp;to&nbsp;get&nbsp;to&nbsp;the<br>
virtual&nbsp;base&nbsp;containing&nbsp;the&nbsp;result&nbsp;subobject.<br>
We&nbsp;achieve&nbsp;this&nbsp;by&nbsp;encoding&nbsp;two&nbsp;&lt;call-offset&gt;&nbsp;components,<br>
either&nbsp;of&nbsp;which&nbsp;may&nbsp;be&nbsp;either&nbsp;virtual&nbsp;or&nbsp;non-virtual.<br>
<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&lt;special-name&gt;&nbsp;::=&nbsp;Tc&nbsp;&lt;call-offset&gt;&nbsp;&lt;call-offset&gt;&nbsp;&lt;&lt;i&gt;base&lt;/i&gt;&nbsp;encoding&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&lt;i&gt;base&lt;/i&gt;&nbsp;is&nbsp;the&nbsp;nominal&nbsp;target&nbsp;function&nbsp;of&nbsp;thunk<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;first&nbsp;&lt;i&gt;call-offset&lt;/i&gt;&nbsp;is&nbsp;'this'&nbsp;adjustment<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;second&nbsp;&lt;i&gt;call-offset&lt;/i&gt;&nbsp;is&nbsp;result&nbsp;adjustment<br>
<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
Constructors&nbsp;and&nbsp;destructors&nbsp;are&nbsp;simply&nbsp;special&nbsp;cases&nbsp;of<br>
&lt;unqualified-name&gt;,<br>
where&nbsp;the&nbsp;final&nbsp;&lt;unqualified-name&gt;&nbsp;of&nbsp;a&nbsp;nested&nbsp;name<br>
is&nbsp;replaced&nbsp;by&nbsp;one&nbsp;of&nbsp;the&nbsp;following:<br>
<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&lt;ctor-dtor-name&gt;&nbsp;::=&nbsp;C1&nbsp;#&nbsp;complete&nbsp;object&nbsp;(in-charge)&nbsp;constructor<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;base&nbsp;object&nbsp;(not-in-charge)&nbsp;constructor<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;complete&nbsp;object&nbsp;(in-charge)&nbsp;allocating&nbsp;constructor<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;deleting&nbsp;(in-charge)&nbsp;destructor<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;D1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;complete&nbsp;object&nbsp;(in-charge)&nbsp;destructor<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;D2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;base&nbsp;object&nbsp;(not-in-charge)&nbsp;destructor<br>
<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=mangling-type&gt;<br>
&lt;h4&gt;&nbsp;5.1.5&nbsp;Type&nbsp;encodings&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
Types&nbsp;are&nbsp;encoded&nbsp;as&nbsp;follows:<br>
<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&lt;type&gt;&nbsp;::=&nbsp;&lt;builtin-type&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;function-type&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;class-enum-type&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;array-type&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;pointer-to-member-type&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;template-param&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;template-template-param&gt;&nbsp;&lt;template-args&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;substitution&gt;&nbsp;#&nbsp;See&nbsp;&lt;a&nbsp;href=#mangling-compression&gt;Compression&lt;/a&gt;&nbsp;below<br>
<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
Types&nbsp;are&nbsp;qualified&nbsp;(optionally)&nbsp;by&nbsp;single-character&nbsp;prefixes&nbsp;encoding<br>
cv-qualifiers&nbsp;and/or&nbsp;pointer,&nbsp;reference,&nbsp;complex,&nbsp;or&nbsp;imaginary&nbsp;types:<br>
<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&lt;type&gt;&nbsp;::=&nbsp;&lt;CV-qualifiers&gt;&nbsp;&lt;type&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;P&nbsp;&lt;type&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;pointer-to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;R&nbsp;&lt;type&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;reference-to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;C&nbsp;&lt;type&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;complex&nbsp;pair&nbsp;(C&nbsp;2000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;G&nbsp;&lt;type&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;imaginary&nbsp;(C&nbsp;2000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;U&nbsp;&lt;source-name&gt;&nbsp;&lt;type&gt;&nbsp;#&nbsp;vendor&nbsp;extended&nbsp;type&nbsp;qualifier<br>
<br>
&nbsp;&nbsp;&lt;CV-qualifiers&gt;&nbsp;::=&nbsp;[r]&nbsp;[V]&nbsp;[K]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;restrict&nbsp;(C99),&nbsp;volatile,&nbsp;const<br>
<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
Vendors&nbsp;who&nbsp;define&nbsp;extended&nbsp;type&nbsp;qualifiers&nbsp;(e.g.&nbsp;_near,&nbsp;_far&nbsp;for&nbsp;pointers)<br>
shall&nbsp;encode&nbsp;them&nbsp;as&nbsp;a&nbsp;'U'&nbsp;prefix&nbsp;followed&nbsp;by&nbsp;the&nbsp;name&nbsp;in&nbsp;&lt;length,ID&gt;&nbsp;form.<br>
<br>
&lt;p&gt;<br>
In&nbsp;cases&nbsp;where&nbsp;multiple&nbsp;order-insensitive&nbsp;qualifiers&nbsp;are&nbsp;present,<br>
they&nbsp;should&nbsp;be&nbsp;ordered&nbsp;'K'&nbsp;(closest&nbsp;to&nbsp;the&nbsp;base&nbsp;type),&nbsp;'V',&nbsp;'r',&nbsp;and<br>
'U'&nbsp;(farthest&nbsp;from&nbsp;the&nbsp;base&nbsp;type),&nbsp;with&nbsp;the&nbsp;'U'&nbsp;qualifiers&nbsp;in<br>
alphabetical&nbsp;order&nbsp;by&nbsp;the&nbsp;vendor&nbsp;name<br>
(with&nbsp;alphabetically&nbsp;earlier&nbsp;names&nbsp;closer&nbsp;to&nbsp;the&nbsp;base&nbsp;type).<br>
For&nbsp;example,&nbsp;&lt;code&gt;int*&nbsp;volatile&nbsp;const&nbsp;restrict&nbsp;_far&nbsp;p&lt;/code&gt;<br>
has&nbsp;mangled&nbsp;type&nbsp;name&nbsp;&lt;code&gt;U4_farrVKPi&lt;/code&gt;.<br>
<br>
&lt;p&gt;<br>
&lt;i&gt;<br>
Vendors&nbsp;must&nbsp;therefore&nbsp;specify&nbsp;which&nbsp;of&nbsp;their&nbsp;extended&nbsp;qualifiers&nbsp;are<br>
considered&nbsp;order-insensitive,<br>
not&nbsp;necessarily&nbsp;on&nbsp;the&nbsp;basis&nbsp;of&nbsp;whether&nbsp;their&nbsp;language&nbsp;translators<br>
impose&nbsp;an&nbsp;order&nbsp;in&nbsp;source&nbsp;code.<br>
They&nbsp;are&nbsp;encouraged&nbsp;to&nbsp;resolve&nbsp;questionable&nbsp;cases&nbsp;as&nbsp;being<br>
order-insensitive&nbsp;to&nbsp;maximize&nbsp;consistency&nbsp;in&nbsp;mangling.<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
&lt;i&gt;<br>
For&nbsp;purposes&nbsp;of&nbsp;substitution,<br>
given&nbsp;a&nbsp;CV-qualified&nbsp;type,<br>
the&nbsp;base&nbsp;type&nbsp;is&nbsp;substitutible,<br>
and&nbsp;the&nbsp;type&nbsp;with&nbsp;all&nbsp;the&nbsp;C,&nbsp;V,&nbsp;and&nbsp;r&nbsp;qualifiers&nbsp;plus&nbsp;any&nbsp;vendor<br>
extended&nbsp;types&nbsp;in&nbsp;the&nbsp;same&nbsp;order-insensitive&nbsp;set&nbsp;is&nbsp;substitutible;<br>
any&nbsp;type&nbsp;with&nbsp;a&nbsp;subset&nbsp;of&nbsp;those&nbsp;qualifiers&nbsp;is&nbsp;not.<br>
That&nbsp;is,&nbsp;given&nbsp;a&nbsp;type&nbsp;&lt;code&gt;const&nbsp;volatile&nbsp;foo&lt;/code&gt;,<br>
the&nbsp;fully&nbsp;qualified&nbsp;type&nbsp;or&nbsp;foo&nbsp;may&nbsp;be&nbsp;substituted,<br>
but&nbsp;not&nbsp;&lt;code&gt;volatile&nbsp;foo&lt;/code&gt;&nbsp;nor&nbsp;&lt;code&gt;const&nbsp;foo&lt;/code&gt;.<br>
Also,&nbsp;note&nbsp;that&nbsp;the&nbsp;grammar&nbsp;above&nbsp;is&nbsp;written&nbsp;with&nbsp;the&nbsp;assumption&nbsp;that<br>
vendor&nbsp;extended&nbsp;type&nbsp;qualifiers&nbsp;will&nbsp;be&nbsp;in&nbsp;the&nbsp;order-sensitive&nbsp;(not&nbsp;CV)<br>
set.&nbsp;&nbsp;An&nbsp;appropriate&nbsp;grammar&nbsp;modification&nbsp;would&nbsp;be&nbsp;necessitated&nbsp;by&nbsp;an<br>
order-insensitive&nbsp;vendor&nbsp;extended&nbsp;type&nbsp;qualifier&nbsp;like&nbsp;const&nbsp;or&nbsp;volatile.<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
&lt;img&nbsp;src=warning.gif&nbsp;alt=&quot;&lt;b&gt;NOTE&lt;/b&gt;:&quot;&gt;<br>
&lt;i&gt;<br>
The&nbsp;restrict&nbsp;qualifier&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;C99&nbsp;standard,<br>
but&nbsp;is&nbsp;strictly&nbsp;an&nbsp;extension&nbsp;to&nbsp;C++&nbsp;at&nbsp;this&nbsp;time.<br>
There&nbsp;is&nbsp;no&nbsp;standard&nbsp;specification&nbsp;of&nbsp;whether&nbsp;the&nbsp;restrict&nbsp;attribute<br>
is&nbsp;part&nbsp;of&nbsp;the&nbsp;type&nbsp;for&nbsp;overloading&nbsp;purposes.<br>
An&nbsp;implementation&nbsp;should&nbsp;include&nbsp;its&nbsp;encoding&nbsp;in&nbsp;the&nbsp;mangled&nbsp;name<br>
if&nbsp;and&nbsp;only&nbsp;if&nbsp;it&nbsp;also&nbsp;treats&nbsp;it&nbsp;as&nbsp;a&nbsp;distinguishing&nbsp;attribute&nbsp;for<br>
overloading&nbsp;purposes.<br>
This&nbsp;ABI&nbsp;does&nbsp;not&nbsp;specify&nbsp;that&nbsp;choice.<br>
&lt;/i&gt;<br>
<br>
&lt;a&nbsp;name=mangling-builtin&gt;<br>
&lt;p&gt;<br>
Builtin&nbsp;types&nbsp;are&nbsp;represented&nbsp;by&nbsp;single-letter&nbsp;codes:<br>
<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&lt;builtin-type&gt;&nbsp;::=&nbsp;v&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;void<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;w&nbsp;&nbsp;#&nbsp;wchar_t<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;b&nbsp;&nbsp;#&nbsp;bool<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;c&nbsp;&nbsp;#&nbsp;char<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;a&nbsp;&nbsp;#&nbsp;signed&nbsp;char<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;h&nbsp;&nbsp;#&nbsp;unsigned&nbsp;char<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;s&nbsp;&nbsp;#&nbsp;short<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;t&nbsp;&nbsp;#&nbsp;unsigned&nbsp;short<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;i&nbsp;&nbsp;#&nbsp;int<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;j&nbsp;&nbsp;#&nbsp;unsigned&nbsp;int<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;l&nbsp;&nbsp;#&nbsp;long<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;m&nbsp;&nbsp;#&nbsp;unsigned&nbsp;long<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;x&nbsp;&nbsp;#&nbsp;long&nbsp;long,&nbsp;__int64<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;y&nbsp;&nbsp;#&nbsp;unsigned&nbsp;long&nbsp;long,&nbsp;__int64<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;n&nbsp;&nbsp;#&nbsp;__int128<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;o&nbsp;&nbsp;#&nbsp;unsigned&nbsp;__int128<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;f&nbsp;&nbsp;#&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;d&nbsp;&nbsp;#&nbsp;double<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;e&nbsp;&nbsp;#&nbsp;long&nbsp;double,&nbsp;__float80<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;g&nbsp;&nbsp;#&nbsp;__float128<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;z&nbsp;&nbsp;#&nbsp;ellipsis<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;u&nbsp;&lt;source-name&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;vendor&nbsp;extended&nbsp;type<br>
<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
Vendors&nbsp;who&nbsp;define&nbsp;builtin&nbsp;extended&nbsp;types&nbsp;shall&nbsp;encode&nbsp;them<br>
as&nbsp;a&nbsp;'u'&nbsp;prefix&nbsp;followed&nbsp;by&nbsp;the&nbsp;name&nbsp;in&nbsp;&lt;length,ID&gt;&nbsp;form.<br>
<br>
&lt;p&gt;<br>
Function&nbsp;types&nbsp;are&nbsp;composed&nbsp;from&nbsp;their&nbsp;parameter&nbsp;types&nbsp;and&nbsp;possibly&nbsp;the<br>
result&nbsp;type.<br>
Except&nbsp;at&nbsp;the&nbsp;outer&nbsp;level&nbsp;type&nbsp;of&nbsp;an&nbsp;&lt;encoding&gt;,<br>
or&nbsp;in&nbsp;the&nbsp;&lt;encoding&gt;&nbsp;of&nbsp;an&nbsp;otherwise&nbsp;delimited&nbsp;external&nbsp;name&nbsp;in&nbsp;a<br>
&lt;template-parameter&gt;&nbsp;or&nbsp;&lt;local-name&gt;&nbsp;function&nbsp;encoding,<br>
these&nbsp;types&nbsp;are&nbsp;delimited&nbsp;by&nbsp;an&nbsp;&quot;F..E&quot;&nbsp;pair.<br>
For&nbsp;purposes&nbsp;of&nbsp;substitution<br>
(see&nbsp;&lt;a&nbsp;href=#mangling-compression&gt;Compression&lt;/a&gt;&nbsp;below),<br>
delimited&nbsp;and&nbsp;undelimited&nbsp;function&nbsp;types&nbsp;are&nbsp;considered&nbsp;the&nbsp;same.<br>
<br>
&lt;p&gt;<br>
Whether&nbsp;the&nbsp;mangling&nbsp;of&nbsp;a&nbsp;function&nbsp;type&nbsp;includes&nbsp;the&nbsp;return&nbsp;type<br>
depends&nbsp;on&nbsp;the&nbsp;context&nbsp;and&nbsp;the&nbsp;nature&nbsp;of&nbsp;the&nbsp;function.<br>
The&nbsp;rules&nbsp;for&nbsp;deciding&nbsp;whether&nbsp;the&nbsp;return&nbsp;type&nbsp;is&nbsp;included&nbsp;are:<br>
&lt;ol&gt;<br>
&lt;li&gt;&nbsp;Template&nbsp;functions&nbsp;(names&nbsp;or&nbsp;types)&nbsp;have&nbsp;return&nbsp;types&nbsp;encoded,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;the&nbsp;exceptions&nbsp;listed&nbsp;below.<br>
&lt;li&gt;&nbsp;Function&nbsp;types&nbsp;not&nbsp;appearing&nbsp;as&nbsp;part&nbsp;of&nbsp;a&nbsp;function&nbsp;name&nbsp;mangling,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.g.&nbsp;parameters,&nbsp;pointer&nbsp;types,&nbsp;etc.,&nbsp;have&nbsp;return&nbsp;type&nbsp;encoded,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;the&nbsp;exceptions&nbsp;listed&nbsp;below.<br>
&lt;li&gt;&nbsp;Non-template&nbsp;function&nbsp;names&nbsp;do&nbsp;not&nbsp;have&nbsp;return&nbsp;types&nbsp;encoded.<br>
&lt;/ol&gt;<br>
The&nbsp;exceptions&nbsp;mentioned&nbsp;in&nbsp;(1)&nbsp;and&nbsp;(2)&nbsp;above,<br>
for&nbsp;which&nbsp;the&nbsp;return&nbsp;type&nbsp;is&nbsp;never&nbsp;included,&nbsp;are<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;Constructors.<br>
&lt;li&gt;&nbsp;Destructors.<br>
&lt;li&gt;&nbsp;Conversion&nbsp;operator&nbsp;functions,&nbsp;e.g.&nbsp;&lt;code&gt;operator&nbsp;int&lt;/code&gt;.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
Empty&nbsp;parameter&nbsp;lists,<br>
whether&nbsp;declared&nbsp;as&nbsp;&lt;code&gt;()&lt;/code&gt;&nbsp;or&nbsp;conventionally&nbsp;as&nbsp;&lt;code&gt;(void)&lt;/code&gt;,<br>
are&nbsp;encoded&nbsp;with&nbsp;a&nbsp;void&nbsp;parameter&nbsp;specifier&nbsp;(v).<br>
Therefore&nbsp;function&nbsp;types&nbsp;always&nbsp;encode&nbsp;at&nbsp;least&nbsp;one&nbsp;parameter&nbsp;type,<br>
and&nbsp;function&nbsp;manglings&nbsp;can&nbsp;always&nbsp;be&nbsp;distinguished&nbsp;from&nbsp;data&nbsp;manglings<br>
by&nbsp;the&nbsp;presence&nbsp;of&nbsp;the&nbsp;type.<br>
Member&nbsp;functions&nbsp;do&nbsp;not&nbsp;encode&nbsp;the&nbsp;&lt;span&nbsp;class=&quot;change&quot;&gt;&lt;strike&gt;type&nbsp;of&nbsp;their&nbsp;implicit&nbsp;&lt;code&gt;this&lt;/code&gt;&nbsp;parameter&lt;/strike&gt;&nbsp;types&nbsp;of<br>
implicit&nbsp;parameters,&nbsp;either&nbsp;&lt;code&gt;this&lt;/code&gt;&nbsp;or&nbsp;the&nbsp;VTT&nbsp;parameter.&lt;/span&gt;<br>
<br>
&lt;p&gt;<br>
A&nbsp;&quot;Y&quot;&nbsp;prefix&nbsp;for&nbsp;the&nbsp;bare&nbsp;function&nbsp;type&nbsp;encodes&nbsp;extern&nbsp;&quot;C&quot;.<br>
If&nbsp;there&nbsp;are&nbsp;any&nbsp;cv-qualifiers&nbsp;of&nbsp;&lt;code&gt;this&lt;/code&gt;,<br>
they&nbsp;are&nbsp;encoded&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;&lt;qualified-name&gt;<br>
as&nbsp;described&nbsp;above.<br>
This&nbsp;affects&nbsp;only&nbsp;type&nbsp;mangling,<br>
since&nbsp;extern&nbsp;&quot;C&quot;&nbsp;function&nbsp;objects&nbsp;have&nbsp;unmangled&nbsp;names.<br>
<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&lt;function-type&gt;&nbsp;::=&nbsp;F&nbsp;[Y]&nbsp;&lt;bare-function-type&gt;&nbsp;E<br>
&nbsp;&nbsp;&lt;bare-function-type&gt;&nbsp;::=&nbsp;&lt;&lt;i&gt;signature&lt;/i&gt;&nbsp;type&gt;+<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;types&nbsp;are&nbsp;possible&nbsp;return&nbsp;type,&nbsp;then&nbsp;parameter&nbsp;types<br>
<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
A&nbsp;class,&nbsp;union,&nbsp;or&nbsp;enum&nbsp;type&nbsp;is&nbsp;simply&nbsp;a&nbsp;name,<br>
It&nbsp;may&nbsp;be&nbsp;a&nbsp;simple&nbsp;&lt;unqualified-name&gt;,<br>
with&nbsp;or&nbsp;without&nbsp;a&nbsp;template&nbsp;argument&nbsp;list,<br>
or&nbsp;a&nbsp;more&nbsp;complex&nbsp;&lt;nested-name&gt;.<br>
Thus,&nbsp;it&nbsp;is&nbsp;encoded&nbsp;like&nbsp;a&nbsp;function&nbsp;name,<br>
except&nbsp;that&nbsp;no&nbsp;CV-qualifiers&nbsp;are&nbsp;present&nbsp;in&nbsp;a&nbsp;nested&nbsp;name&nbsp;specification.<br>
<br>
&lt;pre&gt;&lt;code&gt;&lt;font&nbsp;color=blue&gt;<br>
&nbsp;&nbsp;&lt;class-enum-type&gt;&nbsp;::=&nbsp;&lt;name&gt;<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
Array&nbsp;types&nbsp;encode&nbsp;the&nbsp;dimension&nbsp;(number&nbsp;of&nbsp;elements)&nbsp;and&nbsp;the&nbsp;element&nbsp;type.<br>
Note&nbsp;that&nbsp;&quot;array&quot;&nbsp;parameters&nbsp;to&nbsp;functions&nbsp;are&nbsp;encoded&nbsp;as&nbsp;pointer&nbsp;types.<br>
For&nbsp;variable&nbsp;length&nbsp;arrays&nbsp;(C99&nbsp;VLAs),<br>
the&nbsp;dimension&nbsp;(but&nbsp;not&nbsp;the&nbsp;'_'&nbsp;separator)&nbsp;is&nbsp;omitted.<br>
<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&lt;array-type&gt;&nbsp;::=&nbsp;A&nbsp;&lt;&lt;i&gt;positive&nbsp;dimension&lt;/i&gt;&nbsp;number&gt;&nbsp;_&nbsp;&lt;&lt;i&gt;element&lt;/i&gt;&nbsp;type&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;A&nbsp;[&lt;&lt;i&gt;dimension&lt;/i&gt;&nbsp;expression&gt;]&nbsp;_&nbsp;&lt;&lt;i&gt;element&lt;/i&gt;&nbsp;type&gt;<br>
<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
When&nbsp;the&nbsp;dimension&nbsp;is&nbsp;an&nbsp;expression&nbsp;involving&nbsp;template&nbsp;parameters,<br>
the&nbsp;second&nbsp;production&nbsp;is&nbsp;used.<br>
Thus,&nbsp;the&nbsp;declarations:<br>
&lt;pre&gt;&lt;code&gt;&nbsp;&nbsp;&nbsp;&nbsp;template&lt;int&nbsp;I&gt;&nbsp;void&nbsp;foo&nbsp;(int&nbsp;(&amp;)[I&nbsp;+&nbsp;1])&nbsp;{&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;template&nbsp;void&nbsp;foo&lt;2&gt;&nbsp;(int&nbsp;(&amp;)[3]);<br>
&lt;/pre&gt;&lt;/code&gt;<br>
produce&nbsp;the&nbsp;mangled&nbsp;name&nbsp;&quot;&lt;code&gt;_Z3fooILi2EEvRAplT_Li1E_i&lt;/code&gt;&quot;.<br>
<br>
&lt;p&gt;<br>
Pointer-to-member&nbsp;types&nbsp;encode&nbsp;the&nbsp;class&nbsp;and&nbsp;member&nbsp;types.<br>
<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&lt;pointer-to-member-type&gt;&nbsp;::=&nbsp;M&nbsp;&lt;&lt;i&gt;class&lt;/i&gt;&nbsp;type&gt;&nbsp;&lt;&lt;i&gt;member&lt;/i&gt;&nbsp;type&gt;<br>
<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
&lt;p&gt;<br>
Note&nbsp;that&nbsp;for&nbsp;a&nbsp;pointer&nbsp;to&nbsp;cv-qualified&nbsp;member&nbsp;function,&nbsp;the&nbsp;qualifiers&nbsp;are<br>
attached&nbsp;to&nbsp;the&nbsp;function&nbsp;type,&nbsp;so<br>
&lt;pre&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;A;<br>
&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;f&nbsp;(void&nbsp;(A::*)()&nbsp;const)&nbsp;{}<br>
&lt;/code&gt;&lt;/pre&gt;<br>
produces&nbsp;the&nbsp;mangled&nbsp;name&nbsp;&quot;&lt;code&gt;_Z1fM1AKFvvE&lt;/code&gt;&quot;.<br>
<br>
&lt;p&gt;<br>
When&nbsp;function&nbsp;and&nbsp;member&nbsp;function&nbsp;template&nbsp;instantiations&nbsp;reference<br>
the&nbsp;template&nbsp;parameters&nbsp;in&nbsp;their&nbsp;parameter/result&nbsp;types,<br>
the&nbsp;template&nbsp;parameter&nbsp;number&nbsp;is&nbsp;encoded,<br>
with&nbsp;the&nbsp;sequence&nbsp;T_,&nbsp;T0_,&nbsp;...<br>
Class&nbsp;template&nbsp;parameter&nbsp;references&nbsp;are&nbsp;mangled&nbsp;using&nbsp;the&nbsp;standard<br>
mangling&nbsp;for&nbsp;the&nbsp;actual&nbsp;parameter&nbsp;type,<br>
typically&nbsp;a&nbsp;substitution.<br>
Note&nbsp;that&nbsp;a&nbsp;template&nbsp;parameter&nbsp;reference&nbsp;is&nbsp;a&nbsp;substitution&nbsp;candidate,<br>
distinct&nbsp;from&nbsp;the&nbsp;type&nbsp;(or&nbsp;other&nbsp;substitutible&nbsp;entity)<br>
that&nbsp;is&nbsp;the&nbsp;actual&nbsp;parameter.<br>
<br>
&lt;pre&gt;&lt;code&gt;&lt;font&nbsp;color=blue&gt;<br>
&nbsp;&nbsp;&lt;template-param&gt;&nbsp;::=&nbsp;T_&nbsp;#&nbsp;first&nbsp;template&nbsp;parameter<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;T&nbsp;&lt;&lt;i&gt;parameter-2&nbsp;non-negative&lt;/i&gt;&nbsp;number&gt;&nbsp;_<br>
&nbsp;&nbsp;&lt;template-template-param&gt;&nbsp;::=&nbsp;&lt;template-param&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;substitution&gt;<br>
<br>
&lt;/font&gt;&lt;/code&gt;&lt;/pre&gt;<br>
<br>
&lt;p&gt;<br>
Template&nbsp;argument&nbsp;lists&nbsp;appear&nbsp;after&nbsp;the&nbsp;unqualified&nbsp;template&nbsp;name,<br>
and&nbsp;are&nbsp;bracketed&nbsp;by&nbsp;I/E.<br>
This&nbsp;is&nbsp;used&nbsp;in&nbsp;names&nbsp;for&nbsp;specializations&nbsp;in&nbsp;particular,<br>
but&nbsp;also&nbsp;in&nbsp;types&nbsp;and&nbsp;scope&nbsp;identification.<br>
<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&lt;template-args&gt;&nbsp;::=&nbsp;I&nbsp;&lt;template-arg&gt;+&nbsp;E<br>
&nbsp;&nbsp;&lt;template-arg&gt;&nbsp;::=&nbsp;&lt;type&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;type&nbsp;or&nbsp;template<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;L&nbsp;&lt;type&gt;&nbsp;&lt;&lt;i&gt;value&lt;/i&gt;&nbsp;number&gt;&nbsp;E&nbsp;&nbsp;&nbsp;#&nbsp;literal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;L_Z&nbsp;&lt;encoding&gt;&nbsp;E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;external&nbsp;name<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;X&nbsp;&lt;expression&gt;&nbsp;E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;expression<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
Type&nbsp;arguments&nbsp;appear&nbsp;using&nbsp;their&nbsp;regular&nbsp;encoding.<br>
For&nbsp;example,&nbsp;the&nbsp;template&nbsp;class&nbsp;&quot;A&lt;char,&nbsp;float&gt;&quot;&nbsp;is&nbsp;encoded&nbsp;as&nbsp;&quot;1AIcfE&quot;.<br>
A&nbsp;slightly&nbsp;more&nbsp;involved&nbsp;example&nbsp;is<br>
a&nbsp;dependent&nbsp;function&nbsp;parameter&nbsp;type&nbsp;&quot;A&lt;T2&gt;::X&quot;<br>
(T2&nbsp;is&nbsp;the&nbsp;second&nbsp;template&nbsp;parameter)<br>
which&nbsp;is&nbsp;encoded&nbsp;as&nbsp;&quot;N1AIT0_E1XE&quot;,<br>
where&nbsp;the&nbsp;&quot;N...E&quot;&nbsp;construct&nbsp;is&nbsp;used&nbsp;to&nbsp;describe&nbsp;a&nbsp;qualified&nbsp;name.<br>
<br>
&lt;p&gt;<br>
Literal&nbsp;arguments,&nbsp;e.g.&nbsp;&quot;A&lt;42L&gt;&quot;,<br>
are&nbsp;encoded&nbsp;with&nbsp;their&nbsp;type&nbsp;and&nbsp;value.<br>
Negative&nbsp;integer&nbsp;values&nbsp;are&nbsp;preceded&nbsp;with&nbsp;&quot;n&quot;;<br>
for&nbsp;example,&nbsp;&quot;A&lt;-42L&gt;&quot;&nbsp;becomes&nbsp;&quot;1AILln42EE&quot;.<br>
The&nbsp;bool&nbsp;value&nbsp;false&nbsp;is&nbsp;encoded&nbsp;as&nbsp;0,&nbsp;true&nbsp;as&nbsp;1.<br>
If&nbsp;floating-point&nbsp;arguments&nbsp;are&nbsp;accepted&nbsp;as&nbsp;an&nbsp;extension,<br>
their&nbsp;values&nbsp;should&nbsp;be&nbsp;encoded&nbsp;using&nbsp;a&nbsp;fixed-length&nbsp;lowercase&nbsp;hexadecimal<br>
string&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;internal&nbsp;representation&nbsp;(IEEE&nbsp;on&nbsp;Itanium),<br>
high-order&nbsp;bytes&nbsp;first,&nbsp;without&nbsp;leading&nbsp;zeroes.<br>
For&nbsp;example:&nbsp;&quot;Lf&nbsp;bf800000&nbsp;E&quot;&nbsp;is&nbsp;-1.0f&nbsp;on&nbsp;Itanium.<br>
<br>
&lt;p&gt;<br>
A&nbsp;reference&nbsp;to&nbsp;an&nbsp;entity&nbsp;with&nbsp;external&nbsp;linkage&nbsp;is&nbsp;encoded&nbsp;with<br>
&quot;L&lt;mangled&nbsp;name&gt;E&quot;.<br>
For&nbsp;example:<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;foo(char);&nbsp;//&nbsp;mangled&nbsp;as&nbsp;_Z3fooc<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;template&lt;void&nbsp;(&amp;)(char)&gt;&nbsp;struct&nbsp;CB;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;CB&lt;foo&gt;&nbsp;is&nbsp;mangled&nbsp;as&nbsp;&quot;2CBIL_Z3foocEE&quot;<br>
<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;&lt;encoding&gt;&nbsp;of&nbsp;an&nbsp;extern&nbsp;&quot;C&quot;&nbsp;function&nbsp;is&nbsp;treated&nbsp;like<br>
global-scope&nbsp;data,<br>
i.e.&nbsp;as&nbsp;its&nbsp;&lt;source-name&gt;&nbsp;without&nbsp;a&nbsp;type.<br>
For&nbsp;example:<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extern&nbsp;&quot;C&quot;&nbsp;bool&nbsp;IsEmpty(char&nbsp;*);&nbsp;//&nbsp;(un)mangled&nbsp;as&nbsp;IsEmpty<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;template&lt;void&nbsp;(&amp;)(char&nbsp;*)&gt;&nbsp;struct&nbsp;CB;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;CB&lt;IsEmpty&gt;&nbsp;is&nbsp;mangled&nbsp;as&nbsp;&quot;2CBIL_Z7IsEmptyEE&quot;<br>
<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
An&nbsp;expression,&nbsp;e.g.,&nbsp;&quot;B&lt;(J+1)/2&gt;&quot;,<br>
is&nbsp;encoded&nbsp;with&nbsp;a&nbsp;prefix&nbsp;traversal&nbsp;of&nbsp;the&nbsp;operators&nbsp;involved,<br>
delimited&nbsp;by&nbsp;&quot;X...E&quot;.<br>
The&nbsp;operators&nbsp;are&nbsp;encoded&nbsp;using&nbsp;their&nbsp;two&nbsp;letter&nbsp;mangled&nbsp;names.<br>
For&nbsp;example,&nbsp;&quot;B&lt;(J+1)/2&gt;&quot;,&nbsp;if&nbsp;J&nbsp;is&nbsp;the&nbsp;third&nbsp;template&nbsp;parameter,<br>
becomes&nbsp;&quot;1BI&nbsp;Xdv&nbsp;pl&nbsp;T1_&nbsp;Li1E&nbsp;Li2E&nbsp;E&nbsp;E&quot;<br>
(the&nbsp;blanks&nbsp;are&nbsp;present&nbsp;only&nbsp;to&nbsp;visualize&nbsp;the&nbsp;decomposition).<br>
Note&nbsp;that&nbsp;the&nbsp;expression&nbsp;is&nbsp;mangled&nbsp;without&nbsp;constant&nbsp;folding&nbsp;or&nbsp;other<br>
simplification,<br>
and&nbsp;without&nbsp;parentheses,&nbsp;which&nbsp;are&nbsp;implicit&nbsp;in&nbsp;the&nbsp;prefix&nbsp;representation.<br>
Except&nbsp;for&nbsp;the&nbsp;parentheses,&nbsp;therefore,<br>
it&nbsp;represents&nbsp;the&nbsp;source&nbsp;token&nbsp;stream.<br>
(C++&nbsp;Standard&nbsp;reference&nbsp;14.5.5.1&nbsp;p.&nbsp;5.)<br>
<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&lt;expression&gt;&nbsp;::=&nbsp;&lt;&lt;i&gt;unary&lt;/i&gt;&nbsp;operator-name&gt;&nbsp;&lt;expression&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;&lt;i&gt;binary&lt;/i&gt;&nbsp;operator-name&gt;&nbsp;&lt;expression&gt;&nbsp;&lt;expression&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;&lt;expr-primary&gt;<br>
&nbsp;&nbsp;&lt;expr-primary&gt;&nbsp;::=&nbsp;&lt;template-param&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;L&nbsp;&lt;type&gt;&nbsp;&lt;&lt;i&gt;value&lt;/i&gt;&nbsp;number&gt;&nbsp;E&nbsp;&nbsp;&nbsp;#&nbsp;literal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;L&nbsp;&lt;mangled-name&gt;&nbsp;E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;external&nbsp;name<br>
<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
Template&nbsp;arguments&nbsp;that&nbsp;could&nbsp;be&nbsp;pointer-to-member&nbsp;constants&nbsp;are<br>
difficult&nbsp;because&nbsp;it&nbsp;is&nbsp;often&nbsp;not&nbsp;possible&nbsp;to&nbsp;distinguish&nbsp;them&nbsp;from<br>
pointers&nbsp;to&nbsp;static&nbsp;member&nbsp;functions&nbsp;or&nbsp;data&nbsp;members&nbsp;without&nbsp;doing&nbsp;the<br>
substitution.<br>
Therefore,&nbsp;the&nbsp;&lt;i&gt;scope&nbsp;resolution&lt;/i&gt;&nbsp;(sr)&nbsp;mangling&nbsp;operator&nbsp;is&nbsp;used<br>
if&nbsp;the&nbsp;LHS&nbsp;operand&nbsp;of&nbsp;::&nbsp;involves&nbsp;a&nbsp;template&nbsp;parameter.<br>
Ignoring&nbsp;substitutions,&nbsp;&lt;code&gt;&amp;T::j&lt;/code&gt;&nbsp;as&nbsp;a&nbsp;template&nbsp;argument<br>
would&nbsp;be&nbsp;encoded&nbsp;&lt;code&gt;Xadsr1T1jE&lt;/code&gt;.<br>
<br>
&lt;p&gt;<br>
The&nbsp;encoding&nbsp;for&nbsp;a&nbsp;literal&nbsp;of&nbsp;an&nbsp;enumerated&nbsp;type&nbsp;is&nbsp;the&nbsp;encoding&nbsp;of&nbsp;the<br>
type&nbsp;name&nbsp;followed&nbsp;by&nbsp;the&nbsp;encoding&nbsp;of&nbsp;the&nbsp;numeric&nbsp;value&nbsp;of&nbsp;the&nbsp;literal<br>
in&nbsp;its&nbsp;base&nbsp;integral&nbsp;type<br>
(which&nbsp;deals&nbsp;with&nbsp;values&nbsp;that&nbsp;don't&nbsp;have&nbsp;names&nbsp;declared&nbsp;in&nbsp;the&nbsp;type).<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=mangling-scope&gt;<br>
&lt;h4&gt;&nbsp;5.1.6&nbsp;Scope&nbsp;Encoding&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
A&nbsp;nonlocal&nbsp;scope&nbsp;is&nbsp;encoded&nbsp;as&nbsp;the&nbsp;qualifier&nbsp;of&nbsp;a&nbsp;qualified&nbsp;name:<br>
it&nbsp;can&nbsp;be&nbsp;the&nbsp;top-level&nbsp;name&nbsp;qualification&nbsp;or&nbsp;it&nbsp;can&nbsp;appear&nbsp;inside<br>
&lt;type&gt;&nbsp;to&nbsp;denote&nbsp;dependent&nbsp;types&nbsp;or&nbsp;bind&nbsp;specific&nbsp;names&nbsp;as&nbsp;arguments.<br>
Qualified&nbsp;names&nbsp;are&nbsp;encoded&nbsp;as:<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;&nbsp;N&nbsp;&lt;qual&nbsp;1&gt;&nbsp;...&nbsp;&lt;qual&nbsp;N&gt;&nbsp;&lt;unqual&nbsp;name&gt;&nbsp;E<br>
&lt;/pre&gt;&lt;/code&gt;<br>
where&nbsp;each&nbsp;&lt;qual&nbsp;K&gt;&nbsp;is&nbsp;the&nbsp;encoding&nbsp;of&nbsp;a&nbsp;namespace&nbsp;name&nbsp;or&nbsp;a&nbsp;class&nbsp;name<br>
(with&nbsp;the&nbsp;latter&nbsp;possibly&nbsp;including&nbsp;a&nbsp;template&nbsp;argument&nbsp;list).<br>
<br>
&lt;p&gt;<br>
Occasionally&nbsp;entities&nbsp;in&nbsp;local&nbsp;scopes&nbsp;must&nbsp;be&nbsp;mangled&nbsp;too<br>
(e.g.&nbsp;because&nbsp;inlining&nbsp;or&nbsp;template&nbsp;compilation&nbsp;causes<br>
multiple&nbsp;translation&nbsp;units&nbsp;to&nbsp;require&nbsp;access&nbsp;to&nbsp;that&nbsp;entity).<br>
The&nbsp;encoding&nbsp;for&nbsp;such&nbsp;entities&nbsp;is&nbsp;as&nbsp;follows:<br>
&lt;code&gt;&lt;pre&gt;&lt;font&nbsp;color=blue&gt;<br>
&nbsp;&nbsp;&lt;local-name&gt;&nbsp;:=&nbsp;Z&nbsp;&lt;&lt;i&gt;function&lt;/i&gt;&nbsp;encoding&gt;&nbsp;E&nbsp;&lt;&lt;i&gt;entity&lt;/i&gt;&nbsp;name&gt;&nbsp;[&lt;discriminator&gt;]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;Z&nbsp;&lt;&lt;i&gt;function&lt;/i&gt;&nbsp;encoding&gt;&nbsp;E&nbsp;s&nbsp;[&lt;discriminator&gt;]<br>
&nbsp;&nbsp;&lt;discriminator&gt;&nbsp;:=&nbsp;_&nbsp;&lt;&lt;i&gt;non-negative&lt;/i&gt;&nbsp;number&gt;&nbsp;&lt;/font&gt;&lt;/pre&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;first&nbsp;production&nbsp;is&nbsp;used&nbsp;for&nbsp;named&nbsp;local&nbsp;static&nbsp;objects&nbsp;and&nbsp;classes,<br>
which&nbsp;are&nbsp;identified&nbsp;by&nbsp;their&nbsp;declared&nbsp;names.<br>
The&nbsp;&lt;&lt;i&gt;entity&lt;/i&gt;&nbsp;name&gt;&nbsp;may&nbsp;itself&nbsp;be&nbsp;a&nbsp;compound&nbsp;name,<br>
but&nbsp;it&nbsp;is&nbsp;relative&nbsp;to&nbsp;the&nbsp;closest&nbsp;enclosing&nbsp;function,<br>
i.e.&nbsp;none&nbsp;of&nbsp;the&nbsp;components&nbsp;of&nbsp;the&nbsp;function&nbsp;encoding&nbsp;appear&nbsp;in&nbsp;the&nbsp;entity&nbsp;name.<br>
It&nbsp;is&nbsp;possible&nbsp;to&nbsp;have&nbsp;nested&nbsp;function&nbsp;scopes,<br>
e.g.&nbsp;when&nbsp;dealing&nbsp;with&nbsp;a&nbsp;member&nbsp;function&nbsp;in&nbsp;a&nbsp;local&nbsp;class.<br>
In&nbsp;such&nbsp;cases,&nbsp;the&nbsp;function&nbsp;encoding&nbsp;will&nbsp;itself&nbsp;have&nbsp;&lt;local-name&gt;<br>
structure.<br>
The&nbsp;discriminator&nbsp;is&nbsp;used&nbsp;only&nbsp;for&nbsp;the<br>
second&nbsp;and&nbsp;later&nbsp;occurrences&nbsp;of&nbsp;the&nbsp;same&nbsp;name&nbsp;within&nbsp;a&nbsp;single&nbsp;function.<br>
In&nbsp;this&nbsp;case&nbsp;&lt;number&gt;&nbsp;is&nbsp;n&nbsp;-&nbsp;2,<br>
if&nbsp;this&nbsp;is&nbsp;the&nbsp;nth&nbsp;occurrence,&nbsp;in&nbsp;lexical&nbsp;order,&nbsp;of&nbsp;the&nbsp;given&nbsp;name.<br>
<br>
&lt;p&gt;<br>
The&nbsp;second&nbsp;production&nbsp;is&nbsp;used&nbsp;for&nbsp;string&nbsp;literals.<br>
The&nbsp;discriminator&nbsp;is&nbsp;used&nbsp;only&nbsp;if&nbsp;there&nbsp;is&nbsp;more&nbsp;than&nbsp;one,<br>
for&nbsp;the&nbsp;second&nbsp;and&nbsp;subsequent&nbsp;ones.<br>
In&nbsp;this&nbsp;case&nbsp;&lt;number&gt;&nbsp;is&nbsp;n&nbsp;-&nbsp;2,<br>
if&nbsp;this&nbsp;is&nbsp;the&nbsp;nth&nbsp;distinct&nbsp;string&nbsp;literal,&nbsp;in&nbsp;lexical&nbsp;order,<br>
appearing&nbsp;in&nbsp;the&nbsp;function.<br>
Multiple&nbsp;references&nbsp;to&nbsp;the&nbsp;same&nbsp;string&nbsp;literal&nbsp;produce&nbsp;one&nbsp;string<br>
object&nbsp;with&nbsp;one&nbsp;name&nbsp;in&nbsp;the&nbsp;sequence.<br>
&lt;i&gt;<br>
Note&nbsp;that&nbsp;this&nbsp;assumes&nbsp;that&nbsp;the&nbsp;same&nbsp;string&nbsp;literal&nbsp;occurring&nbsp;twice<br>
in&nbsp;a&nbsp;given&nbsp;function&nbsp;in&nbsp;fact&nbsp;represents&nbsp;a&nbsp;single&nbsp;entity,<br>
i.e.&nbsp;has&nbsp;a&nbsp;unique&nbsp;address.<br>
&lt;/i&gt;<br>
<br>
&lt;i&gt;<br>
&lt;p&gt;<br>
For&nbsp;both&nbsp;named&nbsp;objects&nbsp;and&nbsp;string&nbsp;literals,<br>
the&nbsp;numbering&nbsp;order&nbsp;is&nbsp;strictly&nbsp;lexical&nbsp;order&nbsp;based&nbsp;on&nbsp;the&nbsp;original<br>
token&nbsp;sequence.<br>
All&nbsp;objects&nbsp;occurring&nbsp;in&nbsp;that&nbsp;sequence&nbsp;are&nbsp;to&nbsp;be&nbsp;numbered,<br>
even&nbsp;if&nbsp;subsequent&nbsp;optimization&nbsp;makes&nbsp;some&nbsp;of&nbsp;them&nbsp;unnecessary.<br>
It&nbsp;is&nbsp;expected&nbsp;that&nbsp;this&nbsp;will&nbsp;be&nbsp;the&nbsp;'natural'&nbsp;order&nbsp;in&nbsp;most&nbsp;compilers.<br>
In&nbsp;any&nbsp;case,&nbsp;conflicts&nbsp;would&nbsp;arise&nbsp;only&nbsp;if&nbsp;different&nbsp;compilation&nbsp;units<br>
including&nbsp;the&nbsp;same&nbsp;code&nbsp;were&nbsp;compiled&nbsp;by&nbsp;different&nbsp;compilers,<br>
and&nbsp;multiple&nbsp;entities&nbsp;requiring&nbsp;mangling&nbsp;had&nbsp;the&nbsp;same&nbsp;name.<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
For&nbsp;static&nbsp;objects&nbsp;in&nbsp;constructors&nbsp;and&nbsp;destructors,<br>
the&nbsp;mangling&nbsp;of&nbsp;the&nbsp;complete&nbsp;object&nbsp;constructor&nbsp;or&nbsp;destructor&nbsp;is&nbsp;used<br>
as&nbsp;the&nbsp;base&nbsp;function&nbsp;name,&nbsp;i.e.&nbsp;the&nbsp;C1&nbsp;or&nbsp;D1&nbsp;version.<br>
This&nbsp;yields&nbsp;mangled&nbsp;names&nbsp;that&nbsp;are&nbsp;consistent&nbsp;across&nbsp;the&nbsp;versions.<br>
<br>
&lt;p&gt;<br>
Example:<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;&nbsp;namespace&nbsp;N&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inline&nbsp;char*&nbsp;f(int&nbsp;i)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;char&nbsp;*p&nbsp;=&nbsp;&quot;Itanium&nbsp;C++&nbsp;ABI&quot;;&nbsp;&nbsp;//&nbsp;p&nbsp;=&nbsp;1,&nbsp;&quot;...&quot;&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;struct&nbsp;X&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;X&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;g()&nbsp;{}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;p[i];<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;}<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;&quot;&lt;code&gt;_ZZN1N1fEiE1p&lt;/code&gt;&quot;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;encoding&nbsp;of&nbsp;N::f::p&nbsp;(first&nbsp;local&nbsp;mangled&nbsp;entity)<br>
&lt;li&gt;&nbsp;&quot;&lt;code&gt;_ZZN1N1fEiEs&lt;/code&gt;&quot;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;encoding&nbsp;of&nbsp;N::f::&quot;Itanium&nbsp;C++&nbsp;ABI&quot;&nbsp;(no&nbsp;discriminator)<br>
&lt;li&gt;&nbsp;&quot;&lt;code&gt;_ZNZN1N1fEiE1X1gE&lt;/code&gt;&quot;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;encoding&nbsp;of&nbsp;N::f::X::g()<br>
&nbsp;&nbsp;&nbsp;&nbsp;(third&nbsp;local&nbsp;mangled&nbsp;entity&nbsp;used&nbsp;as&nbsp;a&nbsp;class-qualifier)<br>
&lt;/ul&gt;<br>
See&nbsp;additional&nbsp;examples&nbsp;in&nbsp;the<br>
&lt;a&nbsp;href=abi-examples.html#mangling-ex&gt;ABI&nbsp;examples&lt;/a&gt;&nbsp;document.<br>
<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=mangling-compression&gt;<br>
&lt;h4&gt;&nbsp;5.1.7&nbsp;Compression&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
To&nbsp;minimize&nbsp;the&nbsp;length&nbsp;of&nbsp;external&nbsp;names,<br>
we&nbsp;use&nbsp;two&nbsp;mechanisms,<br>
a&nbsp;substitution&nbsp;encoding&nbsp;to&nbsp;eliminate&nbsp;repetition&nbsp;of&nbsp;name&nbsp;components,<br>
and&nbsp;abbreviations&nbsp;for&nbsp;certain&nbsp;common&nbsp;names.<br>
Each&nbsp;non-terminal&nbsp;in&nbsp;the&nbsp;grammar&nbsp;above&nbsp;for&nbsp;which&nbsp;&lt;substitution&gt;<br>
appears&nbsp;on&nbsp;the&nbsp;RHS,&nbsp;types,&nbsp;names,&nbsp;and&nbsp;qualified&nbsp;name&nbsp;prefixes,<br>
is&nbsp;both&nbsp;a&nbsp;source&nbsp;of&nbsp;future&nbsp;substitutions<br>
and&nbsp;a&nbsp;candidate&nbsp;for&nbsp;being&nbsp;substituted.<br>
There&nbsp;are&nbsp;two&nbsp;exceptions&nbsp;that&nbsp;appear&nbsp;to&nbsp;be&nbsp;substitution<br>
candidates&nbsp;from&nbsp;the&nbsp;grammar,&nbsp;but&nbsp;are&nbsp;explicitly&nbsp;excluded:<br>
&lt;ul&gt;<br>
&lt;li&gt;&nbsp;&lt;builtin-type&gt;&nbsp;other&nbsp;than&nbsp;vendor&nbsp;extended&nbsp;types,&nbsp;and<br>
&lt;li&gt;&nbsp;function&nbsp;and&nbsp;operator&nbsp;names&nbsp;other&nbsp;than&nbsp;extern&nbsp;&quot;C&quot;&nbsp;functions.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
&lt;i&gt;<br>
All&nbsp;substitutions&nbsp;are&nbsp;for&nbsp;entities&nbsp;that&nbsp;would&nbsp;appear&nbsp;in&nbsp;a&nbsp;symbol&nbsp;table.<br>
In&nbsp;particular,<br>
we&nbsp;make&nbsp;substitutions&nbsp;for&nbsp;prefixes&nbsp;of&nbsp;qualified&nbsp;names,<br>
but&nbsp;not&nbsp;for&nbsp;arbitrary&nbsp;components&nbsp;of&nbsp;them.<br>
Thus,&nbsp;the&nbsp;components&nbsp;::n1::foo()&nbsp;and&nbsp;::n2:foo()&nbsp;appearing&nbsp;in&nbsp;the&nbsp;same<br>
name&nbsp;would&nbsp;not&nbsp;result&nbsp;in&nbsp;substituting&nbsp;for&nbsp;the&nbsp;second&nbsp;&quot;foo.&quot;<br>
Similarly,&nbsp;we&nbsp;do&nbsp;not&nbsp;substitute&nbsp;for&nbsp;expressions,<br>
though&nbsp;names&nbsp;appearing&nbsp;in&nbsp;them&nbsp;might&nbsp;be&nbsp;substituted.<br>
The&nbsp;reason&nbsp;for&nbsp;this&nbsp;is&nbsp;to&nbsp;facilitate&nbsp;implementations&nbsp;that&nbsp;use&nbsp;the<br>
symbol&nbsp;table&nbsp;to&nbsp;keep&nbsp;track&nbsp;of&nbsp;components&nbsp;that&nbsp;might&nbsp;be&nbsp;substitutable.<br>
<br>
&lt;p&gt;<br>
Note&nbsp;that&nbsp;the&nbsp;above&nbsp;exclusion&nbsp;of&nbsp;function&nbsp;and&nbsp;operator&nbsp;names&nbsp;from<br>
consideration&nbsp;for&nbsp;substitution&nbsp;does&nbsp;&lt;u&gt;not&lt;/u&gt;&nbsp;exclude&nbsp;the&nbsp;full<br>
function&nbsp;entity,&nbsp;i.e.&nbsp;its&nbsp;name&nbsp;plus&nbsp;its&nbsp;signature&nbsp;encoding.<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
Logically,&nbsp;the&nbsp;substitutable&nbsp;components&nbsp;of&nbsp;a&nbsp;mangled&nbsp;name&nbsp;are<br>
considered&nbsp;left-to-right,<br>
components&nbsp;before&nbsp;the&nbsp;composite&nbsp;structure&nbsp;of&nbsp;which&nbsp;they&nbsp;are&nbsp;a&nbsp;part.<br>
If&nbsp;a&nbsp;component&nbsp;has&nbsp;been&nbsp;encountered&nbsp;before,<br>
it&nbsp;is&nbsp;substituted&nbsp;as&nbsp;described&nbsp;below.<br>
This&nbsp;decision&nbsp;is&nbsp;independent&nbsp;of&nbsp;whether&nbsp;its&nbsp;components&nbsp;have&nbsp;been&nbsp;substituted,<br>
so&nbsp;an&nbsp;implementation&nbsp;may&nbsp;optimize&nbsp;by&nbsp;considering&nbsp;large&nbsp;structures<br>
for&nbsp;substitution&nbsp;before&nbsp;their&nbsp;components.<br>
If&nbsp;a&nbsp;component&nbsp;has&nbsp;not&nbsp;been&nbsp;encountered&nbsp;before,<br>
its&nbsp;mangling&nbsp;is&nbsp;identified,<br>
and&nbsp;it&nbsp;is&nbsp;added&nbsp;to&nbsp;a&nbsp;dictionary&nbsp;of&nbsp;substitution&nbsp;candidates.<br>
No&nbsp;entity&nbsp;is&nbsp;added&nbsp;to&nbsp;the&nbsp;dictionary&nbsp;twice.<br>
<br>
&lt;p&gt;<br>
Substitution&nbsp;is&nbsp;according&nbsp;to&nbsp;the&nbsp;production:<br>
<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&lt;substitution&gt;&nbsp;::=&nbsp;S&nbsp;&lt;seq-id&gt;&nbsp;_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::=&nbsp;S_<br>
<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
The&nbsp;&lt;seq-id&gt;&nbsp;is&nbsp;a&nbsp;sequence&nbsp;number&nbsp;in&nbsp;base&nbsp;36,<br>
using&nbsp;digits&nbsp;and&nbsp;upper&nbsp;case&nbsp;letters,<br>
and&nbsp;identifies&nbsp;the&nbsp;&lt;seq-id&gt;-th<br>
encoded&nbsp;component,<br>
in&nbsp;left-to-right&nbsp;order,<br>
starting&nbsp;at&nbsp;&quot;0&quot;.<br>
As&nbsp;a&nbsp;special&nbsp;case,<br>
the&nbsp;first&nbsp;substitutable&nbsp;entity&nbsp;is&nbsp;encoded&nbsp;as&nbsp;&quot;S_&quot;,<br>
i.e.&nbsp;with&nbsp;no&nbsp;number,<br>
so&nbsp;the&nbsp;numbered&nbsp;entities&nbsp;are&nbsp;the&nbsp;second&nbsp;one&nbsp;as&nbsp;&quot;S0_&quot;,<br>
the&nbsp;third&nbsp;as&nbsp;&quot;S1_&quot;,&nbsp;the&nbsp;twelfth&nbsp;as&nbsp;&quot;SA_&quot;,&nbsp;the&nbsp;thirty-eighth&nbsp;as&nbsp;&quot;S10_&quot;,<br>
etc.<br>
All&nbsp;substitutable&nbsp;components&nbsp;are&nbsp;so&nbsp;numbered,<br>
except&nbsp;those&nbsp;that&nbsp;have&nbsp;already&nbsp;been&nbsp;numbered&nbsp;for&nbsp;substitution.<br>
A&nbsp;component&nbsp;is&nbsp;earlier&nbsp;in&nbsp;the&nbsp;substitution&nbsp;dictionary<br>
than&nbsp;the&nbsp;structure&nbsp;of&nbsp;which&nbsp;it&nbsp;is&nbsp;a&nbsp;part.<br>
For&nbsp;example:<br>
<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;&nbsp;&quot;_ZN1N1TIiiE2mfES0_IddE&quot;:&nbsp;Ret?&nbsp;N::T&lt;int,&nbsp;int&gt;::mf(N::T&lt;double,&nbsp;double&gt;)<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
since&nbsp;at&nbsp;the&nbsp;point&nbsp;where&nbsp;S0_&nbsp;appears:<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;&nbsp;&quot;S_&quot;&nbsp;==&nbsp;N&nbsp;(qualifier&nbsp;is&nbsp;less&nbsp;recent&nbsp;than&nbsp;qualified&nbsp;entity)<br>
&nbsp;&nbsp;&nbsp;&quot;S0_&quot;&nbsp;==&nbsp;N::T&nbsp;(template-id&nbsp;comes&nbsp;before&nbsp;template)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(int&nbsp;is&nbsp;builtin,&nbsp;and&nbsp;isn't&nbsp;considered)<br>
&nbsp;&nbsp;&nbsp;&quot;S1_&quot;&nbsp;==&nbsp;N::T&lt;int,&nbsp;int&gt;<br>
<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
After&nbsp;this&nbsp;point,&nbsp;the&nbsp;numbering&nbsp;continues:<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;&nbsp;&quot;S2_&quot;&nbsp;==&nbsp;N::T&lt;double,&nbsp;double&gt;<br>
&nbsp;&nbsp;&nbsp;&quot;S3_&quot;&nbsp;==&nbsp;N::T&lt;int,&nbsp;int&gt;::mf(N::T&lt;double,&nbsp;double&gt;)<br>
<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
Note&nbsp;that&nbsp;substitutable&nbsp;components&nbsp;are&nbsp;the&nbsp;represented&nbsp;symbolic&nbsp;constructs,<br>
not&nbsp;their&nbsp;associated&nbsp;mangling&nbsp;character&nbsp;strings.<br>
Thus,&nbsp;a&nbsp;substituted&nbsp;object&nbsp;matches&nbsp;its&nbsp;unsubstituted&nbsp;form,<br>
and&nbsp;a&nbsp;delimited&nbsp;&lt;function-type&gt;&nbsp;matches&nbsp;its&nbsp;&lt;bare-function-type&gt;.<br>
<br>
&lt;p&gt;<br>
In&nbsp;addition,<br>
the&nbsp;following&nbsp;catalog&nbsp;of&nbsp;abbreviations&nbsp;of&nbsp;the&nbsp;form&nbsp;&quot;Sx&quot;&nbsp;are&nbsp;used:<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;substitution&gt;&nbsp;::=&nbsp;St&nbsp;#&nbsp;::std::<br>
&nbsp;&nbsp;&nbsp;&lt;substitution&gt;&nbsp;::=&nbsp;Sa&nbsp;#&nbsp;::std::allocator<br>
&nbsp;&nbsp;&nbsp;&lt;substitution&gt;&nbsp;::=&nbsp;Sb&nbsp;#&nbsp;::std::basic_string<br>
&nbsp;&nbsp;&nbsp;&lt;substitution&gt;&nbsp;::=&nbsp;Ss&nbsp;#&nbsp;::std::basic_string&nbsp;&lt;&nbsp;char,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::std::char_traits&lt;char&gt;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::std::allocator&lt;char&gt;&nbsp;&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;substitution&gt;&nbsp;::=&nbsp;Si&nbsp;#&nbsp;::std::basic_istream&lt;char,&nbsp;&nbsp;std::char_traits&lt;char&gt;&nbsp;&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;substitution&gt;&nbsp;::=&nbsp;So&nbsp;#&nbsp;::std::basic_ostream&lt;char,&nbsp;&nbsp;std::char_traits&lt;char&gt;&nbsp;&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;substitution&gt;&nbsp;::=&nbsp;Sd&nbsp;#&nbsp;::std::basic_iostream&lt;char,&nbsp;std::char_traits&lt;char&gt;&nbsp;&gt;<br>
<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;abbreviation&nbsp;St&nbsp;is&nbsp;always&nbsp;an&nbsp;initial&nbsp;qualifier,<br>
i.e.&nbsp;appearing&nbsp;as&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;a&nbsp;compound&nbsp;name.<br>
It&nbsp;does&nbsp;not&nbsp;require&nbsp;N...E&nbsp;delimiters&nbsp;unless<br>
either&nbsp;followed&nbsp;by&nbsp;more&nbsp;than&nbsp;one&nbsp;additional&nbsp;composite&nbsp;name&nbsp;component,<br>
or&nbsp;preceded&nbsp;by&nbsp;CV-qualifiers&nbsp;for&nbsp;a&nbsp;member&nbsp;function.<br>
This&nbsp;adds&nbsp;the&nbsp;case:<br>
&lt;pre&gt;&lt;font&nbsp;color=blue&gt;&lt;code&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;name&gt;&nbsp;::=&nbsp;St&nbsp;&lt;unqualified-name&gt;&nbsp;#&nbsp;::std::<br>
<br>
&lt;/pre&gt;&lt;/font&gt;&lt;/code&gt;<br>
<br>
For&nbsp;example:<br>
&lt;code&gt;&lt;pre&gt;<br>
&nbsp;&nbsp;&nbsp;&quot;_ZSt5state&quot;:&nbsp;::std::state<br>
&nbsp;&nbsp;&nbsp;&quot;_ZNSt3_In4wardE&quot;:&nbsp;::std::_In::ward<br>
&lt;/pre&gt;&lt;/code&gt;<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=vague&gt;<br>
&lt;h3&gt;&nbsp;5.2&nbsp;Vague&nbsp;Linkage&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
Many&nbsp;objects&nbsp;in&nbsp;C++&nbsp;are&nbsp;not&nbsp;clearly&nbsp;part&nbsp;of&nbsp;a&nbsp;single&nbsp;object&nbsp;file,<br>
but&nbsp;are&nbsp;required&nbsp;by&nbsp;the&nbsp;ODR&nbsp;to&nbsp;have&nbsp;a&nbsp;single&nbsp;definition.<br>
This&nbsp;section&nbsp;identifies,&nbsp;for&nbsp;such&nbsp;objects,<br>
where&nbsp;(i.e.&nbsp;in&nbsp;which&nbsp;objects)&nbsp;they&nbsp;should&nbsp;be&nbsp;emitted,<br>
and&nbsp;what&nbsp;special&nbsp;treatment&nbsp;might&nbsp;be&nbsp;required&nbsp;if&nbsp;duplicates&nbsp;are&nbsp;possible.<br>
<br>
&lt;p&gt;<br>
In&nbsp;many&nbsp;cases,<br>
we&nbsp;will&nbsp;deal&nbsp;with&nbsp;duplicates&nbsp;by&nbsp;putting&nbsp;possibly&nbsp;duplicated&nbsp;objects<br>
in&nbsp;distinct&nbsp;ELF&nbsp;sections&nbsp;or&nbsp;groups&nbsp;of&nbsp;sections,<br>
and&nbsp;using&nbsp;the&nbsp;COMDAT&nbsp;feature&nbsp;of&nbsp;&lt;code&gt;SHT_GROUP&lt;/code&gt;&nbsp;sections&nbsp;in&nbsp;the<br>
gABI&nbsp;to&nbsp;remove&nbsp;duplicates.<br>
We&nbsp;will&nbsp;refer&nbsp;to&nbsp;this&nbsp;simply&nbsp;as&nbsp;using&nbsp;a&nbsp;COMDAT&nbsp;group,<br>
and&nbsp;specify&nbsp;the&nbsp;symbol&nbsp;to&nbsp;be&nbsp;used&nbsp;to&nbsp;identify&nbsp;duplicates&nbsp;in&nbsp;the<br>
&lt;code&gt;SHT_GROUP&lt;/code&gt;&nbsp;section.<br>
&lt;i&gt;<br>
COMDAT&nbsp;groups&nbsp;are&nbsp;a&nbsp;new&nbsp;gABI&nbsp;feature&nbsp;specified&nbsp;during&nbsp;the&nbsp;Itanium&nbsp;ABI<br>
definition,&nbsp;and&nbsp;may&nbsp;not&nbsp;be&nbsp;implemented&nbsp;everywhere&nbsp;immediately.<br>
See&nbsp;the&nbsp;separate&nbsp;&lt;a&nbsp;href=abi-examples.html#vague&gt;ABI&nbsp;examples&lt;/a&gt;<br>
document&nbsp;for&nbsp;a&nbsp;discussion&nbsp;of&nbsp;alternatives&nbsp;pending&nbsp;COMDAT&nbsp;implementation.<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
Note&nbsp;that&nbsp;nothing&nbsp;in&nbsp;this&nbsp;section&nbsp;should&nbsp;be&nbsp;construed&nbsp;to&nbsp;require&nbsp;COMDAT<br>
usage&nbsp;for&nbsp;objects&nbsp;with&nbsp;internal&nbsp;linkage&nbsp;unless&nbsp;they&nbsp;may&nbsp;in&nbsp;fact&nbsp;be<br>
referenced&nbsp;outside&nbsp;the&nbsp;translation&nbsp;unit&nbsp;where&nbsp;they&nbsp;appear,<br>
for&nbsp;instance&nbsp;due&nbsp;to&nbsp;inlining.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=vague-inline&gt;&lt;/a&gt;<br>
&lt;h4&gt;&nbsp;5.2.1&nbsp;Out-of-line&nbsp;Functions&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
It&nbsp;may&nbsp;sometimes&nbsp;be&nbsp;necessary&nbsp;or&nbsp;desirable&nbsp;to&nbsp;reference&nbsp;an&nbsp;out-of-line<br>
copy&nbsp;of&nbsp;a&nbsp;function&nbsp;declared&nbsp;inline,<br>
i.e.&nbsp;to&nbsp;reference&nbsp;a&nbsp;global&nbsp;symbol&nbsp;naming&nbsp;the&nbsp;function.<br>
This&nbsp;may&nbsp;occur&nbsp;because&nbsp;the&nbsp;implementation&nbsp;cannot,&nbsp;or&nbsp;chooses&nbsp;not&nbsp;to,<br>
inline&nbsp;the&nbsp;function,&nbsp;or&nbsp;because&nbsp;it&nbsp;needs&nbsp;an&nbsp;address&nbsp;rather&nbsp;than&nbsp;a&nbsp;call.<br>
In&nbsp;such&nbsp;a&nbsp;case,<br>
the&nbsp;function&nbsp;is&nbsp;to&nbsp;be&nbsp;emitted&nbsp;in&nbsp;each&nbsp;object&nbsp;where&nbsp;its&nbsp;name&nbsp;is&nbsp;referenced.<br>
A&nbsp;COMDAT&nbsp;group&nbsp;is&nbsp;used&nbsp;to&nbsp;eliminate&nbsp;duplicates,<br>
with&nbsp;the&nbsp;mangled&nbsp;name&nbsp;of&nbsp;the&nbsp;function&nbsp;as&nbsp;the&nbsp;identifying&nbsp;symbol.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=vague-static&gt;&lt;/a&gt;<br>
&lt;h4&gt;&nbsp;5.2.2&nbsp;Static&nbsp;Data&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
Inline&nbsp;functions,&nbsp;whether&nbsp;or&nbsp;not&nbsp;declared&nbsp;as&nbsp;such,<br>
and&nbsp;whether&nbsp;they&nbsp;are&nbsp;inline&nbsp;or&nbsp;out-of-line&nbsp;copies,<br>
may&nbsp;reference&nbsp;static&nbsp;data&nbsp;or&nbsp;character&nbsp;string&nbsp;literals,<br>
that&nbsp;must&nbsp;be&nbsp;kept&nbsp;in&nbsp;common&nbsp;among&nbsp;all&nbsp;copies<br>
by&nbsp;using&nbsp;the&nbsp;local&nbsp;symbol&nbsp;mangling&nbsp;defined&nbsp;above.<br>
These&nbsp;objects&nbsp;are&nbsp;named&nbsp;according&nbsp;to&nbsp;the&nbsp;rules&nbsp;for&nbsp;local&nbsp;names&nbsp;in&nbsp;the<br>
&lt;a&nbsp;href=#scope-encoding&gt;&nbsp;Scope&nbsp;Encoding&nbsp;&lt;/a&gt;&nbsp;section&nbsp;above,<br>
and&nbsp;the&nbsp;definition&nbsp;of&nbsp;each&nbsp;is&nbsp;emitted&nbsp;in&nbsp;a&nbsp;COMDAT&nbsp;group,<br>
identified&nbsp;by&nbsp;the&nbsp;symbol&nbsp;name&nbsp;described&nbsp;in&nbsp;the<br>
&lt;a&nbsp;href=#scope-encoding&gt;&nbsp;Scope&nbsp;Encoding&nbsp;&lt;/a&gt;&nbsp;section&nbsp;above.<br>
Each&nbsp;COMDAT&nbsp;group&nbsp;must&nbsp;be&nbsp;emitted&nbsp;in&nbsp;any&nbsp;object&nbsp;with&nbsp;references<br>
to&nbsp;the&nbsp;symbol&nbsp;for&nbsp;the&nbsp;object&nbsp;it&nbsp;contains,&nbsp;whether&nbsp;inline&nbsp;or&nbsp;out-of-line.<br>
<br>
&lt;p&gt;<br>
Local&nbsp;static&nbsp;data&nbsp;objects&nbsp;generally&nbsp;have&nbsp;associated&nbsp;guard&nbsp;variables<br>
used&nbsp;to&nbsp;ensure&nbsp;that&nbsp;they&nbsp;are&nbsp;initialized&nbsp;only&nbsp;once<br>
(see&nbsp;&lt;a&nbsp;href=once-ctor&gt;3.3.2&lt;/a&gt;).<br>
If&nbsp;the&nbsp;object&nbsp;is&nbsp;emitted&nbsp;using&nbsp;a&nbsp;COMDAT&nbsp;group,<br>
the&nbsp;guard&nbsp;variable&nbsp;must&nbsp;be&nbsp;too.<br>
It&nbsp;is&nbsp;suggested&nbsp;that&nbsp;it&nbsp;be&nbsp;emitted&nbsp;in&nbsp;the&nbsp;same&nbsp;COMDAT&nbsp;group&nbsp;as&nbsp;the<br>
associated&nbsp;data&nbsp;object,<br>
but&nbsp;it&nbsp;may&nbsp;be&nbsp;emitted&nbsp;in&nbsp;its&nbsp;own&nbsp;COMDAT&nbsp;group,<br>
identified&nbsp;by&nbsp;its&nbsp;name.<br>
In&nbsp;either&nbsp;case,&nbsp;it&nbsp;must&nbsp;be&nbsp;weak.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=vague-vtable&gt;&lt;/a&gt;<br>
&lt;h4&gt;&nbsp;5.2.3&nbsp;Virtual&nbsp;Tables&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;virtual&nbsp;table&nbsp;for&nbsp;a&nbsp;class&nbsp;is&nbsp;emitted&nbsp;in&nbsp;the&nbsp;same&nbsp;object&nbsp;containing<br>
the&nbsp;definition&nbsp;of&nbsp;its&nbsp;&lt;i&gt;key&nbsp;function&lt;/i&gt;,<br>
i.e.&nbsp;the&nbsp;first&nbsp;non-pure&nbsp;virtual&nbsp;function<br>
that&nbsp;is&nbsp;not&nbsp;inline&nbsp;at&nbsp;the&nbsp;point&nbsp;of&nbsp;class&nbsp;definition.<br>
If&nbsp;there&nbsp;is&nbsp;no&nbsp;key&nbsp;function,&nbsp;it&nbsp;is&nbsp;emitted&nbsp;everywhere&nbsp;used.<br>
The&nbsp;emitted&nbsp;virtual&nbsp;table&nbsp;includes&nbsp;the&nbsp;full&nbsp;virtual&nbsp;table&nbsp;group&nbsp;for&nbsp;the&nbsp;class,<br>
any&nbsp;new&nbsp;construction&nbsp;virtual&nbsp;tables&nbsp;required&nbsp;for&nbsp;subobjects,<br>
and&nbsp;the&nbsp;VTT&nbsp;for&nbsp;the&nbsp;class.<br>
They&nbsp;are&nbsp;emitted&nbsp;in&nbsp;a&nbsp;COMDAT&nbsp;group,<br>
with&nbsp;the&nbsp;virtual&nbsp;table&nbsp;mangled&nbsp;name&nbsp;as&nbsp;the&nbsp;identifying&nbsp;symbol.<br>
&lt;i&gt;<br>
Note&nbsp;that&nbsp;if&nbsp;the&nbsp;key&nbsp;function&nbsp;is&nbsp;not&nbsp;declared&nbsp;inline&nbsp;in&nbsp;the&nbsp;class&nbsp;definition,<br>
but&nbsp;its&nbsp;definition&nbsp;later&nbsp;is&nbsp;always&nbsp;declared&nbsp;inline,<br>
it&nbsp;will&nbsp;be&nbsp;emitted&nbsp;in&nbsp;every&nbsp;object&nbsp;containing&nbsp;the&nbsp;definition.<br>
<br>
&lt;span&nbsp;class=&quot;change&quot;&gt;Note&nbsp;also&nbsp;that&nbsp;if&nbsp;we&nbsp;had&nbsp;thought&nbsp;of&nbsp;it&nbsp;in&nbsp;time,&nbsp;we<br>
could&nbsp;also&nbsp;have&nbsp;used&nbsp;a&nbsp;pure&nbsp;virtual&nbsp;destructor&nbsp;as&nbsp;the&nbsp;key&nbsp;function,&nbsp;as&nbsp;it<br>
must&nbsp;be&nbsp;defined&nbsp;even&nbsp;though&nbsp;it&nbsp;is&nbsp;pure.&lt;/span&gt;<br>
&lt;/i&gt;<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=vague-rtti&gt;&lt;/a&gt;<br>
&lt;h4&gt;&nbsp;5.2.4&nbsp;Typeinfo&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
The&nbsp;RTTI&nbsp;std::type_info&nbsp;structure&nbsp;for&nbsp;a&nbsp;complete&nbsp;class&nbsp;type&nbsp;is<br>
emitted&nbsp;in&nbsp;the&nbsp;same&nbsp;object&nbsp;as&nbsp;its&nbsp;virtual&nbsp;table&nbsp;if&nbsp;dynamic,<br>
or&nbsp;everywhere&nbsp;referenced&nbsp;if&nbsp;not.<br>
The&nbsp;RTTI&nbsp;std::type_info&nbsp;structure&nbsp;for&nbsp;an&nbsp;incomplete&nbsp;class&nbsp;type&nbsp;is<br>
emitted&nbsp;wherever&nbsp;referenced.<br>
The&nbsp;RTTI&nbsp;std::type_info&nbsp;structures&nbsp;for&nbsp;various&nbsp;basic&nbsp;types&nbsp;as<br>
specified&nbsp;by&nbsp;the&nbsp;&lt;a&nbsp;href=#rtti&gt;Run-Time&nbsp;Type&nbsp;Information&lt;/a&gt;&nbsp;section<br>
are&nbsp;provided&nbsp;by&nbsp;the&nbsp;runtime&nbsp;library.<br>
The&nbsp;RTTI&nbsp;name&nbsp;NTBS&nbsp;objects&nbsp;are&nbsp;emitted&nbsp;with&nbsp;each&nbsp;referencing<br>
std::type_info&nbsp;object.<br>
<br>
&lt;p&gt;<br>
The&nbsp;RTTI&nbsp;std::type_info&nbsp;structures&nbsp;for&nbsp;complete&nbsp;class&nbsp;types&nbsp;and&nbsp;basic<br>
types&nbsp;are&nbsp;emitted&nbsp;in&nbsp;COMDAT&nbsp;groups&nbsp;identified&nbsp;by&nbsp;their&nbsp;mangled&nbsp;names.<br>
The&nbsp;RTTI&nbsp;std::type_info&nbsp;structures&nbsp;for&nbsp;incomplete&nbsp;class&nbsp;types<br>
are&nbsp;emitted&nbsp;with&nbsp;other&nbsp;than&nbsp;the&nbsp;ABI-defined&nbsp;complete&nbsp;type&nbsp;mangled&nbsp;names;<br>
an&nbsp;implementation&nbsp;may&nbsp;choose&nbsp;to&nbsp;emit&nbsp;them&nbsp;as&nbsp;local&nbsp;static&nbsp;objects,<br>
or&nbsp;in&nbsp;COMDAT&nbsp;groups&nbsp;with&nbsp;implementation-defined&nbsp;names&nbsp;and&nbsp;COMDAT&nbsp;identifiers.<br>
The&nbsp;RTTI&nbsp;name&nbsp;NTBS&nbsp;objects&nbsp;are&nbsp;emitted&nbsp;in&nbsp;separate&nbsp;COMDAT&nbsp;groups<br>
identified&nbsp;by&nbsp;the&nbsp;NTBS&nbsp;mangled&nbsp;names<br>
as&nbsp;weak&nbsp;symbols.<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=vague-ctor&gt;&lt;/a&gt;<br>
&lt;h4&gt;&nbsp;5.2.5&nbsp;Constructors&nbsp;and&nbsp;Destructors&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
Constructors&nbsp;and&nbsp;destructors&nbsp;for&nbsp;a&nbsp;class,<br>
whether&nbsp;implicitly-defined&nbsp;or&nbsp;user-defined,<br>
are&nbsp;emitted&nbsp;under&nbsp;the&nbsp;same&nbsp;rules&nbsp;as&nbsp;other&nbsp;functions.<br>
That&nbsp;is,&nbsp;user-defined&nbsp;constructors&nbsp;or&nbsp;destructors,<br>
unless&nbsp;the&nbsp;function&nbsp;is&nbsp;declared&nbsp;inline,&nbsp;or&nbsp;has&nbsp;internal&nbsp;linkage,<br>
are&nbsp;emitted&nbsp;where&nbsp;defined,<br>
with&nbsp;all&nbsp;variants&nbsp;required&nbsp;(in-charge/not-in-charge).<br>
A&nbsp;user-defined&nbsp;constructor&nbsp;or&nbsp;destructor&nbsp;with&nbsp;non-inline,<br>
internal&nbsp;linkage&nbsp;is&nbsp;emitted&nbsp;where&nbsp;defined,<br>
with&nbsp;only&nbsp;the&nbsp;variants&nbsp;actually&nbsp;referenced.<br>
Implicitly-defined&nbsp;or&nbsp;inline&nbsp;user-defined&nbsp;constructors&nbsp;and&nbsp;destructors<br>
are&nbsp;emitted&nbsp;where&nbsp;referenced,<br>
each&nbsp;in&nbsp;its&nbsp;own&nbsp;COMDAT&nbsp;group&nbsp;identified&nbsp;by&nbsp;the&nbsp;constructor&nbsp;or<br>
destructor&nbsp;name.<br>
<br>
&lt;p&gt;<br>
This&nbsp;ABI&nbsp;does&nbsp;not&nbsp;require&nbsp;the&nbsp;generation&nbsp;or&nbsp;use&nbsp;of&nbsp;allocating&nbsp;constructors,<br>
although&nbsp;it&nbsp;specifies&nbsp;names&nbsp;for&nbsp;them&nbsp;if&nbsp;an&nbsp;implementation&nbsp;chooses&nbsp;to&nbsp;use&nbsp;them.<br>
If&nbsp;the&nbsp;object&nbsp;where&nbsp;a&nbsp;constructor&nbsp;is&nbsp;defined&nbsp;may&nbsp;be&nbsp;compiled&nbsp;by<br>
another&nbsp;implementation,<br>
an&nbsp;implementation&nbsp;using&nbsp;it&nbsp;must&nbsp;emit&nbsp;it&nbsp;whereever&nbsp;referenced,<br>
in&nbsp;a&nbsp;COMDAT&nbsp;group&nbsp;identified&nbsp;by&nbsp;the&nbsp;constructor&nbsp;name.<br>
<br>
&lt;p&gt;<br>
&lt;div&nbsp;class=change&gt;<br>
&lt;strike&gt;<br>
&lt;a&nbsp;name=vague-vfunc&gt;&lt;/a&gt;<br>
&lt;h4&gt;&nbsp;5.2.6&nbsp;Virtual&nbsp;Function&nbsp;Override&nbsp;Thunks&nbsp;&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
Normally,&nbsp;a&nbsp;virtual&nbsp;function&nbsp;override&nbsp;thunk&nbsp;becomes&nbsp;necessary&nbsp;when&nbsp;an<br>
overriding&nbsp;virtual&nbsp;function&nbsp;is&nbsp;declared.<br>
In&nbsp;such&nbsp;cases,&nbsp;it&nbsp;is&nbsp;emitted&nbsp;with&nbsp;the&nbsp;overriding&nbsp;virtual&nbsp;function,<br>
and&nbsp;needs&nbsp;to&nbsp;have&nbsp;vague&nbsp;linkage&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;the&nbsp;base&nbsp;function&nbsp;does,<br>
so&nbsp;it&nbsp;should&nbsp;be&nbsp;included&nbsp;in&nbsp;the&nbsp;base&nbsp;function's&nbsp;COMDAT&nbsp;group.<br>
<br>
&lt;p&gt;<br>
However,&nbsp;it&nbsp;is&nbsp;possible&nbsp;to&nbsp;determine&nbsp;that&nbsp;an&nbsp;override&nbsp;thunk&nbsp;is&nbsp;needed<br>
after&nbsp;the&nbsp;base&nbsp;function&nbsp;is&nbsp;declared.<br>
For&nbsp;instance,&nbsp;consider&nbsp;this&nbsp;example:<br>
<br>
&lt;code&gt;&lt;pre&gt;<br>
struct&nbsp;A&nbsp;{&nbsp;virtual&nbsp;void&nbsp;f();&nbsp;};<br>
struct&nbsp;B&nbsp;:&nbsp;virtual&nbsp;public&nbsp;A&nbsp;{&nbsp;int&nbsp;i;&nbsp;};<br>
struct&nbsp;C&nbsp;:&nbsp;virtual&nbsp;public&nbsp;A&nbsp;{&nbsp;int&nbsp;j;&nbsp;};<br>
struct&nbsp;D&nbsp;:&nbsp;public&nbsp;B,&nbsp;public&nbsp;C&nbsp;{};<br>
<br>
&lt;/pre&gt;&lt;/code&gt;&nbsp;<br>
&lt;p&gt;<br>
When&nbsp;B&nbsp;and&nbsp;C&nbsp;are&nbsp;declared,&nbsp;A&nbsp;is&nbsp;a&nbsp;primary&nbsp;base&nbsp;in&nbsp;each&nbsp;case,<br>
so&nbsp;although&nbsp;vcall&nbsp;offsets&nbsp;are&nbsp;allocated&nbsp;in&nbsp;the&nbsp;A-in-B&nbsp;and&nbsp;A-in-C&nbsp;vtables,<br>
no&nbsp;'this'&nbsp;adjustment&nbsp;is&nbsp;required&nbsp;and&nbsp;no&nbsp;thunk&nbsp;is&nbsp;generated.<br>
However,&nbsp;inside&nbsp;D&nbsp;objects,&nbsp;A&nbsp;is&nbsp;no&nbsp;longer&nbsp;a&nbsp;primary&nbsp;base&nbsp;of&nbsp;C,<br>
and&nbsp;calls&nbsp;to&nbsp;C::f()&nbsp;must&nbsp;adjust&nbsp;'this'&nbsp;from&nbsp;C*&nbsp;to&nbsp;B::A*,<br>
so&nbsp;a&nbsp;thunk&nbsp;is&nbsp;required.<br>
<br>
&lt;p&gt;<br>
In&nbsp;such&nbsp;cases,&nbsp;where&nbsp;the&nbsp;need&nbsp;for&nbsp;a&nbsp;thunk&nbsp;is&nbsp;identified<br>
after&nbsp;the&nbsp;base&nbsp;function&nbsp;is&nbsp;declared,<br>
the&nbsp;thunk&nbsp;is&nbsp;emitted&nbsp;in&nbsp;a&nbsp;COMDAT&nbsp;group,<br>
identified&nbsp;by&nbsp;the&nbsp;(mangled)&nbsp;thunk&nbsp;name.<br>
It&nbsp;must&nbsp;be&nbsp;emitted&nbsp;in&nbsp;the&nbsp;object&nbsp;containing&nbsp;the&nbsp;key&nbsp;function&nbsp;definition<br>
for&nbsp;any&nbsp;class&nbsp;that&nbsp;causes&nbsp;it&nbsp;to&nbsp;be&nbsp;needed&nbsp;(D&nbsp;in&nbsp;the&nbsp;above&nbsp;example),<br>
or&nbsp;in&nbsp;all&nbsp;objects&nbsp;referencing&nbsp;it&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;key&nbsp;function.<br>
Observe&nbsp;that&nbsp;different&nbsp;class&nbsp;hierarchies&nbsp;with&nbsp;the&nbsp;same&nbsp;virtual&nbsp;base&nbsp;may<br>
require&nbsp;override&nbsp;thunks&nbsp;for&nbsp;the&nbsp;same&nbsp;base&nbsp;function,<br>
which&nbsp;will&nbsp;coincide&nbsp;iff&nbsp;the&nbsp;adjustment&nbsp;offsets&nbsp;do.<br>
&lt;/strike&gt;<br>
<br>
&lt;p&gt;<br>
&lt;a&nbsp;name=vague-itemplate&gt;&lt;/a&gt;<br>
&lt;h4&gt;&nbsp;5.2.7&nbsp;Instantiated&nbsp;Templates&lt;/h4&gt;<br>
<br>
&lt;p&gt;<br>
An&nbsp;instantiation&nbsp;of&nbsp;a&nbsp;class&nbsp;template&nbsp;requires:<br>
<br>
&lt;ul&gt;<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;In&nbsp;the&nbsp;object&nbsp;where&nbsp;instantiated,<br>
&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;virtual&nbsp;table,&nbsp;any&nbsp;subobject&nbsp;construction&nbsp;virtual&nbsp;tables,&nbsp;and&nbsp;the&nbsp;VTT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;are&nbsp;emitted&nbsp;in&nbsp;a&nbsp;COMDAT&nbsp;identified&nbsp;by&nbsp;the&nbsp;virtual&nbsp;table&nbsp;mangled&nbsp;name.<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Any&nbsp;static&nbsp;member&nbsp;data&nbsp;object&nbsp;is&nbsp;emitted&nbsp;in&nbsp;a&nbsp;COMDAT&nbsp;identified&nbsp;by<br>
&nbsp;&nbsp;&nbsp;&nbsp;its&nbsp;mangled&nbsp;name,<br>
&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;any&nbsp;object&nbsp;file&nbsp;with&nbsp;a&nbsp;reference&nbsp;to&nbsp;its&nbsp;name&nbsp;symbol.<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;In&nbsp;the&nbsp;object&nbsp;where&nbsp;instantiated,<br>
&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;member&nbsp;functions&nbsp;are&nbsp;emitted&nbsp;in&nbsp;COMDAT&nbsp;groups<br>
&nbsp;&nbsp;&nbsp;&nbsp;identified&nbsp;by&nbsp;the&nbsp;function&nbsp;name.<br>
&lt;p&gt;<br>
&lt;li&gt;&nbsp;A&nbsp;non-inline,&nbsp;non-virtual&nbsp;member&nbsp;function&nbsp;is&nbsp;emitted&nbsp;in&nbsp;any&nbsp;object<br>
&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;its&nbsp;symbol&nbsp;is&nbsp;referenced<br>
&nbsp;&nbsp;&nbsp;&nbsp;(i.e.&nbsp;if&nbsp;the&nbsp;function&nbsp;is&nbsp;called&nbsp;without&nbsp;inlining,<br>
&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;its&nbsp;name&nbsp;is&nbsp;referenced&nbsp;without&nbsp;calling&nbsp;it),<br>
&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;a&nbsp;COMDAT&nbsp;group&nbsp;identified&nbsp;by&nbsp;the&nbsp;function&nbsp;name.<br>
&lt;/ul&gt;<br>
<br>
&lt;p&gt;<br>
An&nbsp;instantiation&nbsp;of&nbsp;a&nbsp;function&nbsp;template&nbsp;or&nbsp;member&nbsp;function&nbsp;template<br>
is&nbsp;emitted&nbsp;in&nbsp;any&nbsp;object&nbsp;where&nbsp;its&nbsp;symbol&nbsp;is&nbsp;referenced&nbsp;(non-inline),<br>
in&nbsp;a&nbsp;COMDAT&nbsp;group&nbsp;identified&nbsp;by&nbsp;the&nbsp;function&nbsp;name.<br>
<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=unwind&gt;<br>
&lt;h3&gt;&nbsp;5.3&nbsp;Unwind&nbsp;Table&nbsp;Location&nbsp;&lt;/h3&gt;<br>
<br>
&lt;p&gt;<br>
As&nbsp;described&nbsp;in&nbsp;the&nbsp;Itanium&nbsp;psABI,<br>
Itanium&nbsp;implementations&nbsp;shall&nbsp;produce&nbsp;unwind&nbsp;table&nbsp;entries&nbsp;in&nbsp;a<br>
&lt;code&gt;SHT_IA_64_UNWIND&lt;/code&gt;&nbsp;section,<br>
and&nbsp;unwind&nbsp;information&nbsp;descriptors&nbsp;in&nbsp;a&nbsp;section&nbsp;that&nbsp;will&nbsp;be&nbsp;linked<br>
with&nbsp;the&nbsp;associated&nbsp;code.<br>
Itanium&nbsp;linkers&nbsp;shall&nbsp;put&nbsp;the&nbsp;unwind&nbsp;table,<br>
the&nbsp;unwind&nbsp;information&nbsp;table,<br>
and&nbsp;the&nbsp;associated&nbsp;code&nbsp;in&nbsp;a&nbsp;single&nbsp;text&nbsp;segment,<br>
with&nbsp;a&nbsp;&lt;code&gt;PT_IA_64_UNWIND&lt;/code&gt;&nbsp;program&nbsp;table&nbsp;entry&nbsp;identifying&nbsp;the<br>
unwind&nbsp;table&nbsp;location.<br>
<br>
<br>
&lt;p&gt;<br>
&lt;hr&gt;<br>
<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
&lt;a&nbsp;name=revisions&gt;<br>
&lt;h2&gt;&nbsp;Appendix&nbsp;R:&nbsp;Revision&nbsp;History&nbsp;&lt;/h2&gt;<br>
&lt;p&gt;&nbsp;&lt;hr&gt;&nbsp;&lt;p&gt;<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=bule&gt;[020827]&lt;/font&gt;<br>
Clarify&nbsp;definition&nbsp;of&nbsp;nearly&nbsp;empty&nbsp;class,&nbsp;dsize,&nbsp;nvsize,&nbsp;nvalign.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=bule&gt;[020827]&lt;/font&gt;<br>
Clarify&nbsp;handling&nbsp;of&nbsp;tail-padding.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[020220]&lt;/font&gt;<br>
Clarify&nbsp;pointer&nbsp;to&nbsp;member&nbsp;function&nbsp;mangling&nbsp;(5.1.5).<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[010407]&lt;/font&gt;<br>
Don't&nbsp;assume&nbsp;that&nbsp;virtual&nbsp;functions&nbsp;can&nbsp;be&nbsp;called&nbsp;through&nbsp;intermediate&nbsp;bases.<br>
Add&nbsp;notes&nbsp;about&nbsp;missed&nbsp;opportunities.<br>
The&nbsp;VTT&nbsp;parm&nbsp;isn't&nbsp;mangled,&nbsp;either.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[010315]&lt;/font&gt;<br>
Many&nbsp;outstanding&nbsp;updates.<br>
Empty&nbsp;classes&nbsp;passed&nbsp;as&nbsp;ordinary&nbsp;classes&nbsp;(3.1.3).<br>
Secondary&nbsp;virtual&nbsp;pointers&nbsp;for&nbsp;subobjects&nbsp;reachable&nbsp;via&nbsp;a&nbsp;virtual&nbsp;path&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(text&nbsp;of&nbsp;2.6.1,&nbsp;text&nbsp;and&nbsp;example&nbsp;in&nbsp;2.6.2).<br>
Note&nbsp;about&nbsp;locating&nbsp;virtual&nbsp;bases&nbsp;statically&nbsp;during&nbsp;construction&nbsp;(2.6.1).<br>
Rename&nbsp;IA-64&nbsp;to&nbsp;Itanium&nbsp;throughout.<br>
Add&nbsp;__cxa_vec_cleanup&nbsp;(3.3.3).<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000817]&lt;/font&gt;<br>
Updates&nbsp;from&nbsp;17&nbsp;August&nbsp;meeting,&nbsp;email.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000807]&lt;/font&gt;<br>
Added&nbsp;base&nbsp;document&nbsp;section&nbsp;(1.5).<br>
Further&nbsp;RTTI&nbsp;field&nbsp;name&nbsp;cleanup&nbsp;(2.9.5).<br>
Update&nbsp;proposed&nbsp;one-time&nbsp;construction&nbsp;API&nbsp;(3.3.2).<br>
Update&nbsp;proposed&nbsp;object&nbsp;construction&nbsp;priority&nbsp;API&nbsp;(3.3.4).<br>
Removed&nbsp;&lt;name&gt;&nbsp;substitution&nbsp;(5.1.2).<br>
COMDAT&nbsp;not&nbsp;generally&nbsp;necessary&nbsp;for&nbsp;internal&nbsp;linkage&nbsp;(5.2).<br>
COMDAT&nbsp;for&nbsp;local&nbsp;static&nbsp;guard&nbsp;variables&nbsp;(5.2.2).<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000727]&lt;/font&gt;<br>
Updates&nbsp;from&nbsp;20&nbsp;July&nbsp;meeting.<br>
Added&nbsp;section&nbsp;on&nbsp;controlling&nbsp;object&nbsp;construction&nbsp;order&nbsp;(3.3.4).<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000707]&lt;/font&gt;<br>
Introduce&nbsp;consistent&nbsp;type_info&nbsp;field&nbsp;names&nbsp;(2.9.5).<br>
Removed&nbsp;vmi&nbsp;flags&nbsp;for&nbsp;publicly/non-publicly&nbsp;inherited&nbsp;bases&nbsp;(2.9.5).<br>
Collect&nbsp;all&nbsp;construction/destruction&nbsp;APIs&nbsp;in&nbsp;one&nbsp;section&nbsp;(3.3).<br>
Added&nbsp;one-time&nbsp;initialization&nbsp;API&nbsp;(3.3.2).<br>
Vector&nbsp;construction/destruction&nbsp;routines&nbsp;are&nbsp;extern&nbsp;&quot;C&quot;&nbsp;(3.3.3).<br>
Added&nbsp;routines&nbsp;for&nbsp;vector&nbsp;construction/destruction&nbsp;(3.3.3).<br>
Added&nbsp;copy&nbsp;construction&nbsp;runtime&nbsp;API&nbsp;(3.3.3).<br>
Make&nbsp;Alex's&nbsp;changes&nbsp;in&nbsp;mangling&nbsp;grammar&nbsp;(5.1).<br>
Add&nbsp;&lt;special-name&gt;&nbsp;cases&nbsp;for&nbsp;covariant&nbsp;override&nbsp;thunks&nbsp;(5.1.4).<br>
Allow&nbsp;expressions&nbsp;as&nbsp;array&nbsp;type&nbsp;dimensions&nbsp;(5.1.5).<br>
Discuss&nbsp;vague&nbsp;linkage&nbsp;for&nbsp;virtual&nbsp;function&nbsp;override&nbsp;thunks&nbsp;(5.2.6).<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000621]&lt;/font&gt;<br>
Add&nbsp;scope&nbsp;section&nbsp;1.4.<br>
Specify&nbsp;guard&nbsp;variables&nbsp;and&nbsp;vague&nbsp;linkage&nbsp;of&nbsp;static&nbsp;data&nbsp;(5.2.2)<br>
and&nbsp;instantiated&nbsp;templates&nbsp;(5.2.4).<br>
Clarify&nbsp;vcall&nbsp;offsets&nbsp;(2.5.3),&nbsp;VTT&nbsp;(2.6.2),<br>
mangling&nbsp;compression&nbsp;rules&nbsp;(5.1.7),&nbsp;and&nbsp;mangling&nbsp;examples.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000511]&lt;/font&gt;<br>
Specify&nbsp;32-bit&nbsp;form&nbsp;of&nbsp;vmi_offset_flags.<br>
Add&nbsp;export&nbsp;template&nbsp;note.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000505]&lt;/font&gt;<br>
Updates&nbsp;from&nbsp;4&nbsp;May&nbsp;meeting.<br>
VTT&nbsp;is&nbsp;preorder,&nbsp;like&nbsp;everything&nbsp;else.<br>
Add&nbsp;issue&nbsp;C-3&nbsp;destructor&nbsp;API.<br>
Added&nbsp;demangler&nbsp;API.<br>
Yet&nbsp;another&nbsp;try&nbsp;at&nbsp;the&nbsp;nested-name&nbsp;mangling&nbsp;grammar.<br>
Don't&nbsp;mangle&nbsp;builtin&nbsp;types&nbsp;(except&nbsp;vendor&nbsp;extended&nbsp;ones).<br>
Reverse&nbsp;mangling&nbsp;substitution&nbsp;order,<br>
and&nbsp;fix&nbsp;mangling&nbsp;substitution&nbsp;examples,<br>
Add&nbsp;vague&nbsp;linkage&nbsp;information&nbsp;for&nbsp;instantiated&nbsp;templates.<br>
Specify&nbsp;location&nbsp;of&nbsp;unwind&nbsp;tables.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000502]&lt;/font&gt;<br>
Fixed&nbsp;mangling&nbsp;of&nbsp;template&nbsp;parameters&nbsp;again.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000427]&lt;/font&gt;<br>
Reorganization&nbsp;and&nbsp;section&nbsp;numbering.<br>
Added&nbsp;&lt;a&nbsp;href=#normal-call&gt;non-virtual&nbsp;function&nbsp;calling&nbsp;conventions&lt;/a&gt;.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000417]&lt;/font&gt;<br>
Updates&nbsp;from&nbsp;17&nbsp;April&nbsp;meeting.<br>
Clarify&nbsp;order&nbsp;of&nbsp;vcall&nbsp;offsets.<br>
More&nbsp;elaboration&nbsp;of&nbsp;construction&nbsp;virtual&nbsp;table.<br>
Specification&nbsp;of&nbsp;COMDAT&nbsp;RTTI&nbsp;name.<br>
Reorganization&nbsp;of&nbsp;pointer&nbsp;RTTI.<br>
Modify&nbsp;mangling&nbsp;grammar&nbsp;to&nbsp;clarify&nbsp;substitution&nbsp;in&nbsp;compound&nbsp;names.<br>
Clarify&nbsp;Vague&nbsp;Linkage&nbsp;section.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000407]&lt;/font&gt;<br>
Updates&nbsp;from&nbsp;6&nbsp;April&nbsp;meeting,&nbsp;email.<br>
More&nbsp;elaboration&nbsp;of&nbsp;construction&nbsp;vtable.<br>
Updates/issues&nbsp;in&nbsp;RTTI.<br>
Minor&nbsp;mangling&nbsp;changes.<br>
Added&nbsp;Vague&nbsp;Linkage&nbsp;section.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000327]&lt;/font&gt;<br>
Updates&nbsp;from&nbsp;30&nbsp;March&nbsp;meeting.<br>
Define&nbsp;base&nbsp;classes&nbsp;to&nbsp;include&nbsp;self,&nbsp;proper&nbsp;base&nbsp;classes.<br>
Modify&nbsp;local&nbsp;function&nbsp;mangling&nbsp;per&nbsp;JFW&nbsp;proposal.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000327]&lt;/font&gt;<br>
Updates&nbsp;from&nbsp;23&nbsp;March&nbsp;meeting.<br>
Adopt&nbsp;construction&nbsp;vtable&nbsp;Proposal&nbsp;B,&nbsp;and&nbsp;rewrite.<br>
Further&nbsp;work&nbsp;on&nbsp;mangling,&nbsp;especially&nbsp;substitution.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000320]&lt;/font&gt;<br>
Clarify&nbsp;class&nbsp;size&nbsp;limit.<br>
Editorial&nbsp;changes&nbsp;in&nbsp;vtable&nbsp;components&nbsp;description.<br>
Add&nbsp;alternate&nbsp;to&nbsp;construction&nbsp;vtable&nbsp;proposal.<br>
Clarification&nbsp;in&nbsp;array&nbsp;cookie&nbsp;specification.<br>
Removed&nbsp;COMMON&nbsp;proxy&nbsp;from&nbsp;class&nbsp;RTTI.<br>
Extensive&nbsp;changes&nbsp;to&nbsp;mangling&nbsp;writeup.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000314]&lt;/font&gt;<br>
Construction&nbsp;vtable&nbsp;modifications.<br>
RTTI&nbsp;modifications&nbsp;for&nbsp;incomplete&nbsp;class&nbsp;types.<br>
Mangling&nbsp;rework:&nbsp;grammar,&nbsp;new&nbsp;constructs,&nbsp;function&nbsp;return&nbsp;types.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000309]&lt;/font&gt;<br>
Add&nbsp;limits&nbsp;section.<br>
Specify&nbsp;NULL&nbsp;member&nbsp;pointer&nbsp;values.<br>
Combine&nbsp;vtable&nbsp;content&nbsp;and&nbsp;order&nbsp;sections;&nbsp;clarify&nbsp;ordering.<br>
Specify&nbsp;when&nbsp;distinct&nbsp;virtual&nbsp;function&nbsp;entries&nbsp;are&nbsp;needed&nbsp;for&nbsp;overriders.<br>
Define&nbsp;(and&nbsp;modify)&nbsp;vector&nbsp;constructor/destructor&nbsp;runtime&nbsp;APIs.<br>
Virtual&nbsp;base&nbsp;offsets&nbsp;are&nbsp;promoted&nbsp;from&nbsp;non-virtual&nbsp;bases.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000228]&lt;/font&gt;<br>
Add&nbsp;thunk&nbsp;definition.<br>
Revise&nbsp;inheritance&nbsp;graph&nbsp;order&nbsp;definition.<br>
Fix&nbsp;member&nbsp;function&nbsp;pointer&nbsp;description&nbsp;(no&nbsp;division&nbsp;by&nbsp;two).<br>
Move&nbsp;bitfield&nbsp;allocation&nbsp;description&nbsp;(much&nbsp;modified)<br>
to&nbsp;the&nbsp;non-virtual-base&nbsp;allocation&nbsp;description.<br>
Replace&nbsp;virtual&nbsp;function&nbsp;calling&nbsp;convention&nbsp;description.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000228]&lt;/font&gt;<br>
Add&nbsp;thunk&nbsp;definition.<br>
Revise&nbsp;inheritance&nbsp;graph&nbsp;order&nbsp;definition.<br>
Fix&nbsp;member&nbsp;function&nbsp;pointer&nbsp;description&nbsp;(no&nbsp;division&nbsp;by&nbsp;two).<br>
Move&nbsp;bitfield&nbsp;allocation&nbsp;description&nbsp;(much&nbsp;modified)<br>
to&nbsp;the&nbsp;non-virtual-base&nbsp;allocation&nbsp;description.<br>
Replace&nbsp;virtual&nbsp;function&nbsp;calling&nbsp;convention&nbsp;description.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000217]&lt;/font&gt;<br>
Add&nbsp;excess-size&nbsp;bitfield&nbsp;specification.<br>
Add&nbsp;namespace/header&nbsp;section.<br>
Touch&nbsp;up&nbsp;array&nbsp;new&nbsp;cookies.<br>
Remove&nbsp;construction&nbsp;vtable&nbsp;example&nbsp;to&nbsp;new&nbsp;file.<br>
Add&nbsp;mangling&nbsp;proposal.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000214]&lt;/font&gt;<br>
Complete&nbsp;array&nbsp;new&nbsp;cookie&nbsp;specification.<br>
Remove&nbsp;unnecessary&nbsp;RTTI&nbsp;flags.<br>
Correct&nbsp;repeated&nbsp;inheritance&nbsp;flag&nbsp;description.<br>
Move&nbsp;all&nbsp;type_info&nbsp;subclasses&nbsp;in&nbsp;namespace&nbsp;abi,&nbsp;not&nbsp;namespace&nbsp;std.<br>
Note&nbsp;requirements&nbsp;for&nbsp;an&nbsp;implementation&nbsp;to&nbsp;prevent&nbsp;users&nbsp;from&nbsp;emitting<br>
invalid&nbsp;vtables&nbsp;for&nbsp;RTTI&nbsp;classes.<br>
Include&nbsp;construction&nbsp;vtable&nbsp;proposal.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000203]&lt;/font&gt;<br>
Incorporate&nbsp;discussion&nbsp;of&nbsp;3&nbsp;Febrary.<br>
Remove&nbsp;__reference_type_info&nbsp;(issue&nbsp;A-22).<br>
Restructure&nbsp;struct&nbsp;RTTI&nbsp;and&nbsp;flags&nbsp;(issue&nbsp;A-23).<br>
Clarify&nbsp;__base_class_info&nbsp;layout.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000125]&lt;/font&gt;<br>
Incorporate&nbsp;discussion&nbsp;of&nbsp;20&nbsp;January,&nbsp;generally&nbsp;clarifications.<br>
Resolved&nbsp;A-19&nbsp;(choice&nbsp;of&nbsp;a&nbsp;primary&nbsp;virtual&nbsp;base).<br>
Answered&nbsp;Nathan's&nbsp;questions&nbsp;about&nbsp;RTTI.<br>
Included&nbsp;RTTI&nbsp;&quot;Deliberations&quot;&nbsp;as&nbsp;rationale&nbsp;notes&nbsp;in&nbsp;the&nbsp;specification,<br>
or&nbsp;removed&nbsp;redundant&nbsp;ones.<br>
Added&nbsp;array&nbsp;operator&nbsp;new&nbsp;section.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[000119]&lt;/font&gt;<br>
Clarify&nbsp;when&nbsp;virtual&nbsp;base&nbsp;offsets&nbsp;are&nbsp;required.<br>
Note&nbsp;that&nbsp;a&nbsp;vtable&nbsp;has&nbsp;offset-to-top&nbsp;and&nbsp;RTTr&nbsp;entries&nbsp;for&nbsp;classes&nbsp;with<br>
virtual&nbsp;bases&nbsp;even&nbsp;if&nbsp;there&nbsp;are&nbsp;no&nbsp;virtual&nbsp;functions.<br>
Resolve&nbsp;allocation&nbsp;of&nbsp;a&nbsp;virtual&nbsp;base&nbsp;class&nbsp;that&nbsp;is&nbsp;a&nbsp;primary&nbsp;base&nbsp;for<br>
another&nbsp;base&nbsp;(A-17).<br>
Resolve&nbsp;choice&nbsp;of&nbsp;a&nbsp;primary&nbsp;virtual&nbsp;base&nbsp;class&nbsp;that&nbsp;is&nbsp;a&nbsp;primary&nbsp;base&nbsp;for<br>
another&nbsp;base&nbsp;(A-19).<br>
Describe&nbsp;the&nbsp;(non-)effect&nbsp;of&nbsp;virtual&nbsp;bases&nbsp;on&nbsp;the&nbsp;alignment&nbsp;of&nbsp;the<br>
non-virtual&nbsp;part&nbsp;of&nbsp;a&nbsp;class&nbsp;as&nbsp;the&nbsp;base&nbsp;of&nbsp;another&nbsp;class&nbsp;(A-18).<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[991230]&lt;/font&gt;<br>
Integrate&nbsp;proposed&nbsp;resolution&nbsp;of&nbsp;A-16,&nbsp;A-17&nbsp;in&nbsp;base&nbsp;class&nbsp;layout.<br>
Add&nbsp;outstanding&nbsp;questions&nbsp;list,&nbsp;and&nbsp;clean&nbsp;up&nbsp;questions&nbsp;in&nbsp;text.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[991229]&lt;/font&gt;<br>
Clarify&nbsp;definition&nbsp;of&nbsp;nearly&nbsp;empty&nbsp;class,&nbsp;layout&nbsp;of&nbsp;virtual&nbsp;bases.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[991203]&lt;/font&gt;<br>
Added&nbsp;description&nbsp;of&nbsp;vfunc&nbsp;calling&nbsp;convention&nbsp;from&nbsp;Jason.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[991104]&lt;/font&gt;<br>
Noted&nbsp;pair&nbsp;of&nbsp;vtable&nbsp;entries&nbsp;for&nbsp;virtual&nbsp;destructors.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[991019]&lt;/font&gt;<br>
Modified&nbsp;RTTI&nbsp;proposal&nbsp;for&nbsp;14&nbsp;October&nbsp;decisions.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[991006]&lt;/font&gt;<br>
Added&nbsp;RTTI&nbsp;proposal.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990930]&lt;/font&gt;<br>
Updated&nbsp;to&nbsp;new&nbsp;vtable&nbsp;layout&nbsp;proposal.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990811]&lt;/font&gt;<br>
Described&nbsp;member&nbsp;pointer&nbsp;representations,&nbsp;virtual&nbsp;table&nbsp;layout.<br>
<br>
&lt;p&gt;<br>
&lt;font&nbsp;color=blue&gt;[990730]&lt;/font&gt;<br>
Selected&nbsp;first&nbsp;variant&nbsp;for&nbsp;empty&nbsp;base&nbsp;allocation;&nbsp;removed&nbsp;others.<br>
<br>
&lt;p&gt;<br>
&lt;hr&gt;<br>
<br>
&lt;p&gt;<br>
Please&nbsp;send&nbsp;corrections&nbsp;to&nbsp;&lt;a&nbsp;href=&quot;mailto:samuel@codesourcery.com&quot;&gt;Alex&nbsp;Samuel&lt;/a&gt;.<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>

</tt>

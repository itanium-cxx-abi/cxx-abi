<tt>
&lt;!doctype&nbsp;html&nbsp;public&nbsp;&quot;-//w3c//dtd&nbsp;html&nbsp;4.0&nbsp;transitional//en&quot;&gt;&lt;html&gt;&lt;head&gt;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;name=&quot;GENERATOR&quot;&nbsp;content=&quot;Mozilla/4.5&nbsp;[en]&nbsp;(X11;&nbsp;I;&nbsp;HP-UX&nbsp;B.10.20&nbsp;9000/715)&nbsp;[Netscape]&quot;&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;&lt;font&nbsp;face=&quot;Arial,Helvetica&quot;&gt;The&nbsp;Layout&nbsp;of&nbsp;Objects&nbsp;in&nbsp;aCC&lt;/font&gt;&lt;/h1&gt;&lt;p&gt;&lt;br&gt;This&nbsp;is&nbsp;a&nbsp;brief&nbsp;note&nbsp;outlining&nbsp;how&nbsp;objects&nbsp;are&nbsp;laid&nbsp;out&nbsp;by&nbsp;aCC.The&nbsp;contents&nbsp;of&nbsp;this&nbsp;page&nbsp;should&nbsp;supersede&nbsp;prior&nbsp;Taligent&nbsp;information.This&nbsp;page&nbsp;does&nbsp;not&nbsp;describe&nbsp;the&nbsp;layout&nbsp;of&nbsp;virtual&nbsp;tables&nbsp;or&nbsp;the&nbsp;constructionprocess&nbsp;for&nbsp;objects&nbsp;(coming&nbsp;soon&nbsp;to&nbsp;a&nbsp;page&nbsp;near&nbsp;you).&lt;h2&gt;&lt;font&nbsp;face=&quot;Arial,Helvetica&quot;&gt;&lt;font&nbsp;size=+2&gt;Single&nbsp;inheritance&lt;/font&gt;&lt;/font&gt;&lt;/h2&gt;&lt;p&gt;&lt;br&gt;Classes&nbsp;not&nbsp;deriving&nbsp;from&nbsp;base-classes&nbsp;simply&nbsp;layout&nbsp;their&nbsp;membersin&nbsp;declaration&nbsp;order.&nbsp;Although&nbsp;ANSI&nbsp;allows&nbsp;us&nbsp;to&nbsp;reorder&nbsp;protection&nbsp;sections(private,&nbsp;protected,&nbsp;public),&nbsp;aCC&nbsp;ignores&nbsp;protection&nbsp;directives&nbsp;for&nbsp;layoutpurposes.&nbsp;The&nbsp;following&nbsp;program&nbsp;illustrates&nbsp;this:&lt;ul&gt;&lt;pre&gt;extern&nbsp;&quot;C&quot;&nbsp;int&nbsp;printf(char&nbsp;const*,&nbsp;...);struct&nbsp;A&nbsp;{&nbsp;&nbsp;&nbsp;int&nbsp;a1;private:&nbsp;&nbsp;&nbsp;friend&nbsp;int&nbsp;main();&nbsp;&nbsp;&nbsp;int&nbsp;a2;public:&nbsp;&nbsp;&nbsp;int&nbsp;a3;};int&nbsp;main()&nbsp;{&nbsp;&nbsp;&nbsp;A&nbsp;obj;&nbsp;&nbsp;&nbsp;printf(&quot;obj.a1@%x&nbsp;&nbsp;obj.a2@%x&nbsp;&nbsp;obj.a3@%x\n&quot;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;obj.a1,&nbsp;&amp;obj.a2,&nbsp;&amp;obj.a3);}&lt;/pre&gt;&lt;/ul&gt;Which&nbsp;e.g.&nbsp;could&nbsp;output:&lt;ul&gt;&lt;pre&gt;obj.a1@7b03ad80&nbsp;&nbsp;obj.a2@7b03ad84&nbsp;&nbsp;obj.a3@7b03ad88&lt;/pre&gt;&lt;/ul&gt;If&nbsp;a&nbsp;class&nbsp;D&nbsp;is&nbsp;derived&nbsp;from&nbsp;a&nbsp;class&nbsp;B,&nbsp;the&nbsp;members&nbsp;of&nbsp;B&nbsp;come&nbsp;before&nbsp;thoseadded&nbsp;by&nbsp;the&nbsp;D-derivation.&lt;p&gt;If&nbsp;D&nbsp;or&nbsp;B&nbsp;has&nbsp;a&nbsp;virtual&nbsp;member&nbsp;function,&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;virtual&nbsp;tableis&nbsp;placed&nbsp;as&nbsp;a&nbsp;first&nbsp;``hidden&nbsp;member''&nbsp;in&nbsp;the&nbsp;object.&nbsp;This&nbsp;pointer&nbsp;is&nbsp;followedby&nbsp;the&nbsp;members&nbsp;of&nbsp;B,&nbsp;which&nbsp;in&nbsp;turn&nbsp;are&nbsp;followed&nbsp;by&nbsp;the&nbsp;members&nbsp;of&nbsp;D.&lt;p&gt;If&nbsp;B&nbsp;is&nbsp;a&nbsp;virtual&nbsp;base&nbsp;class&nbsp;of&nbsp;D,&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;virtual&nbsp;table&nbsp;is&nbsp;alsoinserted&nbsp;as&nbsp;a&nbsp;first&nbsp;``hidden&nbsp;member'',&nbsp;and&nbsp;the&nbsp;members&nbsp;of&nbsp;the&nbsp;virtual&nbsp;basewill&nbsp;follow&nbsp;those&nbsp;added&nbsp;by&nbsp;D.&nbsp;This&nbsp;virtual&nbsp;table&nbsp;describes&nbsp;the&nbsp;locationof&nbsp;the&nbsp;virtual&nbsp;base&nbsp;within&nbsp;the&nbsp;D&nbsp;object;&nbsp;this&nbsp;location&nbsp;depends&nbsp;on&nbsp;whetherthe&nbsp;D&nbsp;object&nbsp;is&nbsp;complete,&nbsp;or&nbsp;whether&nbsp;it&nbsp;is&nbsp;part&nbsp;of&nbsp;a&nbsp;larger&nbsp;object&nbsp;(seethe&nbsp;multiple&nbsp;inheritance&nbsp;case&nbsp;below).&lt;p&gt;If&nbsp;in&nbsp;the&nbsp;latter&nbsp;case,&nbsp;the&nbsp;B&nbsp;object&nbsp;is&nbsp;polymorphic&nbsp;this&nbsp;virtual&nbsp;baseobject&nbsp;must&nbsp;know&nbsp;its&nbsp;location&nbsp;within&nbsp;the&nbsp;larger&nbsp;object&nbsp;and&nbsp;therefore&nbsp;containsa&nbsp;second&nbsp;hidden&nbsp;member&nbsp;as&nbsp;the&nbsp;first&nbsp;item&nbsp;in&nbsp;the&nbsp;list&nbsp;of&nbsp;virtual&nbsp;base&nbsp;members.This&nbsp;is&nbsp;not&nbsp;the&nbsp;case&nbsp;if&nbsp;only&nbsp;the&nbsp;D&nbsp;derivation&nbsp;introduces&nbsp;polymorphism.&lt;p&gt;The&nbsp;following&nbsp;program&nbsp;must&nbsp;be&nbsp;linked&nbsp;with&nbsp;the&nbsp;-E&nbsp;linker&nbsp;option&nbsp;(aCC-Wl,-E);&nbsp;it&nbsp;prints&nbsp;out&nbsp;a&nbsp;description&nbsp;of&nbsp;a&nbsp;variety&nbsp;of&nbsp;D:B&nbsp;objects.&lt;ul&gt;&lt;pre&gt;#include&nbsp;&lt;assert.h&gt;#include&nbsp;&lt;dl.h&gt;#include&nbsp;&lt;malloc.h&gt;#include&nbsp;&lt;stdio.h&gt;#include&nbsp;&lt;typeinfo&gt;typedef&nbsp;void*(*shl_allocator)();shl_symbol&nbsp;*sym_table;int&nbsp;n_syms;static&nbsp;voidload_self_symbols()&nbsp;{&nbsp;&nbsp;&nbsp;shl_descriptor&nbsp;*d&nbsp;=&nbsp;0;&nbsp;&nbsp;&nbsp;shl_gethandle(PROG_HANDLE,&nbsp;&amp;d);&nbsp;&nbsp;&nbsp;printf(&quot;Executable&nbsp;file&nbsp;%s\n&quot;,&nbsp;d-&gt;filename);&nbsp;&nbsp;&nbsp;shl_t&nbsp;h&nbsp;=&nbsp;d-&gt;handle;&nbsp;&nbsp;&nbsp;n_syms&nbsp;=&nbsp;shl_getsymbols(h,&nbsp;TYPE_DATA,&nbsp;EXPORT_SYMBOLS,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(shl_allocator)malloc,&nbsp;&amp;sym_table);}static&nbsp;char&nbsp;const*address2sym(void&nbsp;const&nbsp;*a)&nbsp;{&nbsp;&nbsp;&nbsp;if&nbsp;(!a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&quot;&lt;null&nbsp;pointer&gt;&quot;;&nbsp;&nbsp;&nbsp;int&nbsp;offset&nbsp;=&nbsp;0x3fff,&nbsp;closest&nbsp;=&nbsp;-1;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;k&nbsp;=&nbsp;0;&nbsp;k!=n_syms;&nbsp;++k)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;diff&nbsp;=&nbsp;(char&nbsp;const*)a-(char&nbsp;const*)sym_table[k].value;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(diff==0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sym_table[k].name;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(diff&gt;0&nbsp;&amp;&amp;&nbsp;diff&lt;offset)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closest&nbsp;=&nbsp;k;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offset&nbsp;=&nbsp;diff;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;static&nbsp;char&nbsp;msg[80];&nbsp;&nbsp;&nbsp;if&nbsp;(closest==-1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sprintf(msg,&nbsp;&quot;&lt;address&nbsp;%x&nbsp;not&nbsp;found&gt;&quot;,&nbsp;a);&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sprintf(msg,&nbsp;&quot;%s&nbsp;+&nbsp;%d&quot;,&nbsp;sym_table[closest].name,&nbsp;offset);&nbsp;&nbsp;&nbsp;return&nbsp;msg;}struct&nbsp;B&nbsp;{&nbsp;&nbsp;&nbsp;long&nbsp;b;};struct&nbsp;pB&nbsp;{&nbsp;&nbsp;&nbsp;long&nbsp;b;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;f()&nbsp;{}};struct&nbsp;D:&nbsp;B&nbsp;{&nbsp;&nbsp;&nbsp;long&nbsp;d;}&nbsp;D_obj;struct&nbsp;pD:&nbsp;B&nbsp;{&nbsp;&nbsp;&nbsp;long&nbsp;d;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;f()&nbsp;{}}&nbsp;pD_obj;struct&nbsp;Dp:&nbsp;pB&nbsp;{&nbsp;&nbsp;&nbsp;long&nbsp;d;}&nbsp;Dp_obj;struct&nbsp;pDp:&nbsp;pB&nbsp;{&nbsp;&nbsp;&nbsp;long&nbsp;d;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;f()&nbsp;{}}&nbsp;pDp_obj;struct&nbsp;Dv:&nbsp;virtual&nbsp;B&nbsp;{&nbsp;&nbsp;&nbsp;long&nbsp;d;}&nbsp;Dv_obj;struct&nbsp;Dvp:&nbsp;virtual&nbsp;pB&nbsp;{&nbsp;&nbsp;&nbsp;long&nbsp;d;}&nbsp;Dvp_obj;struct&nbsp;pDv:&nbsp;virtual&nbsp;B&nbsp;{&nbsp;&nbsp;&nbsp;long&nbsp;d;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;f()&nbsp;{}}&nbsp;pDv_obj;template&lt;typename&nbsp;T&gt;void&nbsp;describe(T&amp;&nbsp;obj)&nbsp;{&nbsp;&nbsp;&nbsp;printf(&quot;%s&nbsp;object:&nbsp;size==%d,&nbsp;address==%x\n&quot;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;typeid(T).name(),&nbsp;sizeof(T),&nbsp;&amp;obj);&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;offset&nbsp;=&nbsp;0;&nbsp;offset&lt;sizeof(T);&nbsp;offset+=sizeof(long))&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char&nbsp;const&nbsp;*p&nbsp;=&nbsp;(char&nbsp;const*)&amp;obj+offset;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(p==(char&nbsp;const*)&amp;obj.b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;object.b\n&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(p==(char&nbsp;const*)&amp;obj.d)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;object.d\n&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;pointer&nbsp;to:&nbsp;%s\n&quot;,&nbsp;address2sym(*(void**)p));&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;printf(&quot;\n&quot;);}int&nbsp;main()&nbsp;{&nbsp;&nbsp;&nbsp;assert(sizeof(void*)==sizeof(long));&nbsp;&nbsp;&nbsp;load_self_symbols();&nbsp;&nbsp;&nbsp;describe(D_obj);&nbsp;&nbsp;&nbsp;describe(pD_obj);&nbsp;&nbsp;&nbsp;describe(Dp_obj);&nbsp;&nbsp;&nbsp;describe(pDp_obj);&nbsp;&nbsp;&nbsp;describe(Dv_obj);&nbsp;&nbsp;&nbsp;describe(Dvp_obj);&nbsp;&nbsp;&nbsp;describe(pDv_obj);}&lt;/pre&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/ul&gt;&lt;h2&gt;&lt;font&nbsp;face=&quot;Arial,Helvetica&quot;&gt;&lt;font&nbsp;size=+2&gt;Multiple&nbsp;Inheritance&lt;/font&gt;&lt;/font&gt;&lt;/h2&gt;&lt;p&gt;&lt;br&gt;Assume&nbsp;a&nbsp;class&nbsp;D&nbsp;declares&nbsp;multiple&nbsp;base&nbsp;classes&nbsp;B1,&nbsp;B2,&nbsp;...,&nbsp;Bn(in&nbsp;that&nbsp;order).&nbsp;The&nbsp;``primary&nbsp;base-class&nbsp;of&nbsp;D''&nbsp;is&nbsp;defined&nbsp;as&nbsp;follows:&lt;ol&gt;&lt;li&gt;If&nbsp;any&nbsp;non-virtual&nbsp;base&nbsp;Bk&nbsp;has&nbsp;virtual&nbsp;base-classes&nbsp;itself,&nbsp;the&nbsp;first&nbsp;suchBk&nbsp;will&nbsp;be&nbsp;the&nbsp;primary&nbsp;base&nbsp;class&nbsp;of&nbsp;D;&nbsp;otherwise&lt;/li&gt;&lt;li&gt;If&nbsp;any&nbsp;non-virtual&nbsp;base&nbsp;Bk&nbsp;has&nbsp;or&nbsp;inherits&nbsp;a&nbsp;virtual&nbsp;function,&nbsp;the&nbsp;firstsuch&nbsp;Bk&nbsp;will&nbsp;the&nbsp;primary&nbsp;base&nbsp;class&nbsp;of&nbsp;D;&nbsp;otherwise&lt;/li&gt;&lt;li&gt;There&nbsp;is&nbsp;no&nbsp;primary&nbsp;base&nbsp;class.&lt;/li&gt;&lt;/ol&gt;If&nbsp;D&nbsp;has&nbsp;a&nbsp;primary&nbsp;base-class,&nbsp;the&nbsp;non-virtual&nbsp;part&nbsp;of&nbsp;the&nbsp;correspondingsub-object&nbsp;will&nbsp;come&nbsp;first&nbsp;in&nbsp;the&nbsp;layout.&nbsp;Furthermore,&nbsp;the&nbsp;complete&nbsp;object,and&nbsp;its&nbsp;primary&nbsp;base&nbsp;subobject&nbsp;will&nbsp;share&nbsp;a&nbsp;virtual&nbsp;table&nbsp;pointer.&nbsp;E.g.:&lt;ul&gt;&lt;pre&gt;struct&nbsp;nB&nbsp;{&nbsp;//&nbsp;non-polymorphic&nbsp;&nbsp;&nbsp;long&nbsp;n;};struct&nbsp;pB&nbsp;{&nbsp;//&nbsp;polymorphic&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;f();&nbsp;&nbsp;&nbsp;long&nbsp;p;};struct&nbsp;wB:&nbsp;virtual&nbsp;nB&nbsp;{&nbsp;//&nbsp;with&nbsp;virtual&nbsp;base&nbsp;&nbsp;&nbsp;long&nbsp;w;};struct&nbsp;D:&nbsp;nB,&nbsp;pB,&nbsp;wB&nbsp;{&nbsp;//&nbsp;primary-base&nbsp;is&nbsp;wB&nbsp;by&nbsp;(1)&nbsp;above&nbsp;&nbsp;&nbsp;long&nbsp;d;};&lt;/pre&gt;&lt;/ul&gt;The&nbsp;primary&nbsp;base&nbsp;of&nbsp;D&nbsp;is&nbsp;wB&nbsp;(by&nbsp;(1)&nbsp;above)&nbsp;and&nbsp;hence&nbsp;its&nbsp;data-members&nbsp;andnonvirtual&nbsp;subobjects&nbsp;will&nbsp;come&nbsp;first&nbsp;in&nbsp;the&nbsp;layout:&lt;ul&gt;&lt;tt&gt;word&nbsp;1:&nbsp;vtbl-pointer&nbsp;for&nbsp;D&nbsp;and&nbsp;wB-in-D&nbsp;(shared)&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;word&nbsp;2:&nbsp;wB::w&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;//&nbsp;...&lt;/tt&gt;&lt;/ul&gt;Next&nbsp;come&nbsp;the&nbsp;remaining&nbsp;non-virtual&nbsp;base&nbsp;classes&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;weredeclared,&nbsp;followed&nbsp;by&nbsp;the&nbsp;data-members&nbsp;of&nbsp;D.&nbsp;If&nbsp;any&nbsp;of&nbsp;these&nbsp;virtual&nbsp;base-classeshad&nbsp;virtual&nbsp;members&nbsp;or&nbsp;virtual&nbsp;base-classes,&nbsp;it&nbsp;would&nbsp;have&nbsp;a&nbsp;leading&nbsp;virtual-tablepointer&nbsp;of&nbsp;its&nbsp;own.&nbsp;For&nbsp;the&nbsp;example&nbsp;above:&lt;ul&gt;&lt;tt&gt;word&nbsp;1:&nbsp;vtbl-pointer&nbsp;for&nbsp;D&nbsp;and&nbsp;wB-in-D&nbsp;(shared)&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;word&nbsp;2:&nbsp;D::wB::w&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;word&nbsp;3:&nbsp;D::nB::n&nbsp;//&nbsp;nB&nbsp;needs&nbsp;no&nbsp;vtable-pointer&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;word&nbsp;4:&nbsp;vtbl-pointer&nbsp;for&nbsp;pB&nbsp;(not&nbsp;shared)&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;word&nbsp;5:&nbsp;D::pB::p&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;word&nbsp;6:&nbsp;D::d&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;//&nbsp;...&lt;/tt&gt;&lt;/ul&gt;Finally,&nbsp;the&nbsp;direct&nbsp;and&nbsp;indirect&nbsp;virtual&nbsp;base&nbsp;sub-objects&nbsp;are&nbsp;laid&nbsp;out.They&nbsp;are&nbsp;placed&nbsp;in&nbsp;the&nbsp;order&nbsp;of&nbsp;a&nbsp;depth-first,&nbsp;left-to-right&nbsp;traversalof&nbsp;the&nbsp;inheritance&nbsp;graph&nbsp;(independently&nbsp;of&nbsp;when&nbsp;the&nbsp;traversal&nbsp;hits&nbsp;theprimary&nbsp;base).&nbsp;`Left-to-right'&nbsp;means&nbsp;the&nbsp;order&nbsp;of&nbsp;declaration&nbsp;of&nbsp;the&nbsp;bases.The&nbsp;complete&nbsp;layout&nbsp;of&nbsp;the&nbsp;example&nbsp;above&nbsp;is&nbsp;hence:&lt;ul&gt;&lt;tt&gt;word&nbsp;1:&nbsp;vtbl-pointer&nbsp;for&nbsp;D&nbsp;and&nbsp;wB-in-D&nbsp;(shared)&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;word&nbsp;2:&nbsp;D::wB::w&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;word&nbsp;3:&nbsp;D::nB::n&nbsp;//&nbsp;nB&nbsp;needs&nbsp;no&nbsp;vtable-pointer&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;word&nbsp;4:&nbsp;vtbl-pointer&nbsp;for&nbsp;pB&nbsp;(not&nbsp;shared)&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;word&nbsp;5:&nbsp;D::pB::p&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;word&nbsp;6:&nbsp;D::d&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;word&nbsp;7:&nbsp;D::wB::nB::n&nbsp;//&nbsp;virtual-base&nbsp;subobject&lt;/tt&gt;&lt;/ul&gt;One&nbsp;more&nbsp;(involved)&nbsp;example:&lt;pre&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B_1&nbsp;&nbsp;&nbsp;&nbsp;B_2*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B_4*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B_7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/v&nbsp;&nbsp;\v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B_3&nbsp;&nbsp;&nbsp;B_5&nbsp;&nbsp;&nbsp;B_6&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;|v&nbsp;&nbsp;/v&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\&nbsp;&nbsp;&nbsp;&nbsp;`-&nbsp;D*-'&nbsp;&nbsp;&nbsp;/v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`-----'&nbsp;`----'&lt;/pre&gt;`v'&nbsp;indicates&nbsp;virtual&nbsp;inheritance.&nbsp;Assume&nbsp;that&nbsp;B_2,&nbsp;B_4&nbsp;and&nbsp;D&nbsp;have&nbsp;virtualmember&nbsp;functions&nbsp;(marked&nbsp;with&nbsp;a&nbsp;`*').&nbsp;Here&nbsp;are&nbsp;the&nbsp;declarations:&lt;pre&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;B_1&nbsp;{&nbsp;long&nbsp;b1;&nbsp;};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;B_2&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;b2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;f();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;B_3:&nbsp;B_2&nbsp;{&nbsp;long&nbsp;b3;&nbsp;};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;B_4&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;b4;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;f();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;B_5:&nbsp;virtual&nbsp;B_4&nbsp;{&nbsp;long&nbsp;b5;&nbsp;};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;B_6:&nbsp;virtual&nbsp;B_4&nbsp;{&nbsp;long&nbsp;b6;&nbsp;};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;B_7&nbsp;{&nbsp;long&nbsp;b7;&nbsp;};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;D:&nbsp;B_1,&nbsp;B_3,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;B_5,&nbsp;virtual&nbsp;B_6,&nbsp;virtual&nbsp;B_7&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;d;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;f();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};&lt;/pre&gt;B_3&nbsp;is&nbsp;the&nbsp;primary&nbsp;base&nbsp;of&nbsp;D&nbsp;by&nbsp;definition&nbsp;(2)&nbsp;above.&nbsp;The&nbsp;depth-first,left-to-right&nbsp;traversal&nbsp;of&nbsp;the&nbsp;virtual&nbsp;bases&nbsp;is:&nbsp;B_4,&nbsp;B_5,&nbsp;B_6,&nbsp;B_7&nbsp;(thebase-classes&nbsp;were&nbsp;numbered&nbsp;in&nbsp;depth-&nbsp;first&nbsp;left-to-right&nbsp;order).&nbsp;By&nbsp;thediscussion&nbsp;above,&nbsp;a&nbsp;complete&nbsp;object&nbsp;of&nbsp;type&nbsp;D&nbsp;is&nbsp;laid&nbsp;out&nbsp;as&nbsp;follows:&lt;ul&gt;&lt;tt&gt;primary-base:&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;&nbsp;&nbsp;&nbsp;&nbsp;word&nbsp;1:&nbsp;vtable-pointer&nbsp;for&nbsp;D&nbsp;and&nbsp;B_3-in-D&nbsp;(shared)&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;&nbsp;&nbsp;&nbsp;&nbsp;word&nbsp;2:&nbsp;b2&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;&nbsp;&nbsp;&nbsp;&nbsp;word&nbsp;3:&nbsp;b3&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;other&nbsp;non-virtual&nbsp;bases:&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;&nbsp;&nbsp;&nbsp;&nbsp;word&nbsp;4:&nbsp;b1&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;data-members:&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;&nbsp;&nbsp;&nbsp;&nbsp;word&nbsp;5:&nbsp;d&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;virtual&nbsp;bases:&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;&nbsp;&nbsp;&nbsp;&nbsp;word&nbsp;6:&nbsp;vtable-pointer&nbsp;for&nbsp;B_4&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;&nbsp;&nbsp;&nbsp;&nbsp;word&nbsp;7:&nbsp;b4&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;&nbsp;&nbsp;&nbsp;&nbsp;word&nbsp;8:&nbsp;vtable-pointer&nbsp;for&nbsp;B_5&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;&nbsp;&nbsp;&nbsp;&nbsp;word&nbsp;9:&nbsp;b5&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;&nbsp;&nbsp;&nbsp;&nbsp;word&nbsp;10:&nbsp;vtable-pointer&nbsp;for&nbsp;B_6&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;&nbsp;&nbsp;&nbsp;&nbsp;word&nbsp;11:&nbsp;b6&lt;/tt&gt;&lt;br&gt;&lt;tt&gt;&nbsp;&nbsp;&nbsp;&nbsp;word&nbsp;12:&nbsp;b7&lt;/tt&gt;&lt;/ul&gt;Note&nbsp;that&nbsp;virtual&nbsp;base&nbsp;classes&nbsp;never&nbsp;share&nbsp;a&nbsp;vtable-pointer.&nbsp;Hereunderis&nbsp;a&nbsp;program&nbsp;that&nbsp;demonstrates&nbsp;this&nbsp;last&nbsp;example&nbsp;along&nbsp;with&nbsp;a&nbsp;few&nbsp;simplerexamples:&lt;ul&gt;&lt;pre&gt;#include&nbsp;&lt;assert.h&gt;#include&nbsp;&lt;dl.h&gt;#include&nbsp;&lt;malloc.h&gt;#include&nbsp;&lt;stdio.h&gt;#include&nbsp;&lt;typeinfo&gt;typedef&nbsp;void*(*shl_allocator)();shl_symbol&nbsp;*sym_table;int&nbsp;n_syms;static&nbsp;voidload_self_symbols()&nbsp;{&nbsp;&nbsp;&nbsp;shl_descriptor&nbsp;*d&nbsp;=&nbsp;0;&nbsp;&nbsp;&nbsp;shl_gethandle(PROG_HANDLE,&nbsp;&amp;d);&nbsp;&nbsp;&nbsp;printf(&quot;Executable&nbsp;file&nbsp;%s\n&quot;,&nbsp;d-&gt;filename);&nbsp;&nbsp;&nbsp;shl_t&nbsp;h&nbsp;=&nbsp;d-&gt;handle;&nbsp;&nbsp;&nbsp;n_syms&nbsp;=&nbsp;shl_getsymbols(h,&nbsp;TYPE_DATA,&nbsp;EXPORT_SYMBOLS,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(shl_allocator)malloc,&nbsp;&amp;sym_table);}static&nbsp;char&nbsp;const*address2sym(void&nbsp;const&nbsp;*a)&nbsp;{&nbsp;&nbsp;&nbsp;if&nbsp;(!a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&quot;&lt;null&nbsp;pointer&gt;&quot;;&nbsp;&nbsp;&nbsp;int&nbsp;offset&nbsp;=&nbsp;0x3fff,&nbsp;closest&nbsp;=&nbsp;-1;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;k&nbsp;=&nbsp;0;&nbsp;k!=n_syms;&nbsp;++k)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;diff&nbsp;=&nbsp;(char&nbsp;const*)a-(char&nbsp;const*)sym_table[k].value;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(diff==0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sym_table[k].name;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(diff&gt;0&nbsp;&amp;&amp;&nbsp;diff&lt;offset)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closest&nbsp;=&nbsp;k;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offset&nbsp;=&nbsp;diff;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;static&nbsp;char&nbsp;msg[80];&nbsp;&nbsp;&nbsp;if&nbsp;(closest==-1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sprintf(msg,&nbsp;&quot;&lt;address&nbsp;%x&nbsp;not&nbsp;found&gt;&quot;,&nbsp;a);&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sprintf(msg,&nbsp;&quot;%s&nbsp;+&nbsp;%d&quot;,&nbsp;sym_table[closest].name,&nbsp;offset);&nbsp;&nbsp;&nbsp;return&nbsp;msg;}struct&nbsp;nB&nbsp;{&nbsp;&nbsp;&nbsp;nB():&nbsp;b('b')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;b;};struct&nbsp;pB&nbsp;{&nbsp;&nbsp;&nbsp;pB():&nbsp;p('p')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;p;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;f()&nbsp;{}};struct&nbsp;vB&nbsp;{&nbsp;&nbsp;&nbsp;vB():&nbsp;v('v')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;v;};struct&nbsp;wB:&nbsp;virtual&nbsp;nB&nbsp;{&nbsp;&nbsp;&nbsp;wB():&nbsp;w('w')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;w;};struct&nbsp;xB:&nbsp;virtual&nbsp;nB&nbsp;{&nbsp;&nbsp;&nbsp;xB():&nbsp;x('x')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;x;};struct&nbsp;cB:&nbsp;virtual&nbsp;nB&nbsp;{&nbsp;&nbsp;&nbsp;cB():&nbsp;c('c')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;c;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;f()&nbsp;{}};struct&nbsp;Dnv:&nbsp;nB,&nbsp;virtual&nbsp;vB&nbsp;{&nbsp;&nbsp;&nbsp;Dnv():&nbsp;d('d')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;d;}&nbsp;Dnv_obj;struct&nbsp;Dvn:&nbsp;virtual&nbsp;vB,&nbsp;nB&nbsp;{&nbsp;&nbsp;&nbsp;Dvn():&nbsp;d('d')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;d;}&nbsp;Dvn_obj;struct&nbsp;Dvw:&nbsp;virtual&nbsp;vB,&nbsp;virtual&nbsp;wB&nbsp;{&nbsp;&nbsp;&nbsp;Dvw():&nbsp;d('d')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;d;}&nbsp;Dvw_obj;struct&nbsp;Dwv:&nbsp;virtual&nbsp;wB,&nbsp;virtual&nbsp;vB&nbsp;{&nbsp;&nbsp;&nbsp;Dwv():&nbsp;d('d')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;d;}&nbsp;Dwv_obj;struct&nbsp;Dwx:&nbsp;virtual&nbsp;wB,&nbsp;virtual&nbsp;xB&nbsp;{&nbsp;&nbsp;&nbsp;Dwx():&nbsp;d('d')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;d;}&nbsp;Dwx_obj;struct&nbsp;Dwc:&nbsp;wB,&nbsp;virtual&nbsp;cB&nbsp;{&nbsp;&nbsp;&nbsp;Dwc():&nbsp;d('d')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;d;}&nbsp;Dwc_obj;template&lt;typename&nbsp;T&gt;void&nbsp;describe(T&amp;&nbsp;obj)&nbsp;{&nbsp;&nbsp;&nbsp;printf(&quot;%s&nbsp;object:&nbsp;size==%d,&nbsp;address==%x\n&quot;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;typeid(T).name(),&nbsp;sizeof(T),&nbsp;&amp;obj);&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;offset&nbsp;=&nbsp;0;&nbsp;offset&lt;sizeof(T);&nbsp;offset+=sizeof(long))&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char&nbsp;const&nbsp;*p&nbsp;=&nbsp;(char&nbsp;const*)&amp;obj+offset;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(*(long&nbsp;const*)p&lt;='z')&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;object.%c\n&quot;,&nbsp;char(*(long&nbsp;const*)p));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;pointer&nbsp;to:&nbsp;%s\n&quot;,&nbsp;address2sym(*(void**)p));&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;printf(&quot;\n&quot;);}struct&nbsp;B_1&nbsp;{&nbsp;&nbsp;&nbsp;B_1():&nbsp;b1('1')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;b1;};struct&nbsp;B_3&nbsp;{&nbsp;&nbsp;&nbsp;B_3():&nbsp;b3('3')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;b3;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;f()&nbsp;{}};struct&nbsp;B_2:&nbsp;B_3&nbsp;{&nbsp;&nbsp;&nbsp;B_2():&nbsp;b2('2')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;b2;};struct&nbsp;B_5&nbsp;{&nbsp;&nbsp;&nbsp;B_5():&nbsp;b5('5')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;b5;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;f()&nbsp;{}};struct&nbsp;B_4:&nbsp;virtual&nbsp;B_5&nbsp;{&nbsp;&nbsp;&nbsp;B_4():&nbsp;b4('4')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;b4;};struct&nbsp;B_6:&nbsp;virtual&nbsp;B_5&nbsp;{&nbsp;&nbsp;&nbsp;B_6():&nbsp;b6('6')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;b6;};struct&nbsp;B_7&nbsp;{&nbsp;&nbsp;&nbsp;B_7():&nbsp;b7('7')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;b7;};struct&nbsp;D:&nbsp;B_1,&nbsp;B_2,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;virtual&nbsp;B_4,&nbsp;virtual&nbsp;B_6,&nbsp;virtual&nbsp;B_7&nbsp;{&nbsp;&nbsp;&nbsp;D():&nbsp;d('d')&nbsp;{}&nbsp;&nbsp;&nbsp;long&nbsp;d;&nbsp;&nbsp;&nbsp;virtual&nbsp;void&nbsp;f()&nbsp;{}}&nbsp;complex_D_object;int&nbsp;main()&nbsp;{&nbsp;&nbsp;&nbsp;assert(sizeof(void*)==sizeof(long));&nbsp;&nbsp;&nbsp;load_self_symbols();&nbsp;&nbsp;&nbsp;describe(Dnv_obj);&nbsp;&nbsp;&nbsp;describe(Dvn_obj);&nbsp;&nbsp;&nbsp;describe(Dvw_obj);&nbsp;&nbsp;&nbsp;describe(Dwv_obj);&nbsp;&nbsp;&nbsp;describe(Dwx_obj);&nbsp;&nbsp;&nbsp;describe(Dwc_obj);&nbsp;&nbsp;&nbsp;describe(complex_D_object);}&lt;/pre&gt;&lt;/ul&gt;&lt;h2&gt;&lt;font&nbsp;face=&quot;Arial,Helvetica&quot;&gt;The&nbsp;empty&nbsp;base-class&nbsp;bug&lt;/font&gt;&lt;/h2&gt;&lt;p&gt;&lt;br&gt;The&nbsp;C++&nbsp;language&nbsp;allows&nbsp;an&nbsp;empty&nbsp;base-class&nbsp;to&nbsp;share&nbsp;its&nbsp;locationwith&nbsp;its&nbsp;descendants.&nbsp;E.g.:&lt;ul&gt;&lt;pre&gt;struct&nbsp;Empty&nbsp;{}&nbsp;empty;struct&nbsp;AlsoEmpty:&nbsp;Empty&nbsp;{}&nbsp;also_empty;struct&nbsp;NotEmpty:&nbsp;AlsoEmpty&nbsp;{&nbsp;&nbsp;&nbsp;long&nbsp;d;}&nbsp;not_empty;struct&nbsp;Empty2&nbsp;{};struct&nbsp;Bug:&nbsp;Empty2,&nbsp;AlsoEmpty&nbsp;{&nbsp;&nbsp;&nbsp;long&nbsp;d;}&nbsp;bug;&lt;/pre&gt;&lt;/ul&gt;In&nbsp;this&nbsp;example,&nbsp;the&nbsp;language&nbsp;allows&nbsp;the&nbsp;following&nbsp;equalities:&lt;ul&gt;&lt;pre&gt;(void*)&amp;(Empty&amp;)also_empty&nbsp;==&nbsp;(void*)&amp;also_empty(void*)&amp;(Empty&amp;)(AlsoEmpty&amp;)not_empty&nbsp;&nbsp;&nbsp;==&nbsp;(void*)&amp;(AlsoEmpty&amp;)not_empty&nbsp;&nbsp;&nbsp;==&nbsp;(void*)&amp;not_empty(void*)&amp;(Empty&amp;)(AlsoEmpty&amp;)bug&nbsp;&nbsp;&nbsp;==&nbsp;(void*)&amp;(AlsoEmpty&amp;)bug&nbsp;&nbsp;&nbsp;==&nbsp;(void*)&amp;bug&lt;/pre&gt;&lt;/ul&gt;but&nbsp;also&nbsp;imposes&nbsp;the&nbsp;following&nbsp;INequalities:&lt;pre&gt;(void*)&amp;empty&nbsp;!=&nbsp;(void*)&amp;also_empty(void*)&amp;(Empty2&amp;)bug&nbsp;!=&nbsp;(void*)&amp;(AlsoEmpty&amp;)bug&lt;/pre&gt;I.e.,&nbsp;for&nbsp;two&nbsp;subobjects&nbsp;to&nbsp;have&nbsp;the&nbsp;same&nbsp;address,&nbsp;one&nbsp;must&nbsp;be&nbsp;derivedfrom&nbsp;the&nbsp;other&nbsp;(a&nbsp;sibling-relationship&nbsp;is&nbsp;not&nbsp;valid).&nbsp;aCC&nbsp;violates&nbsp;thislanguage&nbsp;rule&nbsp;by&nbsp;indiscriminately&nbsp;allocating&nbsp;zero&nbsp;bytes&nbsp;for&nbsp;empty&nbsp;base-classes.The&nbsp;following&nbsp;program&nbsp;illustrates&nbsp;how&nbsp;this&nbsp;leads&nbsp;to&nbsp;a&nbsp;violation&nbsp;of&nbsp;thelast&nbsp;inequality&nbsp;above.&lt;ul&gt;&lt;pre&gt;#include&nbsp;&lt;stdio.h&gt;struct&nbsp;Empty&nbsp;{};struct&nbsp;Empty2&nbsp;{};struct&nbsp;AlsoEmpty:&nbsp;Empty&nbsp;{}&nbsp;also_empty;struct&nbsp;Bug:&nbsp;Empty2,&nbsp;AlsoEmpty&nbsp;{&nbsp;&nbsp;&nbsp;long&nbsp;d;}&nbsp;bug;int&nbsp;main()&nbsp;{&nbsp;&nbsp;&nbsp;printf(&quot;&amp;bug&nbsp;==&nbsp;%x\n&amp;(Empty2&amp;)bug&nbsp;==&nbsp;%x\n&amp;(AlsoEmpty&amp;)bug&nbsp;==&nbsp;%x\n&quot;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;bug,&nbsp;&amp;(Empty2&amp;)bug,&nbsp;&amp;(AlsoEmpty&amp;)bug);}&lt;/pre&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;
</tt>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [cxx-abi-dev] Question about tail padding
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:cxx-abi-dev%40codesourcery.com?Subject=Re%3A%20%5Bcxx-abi-dev%5D%20Question%20about%20tail%20padding&In-Reply-To=%3C90490000.1030030860%40warlock.codesourcery.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001502.html">
   <LINK REL="Next"  HREF="001506.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[cxx-abi-dev] Question about tail padding</H1>
    <B>Mark Mitchell</B> 
    <A HREF="mailto:cxx-abi-dev%40codesourcery.com?Subject=Re%3A%20%5Bcxx-abi-dev%5D%20Question%20about%20tail%20padding&In-Reply-To=%3C90490000.1030030860%40warlock.codesourcery.com%3E"
       TITLE="[cxx-abi-dev] Question about tail padding">mark at codesourcery.com
       </A><BR>
    <I>Thu Aug 22 15:41:00 UTC 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="001502.html">[cxx-abi-dev] Question about tail padding
</A></li>
        <LI>Next message: <A HREF="001506.html">[cxx-abi-dev] Question about tail padding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1505">[ date ]</a>
              <a href="thread.html#1505">[ thread ]</a>
              <a href="subject.html#1505">[ subject ]</a>
              <a href="author.html#1505">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> from the ABI doc, 2.1
</I>&gt;<i> 	nvsize(O): the non-virtual size of an object, which intuitively is
</I>&gt;<i> dsize(O) 	minus the size of virtual bases. It is always equal to dsize(O)
</I>&gt;<i> for types 	without virtual bases.
</I>&gt;<i> this implies that nvsize (B) should be 9. and A allocated there.
</I>&gt;<i> but, 2.4 II says
</I>&gt;<i> 	After all such components have been allocated, set nvalign(C) =
</I>&gt;<i> align(C), and 	set nvsize(C) to the least multiple of nvalign(C) that is
</I>&gt;<i> greater than or 	equal to dsize(C). The values of nvalign(C) and
</I>&gt;<i> nvsize(C) will not change 	during virtual base allocation.
</I>&gt;<i> which would make nvsize 12.
</I>&gt;<i>
</I>&gt;<i> This is a different problem to the one Mark brought up.
</I>
It is?

I thought we had decided last week to eliminate the 2.4 II reference to
updating nvsize(C), which would seem to eliminate this particular
inconsistency.  (That would also imply that G++ is incorrect.  From
looking at the G++ source code I can see why it behaves the way it does.)

As you say, what do Intel and HP do?  It would be very nice if they
happen to get this wrong in the same way that G++ does...

I've got patches to the ABI document to try to clarify the issue I
raised last week, but I will wait until we resolve this one too before
checking them in; we may as well try to clarify this all at once.

-- 
Mark Mitchell                <A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/cxx-abi-dev">mark at codesourcery.com</A>
CodeSourcery, LLC            <A HREF="http://www.codesourcery.com">http://www.codesourcery.com</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001502.html">[cxx-abi-dev] Question about tail padding
</A></li>
	<LI>Next message: <A HREF="001506.html">[cxx-abi-dev] Question about tail padding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1505">[ date ]</a>
              <a href="thread.html#1505">[ thread ]</a>
              <a href="subject.html#1505">[ subject ]</a>
              <a href="author.html#1505">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://sourcerytools.com/cgi-bin/mailman/listinfo/cxx-abi-dev">More information about the cxx-abi-dev
mailing list</a><br>
</body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Interleaving members
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:cxx-abi-dev%40codesourcery.com?Subject=Re%3A%20Interleaving%20members&In-Reply-To=%3C0FDJ008OJ9YXCI%40ha-sims.eng.sun.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000119.html">
   <LINK REL="Next"  HREF="000121.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Interleaving members</H1>
    <B>Michael Ball</B> 
    <A HREF="mailto:cxx-abi-dev%40codesourcery.com?Subject=Re%3A%20Interleaving%20members&In-Reply-To=%3C0FDJ008OJ9YXCI%40ha-sims.eng.sun.com%3E"
       TITLE="Interleaving members">michael.ball at eng.sun.com
       </A><BR>
    <I>Fri Jun 18 17:32:15 UTC 1999</I>
    <P><UL>
        <LI>Previous message: <A HREF="000119.html">Interleaving members
</A></li>
        <LI>Next message: <A HREF="000121.html">C++ ABI Summary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#120">[ date ]</a>
              <a href="thread.html#120">[ thread ]</a>
              <a href="subject.html#120">[ subject ]</a>
              <a href="author.html#120">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i>I asked on the reflector: yes, given the class
</I>&gt;<i>  struct X {
</I>&gt;<i>  public:
</I>&gt;<i>    int a, b;
</I>&gt;<i>  public:
</I>&gt;<i>    int c, d;
</I>&gt;<i>  };
</I>&gt;<i>it is legal to have the layout A C B D.  This was intentional; we
</I>&gt;<i>aren't just exploiting a loophole in the wording.  Interestingly,
</I>&gt;<i>Bjarne says that this was also true (and equally intentional) in
</I>&gt;<i>the ARM.
</I>&gt;<i>
</I>&gt;<i>I still don't know of any implementation that actually does this.
</I>
In our case it's because we (Sun) consider it highly desirable to use the
C ABI whenever we can, and the obvious mapping onto a C struct is
considered valuable.

There is no strict technical reason for that.  Rather, it's a stronly
held quasi-religious view.  We would have to promise significant gains
to go against it.

In fact, there seems to be little to be gained, for two reasons.

1.  There are very few structs or classes with both public and private
    data elements.  New classes aren't designed that way because it's widely
    considered bad style.  Most that do exist are there because they have
    migrated from C code, and many still refer to the public parts from
    C routines. 
    
2.  With the single exception of classes with lots of bitfields, there just
    isn't that much padding to squeeze out.  People who care seem to
    follow the usual C rules about ordering by descending size.
    
This conclusion is the result of looking at lots of code.  Still, there may 
be a counter example out there.

-Mike-
    



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000119.html">Interleaving members
</A></li>
	<LI>Next message: <A HREF="000121.html">C++ ABI Summary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#120">[ date ]</a>
              <a href="thread.html#120">[ thread ]</a>
              <a href="subject.html#120">[ subject ]</a>
              <a href="author.html#120">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://sourcerytools.com/cgi-bin/mailman/listinfo/cxx-abi-dev">More information about the cxx-abi-dev
mailing list</a><br>
</body></html>

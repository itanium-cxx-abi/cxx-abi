<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> COMDAT
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:cxx-abi-dev%40codesourcery.com?Subject=Re%3A%20COMDAT&In-Reply-To=%3C200009020749.AAA02660%40baalbek.engr.sgi.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001186.html">
   <LINK REL="Next"  HREF="001188.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>COMDAT</H1>
    <B>Jim Dehnert</B> 
    <A HREF="mailto:cxx-abi-dev%40codesourcery.com?Subject=Re%3A%20COMDAT&In-Reply-To=%3C200009020749.AAA02660%40baalbek.engr.sgi.com%3E"
       TITLE="COMDAT">dehnert at baalbek.engr.sgi.com
       </A><BR>
    <I>Sat Sep  2 07:49:38 UTC 2000</I>
    <P><UL>
        <LI>Previous message: <A HREF="001186.html">COMDAT
</A></li>
        <LI>Next message: <A HREF="001188.html">Page updates, scope section
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1187">[ date ]</a>
              <a href="thread.html#1187">[ thread ]</a>
              <a href="subject.html#1187">[ subject ]</a>
              <a href="author.html#1187">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> From: Mark Mitchell &lt;<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/cxx-abi-dev">mark at codesourcery.com</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; &quot;Jim&quot; == Jim Dehnert &lt;<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/cxx-abi-dev">dehnert at baalbek.engr.sgi.com</A>&gt; writes:
</I>&gt;<i> 
</I>&gt;<i>     Jim&gt; not.  The reason is that the usual &quot;as if&quot; rule makes it
</I>&gt;<i>     Jim&gt; unnecessary.  (We haven't explicitly stated the rule -- I
</I>&gt;<i>     Jim&gt; always assume it -- but could.)
</I>&gt;<i> 
</I>&gt;<i> Well, this goes a little beyond the normal as-if rule, which simply
</I>&gt;<i> says that a program cannot detect the difference.  (For example, in
</I>&gt;<i> C's abstract machine, if `x * 2' is implemented as `x + x', no
</I>&gt;<i> conforming program can ever know how the operation was actually
</I>&gt;<i> calculated.)
</I>&gt;<i> 
</I>&gt;<i> But here, `nm' is certainly going to say something different about
</I>&gt;<i> what's where.  So, I think there's a little more of an issue.
</I>
I don't think nm's behavior is relevant.  The 'as if' rule involves
whether the program itself can see a difference, not whether some
external agent can see it.  After all, a debugger that looks at
instructions can see the difference between x*2 and x+x.  And nm can
see the difference when we inline all calls to a subprogram and remove
the out-of-line version.  But we allow both of these.

The reason this case seems more complicated is that its impact goes
beyond the object file where it occurs, and needs to behave properly in
the presence of objects from multiple compilers.  But the principle is
the same -- if the program itself can't detect the difference, there is
no difference.

&gt;<i> Practically speaking, some vendors are not going to have COMDAT groups
</I>&gt;<i> right away.  It would still be nice if they cna produce ABI-compliant
</I>&gt;<i> binaries.  We have to be careful that we are not designing an ABI that
</I>&gt;<i> will be slightly misimplemented in various incompatible ways -- it
</I>&gt;<i> would be better to do something slightly less technically ambitious
</I>&gt;<i> that permitted widespread implementation and interoperation.
</I>
I agree with this.  But I think it's better to suggest an alternate
implementation in a separate document than in the ABI itself.  I guess
I'm not convinced that we've thought of all the potential complications
of mixed implementations.  And I know that I don't want to encourage a
situation where, for instance, a carefully crafted fall-through
alternate entry in a DSO is pre-empted by a weak thunk in the main
executable.  The COMDAT stuff is new, but let's encourage its use, even
while we recognize that, practically speaking, it will be phased in.
Much of the rest of the ABI will be, too.

Jim

-	    Jim Dehnert		<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/cxx-abi-dev">dehnert at sgi.com</A>
				(650)933-4272


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001186.html">COMDAT
</A></li>
	<LI>Next message: <A HREF="001188.html">Page updates, scope section
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1187">[ date ]</a>
              <a href="thread.html#1187">[ thread ]</a>
              <a href="subject.html#1187">[ subject ]</a>
              <a href="author.html#1187">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://sourcerytools.com/cgi-bin/mailman/listinfo/cxx-abi-dev">More information about the cxx-abi-dev
mailing list</a><br>
</body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> RTTI inconsistency
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:cxx-abi-dev%40codesourcery.com?Subject=Re%3A%20RTTI%20inconsistency&In-Reply-To=%3C200001190626.WAA43447%40baalbek.engr.sgi.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000483.html">
   <LINK REL="Next"  HREF="000446.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>RTTI inconsistency</H1>
    <B>Jim Dehnert</B> 
    <A HREF="mailto:cxx-abi-dev%40codesourcery.com?Subject=Re%3A%20RTTI%20inconsistency&In-Reply-To=%3C200001190626.WAA43447%40baalbek.engr.sgi.com%3E"
       TITLE="RTTI inconsistency">dehnert at baalbek.engr.sgi.com
       </A><BR>
    <I>Wed Jan 19 06:26:35 UTC 2000</I>
    <P><UL>
        <LI>Previous message: <A HREF="000483.html">Mangling: initial attempt
</A></li>
        <LI>Next message: <A HREF="000446.html">RTTI queries
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#445">[ date ]</a>
              <a href="thread.html#445">[ thread ]</a>
              <a href="subject.html#445">[ subject ]</a>
              <a href="author.html#445">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> From: Nathan Sidwell &lt;<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/cxx-abi-dev">sidwell at codesourcery.com</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> Hi,
</I>&gt;<i> there is an inconsistency in the documentation of how a vtable
</I>&gt;<i> points to the type_info object for that type.
</I>&gt;<i> 
</I>&gt;<i> The abi layout document Run-Time Type Information (RTTI) section states,
</I>&gt;<i> 
</I>&gt;<i> 3.Every vtable shall contain one entry pointing to an object derived
</I>&gt;<i> 	from std::type_info. This entry is located at the word preceding
</I>&gt;<i> 	the location pointed to by the vptr (i.e., entry &quot;-1&quot;). The
</I>&gt;<i> 	entry is allocated in all vtables; for classes having virtual bases
</I>&gt;<i> 	but no virtual functions, the entry is zero. This entry is coded
</I>&gt;<i> 	as an offset with respect to the virtual table origin, rather than as
</I>&gt;<i> 	a pointer (thereby avoiding run-time relocations). 
</I>
This one is incorrect.  I've fixed it.  Thanks for the observation.

&gt;<i> but the closed issues document section A-6 ends by saying
</I>&gt;<i> 	[991028 all] The current definition, in the ABI data layout document,
</I>&gt;<i> 	has been updated with Daveed's changes, and is accepted. Note that we
</I>&gt;<i> 	are back to using a pointer to RTTI in the vtable (see B-8)...
</I>&gt;<i> 
</I>&gt;<i> Also the Virtual Table Layout section of the ABI document says,
</I>&gt;<i> 	The typeinfo pointer points to the typeinfo object used for RTTI.
</I>&gt;<i> 	All entries in each of the vtables for a given class must point to the
</I>&gt;<i> 	same typeinfo object. A correct implementation of typeinfo equality is
</I>&gt;<i> 	to check pointer equality. 
</I>&gt;<i> 
</I>&gt;<i> so which is it? An offset or a pointer? (I think it has to be a pointer to
</I>&gt;<i> get uniqueness.)
</I>
-	    Jim Dehnert		<A HREF="http://sourcerytools.com/cgi-bin/mailman/listinfo/cxx-abi-dev">dehnert at sgi.com</A>
				(650)933-4272


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000483.html">Mangling: initial attempt
</A></li>
	<LI>Next message: <A HREF="000446.html">RTTI queries
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#445">[ date ]</a>
              <a href="thread.html#445">[ thread ]</a>
              <a href="subject.html#445">[ subject ]</a>
              <a href="author.html#445">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://sourcerytools.com/cgi-bin/mailman/listinfo/cxx-abi-dev">More information about the cxx-abi-dev
mailing list</a><br>
</body></html>
